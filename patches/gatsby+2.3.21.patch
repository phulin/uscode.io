diff --git a/node_modules/gatsby/CHANGELOG.md b/node_modules/gatsby/CHANGELOG.md
index 384a15d..ee4a3e6 100644
--- a/node_modules/gatsby/CHANGELOG.md
+++ b/node_modules/gatsby/CHANGELOG.md
@@ -3,6 +3,178 @@
 All notable changes to this project will be documented in this file.
 See [Conventional Commits](https://conventionalcommits.org) for commit guidelines.
 
+## [2.3.21](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.3.20...gatsby@2.3.21) (2019-04-12)
+
+### Bug Fixes
+
+- **themes:** Restrict the paths that count as shadowable for an issuer ([#12930](https://github.com/gatsbyjs/gatsby/issues/12930)) ([e040947](https://github.com/gatsbyjs/gatsby/commit/e040947))
+
+## [2.3.20](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.3.19...gatsby@2.3.20) (2019-04-11)
+
+### Features
+
+- **gatsby:** use V8.serialize instead of JSON.stringify if available ([#10732](https://github.com/gatsbyjs/gatsby/issues/10732)) ([c043816](https://github.com/gatsbyjs/gatsby/commit/c043816))
+
+## [2.3.19](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.3.18...gatsby@2.3.19) (2019-04-11)
+
+### Bug Fixes
+
+- Get parent not root File node in resolver ([#13289](https://github.com/gatsbyjs/gatsby/issues/13289)) ([8031fcf](https://github.com/gatsbyjs/gatsby/commit/8031fcf)), closes [#13267](https://github.com/gatsbyjs/gatsby/issues/13267) [#13267](https://github.com/gatsbyjs/gatsby/issues/13267)
+
+## [2.3.18](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.3.17...gatsby@2.3.18) (2019-04-11)
+
+**Note:** Version bump only for package gatsby
+
+## [2.3.17](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.3.16...gatsby@2.3.17) (2019-04-10)
+
+**Note:** Version bump only for package gatsby
+
+## [2.3.16](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.3.15...gatsby@2.3.16) (2019-04-09)
+
+### Features
+
+- **gatsby:** Add normalization for pathPrefix, siteUrl, etc ([#12139](https://github.com/gatsbyjs/gatsby/issues/12139)) ([1e74779](https://github.com/gatsbyjs/gatsby/commit/1e74779)), closes [#11871](https://github.com/gatsbyjs/gatsby/issues/11871) [#11871](https://github.com/gatsbyjs/gatsby/issues/11871)
+
+## [2.3.15](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.3.14...gatsby@2.3.15) (2019-04-08)
+
+### Bug Fixes
+
+- **gatsby:** move db.startAutosave after bootstrap in `gatsby develop` ([#13180](https://github.com/gatsbyjs/gatsby/issues/13180)) ([530e087](https://github.com/gatsbyjs/gatsby/commit/530e087))
+
+## [2.3.14](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.3.13...gatsby@2.3.14) (2019-04-05)
+
+**Note:** Version bump only for package gatsby
+
+## [2.3.13](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.3.12...gatsby@2.3.13) (2019-04-04)
+
+### Features
+
+- **gatsby:** add DANGEROUSLY_DISABLE_OOM ([#13066](https://github.com/gatsbyjs/gatsby/issues/13066)) ([800b8d7](https://github.com/gatsbyjs/gatsby/commit/800b8d7))
+
+## [2.3.12](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.3.11...gatsby@2.3.12) (2019-04-04)
+
+**Note:** Version bump only for package gatsby
+
+## [2.3.11](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.3.10...gatsby@2.3.11) (2019-04-03)
+
+### Bug Fixes
+
+- **query-extraction:** handle duplicated graphql query names error ([#12931](https://github.com/gatsbyjs/gatsby/issues/12931)) ([0263a77](https://github.com/gatsbyjs/gatsby/commit/0263a77))
+
+### Features
+
+- **gatsby:** write match-paths.json ([#13012](https://github.com/gatsbyjs/gatsby/issues/13012)) ([cec5e28](https://github.com/gatsbyjs/gatsby/commit/cec5e28))
+
+## [2.3.10](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.3.9...gatsby@2.3.10) (2019-04-03)
+
+### Bug Fixes
+
+- **gatsby:** ignore \_\_esModule export in gatsby-node exports ([#13081](https://github.com/gatsbyjs/gatsby/issues/13081)) ([1c78ffb](https://github.com/gatsbyjs/gatsby/commit/1c78ffb)), closes [#13079](https://github.com/gatsbyjs/gatsby/issues/13079)
+
+## [2.3.9](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.3.8...gatsby@2.3.9) (2019-04-03)
+
+### Features
+
+- **gatsby:** add util.promisify polyfill for older node version ([#13024](https://github.com/gatsbyjs/gatsby/issues/13024)) ([b278a60](https://github.com/gatsbyjs/gatsby/commit/b278a60))
+
+## [2.3.8](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.3.7...gatsby@2.3.8) (2019-04-03)
+
+### Bug Fixes
+
+- **gatsby:** don't try to statically analyze gatsby-node, require it and examine exports instead ([#13053](https://github.com/gatsbyjs/gatsby/issues/13053)) ([d74b3f0](https://github.com/gatsbyjs/gatsby/commit/d74b3f0))
+
+## [2.3.7](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.3.6...gatsby@2.3.7) (2019-04-02)
+
+**Note:** Version bump only for package gatsby
+
+## [2.3.6](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.3.5...gatsby@2.3.6) (2019-04-02)
+
+**Note:** Version bump only for package gatsby
+
+## [2.3.5](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.3.4...gatsby@2.3.5) (2019-04-02)
+
+### Bug Fixes
+
+- **gatsby:** Only use one redux namespace for plugins ([#12263](https://github.com/gatsbyjs/gatsby/issues/12263)) ([bba69e9](https://github.com/gatsbyjs/gatsby/commit/bba69e9))
+
+### Features
+
+- **gatsby-cli:** Detect if something is already running on a port when running gatsby serve ([#12989](https://github.com/gatsbyjs/gatsby/issues/12989)) ([e587e57](https://github.com/gatsbyjs/gatsby/commit/e587e57))
+
+## [2.3.4](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.3.3...gatsby@2.3.4) (2019-03-28)
+
+### Features
+
+- **schema:** Use extensions to specify infer config ([ff102c9](https://github.com/gatsbyjs/gatsby/commit/ff102c9))
+
+## [2.3.3](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.3.2...gatsby@2.3.3) (2019-03-27)
+
+### Bug Fixes
+
+- **gatsby:** Handle already deleted nodes in deleteNode action ([#12866](https://github.com/gatsbyjs/gatsby/issues/12866)) ([1548841](https://github.com/gatsbyjs/gatsby/commit/1548841))
+- **gatsby-telemetry:** Ensure quickly running commands exit freely ([#12888](https://github.com/gatsbyjs/gatsby/issues/12888)) ([e30d264](https://github.com/gatsbyjs/gatsby/commit/e30d264))
+- **themes:** Handle shared parent theme with component shadowing ([#12883](https://github.com/gatsbyjs/gatsby/issues/12883)) ([7a82dc2](https://github.com/gatsbyjs/gatsby/commit/7a82dc2))
+
+### Features
+
+- **themes:** copy static folders in themes ([#12746](https://github.com/gatsbyjs/gatsby/issues/12746)) ([edd6cb1](https://github.com/gatsbyjs/gatsby/commit/edd6cb1))
+
+## [2.3.2](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.3.1...gatsby@2.3.2) (2019-03-26)
+
+**Note:** Version bump only for package gatsby
+
+## [2.3.1](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.3.0...gatsby@2.3.1) (2019-03-26)
+
+**Note:** Version bump only for package gatsby
+
+# [2.3.0](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.2.13...gatsby@2.3.0) (2019-03-26)
+
+### Features
+
+- **gatsby:** add anonymous telemetry instrumentation to gatsby ([#12758](https://github.com/gatsbyjs/gatsby/issues/12758)) ([da8ded9](https://github.com/gatsbyjs/gatsby/commit/da8ded9))
+
+## [2.2.13](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.2.12...gatsby@2.2.13) (2019-03-26)
+
+### Bug Fixes
+
+- **schema:** Add tests for incorrect list counting ([#12824](https://github.com/gatsbyjs/gatsby/issues/12824)) ([d2bf6f5](https://github.com/gatsbyjs/gatsby/commit/d2bf6f5))
+- **schema:** Remove accidental capitalization of lowercase typenames. ([#12837](https://github.com/gatsbyjs/gatsby/issues/12837)) ([d25b39d](https://github.com/gatsbyjs/gatsby/commit/d25b39d))
+
+## [2.2.12](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.2.11...gatsby@2.2.12) (2019-03-26)
+
+### Features
+
+- **gatsby:** Move page component state & side effect handling to xstate ([#11897](https://github.com/gatsbyjs/gatsby/issues/11897)) ([91086d4](https://github.com/gatsbyjs/gatsby/commit/91086d4))
+
+## [2.2.11](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.2.10...gatsby@2.2.11) (2019-03-25)
+
+**Note:** Version bump only for package gatsby
+
+## [2.2.10](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.2.9...gatsby@2.2.10) (2019-03-25)
+
+### Bug Fixes
+
+- **gatsby:** added looksLikeADate to check date on schema creation ([#12722](https://github.com/gatsbyjs/gatsby/issues/12722)) ([aff2c5d](https://github.com/gatsbyjs/gatsby/commit/aff2c5d))
+- **gatsby:** Allow setting nullability in createResolvers ([#12775](https://github.com/gatsbyjs/gatsby/issues/12775)) ([4fbac99](https://github.com/gatsbyjs/gatsby/commit/4fbac99))
+- **gatsby:** Improve handling of sparse arrays in example value creation ([#12807](https://github.com/gatsbyjs/gatsby/issues/12807)) ([3e84352](https://github.com/gatsbyjs/gatsby/commit/3e84352))
+- **schema:** Don't default to tracking all nodes ([#12825](https://github.com/gatsbyjs/gatsby/issues/12825)) ([a9b6d68](https://github.com/gatsbyjs/gatsby/commit/a9b6d68))
+- **schema:** fix `types` for buildUnionType config object ([#12814](https://github.com/gatsbyjs/gatsby/issues/12814)) ([0c2cda4](https://github.com/gatsbyjs/gatsby/commit/0c2cda4))
+- **schema:** Fix querying for filtered File type ([#12752](https://github.com/gatsbyjs/gatsby/issues/12752)) ([c949b9a](https://github.com/gatsbyjs/gatsby/commit/c949b9a))
+- **schema:** Preserve resolvers on \_\_\_NODE fields ([#12806](https://github.com/gatsbyjs/gatsby/issues/12806)) ([e8816bf](https://github.com/gatsbyjs/gatsby/commit/e8816bf))
+
+## [2.2.9](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.2.8...gatsby@2.2.9) (2019-03-23)
+
+### Features
+
+- **redux:** cache truePath lookups for performance ([#12693](https://github.com/gatsbyjs/gatsby/issues/12693)) ([d5c3351](https://github.com/gatsbyjs/gatsby/commit/d5c3351))
+
+## [2.2.8](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.2.7...gatsby@2.2.8) (2019-03-22)
+
+### Bug Fixes
+
+- **gatsby:** tolerate null object values ([#12756](https://github.com/gatsbyjs/gatsby/issues/12756)) ([7e51263](https://github.com/gatsbyjs/gatsby/commit/7e51263))
+- **gatsby-source-filesystem:** pin chokidar@2.1.2 to fix unix issues ([#12759](https://github.com/gatsbyjs/gatsby/issues/12759)) ([0ea1505](https://github.com/gatsbyjs/gatsby/commit/0ea1505))
+
 ## [2.2.7](https://github.com/gatsbyjs/gatsby/compare/gatsby@2.2.6...gatsby@2.2.7) (2019-03-22)
 
 ### Bug Fixes
diff --git a/node_modules/gatsby/cache-dir/__tests__/find-page.js b/node_modules/gatsby/cache-dir/__tests__/find-page.js
index c998b8e..3024d9c 100644
--- a/node_modules/gatsby/cache-dir/__tests__/find-page.js
+++ b/node_modules/gatsby/cache-dir/__tests__/find-page.js
@@ -1,10 +1,11 @@
 const pageFinderFactory = require(`../find-page`).default
+const { createPathsFromArray } = require(`../path-matcher`)
 
 let findPage
 
 describe(`find-page`, () => {
   beforeEach(() => {
-    const newPages = [
+    const newPages = createPathsFromArray([
       {
         path: `/about/`,
         componentChunkName: `page-component---src-pages-test-js`,
@@ -26,7 +27,7 @@ describe(`find-page`, () => {
         componentChunkName: `page-component---src-pages-app-js`,
         jsonName: `app.json`,
       },
-    ]
+    ])
     findPage = pageFinderFactory(newPages)
   })
 
@@ -54,13 +55,13 @@ describe(`find-page`, () => {
   })
 
   it(`handles finding prefixed links`, () => {
-    const newPages = [
+    const newPages = createPathsFromArray([
       {
         path: `/about/`,
         componentChunkName: `page-component---src-pages-test-js`,
         jsonName: `about.json`,
       },
-    ]
+    ])
     const findPage2 = pageFinderFactory(newPages, `/my-test-prefix`)
     expect(findPage2(`/my-test-prefix/about/`).path).toBe(`/about/`)
   })
diff --git a/node_modules/gatsby/cache-dir/__tests__/static-entry.js b/node_modules/gatsby/cache-dir/__tests__/static-entry.js
index 41edef9..82b667e 100644
--- a/node_modules/gatsby/cache-dir/__tests__/static-entry.js
+++ b/node_modules/gatsby/cache-dir/__tests__/static-entry.js
@@ -1,7 +1,15 @@
 import React from "react"
+import fs from "fs"
+
 import DevelopStaticEntry from "../develop-static-entry"
 
-jest.mock(`fs`)
+jest.mock(`fs`, () => {
+  const fs = jest.requireActual(`fs`)
+  return {
+    ...fs,
+    readFileSync: jest.fn(),
+  }
+})
 jest.mock(`gatsby/package.json`, () => {
   return {
     version: `2.0.0`,
@@ -31,13 +39,17 @@ jest.mock(
           [`about.json`]: `/400/about`,
         },
       ],
-      pages: [
-        {
-          path: `/about/`,
-          componentChunkName: `page-component---src-pages-test-js`,
-          jsonName: `about.json`,
+      pages: {
+        c: {
+          about: {
+            v: {
+              path: `/about/`,
+              componentChunkName: `page-component---src-pages-test-js`,
+              jsonName: `about.json`,
+            },
+          },
         },
-      ],
+      },
     }
   },
   {
@@ -50,10 +62,11 @@ const MOCK_FILE_INFO = {
   [`${process.cwd()}/public/chunk-map.json`]: `{}`,
 }
 
-require(`fs`).__setMockFiles(MOCK_FILE_INFO)
-
-// Needs to be imported after __setMockFiles is called, and imports get hoisted.
-const StaticEntry = require(`../static-entry`).default
+let StaticEntry
+beforeEach(() => {
+  fs.readFileSync.mockImplementation(file => MOCK_FILE_INFO[file])
+  StaticEntry = require(`../static-entry`).default
+})
 
 const reverseHeadersPlugin = {
   plugin: {
diff --git a/node_modules/gatsby/cache-dir/app.js b/node_modules/gatsby/cache-dir/app.js
index be21e76..a3da15e 100644
--- a/node_modules/gatsby/cache-dir/app.js
+++ b/node_modules/gatsby/cache-dir/app.js
@@ -1,6 +1,6 @@
 import React from "react"
 import ReactDOM from "react-dom"
-import domReady from "domready"
+import domReady from "@mikaelkristiansson/domready"
 
 import socketIo from "./socketIo"
 import emitter from "./emitter"
diff --git a/node_modules/gatsby/cache-dir/commonjs/api-runner-browser.js b/node_modules/gatsby/cache-dir/commonjs/api-runner-browser.js
index 04f7157..beef34d 100644
--- a/node_modules/gatsby/cache-dir/commonjs/api-runner-browser.js
+++ b/node_modules/gatsby/cache-dir/commonjs/api-runner-browser.js
@@ -2,10 +2,11 @@
 
 const plugins = require(`./api-runner-browser-plugins`);
 
-const _require$publicLoader = require(`./loader`).publicLoader,
-      getResourcesForPathname = _require$publicLoader.getResourcesForPathname,
-      getResourcesForPathnameSync = _require$publicLoader.getResourcesForPathnameSync,
-      getResourceURLsForPathname = _require$publicLoader.getResourceURLsForPathname;
+const {
+  getResourcesForPathname,
+  getResourcesForPathnameSync,
+  getResourceURLsForPathname
+} = require(`./loader`).publicLoader;
 
 exports.apiRunner = (api, args = {}, defaultReturn, argTransform) => {
   // Hooks for gatsby-cypress's API handler
diff --git a/node_modules/gatsby/cache-dir/commonjs/app.js b/node_modules/gatsby/cache-dir/commonjs/app.js
index 0e2848a..b4eaa01 100644
--- a/node_modules/gatsby/cache-dir/commonjs/app.js
+++ b/node_modules/gatsby/cache-dir/commonjs/app.js
@@ -1,14 +1,14 @@
 "use strict";
 
-var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");
-
 var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
 
+var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");
+
 var _react = _interopRequireDefault(require("react"));
 
 var _reactDom = _interopRequireDefault(require("react-dom"));
 
-var _domready = _interopRequireDefault(require("domready"));
+var _domready = _interopRequireDefault(require("@mikaelkristiansson/domready"));
 
 var _socketIo = _interopRequireDefault(require("./socketIo"));
 
@@ -22,6 +22,7 @@ var _syncRequires = _interopRequireDefault(require("./sync-requires"));
 
 var _pages = _interopRequireDefault(require("./pages.json"));
 
+var _jsxFileName = "/Users/phulin/Documents/Projects/gatsby/packages/gatsby/cache-dir/app.js";
 window.___emitter = _emitter.default;
 (0, _loader.setApiRunnerForLoader)(_apiRunnerBrowser.apiRunner); // Let the site/plugins run code very early.
 
@@ -46,19 +47,7 @@ window.___emitter = _emitter.default;
 
   if (supportsServiceWorkers(location, navigator)) {
     navigator.serviceWorker.getRegistrations().then(registrations => {
-      for (var _iterator = registrations, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
-        var _ref;
-
-        if (_isArray) {
-          if (_i >= _iterator.length) break;
-          _ref = _iterator[_i++];
-        } else {
-          _i = _iterator.next();
-          if (_i.done) break;
-          _ref = _i.value;
-        }
-
-        let registration = _ref;
+      for (let registration of registrations) {
         registration.unregister();
       }
     });
@@ -76,7 +65,13 @@ window.___emitter = _emitter.default;
 
     let Root = preferDefault(require(`./root`));
     (0, _domready.default)(() => {
-      renderer(_react.default.createElement(Root, null), rootElement, () => {
+      renderer(_react.default.createElement(Root, {
+        __source: {
+          fileName: _jsxFileName,
+          lineNumber: 56
+        },
+        __self: void 0
+      }), rootElement, () => {
         (0, _loader.postInitialRenderWork)();
         (0, _apiRunnerBrowser.apiRunner)(`onInitialClientRender`);
       });
diff --git a/node_modules/gatsby/cache-dir/commonjs/default-html.js b/node_modules/gatsby/cache-dir/commonjs/default-html.js
index bb6e0bf..ddfeca1 100644
--- a/node_modules/gatsby/cache-dir/commonjs/default-html.js
+++ b/node_modules/gatsby/cache-dir/commonjs/default-html.js
@@ -5,28 +5,75 @@ var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefau
 exports.__esModule = true;
 exports.default = HTML;
 
+var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));
+
 var _react = _interopRequireDefault(require("react"));
 
 var _propTypes = _interopRequireDefault(require("prop-types"));
 
+var _jsxFileName = "/Users/phulin/Documents/Projects/gatsby/packages/gatsby/cache-dir/default-html.js";
+
 function HTML(props) {
-  return _react.default.createElement("html", props.htmlAttributes, _react.default.createElement("head", null, _react.default.createElement("meta", {
-    charSet: "utf-8"
+  return _react.default.createElement("html", (0, _extends2.default)({}, props.htmlAttributes, {
+    __source: {
+      fileName: _jsxFileName,
+      lineNumber: 6
+    },
+    __self: this
+  }), _react.default.createElement("head", {
+    __source: {
+      fileName: _jsxFileName,
+      lineNumber: 7
+    },
+    __self: this
+  }, _react.default.createElement("meta", {
+    charSet: "utf-8",
+    __source: {
+      fileName: _jsxFileName,
+      lineNumber: 8
+    },
+    __self: this
   }), _react.default.createElement("meta", {
     httpEquiv: "x-ua-compatible",
-    content: "ie=edge"
+    content: "ie=edge",
+    __source: {
+      fileName: _jsxFileName,
+      lineNumber: 9
+    },
+    __self: this
   }), _react.default.createElement("meta", {
     name: "viewport",
-    content: "width=device-width, initial-scale=1, shrink-to-fit=no"
-  }), props.headComponents), _react.default.createElement("body", props.bodyAttributes, props.preBodyComponents, _react.default.createElement("noscript", {
+    content: "width=device-width, initial-scale=1, shrink-to-fit=no",
+    __source: {
+      fileName: _jsxFileName,
+      lineNumber: 10
+    },
+    __self: this
+  }), props.headComponents), _react.default.createElement("body", (0, _extends2.default)({}, props.bodyAttributes, {
+    __source: {
+      fileName: _jsxFileName,
+      lineNumber: 16
+    },
+    __self: this
+  }), props.preBodyComponents, _react.default.createElement("noscript", {
     key: "noscript",
-    id: "gatsby-noscript"
+    id: "gatsby-noscript",
+    __source: {
+      fileName: _jsxFileName,
+      lineNumber: 18
+    },
+    __self: this
   }, "This app works best with JavaScript enabled."), _react.default.createElement("div", {
     key: `body`,
     id: "___gatsby",
     dangerouslySetInnerHTML: {
       __html: props.body
-    }
+    },
+    __source: {
+      fileName: _jsxFileName,
+      lineNumber: 21
+    },
+    __self: this
   }), props.postBodyComponents));
 }
 
diff --git a/node_modules/gatsby/cache-dir/commonjs/develop-static-entry.js b/node_modules/gatsby/cache-dir/commonjs/develop-static-entry.js
index d07dbec..3d75b71 100644
--- a/node_modules/gatsby/cache-dir/commonjs/develop-static-entry.js
+++ b/node_modules/gatsby/cache-dir/commonjs/develop-static-entry.js
@@ -13,6 +13,8 @@ var _lodash = require("lodash");
 
 var _apiRunnerSsr = _interopRequireDefault(require("./api-runner-ssr"));
 
+var _jsxFileName = "/Users/phulin/Documents/Projects/gatsby/packages/gatsby/cache-dir/develop-static-entry.js";
+
 // import testRequireError from "./test-require-error"
 // For some extremely mysterious reason, webpack adds the above module *after*
 // this module so that when this code runs, testRequireError is undefined.
@@ -106,20 +108,30 @@ var _default = (pagePath, callback) => {
     replacePostBodyComponents
   });
 
-  const htmlElement = _react.default.createElement(Html, Object.assign({}, bodyProps, {
+  const htmlElement = _react.default.createElement(Html, { ...bodyProps,
     body: ``,
     headComponents: headComponents.concat([_react.default.createElement("script", {
       key: `io`,
-      src: "/socket.io/socket.io.js"
+      src: "/socket.io/socket.io.js",
+      __source: {
+        fileName: _jsxFileName,
+        lineNumber: 102
+      },
+      __self: void 0
     })]),
     htmlAttributes,
     bodyAttributes,
     preBodyComponents,
     postBodyComponents: postBodyComponents.concat([_react.default.createElement("script", {
       key: `commons`,
-      src: "/commons.js"
+      src: "/commons.js",
+      __source: {
+        fileName: _jsxFileName,
+        lineNumber: 108
+      },
+      __self: void 0
     })])
-  }));
+  });
 
   htmlStr = (0, _server.renderToStaticMarkup)(htmlElement);
   htmlStr = `<!DOCTYPE html>${htmlStr}`;
diff --git a/node_modules/gatsby/cache-dir/commonjs/ensure-resources.js b/node_modules/gatsby/cache-dir/commonjs/ensure-resources.js
index 0d3bb56..b497177 100644
--- a/node_modules/gatsby/cache-dir/commonjs/ensure-resources.js
+++ b/node_modules/gatsby/cache-dir/commonjs/ensure-resources.js
@@ -24,7 +24,8 @@ class EnsureResources extends _react.default.Component {
     super();
     let location = props.location;
     this.state = {
-      location: Object.assign({}, location),
+      location: { ...location
+      },
       pageResources: _loader.default.getResourcesForPathnameSync(location.pathname)
     };
   }
@@ -35,7 +36,9 @@ class EnsureResources extends _react.default.Component {
     // back, the browser will just change the URL and expect JS to handle
     // the change, which won't always work since it might not be a Gatsby
     // page.
-    const href = window.location.href;
+    const {
+      href
+    } = window.location;
     window.history.replaceState({}, ``, prevHref);
     window.location.replace(href);
   }
@@ -48,7 +51,8 @@ class EnsureResources extends _react.default.Component {
 
       return {
         pageResources,
-        location: Object.assign({}, location)
+        location: { ...location
+        }
       };
     }
 
@@ -68,7 +72,9 @@ class EnsureResources extends _react.default.Component {
   }
 
   retryResources(nextProps) {
-    const pathname = nextProps.location.pathname;
+    const {
+      pathname
+    } = nextProps.location;
 
     if (!_loader.default.getResourcesForPathnameSync(pathname)) {
       // Store the previous and next location before resolving resources
@@ -85,7 +91,8 @@ class EnsureResources extends _react.default.Component {
 
         if (this.hasResources(pageResources)) {
           this.setState({
-            location: Object.assign({}, window.location),
+            location: { ...window.location
+            },
             pageResources
           });
           return;
diff --git a/node_modules/gatsby/cache-dir/commonjs/find-page.js b/node_modules/gatsby/cache-dir/commonjs/find-page.js
index 512f379..1892c1c 100644
--- a/node_modules/gatsby/cache-dir/commonjs/find-page.js
+++ b/node_modules/gatsby/cache-dir/commonjs/find-page.js
@@ -5,53 +5,41 @@ var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefau
 exports.__esModule = true;
 exports.default = void 0;
 
-var _utils = require("@reach/router/lib/utils");
-
 var _stripPrefix = _interopRequireDefault(require("./strip-prefix"));
 
+var _pathMatcher = require("./path-matcher");
+
 // TODO add tests especially for handling prefixed links.
 const pageCache = {};
 
-var _default = (pages, pathPrefix = ``) => rawPathname => {
-  let pathname = decodeURIComponent(rawPathname); // Remove the pathPrefix from the pathname.
-
-  let trimmedPathname = (0, _stripPrefix.default)(pathname, pathPrefix); // Remove any hashfragment
-
-  if (trimmedPathname.split(`#`).length > 1) {
-    trimmedPathname = trimmedPathname.split(`#`).slice(0, -1).join(``);
-  } // Remove search query
+var _default = (pages, pathPrefix = ``) => {
+  const matchRoute = (0, _pathMatcher.matchPathFactory)(pages);
+  return rawPathname => {
+    let pathname = decodeURIComponent(rawPathname); // Remove the pathPrefix from the pathname.
 
+    let trimmedPathname = (0, _stripPrefix.default)(pathname, pathPrefix); // Remove any hashfragment
 
-  if (trimmedPathname.split(`?`).length > 1) {
-    trimmedPathname = trimmedPathname.split(`?`).slice(0, -1).join(``);
-  }
+    if (trimmedPathname.split(`#`).length > 1) {
+      trimmedPathname = trimmedPathname.split(`#`).slice(0, -1).join(``);
+    } // Remove search query
 
-  if (pageCache[trimmedPathname]) {
-    return pageCache[trimmedPathname];
-  }
 
-  let foundPage; // Array.prototype.find is not supported in IE so we use this somewhat odd
-  // work around.
-
-  pages.some(page => {
-    let pathToMatch = page.matchPath ? page.matchPath : page.path;
+    if (trimmedPathname.split(`?`).length > 1) {
+      trimmedPathname = trimmedPathname.split(`?`).slice(0, -1).join(``);
+    }
 
-    if ((0, _utils.match)(pathToMatch, trimmedPathname)) {
-      foundPage = page;
-      pageCache[trimmedPathname] = page;
-      return true;
-    } // Finally, try and match request with default document.
+    if (pageCache[trimmedPathname]) {
+      return pageCache[trimmedPathname];
+    }
 
+    const foundPage = matchRoute(trimmedPathname);
 
-    if ((0, _utils.match)(`${page.path}index.html`, trimmedPathname)) {
-      foundPage = page;
-      pageCache[trimmedPathname] = page;
-      return true;
+    if (foundPage) {
+      pageCache[trimmedPathname] = foundPage;
     }
 
-    return false;
-  });
-  return foundPage;
+    return foundPage;
+  };
 };
 
 exports.default = _default;
\ No newline at end of file
diff --git a/node_modules/gatsby/cache-dir/commonjs/gatsby-browser-entry.js b/node_modules/gatsby/cache-dir/commonjs/gatsby-browser-entry.js
index 1ab4447..be462d3 100644
--- a/node_modules/gatsby/cache-dir/commonjs/gatsby-browser-entry.js
+++ b/node_modules/gatsby/cache-dir/commonjs/gatsby-browser-entry.js
@@ -1,9 +1,9 @@
 "use strict";
 
-var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");
-
 var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
 
+var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");
+
 exports.__esModule = true;
 exports.graphql = graphql;
 exports.useStaticQuery = exports.StaticQuery = exports.StaticQueryContext = void 0;
@@ -25,16 +25,29 @@ exports.parsePath = _gatsbyLink.parsePath;
 var _publicPageRenderer = _interopRequireDefault(require("./public-page-renderer"));
 
 exports.PageRenderer = _publicPageRenderer.default;
+var _jsxFileName = "/Users/phulin/Documents/Projects/gatsby/packages/gatsby/cache-dir/gatsby-browser-entry.js";
 
 const StaticQueryContext = _react.default.createContext({});
 
 exports.StaticQueryContext = StaticQueryContext;
 
-const StaticQuery = props => _react.default.createElement(StaticQueryContext.Consumer, null, staticQueryData => {
+const StaticQuery = props => _react.default.createElement(StaticQueryContext.Consumer, {
+  __source: {
+    fileName: _jsxFileName,
+    lineNumber: 16
+  },
+  __self: void 0
+}, staticQueryData => {
   if (props.data || staticQueryData[props.query] && staticQueryData[props.query].data) {
     return (props.render || props.children)(props.data ? props.data.data : staticQueryData[props.query].data);
   } else {
-    return _react.default.createElement("div", null, "Loading (StaticQuery)");
+    return _react.default.createElement("div", {
+      __source: {
+        fileName: _jsxFileName,
+        lineNumber: 26
+      },
+      __self: void 0
+    }, "Loading (StaticQuery)");
   }
 });
 
diff --git a/node_modules/gatsby/cache-dir/commonjs/json-store.js b/node_modules/gatsby/cache-dir/commonjs/json-store.js
index e1d3017..72baa80 100644
--- a/node_modules/gatsby/cache-dir/commonjs/json-store.js
+++ b/node_modules/gatsby/cache-dir/commonjs/json-store.js
@@ -7,8 +7,6 @@ exports.default = void 0;
 
 var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));
 
-var _objectWithoutPropertiesLoose2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutPropertiesLoose"));
-
 var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
 
 var _react = _interopRequireDefault(require("react"));
@@ -19,6 +17,8 @@ var _gatsby = require("gatsby");
 
 var _socketIo = require("./socketIo");
 
+var _jsxFileName = "/Users/phulin/Documents/Projects/gatsby/packages/gatsby/cache-dir/json-store.js";
+
 if (process.env.NODE_ENV === `production`) {
   throw new Error(`It appears like Gatsby is misconfigured. JSONStore is Gatsby internal ` + `development-only component and should never be used in production.\n\n` + `Unless your site has a complex or custom webpack/Gatsby ` + `configuration this is likely a bug in Gatsby. ` + `Please report this at https://github.com/gatsbyjs/gatsby/issues ` + `with steps to reproduce this error.`);
 }
@@ -78,17 +78,35 @@ class JSONStore extends _react.default.Component {
   render() {
     const data = this.state.pageQueryData[getPathFromProps(this.props)]; // eslint-disable-next-line
 
-    const _this$props = this.props,
-          pages = _this$props.pages,
-          propsWithoutPages = (0, _objectWithoutPropertiesLoose2.default)(_this$props, ["pages"]);
+    const {
+      pages,
+      ...propsWithoutPages
+    } = this.props;
 
     if (!data) {
-      return _react.default.createElement("div", null);
+      return _react.default.createElement("div", {
+        __source: {
+          fileName: _jsxFileName,
+          lineNumber: 88
+        },
+        __self: this
+      });
     }
 
     return _react.default.createElement(_gatsby.StaticQueryContext.Provider, {
-      value: this.state.staticQueryData
-    }, _react.default.createElement(_pageRenderer.default, (0, _extends2.default)({}, propsWithoutPages, data)));
+      value: this.state.staticQueryData,
+      __source: {
+        fileName: _jsxFileName,
+        lineNumber: 92
+      },
+      __self: this
+    }, _react.default.createElement(_pageRenderer.default, (0, _extends2.default)({}, propsWithoutPages, data, {
+      __source: {
+        fileName: _jsxFileName,
+        lineNumber: 93
+      },
+      __self: this
+    })));
   }
 
 }
diff --git a/node_modules/gatsby/cache-dir/commonjs/navigation.js b/node_modules/gatsby/cache-dir/commonjs/navigation.js
index 9565a00..776a7ee 100644
--- a/node_modules/gatsby/cache-dir/commonjs/navigation.js
+++ b/node_modules/gatsby/cache-dir/commonjs/navigation.js
@@ -75,9 +75,9 @@ const navigate = (to, options = {}) => {
     window.__navigatingToLink = true;
   }
 
-  let _parsePath = (0, _gatsbyLink.parsePath)(to),
-      pathname = _parsePath.pathname;
-
+  let {
+    pathname
+  } = (0, _gatsbyLink.parsePath)(to);
   const redirect = redirectMap[pathname]; // If we're redirecting, just replace the passed in pathname
   // to the one we want to redirect to.
 
@@ -114,8 +114,10 @@ const navigate = (to, options = {}) => {
 function shouldUpdateScroll(prevRouterProps, {
   location
 }) {
-  const pathname = location.pathname,
-        hash = location.hash;
+  const {
+    pathname,
+    hash
+  } = location;
   const results = (0, _apiRunnerBrowser.apiRunner)(`shouldUpdateScroll`, {
     prevRouterProps,
     // `pathname` for backwards compatibility
@@ -131,7 +133,11 @@ function shouldUpdateScroll(prevRouterProps, {
   }
 
   if (prevRouterProps) {
-    const oldPathname = prevRouterProps.location.pathname;
+    const {
+      location: {
+        pathname: oldPathname
+      }
+    } = prevRouterProps;
 
     if (oldPathname === pathname) {
       // Scroll to element if it exists, if it doesn't, or no hash is provided,
diff --git a/node_modules/gatsby/cache-dir/commonjs/page-renderer.js b/node_modules/gatsby/cache-dir/commonjs/page-renderer.js
index 6b1d8a4..601308e 100644
--- a/node_modules/gatsby/cache-dir/commonjs/page-renderer.js
+++ b/node_modules/gatsby/cache-dir/commonjs/page-renderer.js
@@ -18,19 +18,16 @@ var _apiRunnerBrowser = require("./api-runner-browser");
 // Renders page
 class PageRenderer extends _react.default.Component {
   render() {
-    const props = Object.assign({}, this.props, {
+    const props = { ...this.props,
       pathContext: this.props.pageContext
-    });
-
-    const _apiRunner = (0, _apiRunnerBrowser.apiRunner)(`replaceComponentRenderer`, {
+    };
+    const [replacementElement] = (0, _apiRunnerBrowser.apiRunner)(`replaceComponentRenderer`, {
       props: this.props,
       loader: _loader.publicLoader
-    }),
-          replacementElement = _apiRunner[0];
-
-    const pageElement = replacementElement || (0, _react.createElement)(this.props.pageResources.component, Object.assign({}, props, {
+    });
+    const pageElement = replacementElement || (0, _react.createElement)(this.props.pageResources.component, { ...props,
       key: this.props.pageResources.page.path
-    }));
+    });
     const wrappedPage = (0, _apiRunnerBrowser.apiRunner)(`wrapPageElement`, {
       element: pageElement,
       props
diff --git a/node_modules/gatsby/cache-dir/commonjs/prefetch.js b/node_modules/gatsby/cache-dir/commonjs/prefetch.js
index f228660..9a7b545 100644
--- a/node_modules/gatsby/cache-dir/commonjs/prefetch.js
+++ b/node_modules/gatsby/cache-dir/commonjs/prefetch.js
@@ -3,7 +3,7 @@
 exports.__esModule = true;
 exports.default = void 0;
 
-const support = function support(feature) {
+const support = function (feature) {
   if (typeof document === `undefined`) {
     return false;
   }
@@ -21,7 +21,7 @@ const support = function support(feature) {
   return false;
 };
 
-const linkPrefetchStrategy = function linkPrefetchStrategy(url) {
+const linkPrefetchStrategy = function (url) {
   return new Promise((resolve, reject) => {
     if (typeof document === `undefined`) {
       reject();
@@ -38,7 +38,7 @@ const linkPrefetchStrategy = function linkPrefetchStrategy(url) {
   });
 };
 
-const xhrPrefetchStrategy = function xhrPrefetchStrategy(url) {
+const xhrPrefetchStrategy = function (url) {
   return new Promise((resolve, reject) => {
     const req = new XMLHttpRequest();
     req.open(`GET`, url, true);
@@ -59,7 +59,7 @@ const xhrPrefetchStrategy = function xhrPrefetchStrategy(url) {
 const supportedPrefetchStrategy = support(`prefetch`) ? linkPrefetchStrategy : xhrPrefetchStrategy;
 const preFetched = {};
 
-const prefetch = function prefetch(url) {
+const prefetch = function (url) {
   return new Promise(resolve => {
     if (preFetched[url]) {
       resolve();
diff --git a/node_modules/gatsby/cache-dir/commonjs/production-app.js b/node_modules/gatsby/cache-dir/commonjs/production-app.js
index d4db4db..80a3734 100644
--- a/node_modules/gatsby/cache-dir/commonjs/production-app.js
+++ b/node_modules/gatsby/cache-dir/commonjs/production-app.js
@@ -1,9 +1,9 @@
 "use strict";
 
-var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");
-
 var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
 
+var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");
+
 var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));
 
 var _apiRunnerBrowser = require("./api-runner-browser");
@@ -18,7 +18,7 @@ var _utils = require("@reach/router/lib/utils");
 
 var _gatsbyReactRouterScroll = require("gatsby-react-router-scroll");
 
-var _domready = _interopRequireDefault(require("domready"));
+var _domready = _interopRequireDefault(require("@mikaelkristiansson/domready"));
 
 var _navigation = require("./navigation");
 
@@ -32,11 +32,14 @@ var _loader = _interopRequireWildcard(require("./loader"));
 
 var _ensureResources = _interopRequireDefault(require("./ensure-resources"));
 
+var _pathMatcher = require("./path-matcher");
+
+var _jsxFileName = "/Users/phulin/Documents/Projects/gatsby/packages/gatsby/cache-dir/production-app.js";
 window.asyncRequires = _asyncRequires.default;
 window.___emitter = _emitter.default;
 window.___loader = _loader.default;
 
-_loader.default.addPagesArray([window.page]);
+_loader.default.addPagesArray((0, _pathMatcher.createPathsFromArray)([window.page]));
 
 _loader.default.addDataPaths({
   [window.page.jsonName]: window.dataPath
@@ -56,28 +59,52 @@ _loader.default.addProdRequires(_asyncRequires.default);
 
   class RouteHandler extends _react.default.Component {
     render() {
-      let location = this.props.location;
+      let {
+        location
+      } = this.props;
       return _react.default.createElement(_ensureResources.default, {
-        location: location
+        location: location,
+        __source: {
+          fileName: _jsxFileName,
+          lineNumber: 44
+        },
+        __self: this
       }, ({
         pageResources,
         location
       }) => _react.default.createElement(_navigation.RouteUpdates, {
-        location: location
+        location: location,
+        __source: {
+          fileName: _jsxFileName,
+          lineNumber: 46
+        },
+        __self: this
       }, _react.default.createElement(_gatsbyReactRouterScroll.ScrollContext, {
         location: location,
-        shouldUpdateScroll: _navigation.shouldUpdateScroll
+        shouldUpdateScroll: _navigation.shouldUpdateScroll,
+        __source: {
+          fileName: _jsxFileName,
+          lineNumber: 47
+        },
+        __self: this
       }, _react.default.createElement(_pageRenderer.default, (0, _extends2.default)({}, this.props, {
         location: location,
         pageResources: pageResources
-      }, pageResources.json)))));
+      }, pageResources.json, {
+        __source: {
+          fileName: _jsxFileName,
+          lineNumber: 51
+        },
+        __self: this
+      })))));
     }
 
   }
 
-  const _window = window,
-        page = _window.page,
-        browserLoc = _window.location;
+  const {
+    page,
+    location: browserLoc
+  } = window;
 
   if ( // Make sure the window.page object is defined
   page && // The canonical path doesn't match the actual path (i.e. the address bar)
@@ -99,8 +126,20 @@ _loader.default.addProdRequires(_asyncRequires.default);
     }));
 
     const WrappedRoot = (0, _apiRunnerBrowser.apiRunner)(`wrapRootElement`, {
-      element: _react.default.createElement(Root, null)
-    }, _react.default.createElement(Root, null), ({
+      element: _react.default.createElement(Root, {
+        __source: {
+          fileName: _jsxFileName,
+          lineNumber: 99
+        },
+        __self: void 0
+      })
+    }, _react.default.createElement(Root, {
+      __source: {
+        fileName: _jsxFileName,
+        lineNumber: 100
+      },
+      __self: void 0
+    }), ({
       result
     }) => {
       return {
@@ -112,7 +151,13 @@ _loader.default.addProdRequires(_asyncRequires.default);
 
     const renderer = (0, _apiRunnerBrowser.apiRunner)(`replaceHydrateFunction`, undefined, _reactDom.default.hydrate)[0];
     (0, _domready.default)(() => {
-      renderer(_react.default.createElement(NewRoot, null), typeof window !== `undefined` ? document.getElementById(`___gatsby`) : void 0, () => {
+      renderer(_react.default.createElement(NewRoot, {
+        __source: {
+          fileName: _jsxFileName,
+          lineNumber: 116
+        },
+        __self: void 0
+      }), typeof window !== `undefined` ? document.getElementById(`___gatsby`) : void 0, () => {
         (0, _loader.postInitialRenderWork)();
         (0, _apiRunnerBrowser.apiRunner)(`onInitialClientRender`);
       });
diff --git a/node_modules/gatsby/cache-dir/commonjs/public-page-renderer-prod.js b/node_modules/gatsby/cache-dir/commonjs/public-page-renderer-prod.js
index 3dab848..a52fc3e 100644
--- a/node_modules/gatsby/cache-dir/commonjs/public-page-renderer-prod.js
+++ b/node_modules/gatsby/cache-dir/commonjs/public-page-renderer-prod.js
@@ -18,10 +18,11 @@ const ProdPageRenderer = ({
 }) => {
   const pageResources = _loader.default.getResourcesForPathnameSync(location.pathname);
 
-  return _react.default.createElement(_pageRenderer.default, Object.assign({
+  return _react.default.createElement(_pageRenderer.default, {
     location,
-    pageResources
-  }, pageResources.json));
+    pageResources,
+    ...pageResources.json
+  });
 };
 
 ProdPageRenderer.propTypes = {
diff --git a/node_modules/gatsby/cache-dir/commonjs/root.js b/node_modules/gatsby/cache-dir/commonjs/root.js
index b27db5a..fb2580f 100644
--- a/node_modules/gatsby/cache-dir/commonjs/root.js
+++ b/node_modules/gatsby/cache-dir/commonjs/root.js
@@ -1,9 +1,9 @@
 "use strict";
 
-var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");
-
 var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
 
+var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");
+
 exports.__esModule = true;
 exports.default = void 0;
 
@@ -31,6 +31,10 @@ var _ensureResources = _interopRequireDefault(require("./ensure-resources"));
 
 var _errorOverlayHandler = require("./error-overlay-handler");
 
+var _pathMatcher = require("./path-matcher");
+
+var _jsxFileName = "/Users/phulin/Documents/Projects/gatsby/packages/gatsby/cache-dir/root.js";
+
 if (window.__webpack_hot_middleware_reporter__ !== undefined) {
   const overlayErrorID = `webpack`; // Report build errors
 
@@ -52,48 +56,104 @@ if (window.__webpack_hot_middleware_reporter__ !== undefined) {
 }
 
 (0, _navigation.init)();
+const pages = (0, _pathMatcher.createArrayFromAllPaths)(_pages.default);
 
 class RouteHandler extends _react.default.Component {
   render() {
-    let location = this.props.location; // check if page exists - in dev pages are sync loaded, it's safe to use
+    let {
+      location
+    } = this.props; // check if page exists - in dev pages are sync loaded, it's safe to use
     // loader.getPage
 
     let page = _loader.default.getPage(location.pathname);
 
     if (page) {
       return _react.default.createElement(_ensureResources.default, {
-        location: location
+        location: location,
+        __source: {
+          fileName: _jsxFileName,
+          lineNumber: 50
+        },
+        __self: this
       }, locationAndPageResources => _react.default.createElement(_navigation.RouteUpdates, {
-        location: location
+        location: location,
+        __source: {
+          fileName: _jsxFileName,
+          lineNumber: 52
+        },
+        __self: this
       }, _react.default.createElement(_gatsbyReactRouterScroll.ScrollContext, {
         location: location,
-        shouldUpdateScroll: _navigation.shouldUpdateScroll
+        shouldUpdateScroll: _navigation.shouldUpdateScroll,
+        __source: {
+          fileName: _jsxFileName,
+          lineNumber: 53
+        },
+        __self: this
       }, _react.default.createElement(_jsonStore.default, (0, _extends2.default)({
-        pages: _pages.default
-      }, this.props, locationAndPageResources)))));
+        pages: pages
+      }, this.props, locationAndPageResources, {
+        __source: {
+          fileName: _jsxFileName,
+          lineNumber: 57
+        },
+        __self: this
+      })))));
     } else {
-      const dev404Page = _pages.default.find(p => /^\/dev-404-page\/?$/.test(p.path));
-
+      const dev404Page = (0, _pathMatcher.matchPathFactory)(_pages.default)(`/dev-404-page`);
       const Dev404Page = _syncRequires.default.components[dev404Page.componentChunkName];
 
       if (!_loader.default.getPage(`/404.html`)) {
         return _react.default.createElement(_navigation.RouteUpdates, {
-          location: location
+          location: location,
+          __source: {
+            fileName: _jsxFileName,
+            lineNumber: 73
+          },
+          __self: this
         }, _react.default.createElement(Dev404Page, (0, _extends2.default)({
-          pages: _pages.default
-        }, this.props)));
+          pages: pages
+        }, this.props, {
+          __source: {
+            fileName: _jsxFileName,
+            lineNumber: 74
+          },
+          __self: this
+        })));
       }
 
       return _react.default.createElement(_ensureResources.default, {
-        location: location
+        location: location,
+        __source: {
+          fileName: _jsxFileName,
+          lineNumber: 80
+        },
+        __self: this
       }, locationAndPageResources => _react.default.createElement(_navigation.RouteUpdates, {
-        location: location
+        location: location,
+        __source: {
+          fileName: _jsxFileName,
+          lineNumber: 82
+        },
+        __self: this
       }, _react.default.createElement(Dev404Page, (0, _extends2.default)({
-        pages: _pages.default,
+        pages: pages,
         custom404: _react.default.createElement(_jsonStore.default, (0, _extends2.default)({
-          pages: _pages.default
-        }, this.props, locationAndPageResources))
-      }, this.props))));
+          pages: pages
+        }, this.props, locationAndPageResources, {
+          __source: {
+            fileName: _jsxFileName,
+            lineNumber: 86
+          },
+          __self: this
+        }))
+      }, this.props, {
+        __source: {
+          fileName: _jsxFileName,
+          lineNumber: 83
+        },
+        __self: this
+      }))));
     }
   }
 
@@ -107,8 +167,20 @@ const Root = () => (0, _react.createElement)(_router.Router, {
 
 
 const WrappedRoot = (0, _apiRunnerBrowser.apiRunner)(`wrapRootElement`, {
-  element: _react.default.createElement(Root, null)
-}, _react.default.createElement(Root, null), ({
+  element: _react.default.createElement(Root, {
+    __source: {
+      fileName: _jsxFileName,
+      lineNumber: 114
+    },
+    __self: void 0
+  })
+}, _react.default.createElement(Root, {
+  __source: {
+    fileName: _jsxFileName,
+    lineNumber: 115
+  },
+  __self: void 0
+}), ({
   result,
   plugin
 }) => {
diff --git a/node_modules/gatsby/cache-dir/commonjs/socketIo.js b/node_modules/gatsby/cache-dir/commonjs/socketIo.js
index 694fc98..86ebed5 100644
--- a/node_modules/gatsby/cache-dir/commonjs/socketIo.js
+++ b/node_modules/gatsby/cache-dir/commonjs/socketIo.js
@@ -39,15 +39,15 @@ function socketIo() {
         socket.on(`message`, msg => {
           if (msg.type === `staticQueryResult`) {
             if (didDataChange(msg, staticQueryData)) {
-              staticQueryData = Object.assign({}, staticQueryData, {
+              staticQueryData = { ...staticQueryData,
                 [msg.payload.id]: msg.payload.result
-              });
+              };
             }
           } else if (msg.type === `pageQueryResult`) {
             if (didDataChange(msg, pageQueryData)) {
-              pageQueryData = Object.assign({}, pageQueryData, {
+              pageQueryData = { ...pageQueryData,
                 [msg.payload.id]: msg.payload.result
-              });
+              };
             }
           } else if (msg.type === `overlayError`) {
             if (msg.payload.message) {
diff --git a/node_modules/gatsby/cache-dir/commonjs/static-entry.js b/node_modules/gatsby/cache-dir/commonjs/static-entry.js
index 5a5aa0d..d8f4603 100644
--- a/node_modules/gatsby/cache-dir/commonjs/static-entry.js
+++ b/node_modules/gatsby/cache-dir/commonjs/static-entry.js
@@ -7,43 +7,52 @@ exports.default = void 0;
 
 var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));
 
+var _jsxFileName = "/Users/phulin/Documents/Projects/gatsby/packages/gatsby/cache-dir/static-entry.js";
+
 const React = require(`react`);
 
 const fs = require(`fs`);
 
-const _require = require(`path`),
-      join = _require.join;
-
-const _require2 = require(`react-dom/server`),
-      renderToString = _require2.renderToString,
-      renderToStaticMarkup = _require2.renderToStaticMarkup;
-
-const _require3 = require(`@reach/router`),
-      ServerLocation = _require3.ServerLocation,
-      Router = _require3.Router,
-      isRedirect = _require3.isRedirect;
-
-const _require4 = require(`lodash`),
-      get = _require4.get,
-      merge = _require4.merge,
-      isObject = _require4.isObject,
-      flatten = _require4.flatten,
-      uniqBy = _require4.uniqBy;
+const {
+  join
+} = require(`path`);
+
+const {
+  renderToString,
+  renderToStaticMarkup
+} = require(`react-dom/server`);
+
+const {
+  ServerLocation,
+  Router,
+  isRedirect
+} = require(`@reach/router`);
+
+const {
+  get,
+  merge,
+  isObject,
+  flatten,
+  uniqBy
+} = require(`lodash`);
 
 const apiRunner = require(`./api-runner-ssr`);
 
 const syncRequires = require(`./sync-requires`);
 
-const _require5 = require(`./data.json`),
-      dataPaths = _require5.dataPaths,
-      pages = _require5.pages;
+const {
+  dataPaths,
+  pages
+} = require(`./data.json`);
 
-const _require6 = require(`gatsby/package.json`),
-      gatsbyVersion = _require6.version; // Speed up looking up pages.
+const {
+  version: gatsbyVersion
+} = require(`gatsby/package.json`);
 
+const {
+  matchPathFactory
+} = require(`./path-matcher`);
 
-const pagesObjectMap = new Map();
-pages.forEach(p => pagesObjectMap.set(p.path, p));
 const stats = JSON.parse(fs.readFileSync(`${process.cwd()}/public/webpack.stats.json`, `utf-8`));
 const chunkMapping = JSON.parse(fs.readFileSync(`${process.cwd()}/public/chunk-map.json`, `utf-8`)); // const testRequireError = require("./test-require-error")
 // For some extremely mysterious reason, webpack adds the above module *after*
@@ -69,9 +78,7 @@ try {
 }
 
 Html = Html && Html.__esModule ? Html.default : Html;
-
-const getPage = path => pagesObjectMap.get(path);
-
+const getPage = matchPathFactory(pages);
 const createElement = React.createElement;
 
 const sanitizeComponents = components => {
@@ -89,7 +96,12 @@ var _default = (pagePath, callback) => {
   let headComponents = [React.createElement("meta", {
     name: "generator",
     content: `Gatsby ${gatsbyVersion}`,
-    key: `generator-${gatsbyVersion}`
+    key: `generator-${gatsbyVersion}`,
+    __source: {
+      fileName: _jsxFileName,
+      lineNumber: 62
+    },
+    __self: void 0
   })];
   let htmlAttributes = {};
   let bodyAttributes = {};
@@ -147,10 +159,10 @@ var _default = (pagePath, callback) => {
   let dataAndContext = {};
 
   if (page.jsonName in dataPaths) {
-    const pathToJsonData = `../public/` + dataPaths[page.jsonName];
+    const pathToJsonData = join(process.cwd(), `/public/static/d`, `${dataPaths[page.jsonName]}.json`);
 
     try {
-      dataAndContext = JSON.parse(fs.readFileSync(`${process.cwd()}/public/static/d/${dataPaths[page.jsonName]}.json`));
+      dataAndContext = JSON.parse(fs.readFileSync(pathToJsonData));
     } catch (e) {
       console.log(`error`, pathToJsonData, e);
       process.exit();
@@ -159,9 +171,10 @@ var _default = (pagePath, callback) => {
 
   class RouteHandler extends React.Component {
     render() {
-      const props = Object.assign({}, this.props, dataAndContext, {
+      const props = { ...this.props,
+        ...dataAndContext,
         pathContext: dataAndContext.pageContext
-      });
+      };
       const pageElement = createElement(syncRequires.components[page.componentChunkName], props);
       const wrappedPage = apiRunner(`wrapPageElement`, {
         element: pageElement,
@@ -280,7 +293,12 @@ var _default = (pagePath, callback) => {
       as: "script",
       rel: script.rel,
       key: script.name,
-      href: `${__PATH_PREFIX__}/${script.name}`
+      href: `${__PATH_PREFIX__}/${script.name}`,
+      __source: {
+        fileName: _jsxFileName,
+        lineNumber: 278
+      },
+      __self: void 0
     }));
   });
 
@@ -291,7 +309,12 @@ var _default = (pagePath, callback) => {
       rel: "preload",
       key: dataPath,
       href: dataPath,
-      crossOrigin: "use-credentials"
+      crossOrigin: "use-credentials",
+      __source: {
+        fileName: _jsxFileName,
+        lineNumber: 292
+      },
+      __self: void 0
     }));
   }
 
@@ -303,14 +326,24 @@ var _default = (pagePath, callback) => {
         as: "style",
         rel: style.rel,
         key: style.name,
-        href: `${__PATH_PREFIX__}/${style.name}`
+        href: `${__PATH_PREFIX__}/${style.name}`,
+        __source: {
+          fileName: _jsxFileName,
+          lineNumber: 311
+        },
+        __self: void 0
       }));
     } else {
       headComponents.unshift(React.createElement("style", {
         "data-href": `${__PATH_PREFIX__}/${style.name}`,
         dangerouslySetInnerHTML: {
           __html: fs.readFileSync(join(process.cwd(), `public`, style.name), `utf-8`)
-        }
+        },
+        __source: {
+          fileName: _jsxFileName,
+          lineNumber: 320
+        },
+        __self: void 0
       }));
     }
   }); // Add page metadata for the current page
@@ -321,7 +354,12 @@ var _default = (pagePath, callback) => {
     id: `gatsby-script-loader`,
     dangerouslySetInnerHTML: {
       __html: windowData
-    }
+    },
+    __source: {
+      fileName: _jsxFileName,
+      lineNumber: 341
+    },
+    __self: void 0
   })); // Add chunk mapping metadata
 
   const scriptChunkMapping = `/*<![CDATA[*/window.___chunkMapping=${JSON.stringify(chunkMapping)};/*]]>*/`;
@@ -330,7 +368,12 @@ var _default = (pagePath, callback) => {
     id: `gatsby-chunk-mapping`,
     dangerouslySetInnerHTML: {
       __html: scriptChunkMapping
-    }
+    },
+    __source: {
+      fileName: _jsxFileName,
+      lineNumber: 356
+    },
+    __self: void 0
   })); // Filter out prefetched bundles as adding them as a script tag
   // would force high priority fetching.
 
@@ -339,7 +382,12 @@ var _default = (pagePath, callback) => {
     return React.createElement("script", {
       key: scriptPath,
       src: scriptPath,
-      async: true
+      async: true,
+      __source: {
+        fileName: _jsxFileName,
+        lineNumber: 374
+      },
+      __self: void 0
     });
   });
   postBodyComponents.push(...bodyScripts);
@@ -360,7 +408,12 @@ var _default = (pagePath, callback) => {
     preBodyComponents: preBodyComponents,
     postBodyComponents: postBodyComponents,
     body: bodyHtml,
-    path: pagePath
+    path: pagePath,
+    __source: {
+      fileName: _jsxFileName,
+      lineNumber: 391
+    },
+    __self: void 0
   })))}`;
   callback(null, html);
 };
diff --git a/node_modules/gatsby/cache-dir/find-page.js b/node_modules/gatsby/cache-dir/find-page.js
index f25078f..17b131d 100644
--- a/node_modules/gatsby/cache-dir/find-page.js
+++ b/node_modules/gatsby/cache-dir/find-page.js
@@ -1,55 +1,43 @@
 // TODO add tests especially for handling prefixed links.
-import { match as matchPath } from "@reach/router/lib/utils"
 import stripPrefix from "./strip-prefix"
+import { matchPathFactory } from "./path-matcher"
 
 const pageCache = {}
 
-export default (pages, pathPrefix = ``) => rawPathname => {
-  let pathname = decodeURIComponent(rawPathname)
+export default (pages, pathPrefix = ``) => {
+  const matchRoute = matchPathFactory(pages)
 
-  // Remove the pathPrefix from the pathname.
-  let trimmedPathname = stripPrefix(pathname, pathPrefix)
+  return rawPathname => {
+    let pathname = decodeURIComponent(rawPathname)
 
-  // Remove any hashfragment
-  if (trimmedPathname.split(`#`).length > 1) {
-    trimmedPathname = trimmedPathname
-      .split(`#`)
-      .slice(0, -1)
-      .join(``)
-  }
-
-  // Remove search query
-  if (trimmedPathname.split(`?`).length > 1) {
-    trimmedPathname = trimmedPathname
-      .split(`?`)
-      .slice(0, -1)
-      .join(``)
-  }
+    // Remove the pathPrefix from the pathname.
+    let trimmedPathname = stripPrefix(pathname, pathPrefix)
 
-  if (pageCache[trimmedPathname]) {
-    return pageCache[trimmedPathname]
-  }
+    // Remove any hashfragment
+    if (trimmedPathname.split(`#`).length > 1) {
+      trimmedPathname = trimmedPathname
+        .split(`#`)
+        .slice(0, -1)
+        .join(``)
+    }
 
-  let foundPage
-  // Array.prototype.find is not supported in IE so we use this somewhat odd
-  // work around.
-  pages.some(page => {
-    let pathToMatch = page.matchPath ? page.matchPath : page.path
-    if (matchPath(pathToMatch, trimmedPathname)) {
-      foundPage = page
-      pageCache[trimmedPathname] = page
-      return true
+    // Remove search query
+    if (trimmedPathname.split(`?`).length > 1) {
+      trimmedPathname = trimmedPathname
+        .split(`?`)
+        .slice(0, -1)
+        .join(``)
     }
 
-    // Finally, try and match request with default document.
-    if (matchPath(`${page.path}index.html`, trimmedPathname)) {
-      foundPage = page
-      pageCache[trimmedPathname] = page
-      return true
+    if (pageCache[trimmedPathname]) {
+      return pageCache[trimmedPathname]
     }
 
-    return false
-  })
+    const foundPage = matchRoute(trimmedPathname)
+    if (foundPage) {
+      pageCache[trimmedPathname] = foundPage
+    }
 
-  return foundPage
+    return foundPage
+  }
 }
diff --git a/node_modules/gatsby/cache-dir/production-app.js b/node_modules/gatsby/cache-dir/production-app.js
index 0e174ab..4a67a24 100644
--- a/node_modules/gatsby/cache-dir/production-app.js
+++ b/node_modules/gatsby/cache-dir/production-app.js
@@ -4,7 +4,7 @@ import ReactDOM from "react-dom"
 import { Router, navigate } from "@reach/router"
 import { match } from "@reach/router/lib/utils"
 import { ScrollContext } from "gatsby-react-router-scroll"
-import domReady from "domready"
+import domReady from "@mikaelkristiansson/domready"
 import {
   shouldUpdateScroll,
   init as navigationInit,
@@ -15,12 +15,13 @@ import PageRenderer from "./page-renderer"
 import asyncRequires from "./async-requires"
 import loader, { setApiRunnerForLoader, postInitialRenderWork } from "./loader"
 import EnsureResources from "./ensure-resources"
+import { createPathsFromArray } from "./path-matcher"
 
 window.asyncRequires = asyncRequires
 window.___emitter = emitter
 window.___loader = loader
 
-loader.addPagesArray([window.page])
+loader.addPagesArray(createPathsFromArray([window.page]))
 loader.addDataPaths({ [window.page.jsonName]: window.dataPath })
 loader.addProdRequires(asyncRequires)
 setApiRunnerForLoader(apiRunner)
diff --git a/node_modules/gatsby/cache-dir/root.js b/node_modules/gatsby/cache-dir/root.js
index e4c0147..6a3a585 100644
--- a/node_modules/gatsby/cache-dir/root.js
+++ b/node_modules/gatsby/cache-dir/root.js
@@ -1,7 +1,6 @@
 import React, { createElement } from "react"
 import { Router } from "@reach/router"
 import { ScrollContext } from "gatsby-react-router-scroll"
-
 import {
   shouldUpdateScroll,
   init as navigationInit,
@@ -9,12 +8,13 @@ import {
 } from "./navigation"
 import { apiRunner } from "./api-runner-browser"
 import syncRequires from "./sync-requires"
-import pages from "./pages.json"
+import pageData from "./pages.json"
 import loader from "./loader"
 import JSONStore from "./json-store"
 import EnsureResources from "./ensure-resources"
 
 import { reportError, clearError } from "./error-overlay-handler"
+import { matchPathFactory, createArrayFromAllPaths } from "./path-matcher"
 
 if (window.__webpack_hot_middleware_reporter__ !== undefined) {
   const overlayErrorID = `webpack`
@@ -35,6 +35,8 @@ if (window.__webpack_hot_middleware_reporter__ !== undefined) {
 
 navigationInit()
 
+const pages = createArrayFromAllPaths(pageData)
+
 class RouteHandler extends React.Component {
   render() {
     let { location } = this.props
@@ -63,7 +65,7 @@ class RouteHandler extends React.Component {
         </EnsureResources>
       )
     } else {
-      const dev404Page = pages.find(p => /^\/dev-404-page\/?$/.test(p.path))
+      const dev404Page = matchPathFactory(pageData)(`/dev-404-page`)
       const Dev404Page = syncRequires.components[dev404Page.componentChunkName]
 
       if (!loader.getPage(`/404.html`)) {
diff --git a/node_modules/gatsby/cache-dir/static-entry.js b/node_modules/gatsby/cache-dir/static-entry.js
index d3fbebd..9524911 100644
--- a/node_modules/gatsby/cache-dir/static-entry.js
+++ b/node_modules/gatsby/cache-dir/static-entry.js
@@ -9,10 +9,7 @@ const apiRunner = require(`./api-runner-ssr`)
 const syncRequires = require(`./sync-requires`)
 const { dataPaths, pages } = require(`./data.json`)
 const { version: gatsbyVersion } = require(`gatsby/package.json`)
-
-// Speed up looking up pages.
-const pagesObjectMap = new Map()
-pages.forEach(p => pagesObjectMap.set(p.path, p))
+const { matchPathFactory } = require(`./path-matcher`)
 
 const stats = JSON.parse(
   fs.readFileSync(`${process.cwd()}/public/webpack.stats.json`, `utf-8`)
@@ -45,7 +42,7 @@ try {
 
 Html = Html && Html.__esModule ? Html.default : Html
 
-const getPage = path => pagesObjectMap.get(path)
+const getPage = matchPathFactory(pages)
 
 const createElement = React.createElement
 
@@ -126,13 +123,13 @@ export default (pagePath, callback) => {
 
   let dataAndContext = {}
   if (page.jsonName in dataPaths) {
-    const pathToJsonData = `../public/` + dataPaths[page.jsonName]
+    const pathToJsonData = join(
+      process.cwd(),
+      `/public/static/d`,
+      `${dataPaths[page.jsonName]}.json`
+    )
     try {
-      dataAndContext = JSON.parse(
-        fs.readFileSync(
-          `${process.cwd()}/public/static/d/${dataPaths[page.jsonName]}.json`
-        )
-      )
+      dataAndContext = JSON.parse(fs.readFileSync(pathToJsonData))
     } catch (e) {
       console.log(`error`, pathToJsonData, e)
       process.exit()
diff --git a/node_modules/gatsby/dist/bootstrap/get-config-file.js b/node_modules/gatsby/dist/bootstrap/get-config-file.js
index bd5a440..89f3169 100644
--- a/node_modules/gatsby/dist/bootstrap/get-config-file.js
+++ b/node_modules/gatsby/dist/bootstrap/get-config-file.js
@@ -1,9 +1,5 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const levenshtein = require(`fast-levenshtein`);
 
 const fs = require(`fs-extra`);
@@ -22,35 +18,27 @@ function isNearMatch(fileName, configName, distance) {
   return levenshtein.get(fileName, configName) <= distance;
 }
 
-module.exports =
-/*#__PURE__*/
-function () {
-  var _getConfigFile = (0, _asyncToGenerator2.default)(function* (rootDir, configName, distance = 3) {
-    const configPath = path.join(rootDir, configName);
-    let configModule;
-
-    try {
-      configModule = require(configPath);
-    } catch (err) {
-      const nearMatch = yield fs.readdir(rootDir).then(files => files.find(file => {
-        const fileName = file.split(rootDir).pop();
-        return isNearMatch(fileName, configName, distance);
-      }));
-
-      if (!testRequireError(configPath, err)) {
-        report.panic(`We encountered an error while trying to load your site's ${configName}. Please fix the error and try again.`, err);
-      } else if (nearMatch) {
-        report.panic(`It looks like you were trying to add the config file? Please rename "${chalk.bold(nearMatch)}" to "${chalk.bold(configName)}"`);
-      } else if (existsSync(path.join(rootDir, `src`, configName))) {
-        report.panic(`Your ${configName} file is in the wrong place. You've placed it in the src/ directory. It must instead be at the root of your site next to your package.json file.`);
-      }
+module.exports = async function getConfigFile(rootDir, configName, distance = 3) {
+  const configPath = path.join(rootDir, configName);
+  let configModule;
+
+  try {
+    configModule = require(configPath);
+  } catch (err) {
+    const nearMatch = await fs.readdir(rootDir).then(files => files.find(file => {
+      const fileName = file.split(rootDir).pop();
+      return isNearMatch(fileName, configName, distance);
+    }));
+
+    if (!testRequireError(configPath, err)) {
+      report.panic(`We encountered an error while trying to load your site's ${configName}. Please fix the error and try again.`, err);
+    } else if (nearMatch) {
+      report.panic(`It looks like you were trying to add the config file? Please rename "${chalk.bold(nearMatch)}" to "${chalk.bold(configName)}"`);
+    } else if (existsSync(path.join(rootDir, `src`, configName))) {
+      report.panic(`Your ${configName} file is in the wrong place. You've placed it in the src/ directory. It must instead be at the root of your site next to your package.json file.`);
     }
+  }
 
-    return configModule;
-  });
-
-  return function getConfigFile(_x, _x2) {
-    return _getConfigFile.apply(this, arguments);
-  };
-}();
+  return configModule;
+};
 //# sourceMappingURL=get-config-file.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/bootstrap/get-config-file.js.map b/node_modules/gatsby/dist/bootstrap/get-config-file.js.map
index 2e1ff0c..2ecb215 100644
--- a/node_modules/gatsby/dist/bootstrap/get-config-file.js.map
+++ b/node_modules/gatsby/dist/bootstrap/get-config-file.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/bootstrap/get-config-file.js"],"names":["levenshtein","require","fs","testRequireError","default","report","chalk","path","existsSync","sync","isNearMatch","fileName","configName","distance","get","module","exports","rootDir","configPath","join","configModule","err","nearMatch","readdir","then","files","find","file","split","pop","panic","bold","getConfigFile"],"mappings":";;;;;;AACA,MAAMA,WAAW,GAAGC,OAAO,CAAE,kBAAF,CAA3B;;AACA,MAAMC,EAAE,GAAGD,OAAO,CAAE,UAAF,CAAlB;;AACA,MAAME,gBAAgB,GAAGF,OAAO,CAAE,6BAAF,CAAP,CAAuCG,OAAhE;;AACA,MAAMC,MAAM,GAAGJ,OAAO,CAAE,yBAAF,CAAtB;;AACA,MAAMK,KAAK,GAAGL,OAAO,CAAE,OAAF,CAArB;;AACA,MAAMM,IAAI,GAAGN,OAAO,CAAE,MAAF,CAApB;;AACA,MAAMO,UAAU,GAAGP,OAAO,CAAE,kBAAF,CAAP,CAA4BQ,IAA/C;;AAEA,SAASC,WAAT,CACEC,QADF,EAEEC,UAFF,EAGEC,QAHF,EAIW;AACT,SAAOb,WAAW,CAACc,GAAZ,CAAgBH,QAAhB,EAA0BC,UAA1B,KAAyCC,QAAhD;AACD;;AAEDE,MAAM,CAACC,OAAP;AAAA;AAAA;AAAA,uDAAiB,WACfC,OADe,EAEfL,UAFe,EAGfC,QAAgB,GAAG,CAHJ,EAIf;AACA,UAAMK,UAAU,GAAGX,IAAI,CAACY,IAAL,CAAUF,OAAV,EAAmBL,UAAnB,CAAnB;AACA,QAAIQ,YAAJ;;AACA,QAAI;AACFA,MAAAA,YAAY,GAAGnB,OAAO,CAACiB,UAAD,CAAtB;AACD,KAFD,CAEE,OAAOG,GAAP,EAAY;AACZ,YAAMC,SAAS,SAASpB,EAAE,CAACqB,OAAH,CAAWN,OAAX,EAAoBO,IAApB,CAAyBC,KAAK,IACpDA,KAAK,CAACC,IAAN,CAAWC,IAAI,IAAI;AACjB,cAAMhB,QAAQ,GAAGgB,IAAI,CAACC,KAAL,CAAWX,OAAX,EAAoBY,GAApB,EAAjB;AACA,eAAOnB,WAAW,CAACC,QAAD,EAAWC,UAAX,EAAuBC,QAAvB,CAAlB;AACD,OAHD,CADsB,CAAxB;;AAMA,UAAI,CAACV,gBAAgB,CAACe,UAAD,EAAaG,GAAb,CAArB,EAAwC;AACtChB,QAAAA,MAAM,CAACyB,KAAP,CACG,4DAA2DlB,UAAW,uCADzE,EAEES,GAFF;AAID,OALD,MAKO,IAAIC,SAAJ,EAAe;AACpBjB,QAAAA,MAAM,CAACyB,KAAP,CACG,wEAAuExB,KAAK,CAACyB,IAAN,CACtET,SADsE,CAEtE,SAAQhB,KAAK,CAACyB,IAAN,CAAWnB,UAAX,CAAuB,GAHnC;AAKD,OANM,MAMA,IAAIJ,UAAU,CAACD,IAAI,CAACY,IAAL,CAAUF,OAAV,EAAoB,KAApB,EAA0BL,UAA1B,CAAD,CAAd,EAAuD;AAC5DP,QAAAA,MAAM,CAACyB,KAAP,CACG,QAAOlB,UAAW,kJADrB;AAGD;AACF;;AAED,WAAOQ,YAAP;AACD,GAnCD;;AAAA,kBAAgCY,aAAhC;AAAA;AAAA;AAAA","sourcesContent":["/* @flow */\nconst levenshtein = require(`fast-levenshtein`)\nconst fs = require(`fs-extra`)\nconst testRequireError = require(`../utils/test-require-error`).default\nconst report = require(`gatsby-cli/lib/reporter`)\nconst chalk = require(`chalk`)\nconst path = require(`path`)\nconst existsSync = require(`fs-exists-cached`).sync\n\nfunction isNearMatch(\n  fileName: string,\n  configName: string,\n  distance: number\n): boolean {\n  return levenshtein.get(fileName, configName) <= distance\n}\n\nmodule.exports = async function getConfigFile(\n  rootDir: string,\n  configName: string,\n  distance: number = 3\n) {\n  const configPath = path.join(rootDir, configName)\n  let configModule\n  try {\n    configModule = require(configPath)\n  } catch (err) {\n    const nearMatch = await fs.readdir(rootDir).then(files =>\n      files.find(file => {\n        const fileName = file.split(rootDir).pop()\n        return isNearMatch(fileName, configName, distance)\n      })\n    )\n    if (!testRequireError(configPath, err)) {\n      report.panic(\n        `We encountered an error while trying to load your site's ${configName}. Please fix the error and try again.`,\n        err\n      )\n    } else if (nearMatch) {\n      report.panic(\n        `It looks like you were trying to add the config file? Please rename \"${chalk.bold(\n          nearMatch\n        )}\" to \"${chalk.bold(configName)}\"`\n      )\n    } else if (existsSync(path.join(rootDir, `src`, configName))) {\n      report.panic(\n        `Your ${configName} file is in the wrong place. You've placed it in the src/ directory. It must instead be at the root of your site next to your package.json file.`\n      )\n    }\n  }\n\n  return configModule\n}\n"],"file":"get-config-file.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/bootstrap/get-config-file.js"],"names":["levenshtein","require","fs","testRequireError","default","report","chalk","path","existsSync","sync","isNearMatch","fileName","configName","distance","get","module","exports","getConfigFile","rootDir","configPath","join","configModule","err","nearMatch","readdir","then","files","find","file","split","pop","panic","bold"],"mappings":";;AACA,MAAMA,WAAW,GAAGC,OAAO,CAAE,kBAAF,CAA3B;;AACA,MAAMC,EAAE,GAAGD,OAAO,CAAE,UAAF,CAAlB;;AACA,MAAME,gBAAgB,GAAGF,OAAO,CAAE,6BAAF,CAAP,CAAuCG,OAAhE;;AACA,MAAMC,MAAM,GAAGJ,OAAO,CAAE,yBAAF,CAAtB;;AACA,MAAMK,KAAK,GAAGL,OAAO,CAAE,OAAF,CAArB;;AACA,MAAMM,IAAI,GAAGN,OAAO,CAAE,MAAF,CAApB;;AACA,MAAMO,UAAU,GAAGP,OAAO,CAAE,kBAAF,CAAP,CAA4BQ,IAA/C;;AAEA,SAASC,WAAT,CACEC,QADF,EAEEC,UAFF,EAGEC,QAHF,EAIW;AACT,SAAOb,WAAW,CAACc,GAAZ,CAAgBH,QAAhB,EAA0BC,UAA1B,KAAyCC,QAAhD;AACD;;AAEDE,MAAM,CAACC,OAAP,GAAiB,eAAeC,aAAf,CACfC,OADe,EAEfN,UAFe,EAGfC,QAAgB,GAAG,CAHJ,EAIf;AACA,QAAMM,UAAU,GAAGZ,IAAI,CAACa,IAAL,CAAUF,OAAV,EAAmBN,UAAnB,CAAnB;AACA,MAAIS,YAAJ;;AACA,MAAI;AACFA,IAAAA,YAAY,GAAGpB,OAAO,CAACkB,UAAD,CAAtB;AACD,GAFD,CAEE,OAAOG,GAAP,EAAY;AACZ,UAAMC,SAAS,GAAG,MAAMrB,EAAE,CAACsB,OAAH,CAAWN,OAAX,EAAoBO,IAApB,CAAyBC,KAAK,IACpDA,KAAK,CAACC,IAAN,CAAWC,IAAI,IAAI;AACjB,YAAMjB,QAAQ,GAAGiB,IAAI,CAACC,KAAL,CAAWX,OAAX,EAAoBY,GAApB,EAAjB;AACA,aAAOpB,WAAW,CAACC,QAAD,EAAWC,UAAX,EAAuBC,QAAvB,CAAlB;AACD,KAHD,CADsB,CAAxB;;AAMA,QAAI,CAACV,gBAAgB,CAACgB,UAAD,EAAaG,GAAb,CAArB,EAAwC;AACtCjB,MAAAA,MAAM,CAAC0B,KAAP,CACG,4DAA2DnB,UAAW,uCADzE,EAEEU,GAFF;AAID,KALD,MAKO,IAAIC,SAAJ,EAAe;AACpBlB,MAAAA,MAAM,CAAC0B,KAAP,CACG,wEAAuEzB,KAAK,CAAC0B,IAAN,CACtET,SADsE,CAEtE,SAAQjB,KAAK,CAAC0B,IAAN,CAAWpB,UAAX,CAAuB,GAHnC;AAKD,KANM,MAMA,IAAIJ,UAAU,CAACD,IAAI,CAACa,IAAL,CAAUF,OAAV,EAAoB,KAApB,EAA0BN,UAA1B,CAAD,CAAd,EAAuD;AAC5DP,MAAAA,MAAM,CAAC0B,KAAP,CACG,QAAOnB,UAAW,kJADrB;AAGD;AACF;;AAED,SAAOS,YAAP;AACD,CAnCD","sourcesContent":["/* @flow */\nconst levenshtein = require(`fast-levenshtein`)\nconst fs = require(`fs-extra`)\nconst testRequireError = require(`../utils/test-require-error`).default\nconst report = require(`gatsby-cli/lib/reporter`)\nconst chalk = require(`chalk`)\nconst path = require(`path`)\nconst existsSync = require(`fs-exists-cached`).sync\n\nfunction isNearMatch(\n  fileName: string,\n  configName: string,\n  distance: number\n): boolean {\n  return levenshtein.get(fileName, configName) <= distance\n}\n\nmodule.exports = async function getConfigFile(\n  rootDir: string,\n  configName: string,\n  distance: number = 3\n) {\n  const configPath = path.join(rootDir, configName)\n  let configModule\n  try {\n    configModule = require(configPath)\n  } catch (err) {\n    const nearMatch = await fs.readdir(rootDir).then(files =>\n      files.find(file => {\n        const fileName = file.split(rootDir).pop()\n        return isNearMatch(fileName, configName, distance)\n      })\n    )\n    if (!testRequireError(configPath, err)) {\n      report.panic(\n        `We encountered an error while trying to load your site's ${configName}. Please fix the error and try again.`,\n        err\n      )\n    } else if (nearMatch) {\n      report.panic(\n        `It looks like you were trying to add the config file? Please rename \"${chalk.bold(\n          nearMatch\n        )}\" to \"${chalk.bold(configName)}\"`\n      )\n    } else if (existsSync(path.join(rootDir, `src`, configName))) {\n      report.panic(\n        `Your ${configName} file is in the wrong place. You've placed it in the src/ directory. It must instead be at the root of your site next to your package.json file.`\n      )\n    }\n  }\n\n  return configModule\n}\n"],"file":"get-config-file.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/bootstrap/index.js b/node_modules/gatsby/dist/bootstrap/index.js
index 353a1de..d360aa3 100644
--- a/node_modules/gatsby/dist/bootstrap/index.js
+++ b/node_modules/gatsby/dist/bootstrap/index.js
@@ -1,9 +1,5 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const _ = require(`lodash`);
 
 const slash = require(`slash`);
@@ -18,20 +14,22 @@ const del = require(`del`);
 
 const path = require(`path`);
 
-const convertHrtime = require(`convert-hrtime`);
-
 const Promise = require(`bluebird`);
 
+const telemetry = require(`gatsby-telemetry`);
+
 const apiRunnerNode = require(`../utils/api-runner-node`);
 
 const getBrowserslist = require(`../utils/browserslist`);
 
-const _require = require(`graphql`),
-      graphql = _require.graphql;
+const {
+  graphql
+} = require(`graphql`);
 
-const _require2 = require(`../redux`),
-      store = _require2.store,
-      emitter = _require2.emitter;
+const {
+  store,
+  emitter
+} = require(`../redux`);
 
 const loadPlugins = require(`./load-plugins`);
 
@@ -47,469 +45,452 @@ const preferDefault = require(`./prefer-default`);
 
 const nodeTracking = require(`../db/node-tracking`);
 
-const withResolverContext = require(`../schema/context`);
+const withResolverContext = require(`../schema/context`); // Add `util.promisify` polyfill for old node versions
+
 
-require(`../db`).startAutosave(); // Show stack trace on unhandled promises.
+require(`util.promisify/shim`)(); // Show stack trace on unhandled promises.
 
 
 process.on(`unhandledRejection`, (reason, p) => {
   report.panic(reason);
 });
 
-const _require3 = require(`../internal-plugins/query-runner/query-watcher`),
-      extractQueries = _require3.extractQueries;
+const {
+  extractQueries
+} = require(`../query/query-watcher`);
 
-const _require4 = require(`../internal-plugins/query-runner/page-query-runner`),
-      runInitialQueries = _require4.runInitialQueries;
+const {
+  runInitialQueries
+} = require(`../query/page-query-runner`);
 
-const queryQueue = require(`../internal-plugins/query-runner/query-queue`);
+const {
+  writePages
+} = require(`../query/pages-writer`);
 
-const _require5 = require(`../internal-plugins/query-runner/pages-writer`),
-      writePages = _require5.writePages;
-
-const _require6 = require(`../internal-plugins/query-runner/redirects-writer`),
-      writeRedirects = _require6.writeRedirects; // Override console.log to add the source file + line number.
+const {
+  writeRedirects
+} = require(`./redirects-writer`); // Override console.log to add the source file + line number.
 // Useful for debugging if you lose a console.log somewhere.
 // Otherwise leave commented out.
 // require(`./log-line-function`)
 
 
-module.exports =
-/*#__PURE__*/
-function () {
-  var _ref = (0, _asyncToGenerator2.default)(function* (args) {
-    const spanArgs = args.parentSpan ? {
-      childOf: args.parentSpan
-    } : {};
-    const bootstrapSpan = tracer.startSpan(`bootstrap`, spanArgs); // Start plugin runner which listens to the store
-    // and invokes Gatsby API based on actions.
-
-    require(`../redux/plugin-runner`);
+module.exports = async args => {
+  const spanArgs = args.parentSpan ? {
+    childOf: args.parentSpan
+  } : {};
+  const bootstrapSpan = tracer.startSpan(`bootstrap`, spanArgs); // Start plugin runner which listens to the store
+  // and invokes Gatsby API based on actions.
 
-    const directory = slash(args.directory);
-    const program = Object.assign({}, args, {
-      browserslist: getBrowserslist(directory),
-      // Fix program directory path for windows env.
-      directory
-    });
-    store.dispatch({
-      type: `SET_PROGRAM`,
-      payload: program
-    }); // Try opening the site's gatsby-config.js file.
+  require(`../redux/plugin-runner`);
 
-    let activity = report.activityTimer(`open and validate gatsby-configs`, {
-      parentSpan: bootstrapSpan
-    });
-    activity.start();
-    let config = yield preferDefault(getConfigFile(program.directory, `gatsby-config`)); // theme gatsby configs can be functions or objects
-
-    if (config && config.__experimentalThemes) {
-      const themes = yield loadThemes(config);
-      config = themes.config;
-      store.dispatch({
-        type: `SET_RESOLVED_THEMES`,
-        payload: themes.themes
-      });
-    }
+  const directory = slash(args.directory);
+  const program = { ...args,
+    browserslist: getBrowserslist(directory),
+    // Fix program directory path for windows env.
+    directory
+  };
+  store.dispatch({
+    type: `SET_PROGRAM`,
+    payload: program
+  }); // Try opening the site's gatsby-config.js file.
 
-    if (config && config.polyfill) {
-      report.warn(`Support for custom Promise polyfills has been removed in Gatsby v2. We only support Babel 7's new automatic polyfilling behavior.`);
-    }
+  let activity = report.activityTimer(`open and validate gatsby-configs`, {
+    parentSpan: bootstrapSpan
+  });
+  activity.start();
+  let config = await preferDefault(getConfigFile(program.directory, `gatsby-config`)); // theme gatsby configs can be functions or objects
 
+  if (config && config.__experimentalThemes) {
+    const themes = await loadThemes(config);
+    config = themes.config;
     store.dispatch({
-      type: `SET_SITE_CONFIG`,
-      payload: config
+      type: `SET_RESOLVED_THEMES`,
+      payload: themes.themes
     });
-    activity.end();
-    activity = report.activityTimer(`load plugins`);
-    activity.start();
-    const flattenedPlugins = yield loadPlugins(config, program.directory);
-    activity.end(); // onPreInit
+  }
+
+  if (config && config.polyfill) {
+    report.warn(`Support for custom Promise polyfills has been removed in Gatsby v2. We only support Babel 7's new automatic polyfilling behavior.`);
+  }
 
-    activity = report.activityTimer(`onPreInit`, {
+  store.dispatch({
+    type: `SET_SITE_CONFIG`,
+    payload: config
+  });
+  activity.end();
+  activity = report.activityTimer(`load plugins`);
+  activity.start();
+  const flattenedPlugins = await loadPlugins(config, program.directory);
+  activity.end();
+  telemetry.decorateEvent(`BUILD_END`, {
+    plugins: flattenedPlugins.map(p => `${p.name}@${p.version}`)
+  }); // onPreInit
+
+  activity = report.activityTimer(`onPreInit`, {
+    parentSpan: bootstrapSpan
+  });
+  activity.start();
+  await apiRunnerNode(`onPreInit`, {
+    parentSpan: activity.span
+  });
+  activity.end(); // During builds, delete html and css files from the public directory as we don't want
+  // deleted pages and styles from previous builds to stick around.
+
+  if (process.env.NODE_ENV === `production`) {
+    activity = report.activityTimer(`delete html and css files from previous builds`, {
       parentSpan: bootstrapSpan
     });
     activity.start();
-    yield apiRunnerNode(`onPreInit`, {
-      parentSpan: activity.span
-    });
-    activity.end(); // During builds, delete html and css files from the public directory as we don't want
-    // deleted pages and styles from previous builds to stick around.
-
-    if (process.env.NODE_ENV === `production`) {
-      activity = report.activityTimer(`delete html and css files from previous builds`, {
-        parentSpan: bootstrapSpan
-      });
-      activity.start();
-      yield del([`public/*.{html,css}`, `public/**/*.{html,css}`, `!public/static`, `!public/static/**/*.{html,css}`]);
-      activity.end();
-    }
-
-    activity = report.activityTimer(`initialize cache`);
-    activity.start(); // Check if any plugins have been updated since our last run. If so
-    // we delete the cache is there's likely been changes
-    // since the previous run.
-    //
-    // We do this by creating a hash of all the version numbers of installed
-    // plugins, the site's package.json, gatsby-config.js, and gatsby-node.js.
-    // The last, gatsby-node.js, is important as many gatsby sites put important
-    // logic in there e.g. generating slugs for custom pages.
-
-    const pluginVersions = flattenedPlugins.map(p => p.version);
-    const hashes = yield Promise.all([md5File(`package.json`), Promise.resolve(md5File(`${program.directory}/gatsby-config.js`).catch(() => {})), // ignore as this file isn't required),
-    Promise.resolve(md5File(`${program.directory}/gatsby-node.js`).catch(() => {}))]);
-    const pluginsHash = crypto.createHash(`md5`).update(JSON.stringify(pluginVersions.concat(hashes))).digest(`hex`);
-    let state = store.getState();
-    const oldPluginsHash = state && state.status ? state.status.PLUGINS_HASH : ``; // Check if anything has changed. If it has, delete the site's .cache
-    // directory and tell reducers to empty themselves.
-    //
-    // Also if the hash isn't there, then delete things just in case something
-    // is weird.
-
-    if (oldPluginsHash && pluginsHash !== oldPluginsHash) {
-      report.info(report.stripIndent`
+    await del([`public/*.{html,css}`, `public/**/*.{html,css}`, `!public/static`, `!public/static/**/*.{html,css}`]);
+    activity.end();
+  }
+
+  activity = report.activityTimer(`initialize cache`);
+  activity.start(); // Check if any plugins have been updated since our last run. If so
+  // we delete the cache is there's likely been changes
+  // since the previous run.
+  //
+  // We do this by creating a hash of all the version numbers of installed
+  // plugins, the site's package.json, gatsby-config.js, and gatsby-node.js.
+  // The last, gatsby-node.js, is important as many gatsby sites put important
+  // logic in there e.g. generating slugs for custom pages.
+
+  const pluginVersions = flattenedPlugins.map(p => p.version);
+  const hashes = await Promise.all([md5File(`package.json`), Promise.resolve(md5File(`${program.directory}/gatsby-config.js`).catch(() => {})), // ignore as this file isn't required),
+  Promise.resolve(md5File(`${program.directory}/gatsby-node.js`).catch(() => {}))]);
+  const pluginsHash = crypto.createHash(`md5`).update(JSON.stringify(pluginVersions.concat(hashes))).digest(`hex`);
+  let state = store.getState();
+  const oldPluginsHash = state && state.status ? state.status.PLUGINS_HASH : ``; // Check if anything has changed. If it has, delete the site's .cache
+  // directory and tell reducers to empty themselves.
+  //
+  // Also if the hash isn't there, then delete things just in case something
+  // is weird.
+
+  if (oldPluginsHash && pluginsHash !== oldPluginsHash) {
+    report.info(report.stripIndent`
       One or more of your plugins have changed since the last time you ran Gatsby. As
       a precaution, we're deleting your site's cache to ensure there's not any stale
       data
     `);
-    }
+  }
 
-    const cacheDirectory = `${program.directory}/.cache`;
+  const cacheDirectory = `${program.directory}/.cache`;
 
-    if (!oldPluginsHash || pluginsHash !== oldPluginsHash) {
-      try {
-        // Attempt to empty dir if remove fails,
-        // like when directory is mount point
-        yield fs.remove(cacheDirectory).catch(() => fs.emptyDir(cacheDirectory));
-      } catch (e) {
-        report.error(`Failed to remove .cache files.`, e);
-      } // Tell reducers to delete their data (the store will already have
-      // been loaded from the file system cache).
+  if (!oldPluginsHash || pluginsHash !== oldPluginsHash) {
+    try {
+      // Attempt to empty dir if remove fails,
+      // like when directory is mount point
+      await fs.remove(cacheDirectory).catch(() => fs.emptyDir(cacheDirectory));
+    } catch (e) {
+      report.error(`Failed to remove .cache files.`, e);
+    } // Tell reducers to delete their data (the store will already have
+    // been loaded from the file system cache).
 
 
-      store.dispatch({
-        type: `DELETE_CACHE`
-      });
-    } // Update the store with the new plugins hash.
+    store.dispatch({
+      type: `DELETE_CACHE`
+    });
+  } // Update the store with the new plugins hash.
 
 
-    store.dispatch({
-      type: `UPDATE_PLUGINS_HASH`,
-      payload: pluginsHash
-    }); // Now that we know the .cache directory is safe, initialize the cache
-    // directory.
+  store.dispatch({
+    type: `UPDATE_PLUGINS_HASH`,
+    payload: pluginsHash
+  }); // Now that we know the .cache directory is safe, initialize the cache
+  // directory.
 
-    yield fs.ensureDir(cacheDirectory); // Ensure the public/static directory
+  await fs.ensureDir(cacheDirectory); // Ensure the public/static directory
 
-    yield fs.ensureDir(`${program.directory}/public/static`);
-    activity.end();
+  await fs.ensureDir(`${program.directory}/public/static`);
+  activity.end();
+
+  if (process.env.GATSBY_DB_NODES === `loki`) {
+    const loki = require(`../db/loki`); // Start the nodes database (in memory loki js with interval disk
+    // saves). If data was saved from a previous build, it will be
+    // loaded here
 
-    if (process.env.GATSBY_DB_NODES === `loki`) {
-      const loki = require(`../db/loki`); // Start the nodes database (in memory loki js with interval disk
-      // saves). If data was saved from a previous build, it will be
-      // loaded here
 
+    activity = report.activityTimer(`start nodes db`, {
+      parentSpan: bootstrapSpan
+    });
+    activity.start();
+    const dbSaveFile = `${cacheDirectory}/loki/loki.db`;
 
-      activity = report.activityTimer(`start nodes db`, {
-        parentSpan: bootstrapSpan
+    try {
+      await loki.start({
+        saveFile: dbSaveFile
       });
-      activity.start();
-      const dbSaveFile = `${cacheDirectory}/loki/loki.db`;
-
-      try {
-        yield loki.start({
-          saveFile: dbSaveFile
-        });
-      } catch (e) {
-        report.error(`Error starting DB. Perhaps try deleting ${path.dirname(dbSaveFile)}`);
-      }
+    } catch (e) {
+      report.error(`Error starting DB. Perhaps try deleting ${path.dirname(dbSaveFile)}`);
+    }
 
-      activity.end();
-    } // By now, our nodes database has been loaded, so ensure that we
-    // have tracked all inline objects
+    activity.end();
+  } // By now, our nodes database has been loaded, so ensure that we
+  // have tracked all inline objects
 
 
-    nodeTracking.trackDbNodes(); // Copy our site files to the root of the site.
+  nodeTracking.trackDbNodes(); // Copy our site files to the root of the site.
 
-    activity = report.activityTimer(`copy gatsby files`, {
-      parentSpan: bootstrapSpan
+  activity = report.activityTimer(`copy gatsby files`, {
+    parentSpan: bootstrapSpan
+  });
+  activity.start();
+  const srcDir = `${__dirname}/../../cache-dir`;
+  const siteDir = cacheDirectory;
+  const tryRequire = `${__dirname}/../utils/test-require-error.js`;
+
+  try {
+    await fs.copy(srcDir, siteDir, {
+      clobber: true
     });
-    activity.start();
-    const srcDir = `${__dirname}/../../cache-dir`;
-    const siteDir = cacheDirectory;
-    const tryRequire = `${__dirname}/../utils/test-require-error.js`;
+    await fs.copy(tryRequire, `${siteDir}/test-require-error.js`, {
+      clobber: true
+    });
+    await fs.ensureDirSync(`${cacheDirectory}/json`); // Ensure .cache/fragments exists and is empty. We want fragments to be
+    // added on every run in response to data as fragments can only be added if
+    // the data used to create the schema they're dependent on is available.
+
+    await fs.emptyDir(`${cacheDirectory}/fragments`);
+  } catch (err) {
+    report.panic(`Unable to copy site files to .cache`, err);
+  } // Find plugins which implement gatsby-browser and gatsby-ssr and write
+  // out api-runners for them.
+
+
+  const hasAPIFile = (env, plugin) => {
+    // The plugin loader has disabled SSR APIs for this plugin. Usually due to
+    // multiple implementations of an API that can only be implemented once
+    if (env === `ssr` && plugin.skipSSR === true) return undefined;
+    const envAPIs = plugin[`${env}APIs`]; // Always include gatsby-browser.js files if they exists as they're
+    // a handy place to include global styles and other global imports.
 
     try {
-      yield fs.copy(srcDir, siteDir, {
-        clobber: true
-      });
-      yield fs.copy(tryRequire, `${siteDir}/test-require-error.js`, {
-        clobber: true
-      });
-      yield fs.ensureDirSync(`${cacheDirectory}/json`); // Ensure .cache/fragments exists and is empty. We want fragments to be
-      // added on every run in response to data as fragments can only be added if
-      // the data used to create the schema they're dependent on is available.
-
-      yield fs.emptyDir(`${cacheDirectory}/fragments`);
-    } catch (err) {
-      report.panic(`Unable to copy site files to .cache`, err);
-    } // Find plugins which implement gatsby-browser and gatsby-ssr and write
-    // out api-runners for them.
-
-
-    const hasAPIFile = (env, plugin) => {
-      // The plugin loader has disabled SSR APIs for this plugin. Usually due to
-      // multiple implementations of an API that can only be implemented once
-      if (env === `ssr` && plugin.skipSSR === true) return undefined;
-      const envAPIs = plugin[`${env}APIs`]; // Always include gatsby-browser.js files if they exists as they're
-      // a handy place to include global styles and other global imports.
-
-      try {
-        if (env === `browser`) {
-          return slash(require.resolve(path.join(plugin.resolve, `gatsby-${env}`)));
-        }
-      } catch (e) {// ignore
+      if (env === `browser`) {
+        return slash(require.resolve(path.join(plugin.resolve, `gatsby-${env}`)));
       }
+    } catch (e) {// ignore
+    }
 
-      if (envAPIs && Array.isArray(envAPIs) && envAPIs.length > 0) {
-        return slash(path.join(plugin.resolve, `gatsby-${env}`));
-      }
+    if (envAPIs && Array.isArray(envAPIs) && envAPIs.length > 0) {
+      return slash(path.join(plugin.resolve, `gatsby-${env}`));
+    }
+
+    return undefined;
+  };
 
-      return undefined;
+  const ssrPlugins = _.filter(flattenedPlugins.map(plugin => {
+    return {
+      resolve: hasAPIFile(`ssr`, plugin),
+      options: plugin.pluginOptions
     };
+  }), plugin => plugin.resolve);
 
-    const ssrPlugins = _.filter(flattenedPlugins.map(plugin => {
-      return {
-        resolve: hasAPIFile(`ssr`, plugin),
-        options: plugin.pluginOptions
-      };
-    }), plugin => plugin.resolve);
-
-    const browserPlugins = _.filter(flattenedPlugins.map(plugin => {
-      return {
-        resolve: hasAPIFile(`browser`, plugin),
-        options: plugin.pluginOptions
-      };
-    }), plugin => plugin.resolve);
-
-    const browserPluginsRequires = browserPlugins.map(plugin => `{
+  const browserPlugins = _.filter(flattenedPlugins.map(plugin => {
+    return {
+      resolve: hasAPIFile(`browser`, plugin),
+      options: plugin.pluginOptions
+    };
+  }), plugin => plugin.resolve);
+
+  const browserPluginsRequires = browserPlugins.map(plugin => `{
       plugin: require('${plugin.resolve}'),
       options: ${JSON.stringify(plugin.options)},
     }`).join(`,`);
-    const browserAPIRunner = `module.exports = [${browserPluginsRequires}]\n`;
-    let sSRAPIRunner = ``;
+  const browserAPIRunner = `module.exports = [${browserPluginsRequires}]\n`;
+  let sSRAPIRunner = ``;
 
-    try {
-      sSRAPIRunner = fs.readFileSync(`${siteDir}/api-runner-ssr.js`, `utf-8`);
-    } catch (err) {
-      report.panic(`Failed to read ${siteDir}/api-runner-ssr.js`, err);
-    }
+  try {
+    sSRAPIRunner = fs.readFileSync(`${siteDir}/api-runner-ssr.js`, `utf-8`);
+  } catch (err) {
+    report.panic(`Failed to read ${siteDir}/api-runner-ssr.js`, err);
+  }
 
-    const ssrPluginsRequires = ssrPlugins.map(plugin => `{
+  const ssrPluginsRequires = ssrPlugins.map(plugin => `{
       plugin: require('${plugin.resolve}'),
       options: ${JSON.stringify(plugin.options)},
     }`).join(`,`);
-    sSRAPIRunner = `var plugins = [${ssrPluginsRequires}]\n${sSRAPIRunner}`;
-    fs.writeFileSync(`${siteDir}/api-runner-browser-plugins.js`, browserAPIRunner, `utf-8`);
-    fs.writeFileSync(`${siteDir}/api-runner-ssr.js`, sSRAPIRunner, `utf-8`);
-    activity.end();
-    /**
-     * Start the main bootstrap processes.
-     */
-    // onPreBootstrap
-
-    activity = report.activityTimer(`onPreBootstrap`);
-    activity.start();
-    yield apiRunnerNode(`onPreBootstrap`);
-    activity.end(); // Source nodes
-
-    activity = report.activityTimer(`source and transform nodes`, {
-      parentSpan: bootstrapSpan
-    });
-    activity.start();
-    yield require(`../utils/source-nodes`)({
-      parentSpan: activity.span
-    });
-    activity.end(); // Create Schema.
+  sSRAPIRunner = `var plugins = [${ssrPluginsRequires}]\n${sSRAPIRunner}`;
+  fs.writeFileSync(`${siteDir}/api-runner-browser-plugins.js`, browserAPIRunner, `utf-8`);
+  fs.writeFileSync(`${siteDir}/api-runner-ssr.js`, sSRAPIRunner, `utf-8`);
+  activity.end();
+  /**
+   * Start the main bootstrap processes.
+   */
+  // onPreBootstrap
+
+  activity = report.activityTimer(`onPreBootstrap`);
+  activity.start();
+  await apiRunnerNode(`onPreBootstrap`);
+  activity.end(); // Source nodes
+
+  activity = report.activityTimer(`source and transform nodes`, {
+    parentSpan: bootstrapSpan
+  });
+  activity.start();
+  await require(`../utils/source-nodes`)({
+    parentSpan: activity.span
+  });
+  activity.end(); // Create Schema.
 
-    activity = report.activityTimer(`building schema`, {
-      parentSpan: bootstrapSpan
-    });
-    activity.start();
-    yield require(`../schema`).build({
-      parentSpan: activity.span
-    });
-    activity.end(); // Collect resolvable extensions and attach to program.
+  activity = report.activityTimer(`building schema`, {
+    parentSpan: bootstrapSpan
+  });
+  activity.start();
+  await require(`../schema`).build({
+    parentSpan: activity.span
+  });
+  activity.end(); // Collect resolvable extensions and attach to program.
 
-    const extensions = [`.mjs`, `.js`, `.jsx`, `.wasm`, `.json`]; // Change to this being an action and plugins implement `onPreBootstrap`
-    // for adding extensions.
+  const extensions = [`.mjs`, `.js`, `.jsx`, `.wasm`, `.json`]; // Change to this being an action and plugins implement `onPreBootstrap`
+  // for adding extensions.
 
-    const apiResults = yield apiRunnerNode(`resolvableExtensions`, {
-      traceId: `initial-resolvableExtensions`,
-      parentSpan: bootstrapSpan
-    });
-    store.dispatch({
-      type: `SET_PROGRAM_EXTENSIONS`,
-      payload: _.flattenDeep([extensions, apiResults])
-    });
+  const apiResults = await apiRunnerNode(`resolvableExtensions`, {
+    traceId: `initial-resolvableExtensions`,
+    parentSpan: bootstrapSpan
+  });
+  store.dispatch({
+    type: `SET_PROGRAM_EXTENSIONS`,
+    payload: _.flattenDeep([extensions, apiResults])
+  });
 
-    const graphqlRunner = (query, context = {}) => {
-      const schema = store.getState().schema;
-      return graphql(schema, query, context, withResolverContext(context, schema), context);
-    }; // Collect pages.
+  const graphqlRunner = (query, context = {}) => {
+    const schema = store.getState().schema;
+    return graphql(schema, query, context, withResolverContext(context, schema), context);
+  }; // Collect pages.
 
 
-    activity = report.activityTimer(`createPages`, {
-      parentSpan: bootstrapSpan
-    });
-    activity.start();
-    yield apiRunnerNode(`createPages`, {
-      graphql: graphqlRunner,
-      traceId: `initial-createPages`,
-      waitForCascadingActions: true,
-      parentSpan: activity.span
-    });
-    activity.end(); // A variant on createPages for plugins that want to
-    // have full control over adding/removing pages. The normal
-    // "createPages" API is called every time (during development)
-    // that data changes.
+  activity = report.activityTimer(`createPages`, {
+    parentSpan: bootstrapSpan
+  });
+  activity.start();
+  await apiRunnerNode(`createPages`, {
+    graphql: graphqlRunner,
+    traceId: `initial-createPages`,
+    waitForCascadingActions: true,
+    parentSpan: activity.span
+  });
+  activity.end(); // A variant on createPages for plugins that want to
+  // have full control over adding/removing pages. The normal
+  // "createPages" API is called every time (during development)
+  // that data changes.
 
-    activity = report.activityTimer(`createPagesStatefully`, {
-      parentSpan: bootstrapSpan
-    });
-    activity.start();
-    yield apiRunnerNode(`createPagesStatefully`, {
-      graphql: graphqlRunner,
-      traceId: `initial-createPagesStatefully`,
-      waitForCascadingActions: true,
-      parentSpan: activity.span
-    });
-    activity.end();
-    activity = report.activityTimer(`onPreExtractQueries`, {
-      parentSpan: bootstrapSpan
-    });
-    activity.start();
-    yield apiRunnerNode(`onPreExtractQueries`, {
-      parentSpan: activity.span
-    });
-    activity.end(); // Update Schema for SitePage.
+  activity = report.activityTimer(`createPagesStatefully`, {
+    parentSpan: bootstrapSpan
+  });
+  activity.start();
+  await apiRunnerNode(`createPagesStatefully`, {
+    graphql: graphqlRunner,
+    traceId: `initial-createPagesStatefully`,
+    waitForCascadingActions: true,
+    parentSpan: activity.span
+  });
+  activity.end();
+  activity = report.activityTimer(`onPreExtractQueries`, {
+    parentSpan: bootstrapSpan
+  });
+  activity.start();
+  await apiRunnerNode(`onPreExtractQueries`, {
+    parentSpan: activity.span
+  });
+  activity.end(); // Update Schema for SitePage.
 
-    activity = report.activityTimer(`update schema`, {
-      parentSpan: bootstrapSpan
-    });
-    activity.start();
-    yield require(`../schema`).rebuildWithSitePage({
-      parentSpan: activity.span
-    });
-    activity.end(); // Extract queries
+  activity = report.activityTimer(`update schema`, {
+    parentSpan: bootstrapSpan
+  });
+  activity.start();
+  await require(`../schema`).rebuildWithSitePage({
+    parentSpan: activity.span
+  });
+  activity.end(); // Extract queries
 
-    activity = report.activityTimer(`extract queries from components`, {
-      parentSpan: bootstrapSpan
-    });
-    activity.start();
-    yield extractQueries();
-    activity.end(); // Start the createPages hot reloader.
+  activity = report.activityTimer(`extract queries from components`, {
+    parentSpan: bootstrapSpan
+  });
+  activity.start();
+  await extractQueries();
+  activity.end(); // Start the createPages hot reloader.
 
-    if (process.env.NODE_ENV !== `production`) {
-      require(`./page-hot-reloader`)(graphqlRunner);
-    } // Run queries
+  if (process.env.NODE_ENV !== `production`) {
+    require(`./page-hot-reloader`)(graphqlRunner);
+  } // Run queries
 
 
-    activity = report.activityTimer(`run graphql queries`, {
-      parentSpan: bootstrapSpan
-    });
-    activity.start();
-    const startQueries = process.hrtime();
-    queryQueue.on(`task_finish`, () => {
-      const stats = queryQueue.getStats();
-      activity.setStatus(`${stats.total}/${stats.peak} ${(stats.total / convertHrtime(process.hrtime(startQueries)).seconds).toFixed(2)} queries/second`);
-    });
-    yield runInitialQueries(activity);
-    activity.end(); // Write out files.
+  activity = report.activityTimer(`run graphql queries`, {
+    parentSpan: bootstrapSpan
+  });
+  activity.start();
+  await runInitialQueries(activity);
+  activity.end();
 
-    activity = report.activityTimer(`write out page data`, {
-      parentSpan: bootstrapSpan
-    });
-    activity.start();
+  require(`../redux/actions`).boundActionCreators.setProgramStatus(`BOOTSTRAP_QUERY_RUNNING_FINISHED`); // Write out files.
 
-    try {
-      yield writePages();
-    } catch (err) {
-      report.panic(`Failed to write out page data`, err);
-    }
 
-    activity.end(); // Write out redirects.
+  activity = report.activityTimer(`write out page data`, {
+    parentSpan: bootstrapSpan
+  });
+  activity.start();
 
-    activity = report.activityTimer(`write out redirect data`, {
-      parentSpan: bootstrapSpan
-    });
-    activity.start();
-    yield writeRedirects();
-    activity.end();
-    let onEndJob;
-
-    const checkJobsDone = _.debounce(
-    /*#__PURE__*/
-    function () {
-      var _ref2 = (0, _asyncToGenerator2.default)(function* (resolve) {
-        const state = store.getState();
-
-        if (state.jobs.active.length === 0) {
-          emitter.off(`END_JOB`, onEndJob);
-          yield finishBootstrap(bootstrapSpan);
-          resolve({
-            graphqlRunner
-          });
-        }
-      });
+  try {
+    await writePages();
+  } catch (err) {
+    report.panic(`Failed to write out page data`, err);
+  }
 
-      return function (_x2) {
-        return _ref2.apply(this, arguments);
-      };
-    }(), 100);
+  activity.end(); // Write out redirects.
 
-    if (store.getState().jobs.active.length === 0) {
-      yield finishBootstrap(bootstrapSpan);
-      return {
+  activity = report.activityTimer(`write out redirect data`, {
+    parentSpan: bootstrapSpan
+  });
+  activity.start();
+  await writeRedirects();
+  activity.end();
+  let onEndJob;
+
+  const checkJobsDone = _.debounce(async resolve => {
+    const state = store.getState();
+
+    if (state.jobs.active.length === 0) {
+      emitter.off(`END_JOB`, onEndJob);
+      await finishBootstrap(bootstrapSpan);
+      resolve({
         graphqlRunner
-      };
-    } else {
-      return new Promise(resolve => {
-        // Wait until all side effect jobs are finished.
-        onEndJob = () => checkJobsDone(resolve);
-
-        emitter.on(`END_JOB`, onEndJob);
       });
     }
-  });
+  }, 100);
 
-  return function (_x) {
-    return _ref.apply(this, arguments);
-  };
-}();
-
-const finishBootstrap =
-/*#__PURE__*/
-function () {
-  var _ref3 = (0, _asyncToGenerator2.default)(function* (bootstrapSpan) {
-    // onPostBootstrap
-    const activity = report.activityTimer(`onPostBootstrap`, {
-      parentSpan: bootstrapSpan
-    });
-    activity.start();
-    yield apiRunnerNode(`onPostBootstrap`, {
-      parentSpan: activity.span
+  if (store.getState().jobs.active.length === 0) {
+    await finishBootstrap(bootstrapSpan);
+    return {
+      graphqlRunner
+    };
+  } else {
+    return new Promise(resolve => {
+      // Wait until all side effect jobs are finished.
+      onEndJob = () => checkJobsDone(resolve);
+
+      emitter.on(`END_JOB`, onEndJob);
     });
-    activity.end();
-    report.log(``);
-    report.info(`bootstrap finished - ${process.uptime()} s`);
-    report.log(``);
-    emitter.emit(`BOOTSTRAP_FINISHED`);
-    bootstrapSpan.finish();
+  }
+};
+
+const finishBootstrap = async bootstrapSpan => {
+  // onPostBootstrap
+  const activity = report.activityTimer(`onPostBootstrap`, {
+    parentSpan: bootstrapSpan
+  });
+  activity.start();
+  await apiRunnerNode(`onPostBootstrap`, {
+    parentSpan: activity.span
   });
+  activity.end();
+  report.log(``);
+  report.info(`bootstrap finished - ${process.uptime()} s`);
+  report.log(``);
+  emitter.emit(`BOOTSTRAP_FINISHED`);
 
-  return function finishBootstrap(_x3) {
-    return _ref3.apply(this, arguments);
-  };
-}();
+  require(`../redux/actions`).boundActionCreators.setProgramStatus(`BOOTSTRAP_FINISHED`);
+
+  bootstrapSpan.finish();
+};
 //# sourceMappingURL=index.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/bootstrap/index.js.map b/node_modules/gatsby/dist/bootstrap/index.js.map
index 578a88d..f082c24 100644
--- a/node_modules/gatsby/dist/bootstrap/index.js.map
+++ b/node_modules/gatsby/dist/bootstrap/index.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/bootstrap/index.js"],"names":["_","require","slash","fs","md5File","crypto","del","path","convertHrtime","Promise","apiRunnerNode","getBrowserslist","graphql","store","emitter","loadPlugins","loadThemes","report","getConfigFile","tracer","globalTracer","preferDefault","nodeTracking","withResolverContext","startAutosave","process","on","reason","p","panic","extractQueries","runInitialQueries","queryQueue","writePages","writeRedirects","module","exports","args","spanArgs","parentSpan","childOf","bootstrapSpan","startSpan","directory","program","browserslist","dispatch","type","payload","activity","activityTimer","start","config","__experimentalThemes","themes","polyfill","warn","end","flattenedPlugins","span","env","NODE_ENV","pluginVersions","map","version","hashes","all","resolve","catch","pluginsHash","createHash","update","JSON","stringify","concat","digest","state","getState","oldPluginsHash","status","PLUGINS_HASH","info","stripIndent","cacheDirectory","remove","emptyDir","e","error","ensureDir","GATSBY_DB_NODES","loki","dbSaveFile","saveFile","dirname","trackDbNodes","srcDir","__dirname","siteDir","tryRequire","copy","clobber","ensureDirSync","err","hasAPIFile","plugin","skipSSR","undefined","envAPIs","join","Array","isArray","length","ssrPlugins","filter","options","pluginOptions","browserPlugins","browserPluginsRequires","browserAPIRunner","sSRAPIRunner","readFileSync","ssrPluginsRequires","writeFileSync","build","extensions","apiResults","traceId","flattenDeep","graphqlRunner","query","context","schema","waitForCascadingActions","rebuildWithSitePage","startQueries","hrtime","stats","getStats","setStatus","total","peak","seconds","toFixed","onEndJob","checkJobsDone","debounce","jobs","active","off","finishBootstrap","log","uptime","emit","finish"],"mappings":"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","sourcesContent":["/* @flow */\n\nconst _ = require(`lodash`)\nconst slash = require(`slash`)\nconst fs = require(`fs-extra`)\nconst md5File = require(`md5-file/promise`)\nconst crypto = require(`crypto`)\nconst del = require(`del`)\nconst path = require(`path`)\nconst convertHrtime = require(`convert-hrtime`)\nconst Promise = require(`bluebird`)\n\nconst apiRunnerNode = require(`../utils/api-runner-node`)\nconst getBrowserslist = require(`../utils/browserslist`)\nconst { graphql } = require(`graphql`)\nconst { store, emitter } = require(`../redux`)\nconst loadPlugins = require(`./load-plugins`)\nconst loadThemes = require(`./load-themes`)\nconst report = require(`gatsby-cli/lib/reporter`)\nconst getConfigFile = require(`./get-config-file`)\nconst tracer = require(`opentracing`).globalTracer()\nconst preferDefault = require(`./prefer-default`)\nconst nodeTracking = require(`../db/node-tracking`)\nconst withResolverContext = require(`../schema/context`)\nrequire(`../db`).startAutosave()\n\n// Show stack trace on unhandled promises.\nprocess.on(`unhandledRejection`, (reason, p) => {\n  report.panic(reason)\n})\n\nconst {\n  extractQueries,\n} = require(`../internal-plugins/query-runner/query-watcher`)\nconst {\n  runInitialQueries,\n} = require(`../internal-plugins/query-runner/page-query-runner`)\nconst queryQueue = require(`../internal-plugins/query-runner/query-queue`)\nconst { writePages } = require(`../internal-plugins/query-runner/pages-writer`)\nconst {\n  writeRedirects,\n} = require(`../internal-plugins/query-runner/redirects-writer`)\n\n// Override console.log to add the source file + line number.\n// Useful for debugging if you lose a console.log somewhere.\n// Otherwise leave commented out.\n// require(`./log-line-function`)\n\ntype BootstrapArgs = {\n  directory: string,\n  prefixPaths?: boolean,\n  parentSpan: Object,\n}\n\nmodule.exports = async (args: BootstrapArgs) => {\n  const spanArgs = args.parentSpan ? { childOf: args.parentSpan } : {}\n  const bootstrapSpan = tracer.startSpan(`bootstrap`, spanArgs)\n\n  // Start plugin runner which listens to the store\n  // and invokes Gatsby API based on actions.\n  require(`../redux/plugin-runner`)\n\n  const directory = slash(args.directory)\n\n  const program = {\n    ...args,\n    browserslist: getBrowserslist(directory),\n    // Fix program directory path for windows env.\n    directory,\n  }\n\n  store.dispatch({\n    type: `SET_PROGRAM`,\n    payload: program,\n  })\n\n  // Try opening the site's gatsby-config.js file.\n  let activity = report.activityTimer(`open and validate gatsby-configs`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  let config = await preferDefault(\n    getConfigFile(program.directory, `gatsby-config`)\n  )\n\n  // theme gatsby configs can be functions or objects\n  if (config && config.__experimentalThemes) {\n    const themes = await loadThemes(config)\n    config = themes.config\n\n    store.dispatch({\n      type: `SET_RESOLVED_THEMES`,\n      payload: themes.themes,\n    })\n  }\n\n  if (config && config.polyfill) {\n    report.warn(\n      `Support for custom Promise polyfills has been removed in Gatsby v2. We only support Babel 7's new automatic polyfilling behavior.`\n    )\n  }\n\n  store.dispatch({\n    type: `SET_SITE_CONFIG`,\n    payload: config,\n  })\n\n  activity.end()\n\n  activity = report.activityTimer(`load plugins`)\n  activity.start()\n  const flattenedPlugins = await loadPlugins(config, program.directory)\n  activity.end()\n\n  // onPreInit\n  activity = report.activityTimer(`onPreInit`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  await apiRunnerNode(`onPreInit`, { parentSpan: activity.span })\n  activity.end()\n\n  // During builds, delete html and css files from the public directory as we don't want\n  // deleted pages and styles from previous builds to stick around.\n  if (process.env.NODE_ENV === `production`) {\n    activity = report.activityTimer(\n      `delete html and css files from previous builds`,\n      {\n        parentSpan: bootstrapSpan,\n      }\n    )\n    activity.start()\n    await del([\n      `public/*.{html,css}`,\n      `public/**/*.{html,css}`,\n      `!public/static`,\n      `!public/static/**/*.{html,css}`,\n    ])\n    activity.end()\n  }\n\n  activity = report.activityTimer(`initialize cache`)\n  activity.start()\n  // Check if any plugins have been updated since our last run. If so\n  // we delete the cache is there's likely been changes\n  // since the previous run.\n  //\n  // We do this by creating a hash of all the version numbers of installed\n  // plugins, the site's package.json, gatsby-config.js, and gatsby-node.js.\n  // The last, gatsby-node.js, is important as many gatsby sites put important\n  // logic in there e.g. generating slugs for custom pages.\n  const pluginVersions = flattenedPlugins.map(p => p.version)\n  const hashes = await Promise.all([\n    md5File(`package.json`),\n    Promise.resolve(\n      md5File(`${program.directory}/gatsby-config.js`).catch(() => {})\n    ), // ignore as this file isn't required),\n    Promise.resolve(\n      md5File(`${program.directory}/gatsby-node.js`).catch(() => {})\n    ), // ignore as this file isn't required),\n  ])\n  const pluginsHash = crypto\n    .createHash(`md5`)\n    .update(JSON.stringify(pluginVersions.concat(hashes)))\n    .digest(`hex`)\n  let state = store.getState()\n  const oldPluginsHash = state && state.status ? state.status.PLUGINS_HASH : ``\n\n  // Check if anything has changed. If it has, delete the site's .cache\n  // directory and tell reducers to empty themselves.\n  //\n  // Also if the hash isn't there, then delete things just in case something\n  // is weird.\n  if (oldPluginsHash && pluginsHash !== oldPluginsHash) {\n    report.info(report.stripIndent`\n      One or more of your plugins have changed since the last time you ran Gatsby. As\n      a precaution, we're deleting your site's cache to ensure there's not any stale\n      data\n    `)\n  }\n  const cacheDirectory = `${program.directory}/.cache`\n  if (!oldPluginsHash || pluginsHash !== oldPluginsHash) {\n    try {\n      // Attempt to empty dir if remove fails,\n      // like when directory is mount point\n      await fs.remove(cacheDirectory).catch(() => fs.emptyDir(cacheDirectory))\n    } catch (e) {\n      report.error(`Failed to remove .cache files.`, e)\n    }\n    // Tell reducers to delete their data (the store will already have\n    // been loaded from the file system cache).\n    store.dispatch({\n      type: `DELETE_CACHE`,\n    })\n  }\n\n  // Update the store with the new plugins hash.\n  store.dispatch({\n    type: `UPDATE_PLUGINS_HASH`,\n    payload: pluginsHash,\n  })\n\n  // Now that we know the .cache directory is safe, initialize the cache\n  // directory.\n  await fs.ensureDir(cacheDirectory)\n\n  // Ensure the public/static directory\n  await fs.ensureDir(`${program.directory}/public/static`)\n\n  activity.end()\n\n  if (process.env.GATSBY_DB_NODES === `loki`) {\n    const loki = require(`../db/loki`)\n    // Start the nodes database (in memory loki js with interval disk\n    // saves). If data was saved from a previous build, it will be\n    // loaded here\n    activity = report.activityTimer(`start nodes db`, {\n      parentSpan: bootstrapSpan,\n    })\n    activity.start()\n    const dbSaveFile = `${cacheDirectory}/loki/loki.db`\n    try {\n      await loki.start({\n        saveFile: dbSaveFile,\n      })\n    } catch (e) {\n      report.error(\n        `Error starting DB. Perhaps try deleting ${path.dirname(dbSaveFile)}`\n      )\n    }\n    activity.end()\n  }\n\n  // By now, our nodes database has been loaded, so ensure that we\n  // have tracked all inline objects\n  nodeTracking.trackDbNodes()\n\n  // Copy our site files to the root of the site.\n  activity = report.activityTimer(`copy gatsby files`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  const srcDir = `${__dirname}/../../cache-dir`\n  const siteDir = cacheDirectory\n  const tryRequire = `${__dirname}/../utils/test-require-error.js`\n  try {\n    await fs.copy(srcDir, siteDir, {\n      clobber: true,\n    })\n    await fs.copy(tryRequire, `${siteDir}/test-require-error.js`, {\n      clobber: true,\n    })\n    await fs.ensureDirSync(`${cacheDirectory}/json`)\n\n    // Ensure .cache/fragments exists and is empty. We want fragments to be\n    // added on every run in response to data as fragments can only be added if\n    // the data used to create the schema they're dependent on is available.\n    await fs.emptyDir(`${cacheDirectory}/fragments`)\n  } catch (err) {\n    report.panic(`Unable to copy site files to .cache`, err)\n  }\n\n  // Find plugins which implement gatsby-browser and gatsby-ssr and write\n  // out api-runners for them.\n  const hasAPIFile = (env, plugin) => {\n    // The plugin loader has disabled SSR APIs for this plugin. Usually due to\n    // multiple implementations of an API that can only be implemented once\n    if (env === `ssr` && plugin.skipSSR === true) return undefined\n\n    const envAPIs = plugin[`${env}APIs`]\n\n    // Always include gatsby-browser.js files if they exists as they're\n    // a handy place to include global styles and other global imports.\n    try {\n      if (env === `browser`) {\n        return slash(\n          require.resolve(path.join(plugin.resolve, `gatsby-${env}`))\n        )\n      }\n    } catch (e) {\n      // ignore\n    }\n\n    if (envAPIs && Array.isArray(envAPIs) && envAPIs.length > 0) {\n      return slash(path.join(plugin.resolve, `gatsby-${env}`))\n    }\n    return undefined\n  }\n\n  const ssrPlugins = _.filter(\n    flattenedPlugins.map(plugin => {\n      return {\n        resolve: hasAPIFile(`ssr`, plugin),\n        options: plugin.pluginOptions,\n      }\n    }),\n    plugin => plugin.resolve\n  )\n\n  const browserPlugins = _.filter(\n    flattenedPlugins.map(plugin => {\n      return {\n        resolve: hasAPIFile(`browser`, plugin),\n        options: plugin.pluginOptions,\n      }\n    }),\n    plugin => plugin.resolve\n  )\n\n  const browserPluginsRequires = browserPlugins\n    .map(\n      plugin =>\n        `{\n      plugin: require('${plugin.resolve}'),\n      options: ${JSON.stringify(plugin.options)},\n    }`\n    )\n    .join(`,`)\n\n  const browserAPIRunner = `module.exports = [${browserPluginsRequires}]\\n`\n\n  let sSRAPIRunner = ``\n\n  try {\n    sSRAPIRunner = fs.readFileSync(`${siteDir}/api-runner-ssr.js`, `utf-8`)\n  } catch (err) {\n    report.panic(`Failed to read ${siteDir}/api-runner-ssr.js`, err)\n  }\n\n  const ssrPluginsRequires = ssrPlugins\n    .map(\n      plugin =>\n        `{\n      plugin: require('${plugin.resolve}'),\n      options: ${JSON.stringify(plugin.options)},\n    }`\n    )\n    .join(`,`)\n  sSRAPIRunner = `var plugins = [${ssrPluginsRequires}]\\n${sSRAPIRunner}`\n\n  fs.writeFileSync(\n    `${siteDir}/api-runner-browser-plugins.js`,\n    browserAPIRunner,\n    `utf-8`\n  )\n  fs.writeFileSync(`${siteDir}/api-runner-ssr.js`, sSRAPIRunner, `utf-8`)\n\n  activity.end()\n  /**\n   * Start the main bootstrap processes.\n   */\n\n  // onPreBootstrap\n  activity = report.activityTimer(`onPreBootstrap`)\n  activity.start()\n  await apiRunnerNode(`onPreBootstrap`)\n  activity.end()\n\n  // Source nodes\n  activity = report.activityTimer(`source and transform nodes`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  await require(`../utils/source-nodes`)({ parentSpan: activity.span })\n  activity.end()\n\n  // Create Schema.\n  activity = report.activityTimer(`building schema`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  await require(`../schema`).build({ parentSpan: activity.span })\n  activity.end()\n\n  // Collect resolvable extensions and attach to program.\n  const extensions = [`.mjs`, `.js`, `.jsx`, `.wasm`, `.json`]\n  // Change to this being an action and plugins implement `onPreBootstrap`\n  // for adding extensions.\n  const apiResults = await apiRunnerNode(`resolvableExtensions`, {\n    traceId: `initial-resolvableExtensions`,\n    parentSpan: bootstrapSpan,\n  })\n\n  store.dispatch({\n    type: `SET_PROGRAM_EXTENSIONS`,\n    payload: _.flattenDeep([extensions, apiResults]),\n  })\n\n  const graphqlRunner = (query, context = {}) => {\n    const schema = store.getState().schema\n    return graphql(\n      schema,\n      query,\n      context,\n      withResolverContext(context, schema),\n      context\n    )\n  }\n\n  // Collect pages.\n  activity = report.activityTimer(`createPages`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  await apiRunnerNode(`createPages`, {\n    graphql: graphqlRunner,\n    traceId: `initial-createPages`,\n    waitForCascadingActions: true,\n    parentSpan: activity.span,\n  })\n  activity.end()\n\n  // A variant on createPages for plugins that want to\n  // have full control over adding/removing pages. The normal\n  // \"createPages\" API is called every time (during development)\n  // that data changes.\n  activity = report.activityTimer(`createPagesStatefully`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  await apiRunnerNode(`createPagesStatefully`, {\n    graphql: graphqlRunner,\n    traceId: `initial-createPagesStatefully`,\n    waitForCascadingActions: true,\n    parentSpan: activity.span,\n  })\n  activity.end()\n\n  activity = report.activityTimer(`onPreExtractQueries`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  await apiRunnerNode(`onPreExtractQueries`, { parentSpan: activity.span })\n  activity.end()\n\n  // Update Schema for SitePage.\n  activity = report.activityTimer(`update schema`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  await require(`../schema`).rebuildWithSitePage({ parentSpan: activity.span })\n  activity.end()\n\n  // Extract queries\n  activity = report.activityTimer(`extract queries from components`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  await extractQueries()\n  activity.end()\n\n  // Start the createPages hot reloader.\n  if (process.env.NODE_ENV !== `production`) {\n    require(`./page-hot-reloader`)(graphqlRunner)\n  }\n\n  // Run queries\n  activity = report.activityTimer(`run graphql queries`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  const startQueries = process.hrtime()\n  queryQueue.on(`task_finish`, () => {\n    const stats = queryQueue.getStats()\n    activity.setStatus(\n      `${stats.total}/${stats.peak} ${(\n        stats.total / convertHrtime(process.hrtime(startQueries)).seconds\n      ).toFixed(2)} queries/second`\n    )\n  })\n  await runInitialQueries(activity)\n  activity.end()\n\n  // Write out files.\n  activity = report.activityTimer(`write out page data`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  try {\n    await writePages()\n  } catch (err) {\n    report.panic(`Failed to write out page data`, err)\n  }\n  activity.end()\n\n  // Write out redirects.\n  activity = report.activityTimer(`write out redirect data`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  await writeRedirects()\n  activity.end()\n\n  let onEndJob\n\n  const checkJobsDone = _.debounce(async resolve => {\n    const state = store.getState()\n    if (state.jobs.active.length === 0) {\n      emitter.off(`END_JOB`, onEndJob)\n\n      await finishBootstrap(bootstrapSpan)\n      resolve({ graphqlRunner })\n    }\n  }, 100)\n\n  if (store.getState().jobs.active.length === 0) {\n    await finishBootstrap(bootstrapSpan)\n    return { graphqlRunner }\n  } else {\n    return new Promise(resolve => {\n      // Wait until all side effect jobs are finished.\n      onEndJob = () => checkJobsDone(resolve)\n      emitter.on(`END_JOB`, onEndJob)\n    })\n  }\n}\n\nconst finishBootstrap = async bootstrapSpan => {\n  // onPostBootstrap\n  const activity = report.activityTimer(`onPostBootstrap`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  await apiRunnerNode(`onPostBootstrap`, { parentSpan: activity.span })\n  activity.end()\n\n  report.log(``)\n  report.info(`bootstrap finished - ${process.uptime()} s`)\n  report.log(``)\n  emitter.emit(`BOOTSTRAP_FINISHED`)\n\n  bootstrapSpan.finish()\n}\n"],"file":"index.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/bootstrap/index.js"],"names":["_","require","slash","fs","md5File","crypto","del","path","Promise","telemetry","apiRunnerNode","getBrowserslist","graphql","store","emitter","loadPlugins","loadThemes","report","getConfigFile","tracer","globalTracer","preferDefault","nodeTracking","withResolverContext","process","on","reason","p","panic","extractQueries","runInitialQueries","writePages","writeRedirects","module","exports","args","spanArgs","parentSpan","childOf","bootstrapSpan","startSpan","directory","program","browserslist","dispatch","type","payload","activity","activityTimer","start","config","__experimentalThemes","themes","polyfill","warn","end","flattenedPlugins","decorateEvent","plugins","map","name","version","span","env","NODE_ENV","pluginVersions","hashes","all","resolve","catch","pluginsHash","createHash","update","JSON","stringify","concat","digest","state","getState","oldPluginsHash","status","PLUGINS_HASH","info","stripIndent","cacheDirectory","remove","emptyDir","e","error","ensureDir","GATSBY_DB_NODES","loki","dbSaveFile","saveFile","dirname","trackDbNodes","srcDir","__dirname","siteDir","tryRequire","copy","clobber","ensureDirSync","err","hasAPIFile","plugin","skipSSR","undefined","envAPIs","join","Array","isArray","length","ssrPlugins","filter","options","pluginOptions","browserPlugins","browserPluginsRequires","browserAPIRunner","sSRAPIRunner","readFileSync","ssrPluginsRequires","writeFileSync","build","extensions","apiResults","traceId","flattenDeep","graphqlRunner","query","context","schema","waitForCascadingActions","rebuildWithSitePage","boundActionCreators","setProgramStatus","onEndJob","checkJobsDone","debounce","jobs","active","off","finishBootstrap","log","uptime","emit","finish"],"mappings":"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","sourcesContent":["/* @flow */\n\nconst _ = require(`lodash`)\nconst slash = require(`slash`)\nconst fs = require(`fs-extra`)\nconst md5File = require(`md5-file/promise`)\nconst crypto = require(`crypto`)\nconst del = require(`del`)\nconst path = require(`path`)\nconst Promise = require(`bluebird`)\nconst telemetry = require(`gatsby-telemetry`)\n\nconst apiRunnerNode = require(`../utils/api-runner-node`)\nconst getBrowserslist = require(`../utils/browserslist`)\nconst { graphql } = require(`graphql`)\nconst { store, emitter } = require(`../redux`)\nconst loadPlugins = require(`./load-plugins`)\nconst loadThemes = require(`./load-themes`)\nconst report = require(`gatsby-cli/lib/reporter`)\nconst getConfigFile = require(`./get-config-file`)\nconst tracer = require(`opentracing`).globalTracer()\nconst preferDefault = require(`./prefer-default`)\nconst nodeTracking = require(`../db/node-tracking`)\nconst withResolverContext = require(`../schema/context`)\n// Add `util.promisify` polyfill for old node versions\nrequire(`util.promisify/shim`)()\n\n// Show stack trace on unhandled promises.\nprocess.on(`unhandledRejection`, (reason, p) => {\n  report.panic(reason)\n})\n\nconst { extractQueries } = require(`../query/query-watcher`)\nconst { runInitialQueries } = require(`../query/page-query-runner`)\nconst { writePages } = require(`../query/pages-writer`)\nconst { writeRedirects } = require(`./redirects-writer`)\n\n// Override console.log to add the source file + line number.\n// Useful for debugging if you lose a console.log somewhere.\n// Otherwise leave commented out.\n// require(`./log-line-function`)\n\ntype BootstrapArgs = {\n  directory: string,\n  prefixPaths?: boolean,\n  parentSpan: Object,\n}\n\nmodule.exports = async (args: BootstrapArgs) => {\n  const spanArgs = args.parentSpan ? { childOf: args.parentSpan } : {}\n  const bootstrapSpan = tracer.startSpan(`bootstrap`, spanArgs)\n\n  // Start plugin runner which listens to the store\n  // and invokes Gatsby API based on actions.\n  require(`../redux/plugin-runner`)\n\n  const directory = slash(args.directory)\n\n  const program = {\n    ...args,\n    browserslist: getBrowserslist(directory),\n    // Fix program directory path for windows env.\n    directory,\n  }\n\n  store.dispatch({\n    type: `SET_PROGRAM`,\n    payload: program,\n  })\n\n  // Try opening the site's gatsby-config.js file.\n  let activity = report.activityTimer(`open and validate gatsby-configs`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  let config = await preferDefault(\n    getConfigFile(program.directory, `gatsby-config`)\n  )\n\n  // theme gatsby configs can be functions or objects\n  if (config && config.__experimentalThemes) {\n    const themes = await loadThemes(config)\n    config = themes.config\n\n    store.dispatch({\n      type: `SET_RESOLVED_THEMES`,\n      payload: themes.themes,\n    })\n  }\n\n  if (config && config.polyfill) {\n    report.warn(\n      `Support for custom Promise polyfills has been removed in Gatsby v2. We only support Babel 7's new automatic polyfilling behavior.`\n    )\n  }\n\n  store.dispatch({\n    type: `SET_SITE_CONFIG`,\n    payload: config,\n  })\n\n  activity.end()\n\n  activity = report.activityTimer(`load plugins`)\n  activity.start()\n  const flattenedPlugins = await loadPlugins(config, program.directory)\n  activity.end()\n\n  telemetry.decorateEvent(`BUILD_END`, {\n    plugins: flattenedPlugins.map(p => `${p.name}@${p.version}`),\n  })\n\n  // onPreInit\n  activity = report.activityTimer(`onPreInit`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  await apiRunnerNode(`onPreInit`, { parentSpan: activity.span })\n  activity.end()\n\n  // During builds, delete html and css files from the public directory as we don't want\n  // deleted pages and styles from previous builds to stick around.\n  if (process.env.NODE_ENV === `production`) {\n    activity = report.activityTimer(\n      `delete html and css files from previous builds`,\n      {\n        parentSpan: bootstrapSpan,\n      }\n    )\n    activity.start()\n    await del([\n      `public/*.{html,css}`,\n      `public/**/*.{html,css}`,\n      `!public/static`,\n      `!public/static/**/*.{html,css}`,\n    ])\n    activity.end()\n  }\n\n  activity = report.activityTimer(`initialize cache`)\n  activity.start()\n  // Check if any plugins have been updated since our last run. If so\n  // we delete the cache is there's likely been changes\n  // since the previous run.\n  //\n  // We do this by creating a hash of all the version numbers of installed\n  // plugins, the site's package.json, gatsby-config.js, and gatsby-node.js.\n  // The last, gatsby-node.js, is important as many gatsby sites put important\n  // logic in there e.g. generating slugs for custom pages.\n  const pluginVersions = flattenedPlugins.map(p => p.version)\n  const hashes = await Promise.all([\n    md5File(`package.json`),\n    Promise.resolve(\n      md5File(`${program.directory}/gatsby-config.js`).catch(() => {})\n    ), // ignore as this file isn't required),\n    Promise.resolve(\n      md5File(`${program.directory}/gatsby-node.js`).catch(() => {})\n    ), // ignore as this file isn't required),\n  ])\n  const pluginsHash = crypto\n    .createHash(`md5`)\n    .update(JSON.stringify(pluginVersions.concat(hashes)))\n    .digest(`hex`)\n  let state = store.getState()\n  const oldPluginsHash = state && state.status ? state.status.PLUGINS_HASH : ``\n\n  // Check if anything has changed. If it has, delete the site's .cache\n  // directory and tell reducers to empty themselves.\n  //\n  // Also if the hash isn't there, then delete things just in case something\n  // is weird.\n  if (oldPluginsHash && pluginsHash !== oldPluginsHash) {\n    report.info(report.stripIndent`\n      One or more of your plugins have changed since the last time you ran Gatsby. As\n      a precaution, we're deleting your site's cache to ensure there's not any stale\n      data\n    `)\n  }\n  const cacheDirectory = `${program.directory}/.cache`\n  if (!oldPluginsHash || pluginsHash !== oldPluginsHash) {\n    try {\n      // Attempt to empty dir if remove fails,\n      // like when directory is mount point\n      await fs.remove(cacheDirectory).catch(() => fs.emptyDir(cacheDirectory))\n    } catch (e) {\n      report.error(`Failed to remove .cache files.`, e)\n    }\n    // Tell reducers to delete their data (the store will already have\n    // been loaded from the file system cache).\n    store.dispatch({\n      type: `DELETE_CACHE`,\n    })\n  }\n\n  // Update the store with the new plugins hash.\n  store.dispatch({\n    type: `UPDATE_PLUGINS_HASH`,\n    payload: pluginsHash,\n  })\n\n  // Now that we know the .cache directory is safe, initialize the cache\n  // directory.\n  await fs.ensureDir(cacheDirectory)\n\n  // Ensure the public/static directory\n  await fs.ensureDir(`${program.directory}/public/static`)\n\n  activity.end()\n\n  if (process.env.GATSBY_DB_NODES === `loki`) {\n    const loki = require(`../db/loki`)\n    // Start the nodes database (in memory loki js with interval disk\n    // saves). If data was saved from a previous build, it will be\n    // loaded here\n    activity = report.activityTimer(`start nodes db`, {\n      parentSpan: bootstrapSpan,\n    })\n    activity.start()\n    const dbSaveFile = `${cacheDirectory}/loki/loki.db`\n    try {\n      await loki.start({\n        saveFile: dbSaveFile,\n      })\n    } catch (e) {\n      report.error(\n        `Error starting DB. Perhaps try deleting ${path.dirname(dbSaveFile)}`\n      )\n    }\n    activity.end()\n  }\n\n  // By now, our nodes database has been loaded, so ensure that we\n  // have tracked all inline objects\n  nodeTracking.trackDbNodes()\n\n  // Copy our site files to the root of the site.\n  activity = report.activityTimer(`copy gatsby files`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  const srcDir = `${__dirname}/../../cache-dir`\n  const siteDir = cacheDirectory\n  const tryRequire = `${__dirname}/../utils/test-require-error.js`\n  try {\n    await fs.copy(srcDir, siteDir, {\n      clobber: true,\n    })\n    await fs.copy(tryRequire, `${siteDir}/test-require-error.js`, {\n      clobber: true,\n    })\n    await fs.ensureDirSync(`${cacheDirectory}/json`)\n\n    // Ensure .cache/fragments exists and is empty. We want fragments to be\n    // added on every run in response to data as fragments can only be added if\n    // the data used to create the schema they're dependent on is available.\n    await fs.emptyDir(`${cacheDirectory}/fragments`)\n  } catch (err) {\n    report.panic(`Unable to copy site files to .cache`, err)\n  }\n\n  // Find plugins which implement gatsby-browser and gatsby-ssr and write\n  // out api-runners for them.\n  const hasAPIFile = (env, plugin) => {\n    // The plugin loader has disabled SSR APIs for this plugin. Usually due to\n    // multiple implementations of an API that can only be implemented once\n    if (env === `ssr` && plugin.skipSSR === true) return undefined\n\n    const envAPIs = plugin[`${env}APIs`]\n\n    // Always include gatsby-browser.js files if they exists as they're\n    // a handy place to include global styles and other global imports.\n    try {\n      if (env === `browser`) {\n        return slash(\n          require.resolve(path.join(plugin.resolve, `gatsby-${env}`))\n        )\n      }\n    } catch (e) {\n      // ignore\n    }\n\n    if (envAPIs && Array.isArray(envAPIs) && envAPIs.length > 0) {\n      return slash(path.join(plugin.resolve, `gatsby-${env}`))\n    }\n    return undefined\n  }\n\n  const ssrPlugins = _.filter(\n    flattenedPlugins.map(plugin => {\n      return {\n        resolve: hasAPIFile(`ssr`, plugin),\n        options: plugin.pluginOptions,\n      }\n    }),\n    plugin => plugin.resolve\n  )\n\n  const browserPlugins = _.filter(\n    flattenedPlugins.map(plugin => {\n      return {\n        resolve: hasAPIFile(`browser`, plugin),\n        options: plugin.pluginOptions,\n      }\n    }),\n    plugin => plugin.resolve\n  )\n\n  const browserPluginsRequires = browserPlugins\n    .map(\n      plugin =>\n        `{\n      plugin: require('${plugin.resolve}'),\n      options: ${JSON.stringify(plugin.options)},\n    }`\n    )\n    .join(`,`)\n\n  const browserAPIRunner = `module.exports = [${browserPluginsRequires}]\\n`\n\n  let sSRAPIRunner = ``\n\n  try {\n    sSRAPIRunner = fs.readFileSync(`${siteDir}/api-runner-ssr.js`, `utf-8`)\n  } catch (err) {\n    report.panic(`Failed to read ${siteDir}/api-runner-ssr.js`, err)\n  }\n\n  const ssrPluginsRequires = ssrPlugins\n    .map(\n      plugin =>\n        `{\n      plugin: require('${plugin.resolve}'),\n      options: ${JSON.stringify(plugin.options)},\n    }`\n    )\n    .join(`,`)\n  sSRAPIRunner = `var plugins = [${ssrPluginsRequires}]\\n${sSRAPIRunner}`\n\n  fs.writeFileSync(\n    `${siteDir}/api-runner-browser-plugins.js`,\n    browserAPIRunner,\n    `utf-8`\n  )\n  fs.writeFileSync(`${siteDir}/api-runner-ssr.js`, sSRAPIRunner, `utf-8`)\n\n  activity.end()\n  /**\n   * Start the main bootstrap processes.\n   */\n\n  // onPreBootstrap\n  activity = report.activityTimer(`onPreBootstrap`)\n  activity.start()\n  await apiRunnerNode(`onPreBootstrap`)\n  activity.end()\n\n  // Source nodes\n  activity = report.activityTimer(`source and transform nodes`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  await require(`../utils/source-nodes`)({ parentSpan: activity.span })\n  activity.end()\n\n  // Create Schema.\n  activity = report.activityTimer(`building schema`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  await require(`../schema`).build({ parentSpan: activity.span })\n  activity.end()\n\n  // Collect resolvable extensions and attach to program.\n  const extensions = [`.mjs`, `.js`, `.jsx`, `.wasm`, `.json`]\n  // Change to this being an action and plugins implement `onPreBootstrap`\n  // for adding extensions.\n  const apiResults = await apiRunnerNode(`resolvableExtensions`, {\n    traceId: `initial-resolvableExtensions`,\n    parentSpan: bootstrapSpan,\n  })\n\n  store.dispatch({\n    type: `SET_PROGRAM_EXTENSIONS`,\n    payload: _.flattenDeep([extensions, apiResults]),\n  })\n\n  const graphqlRunner = (query, context = {}) => {\n    const schema = store.getState().schema\n    return graphql(\n      schema,\n      query,\n      context,\n      withResolverContext(context, schema),\n      context\n    )\n  }\n\n  // Collect pages.\n  activity = report.activityTimer(`createPages`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  await apiRunnerNode(`createPages`, {\n    graphql: graphqlRunner,\n    traceId: `initial-createPages`,\n    waitForCascadingActions: true,\n    parentSpan: activity.span,\n  })\n  activity.end()\n\n  // A variant on createPages for plugins that want to\n  // have full control over adding/removing pages. The normal\n  // \"createPages\" API is called every time (during development)\n  // that data changes.\n  activity = report.activityTimer(`createPagesStatefully`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  await apiRunnerNode(`createPagesStatefully`, {\n    graphql: graphqlRunner,\n    traceId: `initial-createPagesStatefully`,\n    waitForCascadingActions: true,\n    parentSpan: activity.span,\n  })\n  activity.end()\n\n  activity = report.activityTimer(`onPreExtractQueries`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  await apiRunnerNode(`onPreExtractQueries`, { parentSpan: activity.span })\n  activity.end()\n\n  // Update Schema for SitePage.\n  activity = report.activityTimer(`update schema`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  await require(`../schema`).rebuildWithSitePage({ parentSpan: activity.span })\n  activity.end()\n\n  // Extract queries\n  activity = report.activityTimer(`extract queries from components`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  await extractQueries()\n  activity.end()\n\n  // Start the createPages hot reloader.\n  if (process.env.NODE_ENV !== `production`) {\n    require(`./page-hot-reloader`)(graphqlRunner)\n  }\n\n  // Run queries\n  activity = report.activityTimer(`run graphql queries`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  await runInitialQueries(activity)\n  activity.end()\n\n  require(`../redux/actions`).boundActionCreators.setProgramStatus(\n    `BOOTSTRAP_QUERY_RUNNING_FINISHED`\n  )\n\n  // Write out files.\n  activity = report.activityTimer(`write out page data`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  try {\n    await writePages()\n  } catch (err) {\n    report.panic(`Failed to write out page data`, err)\n  }\n  activity.end()\n\n  // Write out redirects.\n  activity = report.activityTimer(`write out redirect data`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  await writeRedirects()\n  activity.end()\n\n  let onEndJob\n\n  const checkJobsDone = _.debounce(async resolve => {\n    const state = store.getState()\n    if (state.jobs.active.length === 0) {\n      emitter.off(`END_JOB`, onEndJob)\n\n      await finishBootstrap(bootstrapSpan)\n      resolve({ graphqlRunner })\n    }\n  }, 100)\n\n  if (store.getState().jobs.active.length === 0) {\n    await finishBootstrap(bootstrapSpan)\n    return { graphqlRunner }\n  } else {\n    return new Promise(resolve => {\n      // Wait until all side effect jobs are finished.\n      onEndJob = () => checkJobsDone(resolve)\n      emitter.on(`END_JOB`, onEndJob)\n    })\n  }\n}\n\nconst finishBootstrap = async bootstrapSpan => {\n  // onPostBootstrap\n  const activity = report.activityTimer(`onPostBootstrap`, {\n    parentSpan: bootstrapSpan,\n  })\n  activity.start()\n  await apiRunnerNode(`onPostBootstrap`, { parentSpan: activity.span })\n  activity.end()\n\n  report.log(``)\n  report.info(`bootstrap finished - ${process.uptime()} s`)\n  report.log(``)\n  emitter.emit(`BOOTSTRAP_FINISHED`)\n  require(`../redux/actions`).boundActionCreators.setProgramStatus(\n    `BOOTSTRAP_FINISHED`\n  )\n\n  bootstrapSpan.finish()\n}\n"],"file":"index.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/bootstrap/load-plugins/index.js b/node_modules/gatsby/dist/bootstrap/load-plugins/index.js
index f21a627..dd9262f 100644
--- a/node_modules/gatsby/dist/bootstrap/load-plugins/index.js
+++ b/node_modules/gatsby/dist/bootstrap/load-plugins/index.js
@@ -1,13 +1,10 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const _ = require(`lodash`);
 
-const _require = require(`../../redux`),
-      store = _require.store;
+const {
+  store
+} = require(`../../redux`);
 
 const nodeAPIs = require(`../../utils/api-node-docs`);
 
@@ -17,10 +14,11 @@ const ssrAPIs = require(`../../../cache-dir/api-ssr-docs`);
 
 const loadPlugins = require(`./load`);
 
-const _require2 = require(`./validate`),
-      collatePluginAPIs = _require2.collatePluginAPIs,
-      handleBadExports = _require2.handleBadExports,
-      handleMultipleReplaceRenderers = _require2.handleMultipleReplaceRenderers;
+const {
+  collatePluginAPIs,
+  handleBadExports,
+  handleMultipleReplaceRenderers
+} = require(`./validate`);
 
 const apis = {
   node: _.keys(nodeAPIs),
@@ -48,52 +46,33 @@ const flattenPlugins = plugins => {
   return flattened;
 };
 
-module.exports =
-/*#__PURE__*/
-function () {
-  var _ref = (0, _asyncToGenerator2.default)(function* (config = {}, rootDir = null) {
-    // Collate internal plugins, site config plugins, site default plugins
-    const plugins = loadPlugins(config, rootDir); // Create a flattened array of the plugins
+module.exports = async (config = {}, rootDir = null) => {
+  // Collate internal plugins, site config plugins, site default plugins
+  const plugins = loadPlugins(config, rootDir); // Create a flattened array of the plugins
 
-    let flattenedPlugins = flattenPlugins(plugins); // Work out which plugins use which APIs, including those which are not
-    // valid Gatsby APIs, aka 'badExports'
+  let flattenedPlugins = flattenPlugins(plugins); // Work out which plugins use which APIs, including those which are not
+  // valid Gatsby APIs, aka 'badExports'
 
-    const x = collatePluginAPIs({
-      apis,
-      flattenedPlugins
-    });
-    flattenedPlugins = x.flattenedPlugins;
-    const apiToPlugins = x.apiToPlugins;
-    const badExports = x.badExports; // Show errors for any non-Gatsby APIs exported from plugins
-
-    handleBadExports({
-      apis,
-      badExports
-    }); // Show errors when ReplaceRenderer has been implemented multiple times
-
-    flattenedPlugins = handleMultipleReplaceRenderers({
-      apiToPlugins,
-      flattenedPlugins
-    }); // If we get this far, everything looks good. Update the store
-
-    store.dispatch({
-      type: `SET_SITE_FLATTENED_PLUGINS`,
-      payload: flattenedPlugins
-    });
-    store.dispatch({
-      type: `SET_SITE_API_TO_PLUGINS`,
-      payload: apiToPlugins
-    }); // TODO: Is this used? plugins and flattenedPlugins may be out of sync
-
-    store.dispatch({
-      type: `SET_SITE_PLUGINS`,
-      payload: plugins
-    });
-    return flattenedPlugins;
+  const x = collatePluginAPIs({
+    apis,
+    flattenedPlugins
   });
+  flattenedPlugins = x.flattenedPlugins;
+  const badExports = x.badExports; // Show errors for any non-Gatsby APIs exported from plugins
 
-  return function () {
-    return _ref.apply(this, arguments);
-  };
-}();
+  handleBadExports({
+    apis,
+    badExports
+  }); // Show errors when ReplaceRenderer has been implemented multiple times
+
+  flattenedPlugins = handleMultipleReplaceRenderers({
+    flattenedPlugins
+  }); // If we get this far, everything looks good. Update the store
+
+  store.dispatch({
+    type: `SET_SITE_FLATTENED_PLUGINS`,
+    payload: flattenedPlugins
+  });
+  return flattenedPlugins;
+};
 //# sourceMappingURL=index.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/bootstrap/load-plugins/index.js.map b/node_modules/gatsby/dist/bootstrap/load-plugins/index.js.map
index 9a44234..a5f212d 100644
--- a/node_modules/gatsby/dist/bootstrap/load-plugins/index.js.map
+++ b/node_modules/gatsby/dist/bootstrap/load-plugins/index.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/bootstrap/load-plugins/index.js"],"names":["_","require","store","nodeAPIs","browserAPIs","ssrAPIs","loadPlugins","collatePluginAPIs","handleBadExports","handleMultipleReplaceRenderers","apis","node","keys","browser","ssr","flattenPlugins","plugins","flattened","extractPlugins","plugin","pluginOptions","forEach","subPlugin","push","module","exports","config","rootDir","flattenedPlugins","x","apiToPlugins","badExports","dispatch","type","payload"],"mappings":";;;;;;AAAA,MAAMA,CAAC,GAAGC,OAAO,CAAE,QAAF,CAAjB;;iBAEkBA,OAAO,CAAE,aAAF,C;MAAjBC,K,YAAAA,K;;AACR,MAAMC,QAAQ,GAAGF,OAAO,CAAE,2BAAF,CAAxB;;AACA,MAAMG,WAAW,GAAGH,OAAO,CAAE,8BAAF,CAA3B;;AACA,MAAMI,OAAO,GAAGJ,OAAO,CAAE,iCAAF,CAAvB;;AACA,MAAMK,WAAW,GAAGL,OAAO,CAAE,QAAF,CAA3B;;kBAKIA,OAAO,CAAE,YAAF,C;MAHTM,iB,aAAAA,iB;MACAC,gB,aAAAA,gB;MACAC,8B,aAAAA,8B;;AAGF,MAAMC,IAAI,GAAG;AACXC,EAAAA,IAAI,EAAEX,CAAC,CAACY,IAAF,CAAOT,QAAP,CADK;AAEXU,EAAAA,OAAO,EAAEb,CAAC,CAACY,IAAF,CAAOR,WAAP,CAFE;AAGXU,EAAAA,GAAG,EAAEd,CAAC,CAACY,IAAF,CAAOP,OAAP,CAHM,CAMb;AACA;AACA;;AARa,CAAb;;AASA,MAAMU,cAAc,GAAGC,OAAO,IAAI;AAChC,QAAMC,SAAS,GAAG,EAAlB;;AACA,QAAMC,cAAc,GAAGC,MAAM,IAAI;AAC/BA,IAAAA,MAAM,CAACC,aAAP,CAAqBJ,OAArB,CAA6BK,OAA7B,CAAqCC,SAAS,IAAI;AAChDL,MAAAA,SAAS,CAACM,IAAV,CAAeD,SAAf;AACAJ,MAAAA,cAAc,CAACI,SAAD,CAAd;AACD,KAHD;AAID,GALD;;AAOAN,EAAAA,OAAO,CAACK,OAAR,CAAgBF,MAAM,IAAI;AACxBF,IAAAA,SAAS,CAACM,IAAV,CAAeJ,MAAf;AACAD,IAAAA,cAAc,CAACC,MAAD,CAAd;AACD,GAHD;AAKA,SAAOF,SAAP;AACD,CAfD;;AAiBAO,MAAM,CAACC,OAAP;AAAA;AAAA;AAAA,6CAAiB,WAAOC,MAAM,GAAG,EAAhB,EAAoBC,OAAO,GAAG,IAA9B,EAAuC;AACtD;AACA,UAAMX,OAAO,GAAGV,WAAW,CAACoB,MAAD,EAASC,OAAT,CAA3B,CAFsD,CAItD;;AACA,QAAIC,gBAAgB,GAAGb,cAAc,CAACC,OAAD,CAArC,CALsD,CAOtD;AACA;;AACA,UAAMa,CAAC,GAAGtB,iBAAiB,CAAC;AAAEG,MAAAA,IAAF;AAAQkB,MAAAA;AAAR,KAAD,CAA3B;AACAA,IAAAA,gBAAgB,GAAGC,CAAC,CAACD,gBAArB;AACA,UAAME,YAAY,GAAGD,CAAC,CAACC,YAAvB;AACA,UAAMC,UAAU,GAAGF,CAAC,CAACE,UAArB,CAZsD,CActD;;AACAvB,IAAAA,gBAAgB,CAAC;AAAEE,MAAAA,IAAF;AAAQqB,MAAAA;AAAR,KAAD,CAAhB,CAfsD,CAiBtD;;AACAH,IAAAA,gBAAgB,GAAGnB,8BAA8B,CAAC;AAChDqB,MAAAA,YADgD;AAEhDF,MAAAA;AAFgD,KAAD,CAAjD,CAlBsD,CAuBtD;;AACA1B,IAAAA,KAAK,CAAC8B,QAAN,CAAe;AACbC,MAAAA,IAAI,EAAG,4BADM;AAEbC,MAAAA,OAAO,EAAEN;AAFI,KAAf;AAKA1B,IAAAA,KAAK,CAAC8B,QAAN,CAAe;AACbC,MAAAA,IAAI,EAAG,yBADM;AAEbC,MAAAA,OAAO,EAAEJ;AAFI,KAAf,EA7BsD,CAkCtD;;AACA5B,IAAAA,KAAK,CAAC8B,QAAN,CAAe;AACbC,MAAAA,IAAI,EAAG,kBADM;AAEbC,MAAAA,OAAO,EAAElB;AAFI,KAAf;AAKA,WAAOY,gBAAP;AACD,GAzCD;;AAAA;AAAA;AAAA;AAAA","sourcesContent":["const _ = require(`lodash`)\n\nconst { store } = require(`../../redux`)\nconst nodeAPIs = require(`../../utils/api-node-docs`)\nconst browserAPIs = require(`../../utils/api-browser-docs`)\nconst ssrAPIs = require(`../../../cache-dir/api-ssr-docs`)\nconst loadPlugins = require(`./load`)\nconst {\n  collatePluginAPIs,\n  handleBadExports,\n  handleMultipleReplaceRenderers,\n} = require(`./validate`)\n\nconst apis = {\n  node: _.keys(nodeAPIs),\n  browser: _.keys(browserAPIs),\n  ssr: _.keys(ssrAPIs),\n}\n\n// Create a \"flattened\" array of plugins with all subplugins\n// brought to the top-level. This simplifies running gatsby-* files\n// for subplugins.\nconst flattenPlugins = plugins => {\n  const flattened = []\n  const extractPlugins = plugin => {\n    plugin.pluginOptions.plugins.forEach(subPlugin => {\n      flattened.push(subPlugin)\n      extractPlugins(subPlugin)\n    })\n  }\n\n  plugins.forEach(plugin => {\n    flattened.push(plugin)\n    extractPlugins(plugin)\n  })\n\n  return flattened\n}\n\nmodule.exports = async (config = {}, rootDir = null) => {\n  // Collate internal plugins, site config plugins, site default plugins\n  const plugins = loadPlugins(config, rootDir)\n\n  // Create a flattened array of the plugins\n  let flattenedPlugins = flattenPlugins(plugins)\n\n  // Work out which plugins use which APIs, including those which are not\n  // valid Gatsby APIs, aka 'badExports'\n  const x = collatePluginAPIs({ apis, flattenedPlugins })\n  flattenedPlugins = x.flattenedPlugins\n  const apiToPlugins = x.apiToPlugins\n  const badExports = x.badExports\n\n  // Show errors for any non-Gatsby APIs exported from plugins\n  handleBadExports({ apis, badExports })\n\n  // Show errors when ReplaceRenderer has been implemented multiple times\n  flattenedPlugins = handleMultipleReplaceRenderers({\n    apiToPlugins,\n    flattenedPlugins,\n  })\n\n  // If we get this far, everything looks good. Update the store\n  store.dispatch({\n    type: `SET_SITE_FLATTENED_PLUGINS`,\n    payload: flattenedPlugins,\n  })\n\n  store.dispatch({\n    type: `SET_SITE_API_TO_PLUGINS`,\n    payload: apiToPlugins,\n  })\n\n  // TODO: Is this used? plugins and flattenedPlugins may be out of sync\n  store.dispatch({\n    type: `SET_SITE_PLUGINS`,\n    payload: plugins,\n  })\n\n  return flattenedPlugins\n}\n"],"file":"index.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/bootstrap/load-plugins/index.js"],"names":["_","require","store","nodeAPIs","browserAPIs","ssrAPIs","loadPlugins","collatePluginAPIs","handleBadExports","handleMultipleReplaceRenderers","apis","node","keys","browser","ssr","flattenPlugins","plugins","flattened","extractPlugins","plugin","pluginOptions","forEach","subPlugin","push","module","exports","config","rootDir","flattenedPlugins","x","badExports","dispatch","type","payload"],"mappings":";;AAAA,MAAMA,CAAC,GAAGC,OAAO,CAAE,QAAF,CAAjB;;AAEA,MAAM;AAAEC,EAAAA;AAAF,IAAYD,OAAO,CAAE,aAAF,CAAzB;;AACA,MAAME,QAAQ,GAAGF,OAAO,CAAE,2BAAF,CAAxB;;AACA,MAAMG,WAAW,GAAGH,OAAO,CAAE,8BAAF,CAA3B;;AACA,MAAMI,OAAO,GAAGJ,OAAO,CAAE,iCAAF,CAAvB;;AACA,MAAMK,WAAW,GAAGL,OAAO,CAAE,QAAF,CAA3B;;AACA,MAAM;AACJM,EAAAA,iBADI;AAEJC,EAAAA,gBAFI;AAGJC,EAAAA;AAHI,IAIFR,OAAO,CAAE,YAAF,CAJX;;AAMA,MAAMS,IAAI,GAAG;AACXC,EAAAA,IAAI,EAAEX,CAAC,CAACY,IAAF,CAAOT,QAAP,CADK;AAEXU,EAAAA,OAAO,EAAEb,CAAC,CAACY,IAAF,CAAOR,WAAP,CAFE;AAGXU,EAAAA,GAAG,EAAEd,CAAC,CAACY,IAAF,CAAOP,OAAP,CAHM,CAMb;AACA;AACA;;AARa,CAAb;;AASA,MAAMU,cAAc,GAAGC,OAAO,IAAI;AAChC,QAAMC,SAAS,GAAG,EAAlB;;AACA,QAAMC,cAAc,GAAGC,MAAM,IAAI;AAC/BA,IAAAA,MAAM,CAACC,aAAP,CAAqBJ,OAArB,CAA6BK,OAA7B,CAAqCC,SAAS,IAAI;AAChDL,MAAAA,SAAS,CAACM,IAAV,CAAeD,SAAf;AACAJ,MAAAA,cAAc,CAACI,SAAD,CAAd;AACD,KAHD;AAID,GALD;;AAOAN,EAAAA,OAAO,CAACK,OAAR,CAAgBF,MAAM,IAAI;AACxBF,IAAAA,SAAS,CAACM,IAAV,CAAeJ,MAAf;AACAD,IAAAA,cAAc,CAACC,MAAD,CAAd;AACD,GAHD;AAKA,SAAOF,SAAP;AACD,CAfD;;AAiBAO,MAAM,CAACC,OAAP,GAAiB,OAAOC,MAAM,GAAG,EAAhB,EAAoBC,OAAO,GAAG,IAA9B,KAAuC;AACtD;AACA,QAAMX,OAAO,GAAGV,WAAW,CAACoB,MAAD,EAASC,OAAT,CAA3B,CAFsD,CAItD;;AACA,MAAIC,gBAAgB,GAAGb,cAAc,CAACC,OAAD,CAArC,CALsD,CAOtD;AACA;;AACA,QAAMa,CAAC,GAAGtB,iBAAiB,CAAC;AAAEG,IAAAA,IAAF;AAAQkB,IAAAA;AAAR,GAAD,CAA3B;AACAA,EAAAA,gBAAgB,GAAGC,CAAC,CAACD,gBAArB;AACA,QAAME,UAAU,GAAGD,CAAC,CAACC,UAArB,CAXsD,CAatD;;AACAtB,EAAAA,gBAAgB,CAAC;AAAEE,IAAAA,IAAF;AAAQoB,IAAAA;AAAR,GAAD,CAAhB,CAdsD,CAgBtD;;AACAF,EAAAA,gBAAgB,GAAGnB,8BAA8B,CAAC;AAChDmB,IAAAA;AADgD,GAAD,CAAjD,CAjBsD,CAqBtD;;AACA1B,EAAAA,KAAK,CAAC6B,QAAN,CAAe;AACbC,IAAAA,IAAI,EAAG,4BADM;AAEbC,IAAAA,OAAO,EAAEL;AAFI,GAAf;AAKA,SAAOA,gBAAP;AACD,CA5BD","sourcesContent":["const _ = require(`lodash`)\n\nconst { store } = require(`../../redux`)\nconst nodeAPIs = require(`../../utils/api-node-docs`)\nconst browserAPIs = require(`../../utils/api-browser-docs`)\nconst ssrAPIs = require(`../../../cache-dir/api-ssr-docs`)\nconst loadPlugins = require(`./load`)\nconst {\n  collatePluginAPIs,\n  handleBadExports,\n  handleMultipleReplaceRenderers,\n} = require(`./validate`)\n\nconst apis = {\n  node: _.keys(nodeAPIs),\n  browser: _.keys(browserAPIs),\n  ssr: _.keys(ssrAPIs),\n}\n\n// Create a \"flattened\" array of plugins with all subplugins\n// brought to the top-level. This simplifies running gatsby-* files\n// for subplugins.\nconst flattenPlugins = plugins => {\n  const flattened = []\n  const extractPlugins = plugin => {\n    plugin.pluginOptions.plugins.forEach(subPlugin => {\n      flattened.push(subPlugin)\n      extractPlugins(subPlugin)\n    })\n  }\n\n  plugins.forEach(plugin => {\n    flattened.push(plugin)\n    extractPlugins(plugin)\n  })\n\n  return flattened\n}\n\nmodule.exports = async (config = {}, rootDir = null) => {\n  // Collate internal plugins, site config plugins, site default plugins\n  const plugins = loadPlugins(config, rootDir)\n\n  // Create a flattened array of the plugins\n  let flattenedPlugins = flattenPlugins(plugins)\n\n  // Work out which plugins use which APIs, including those which are not\n  // valid Gatsby APIs, aka 'badExports'\n  const x = collatePluginAPIs({ apis, flattenedPlugins })\n  flattenedPlugins = x.flattenedPlugins\n  const badExports = x.badExports\n\n  // Show errors for any non-Gatsby APIs exported from plugins\n  handleBadExports({ apis, badExports })\n\n  // Show errors when ReplaceRenderer has been implemented multiple times\n  flattenedPlugins = handleMultipleReplaceRenderers({\n    flattenedPlugins,\n  })\n\n  // If we get this far, everything looks good. Update the store\n  store.dispatch({\n    type: `SET_SITE_FLATTENED_PLUGINS`,\n    payload: flattenedPlugins,\n  })\n\n  return flattenedPlugins\n}\n"],"file":"index.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/bootstrap/load-plugins/load.js b/node_modules/gatsby/dist/bootstrap/load-plugins/load.js
index e420686..61558fb 100644
--- a/node_modules/gatsby/dist/bootstrap/load-plugins/load.js
+++ b/node_modules/gatsby/dist/bootstrap/load-plugins/load.js
@@ -12,11 +12,13 @@ const crypto = require(`crypto`);
 
 const glob = require(`glob`);
 
-const _require = require(`./validate`),
-      warnOnIncompatiblePeerDependency = _require.warnOnIncompatiblePeerDependency;
+const {
+  warnOnIncompatiblePeerDependency
+} = require(`./validate`);
 
-const _require2 = require(`../../redux`),
-      store = _require2.store;
+const {
+  store
+} = require(`../../redux`);
 
 const existsSync = require(`fs-exists-cached`).sync;
 
@@ -117,11 +119,11 @@ module.exports = (config = {}, rootDir = null) => {
   const processPlugin = plugin => {
     if (_.isString(plugin)) {
       const info = resolvePlugin(plugin, rootDir);
-      return Object.assign({}, info, {
+      return { ...info,
         pluginOptions: {
           plugins: []
         }
-      });
+      };
     } else {
       plugin.options = plugin.options || {}; // Plugins can have plugins.
 
@@ -148,17 +150,17 @@ module.exports = (config = {}, rootDir = null) => {
       }
 
       const info = resolvePlugin(plugin.resolve, rootDir);
-      return Object.assign({}, info, {
+      return { ...info,
         id: createPluginId(info.name, plugin),
         pluginOptions: _.merge({
           plugins: []
         }, plugin.options)
-      });
+      };
     }
   }; // Add internal plugins
 
 
-  const internalPlugins = [`../../internal-plugins/dev-404-page`, `../../internal-plugins/load-babel-config`, `../../internal-plugins/internal-data-bridge`, `../../internal-plugins/prod-404`, `../../internal-plugins/query-runner`, `../../internal-plugins/webpack-theme-component-shadowing`];
+  const internalPlugins = [`../../internal-plugins/dev-404-page`, `../../internal-plugins/load-babel-config`, `../../internal-plugins/internal-data-bridge`, `../../internal-plugins/prod-404`, `../../internal-plugins/webpack-theme-component-shadowing`];
   internalPlugins.forEach(relPath => {
     const absPath = path.join(__dirname, relPath);
     plugins.push(processPlugin(absPath));
diff --git a/node_modules/gatsby/dist/bootstrap/load-plugins/load.js.map b/node_modules/gatsby/dist/bootstrap/load-plugins/load.js.map
index 7745f9c..698fa6d 100644
--- a/node_modules/gatsby/dist/bootstrap/load-plugins/load.js.map
+++ b/node_modules/gatsby/dist/bootstrap/load-plugins/load.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/bootstrap/load-plugins/load.js"],"names":["_","require","slash","fs","path","crypto","glob","warnOnIncompatiblePeerDependency","store","existsSync","sync","createNodeId","createRequireFromPath","createFileContentHash","root","globPattern","hash","createHash","files","nodir","forEach","filepath","update","readFileSync","digest","createPluginId","name","pluginObject","JSON","stringify","options","resolvePlugin","pluginName","rootDir","resolvedPath","resolve","packageJSON","parse","id","version","Error","requireSource","dirname","err","module","exports","config","plugins","processPlugin","plugin","isString","info","pluginOptions","subplugins","p","push","merge","internalPlugins","relPath","absPath","join","__dirname","process","cwd","program","getState","directory","pathCheck"],"mappings":"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","sourcesContent":["const _ = require(`lodash`)\nconst slash = require(`slash`)\nconst fs = require(`fs`)\nconst path = require(`path`)\nconst crypto = require(`crypto`)\nconst glob = require(`glob`)\nconst { warnOnIncompatiblePeerDependency } = require(`./validate`)\nconst { store } = require(`../../redux`)\nconst existsSync = require(`fs-exists-cached`).sync\nconst createNodeId = require(`../../utils/create-node-id`)\nconst createRequireFromPath = require(`../../utils/create-require-from-path`)\n\nfunction createFileContentHash(root, globPattern) {\n  const hash = crypto.createHash(`md5`)\n  const files = glob.sync(`${root}/${globPattern}`, { nodir: true })\n\n  files.forEach(filepath => {\n    hash.update(fs.readFileSync(filepath))\n  })\n\n  return hash.digest(`hex`)\n}\n\n/**\n * Make sure key is unique to plugin options. E.g there could\n * be multiple source-filesystem plugins, with different names\n * (docs, blogs).\n * @param {*} name Name of the plugin\n * @param {*} pluginObject\n */\nconst createPluginId = (name, pluginObject = null) =>\n  createNodeId(\n    name + (pluginObject ? JSON.stringify(pluginObject.options) : ``),\n    `Plugin`\n  )\n\n/**\n * @typedef {Object} PluginInfo\n * @property {string} resolve The absolute path to the plugin\n * @property {string} name The plugin name\n * @property {string} version The plugin version (can be content hash)\n */\n\n/**\n * resolvePlugin\n * @param {string} pluginName\n * This can be a name of a local plugin, the name of a plugin located in\n * node_modules, or a Gatsby internal plugin. In the last case the pluginName\n * will be an absolute path.\n * @param {string} rootDir\n * This is the project location, from which are found the plugins\n * @return {PluginInfo}\n */\nfunction resolvePlugin(pluginName, rootDir) {\n  // Only find plugins when we're not given an absolute path\n  if (!existsSync(pluginName)) {\n    // Find the plugin in the local plugins folder\n    const resolvedPath = slash(path.resolve(`./plugins/${pluginName}`))\n\n    if (existsSync(resolvedPath)) {\n      if (existsSync(`${resolvedPath}/package.json`)) {\n        const packageJSON = JSON.parse(\n          fs.readFileSync(`${resolvedPath}/package.json`, `utf-8`)\n        )\n        const name = packageJSON.name || pluginName\n        warnOnIncompatiblePeerDependency(name, packageJSON)\n\n        return {\n          resolve: resolvedPath,\n          name,\n          id: createPluginId(name),\n          version:\n            packageJSON.version || createFileContentHash(resolvedPath, `**`),\n        }\n      } else {\n        // Make package.json a requirement for local plugins too\n        throw new Error(`Plugin ${pluginName} requires a package.json file`)\n      }\n    }\n  }\n\n  /**\n   * Here we have an absolute path to an internal plugin, or a name of a module\n   * which should be located in node_modules.\n   */\n  try {\n    const requireSource =\n      rootDir !== null\n        ? createRequireFromPath(`${rootDir}/:internal:`)\n        : require\n    const resolvedPath = slash(path.dirname(requireSource.resolve(pluginName)))\n\n    const packageJSON = JSON.parse(\n      fs.readFileSync(`${resolvedPath}/package.json`, `utf-8`)\n    )\n    warnOnIncompatiblePeerDependency(packageJSON.name, packageJSON)\n\n    return {\n      resolve: resolvedPath,\n      id: createPluginId(packageJSON.name),\n      name: packageJSON.name,\n      version: packageJSON.version,\n    }\n  } catch (err) {\n    throw new Error(\n      `Unable to find plugin \"${pluginName}\". Perhaps you need to install its package?`\n    )\n  }\n}\n\nmodule.exports = (config = {}, rootDir = null) => {\n  // Instantiate plugins.\n  const plugins = []\n\n  // Create fake little site with a plugin for testing this\n  // w/ snapshots. Move plugin processing to its own module.\n  // Also test adding to redux store.\n  const processPlugin = plugin => {\n    if (_.isString(plugin)) {\n      const info = resolvePlugin(plugin, rootDir)\n\n      return {\n        ...info,\n        pluginOptions: {\n          plugins: [],\n        },\n      }\n    } else {\n      plugin.options = plugin.options || {}\n\n      // Plugins can have plugins.\n      const subplugins = []\n      if (plugin.options.plugins) {\n        plugin.options.plugins.forEach(p => {\n          subplugins.push(processPlugin(p))\n        })\n\n        plugin.options.plugins = subplugins\n      }\n\n      // Add some default values for tests as we don't actually\n      // want to try to load anything during tests.\n      if (plugin.resolve === `___TEST___`) {\n        const name = `TEST`\n\n        return {\n          id: createPluginId(name, plugin),\n          name,\n          pluginOptions: {\n            plugins: [],\n          },\n        }\n      }\n\n      const info = resolvePlugin(plugin.resolve, rootDir)\n\n      return {\n        ...info,\n        id: createPluginId(info.name, plugin),\n        pluginOptions: _.merge({ plugins: [] }, plugin.options),\n      }\n    }\n  }\n\n  // Add internal plugins\n  const internalPlugins = [\n    `../../internal-plugins/dev-404-page`,\n    `../../internal-plugins/load-babel-config`,\n    `../../internal-plugins/internal-data-bridge`,\n    `../../internal-plugins/prod-404`,\n    `../../internal-plugins/query-runner`,\n    `../../internal-plugins/webpack-theme-component-shadowing`,\n  ]\n  internalPlugins.forEach(relPath => {\n    const absPath = path.join(__dirname, relPath)\n    plugins.push(processPlugin(absPath))\n  })\n\n  // Add plugins from the site config.\n  if (config.plugins) {\n    config.plugins.forEach(plugin => {\n      plugins.push(processPlugin(plugin))\n    })\n  }\n\n  // Add the site's default \"plugin\" i.e. gatsby-x files in root of site.\n  plugins.push({\n    resolve: slash(process.cwd()),\n    id: createPluginId(`default-site-plugin`),\n    name: `default-site-plugin`,\n    version: createFileContentHash(process.cwd(), `gatsby-*`),\n    pluginOptions: {\n      plugins: [],\n    },\n  })\n\n  const program = store.getState().program\n  plugins.push(\n    processPlugin({\n      resolve: require.resolve(`gatsby-plugin-page-creator`),\n      options: {\n        path: slash(path.join(program.directory, `src/pages`)),\n        pathCheck: false,\n      },\n    })\n  )\n\n  return plugins\n}\n"],"file":"load.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/bootstrap/load-plugins/load.js"],"names":["_","require","slash","fs","path","crypto","glob","warnOnIncompatiblePeerDependency","store","existsSync","sync","createNodeId","createRequireFromPath","createFileContentHash","root","globPattern","hash","createHash","files","nodir","forEach","filepath","update","readFileSync","digest","createPluginId","name","pluginObject","JSON","stringify","options","resolvePlugin","pluginName","rootDir","resolvedPath","resolve","packageJSON","parse","id","version","Error","requireSource","dirname","err","module","exports","config","plugins","processPlugin","plugin","isString","info","pluginOptions","subplugins","p","push","merge","internalPlugins","relPath","absPath","join","__dirname","process","cwd","program","getState","directory","pathCheck"],"mappings":";;AAAA,MAAMA,CAAC,GAAGC,OAAO,CAAE,QAAF,CAAjB;;AACA,MAAMC,KAAK,GAAGD,OAAO,CAAE,OAAF,CAArB;;AACA,MAAME,EAAE,GAAGF,OAAO,CAAE,IAAF,CAAlB;;AACA,MAAMG,IAAI,GAAGH,OAAO,CAAE,MAAF,CAApB;;AACA,MAAMI,MAAM,GAAGJ,OAAO,CAAE,QAAF,CAAtB;;AACA,MAAMK,IAAI,GAAGL,OAAO,CAAE,MAAF,CAApB;;AACA,MAAM;AAAEM,EAAAA;AAAF,IAAuCN,OAAO,CAAE,YAAF,CAApD;;AACA,MAAM;AAAEO,EAAAA;AAAF,IAAYP,OAAO,CAAE,aAAF,CAAzB;;AACA,MAAMQ,UAAU,GAAGR,OAAO,CAAE,kBAAF,CAAP,CAA4BS,IAA/C;;AACA,MAAMC,YAAY,GAAGV,OAAO,CAAE,4BAAF,CAA5B;;AACA,MAAMW,qBAAqB,GAAGX,OAAO,CAAE,sCAAF,CAArC;;AAEA,SAASY,qBAAT,CAA+BC,IAA/B,EAAqCC,WAArC,EAAkD;AAChD,QAAMC,IAAI,GAAGX,MAAM,CAACY,UAAP,CAAmB,KAAnB,CAAb;AACA,QAAMC,KAAK,GAAGZ,IAAI,CAACI,IAAL,CAAW,GAAEI,IAAK,IAAGC,WAAY,EAAjC,EAAoC;AAAEI,IAAAA,KAAK,EAAE;AAAT,GAApC,CAAd;AAEAD,EAAAA,KAAK,CAACE,OAAN,CAAcC,QAAQ,IAAI;AACxBL,IAAAA,IAAI,CAACM,MAAL,CAAYnB,EAAE,CAACoB,YAAH,CAAgBF,QAAhB,CAAZ;AACD,GAFD;AAIA,SAAOL,IAAI,CAACQ,MAAL,CAAa,KAAb,CAAP;AACD;AAED;;;;;;;;;AAOA,MAAMC,cAAc,GAAG,CAACC,IAAD,EAAOC,YAAY,GAAG,IAAtB,KACrBhB,YAAY,CACVe,IAAI,IAAIC,YAAY,GAAGC,IAAI,CAACC,SAAL,CAAeF,YAAY,CAACG,OAA5B,CAAH,GAA2C,EAA3D,CADM,EAET,QAFS,CADd;AAMA;;;;;;;AAOA;;;;;;;;;;;;AAUA,SAASC,aAAT,CAAuBC,UAAvB,EAAmCC,OAAnC,EAA4C;AAC1C;AACA,MAAI,CAACxB,UAAU,CAACuB,UAAD,CAAf,EAA6B;AAC3B;AACA,UAAME,YAAY,GAAGhC,KAAK,CAACE,IAAI,CAAC+B,OAAL,CAAc,aAAYH,UAAW,EAArC,CAAD,CAA1B;;AAEA,QAAIvB,UAAU,CAACyB,YAAD,CAAd,EAA8B;AAC5B,UAAIzB,UAAU,CAAE,GAAEyB,YAAa,eAAjB,CAAd,EAAgD;AAC9C,cAAME,WAAW,GAAGR,IAAI,CAACS,KAAL,CAClBlC,EAAE,CAACoB,YAAH,CAAiB,GAAEW,YAAa,eAAhC,EAAiD,OAAjD,CADkB,CAApB;AAGA,cAAMR,IAAI,GAAGU,WAAW,CAACV,IAAZ,IAAoBM,UAAjC;AACAzB,QAAAA,gCAAgC,CAACmB,IAAD,EAAOU,WAAP,CAAhC;AAEA,eAAO;AACLD,UAAAA,OAAO,EAAED,YADJ;AAELR,UAAAA,IAFK;AAGLY,UAAAA,EAAE,EAAEb,cAAc,CAACC,IAAD,CAHb;AAILa,UAAAA,OAAO,EACLH,WAAW,CAACG,OAAZ,IAAuB1B,qBAAqB,CAACqB,YAAD,EAAgB,IAAhB;AALzC,SAAP;AAOD,OAdD,MAcO;AACL;AACA,cAAM,IAAIM,KAAJ,CAAW,UAASR,UAAW,+BAA/B,CAAN;AACD;AACF;AACF;AAED;;;;;;AAIA,MAAI;AACF,UAAMS,aAAa,GACjBR,OAAO,KAAK,IAAZ,GACIrB,qBAAqB,CAAE,GAAEqB,OAAQ,aAAZ,CADzB,GAEIhC,OAHN;AAIA,UAAMiC,YAAY,GAAGhC,KAAK,CAACE,IAAI,CAACsC,OAAL,CAAaD,aAAa,CAACN,OAAd,CAAsBH,UAAtB,CAAb,CAAD,CAA1B;AAEA,UAAMI,WAAW,GAAGR,IAAI,CAACS,KAAL,CAClBlC,EAAE,CAACoB,YAAH,CAAiB,GAAEW,YAAa,eAAhC,EAAiD,OAAjD,CADkB,CAApB;AAGA3B,IAAAA,gCAAgC,CAAC6B,WAAW,CAACV,IAAb,EAAmBU,WAAnB,CAAhC;AAEA,WAAO;AACLD,MAAAA,OAAO,EAAED,YADJ;AAELI,MAAAA,EAAE,EAAEb,cAAc,CAACW,WAAW,CAACV,IAAb,CAFb;AAGLA,MAAAA,IAAI,EAAEU,WAAW,CAACV,IAHb;AAILa,MAAAA,OAAO,EAAEH,WAAW,CAACG;AAJhB,KAAP;AAMD,GAlBD,CAkBE,OAAOI,GAAP,EAAY;AACZ,UAAM,IAAIH,KAAJ,CACH,0BAAyBR,UAAW,6CADjC,CAAN;AAGD;AACF;;AAEDY,MAAM,CAACC,OAAP,GAAiB,CAACC,MAAM,GAAG,EAAV,EAAcb,OAAO,GAAG,IAAxB,KAAiC;AAChD;AACA,QAAMc,OAAO,GAAG,EAAhB,CAFgD,CAIhD;AACA;AACA;;AACA,QAAMC,aAAa,GAAGC,MAAM,IAAI;AAC9B,QAAIjD,CAAC,CAACkD,QAAF,CAAWD,MAAX,CAAJ,EAAwB;AACtB,YAAME,IAAI,GAAGpB,aAAa,CAACkB,MAAD,EAAShB,OAAT,CAA1B;AAEA,aAAO,EACL,GAAGkB,IADE;AAELC,QAAAA,aAAa,EAAE;AACbL,UAAAA,OAAO,EAAE;AADI;AAFV,OAAP;AAMD,KATD,MASO;AACLE,MAAAA,MAAM,CAACnB,OAAP,GAAiBmB,MAAM,CAACnB,OAAP,IAAkB,EAAnC,CADK,CAGL;;AACA,YAAMuB,UAAU,GAAG,EAAnB;;AACA,UAAIJ,MAAM,CAACnB,OAAP,CAAeiB,OAAnB,EAA4B;AAC1BE,QAAAA,MAAM,CAACnB,OAAP,CAAeiB,OAAf,CAAuB3B,OAAvB,CAA+BkC,CAAC,IAAI;AAClCD,UAAAA,UAAU,CAACE,IAAX,CAAgBP,aAAa,CAACM,CAAD,CAA7B;AACD,SAFD;AAIAL,QAAAA,MAAM,CAACnB,OAAP,CAAeiB,OAAf,GAAyBM,UAAzB;AACD,OAXI,CAaL;AACA;;;AACA,UAAIJ,MAAM,CAACd,OAAP,KAAoB,YAAxB,EAAqC;AACnC,cAAMT,IAAI,GAAI,MAAd;AAEA,eAAO;AACLY,UAAAA,EAAE,EAAEb,cAAc,CAACC,IAAD,EAAOuB,MAAP,CADb;AAELvB,UAAAA,IAFK;AAGL0B,UAAAA,aAAa,EAAE;AACbL,YAAAA,OAAO,EAAE;AADI;AAHV,SAAP;AAOD;;AAED,YAAMI,IAAI,GAAGpB,aAAa,CAACkB,MAAM,CAACd,OAAR,EAAiBF,OAAjB,CAA1B;AAEA,aAAO,EACL,GAAGkB,IADE;AAELb,QAAAA,EAAE,EAAEb,cAAc,CAAC0B,IAAI,CAACzB,IAAN,EAAYuB,MAAZ,CAFb;AAGLG,QAAAA,aAAa,EAAEpD,CAAC,CAACwD,KAAF,CAAQ;AAAET,UAAAA,OAAO,EAAE;AAAX,SAAR,EAAyBE,MAAM,CAACnB,OAAhC;AAHV,OAAP;AAKD;AACF,GA7CD,CAPgD,CAsDhD;;;AACA,QAAM2B,eAAe,GAAG,CACrB,qCADqB,EAErB,0CAFqB,EAGrB,6CAHqB,EAIrB,iCAJqB,EAKrB,0DALqB,CAAxB;AAOAA,EAAAA,eAAe,CAACrC,OAAhB,CAAwBsC,OAAO,IAAI;AACjC,UAAMC,OAAO,GAAGvD,IAAI,CAACwD,IAAL,CAAUC,SAAV,EAAqBH,OAArB,CAAhB;AACAX,IAAAA,OAAO,CAACQ,IAAR,CAAaP,aAAa,CAACW,OAAD,CAA1B;AACD,GAHD,EA9DgD,CAmEhD;;AACA,MAAIb,MAAM,CAACC,OAAX,EAAoB;AAClBD,IAAAA,MAAM,CAACC,OAAP,CAAe3B,OAAf,CAAuB6B,MAAM,IAAI;AAC/BF,MAAAA,OAAO,CAACQ,IAAR,CAAaP,aAAa,CAACC,MAAD,CAA1B;AACD,KAFD;AAGD,GAxE+C,CA0EhD;;;AACAF,EAAAA,OAAO,CAACQ,IAAR,CAAa;AACXpB,IAAAA,OAAO,EAAEjC,KAAK,CAAC4D,OAAO,CAACC,GAAR,EAAD,CADH;AAEXzB,IAAAA,EAAE,EAAEb,cAAc,CAAE,qBAAF,CAFP;AAGXC,IAAAA,IAAI,EAAG,qBAHI;AAIXa,IAAAA,OAAO,EAAE1B,qBAAqB,CAACiD,OAAO,CAACC,GAAR,EAAD,EAAiB,UAAjB,CAJnB;AAKXX,IAAAA,aAAa,EAAE;AACbL,MAAAA,OAAO,EAAE;AADI;AALJ,GAAb;AAUA,QAAMiB,OAAO,GAAGxD,KAAK,CAACyD,QAAN,GAAiBD,OAAjC;AACAjB,EAAAA,OAAO,CAACQ,IAAR,CACEP,aAAa,CAAC;AACZb,IAAAA,OAAO,EAAElC,OAAO,CAACkC,OAAR,CAAiB,4BAAjB,CADG;AAEZL,IAAAA,OAAO,EAAE;AACP1B,MAAAA,IAAI,EAAEF,KAAK,CAACE,IAAI,CAACwD,IAAL,CAAUI,OAAO,CAACE,SAAlB,EAA8B,WAA9B,CAAD,CADJ;AAEPC,MAAAA,SAAS,EAAE;AAFJ;AAFG,GAAD,CADf;AAUA,SAAOpB,OAAP;AACD,CAjGD","sourcesContent":["const _ = require(`lodash`)\nconst slash = require(`slash`)\nconst fs = require(`fs`)\nconst path = require(`path`)\nconst crypto = require(`crypto`)\nconst glob = require(`glob`)\nconst { warnOnIncompatiblePeerDependency } = require(`./validate`)\nconst { store } = require(`../../redux`)\nconst existsSync = require(`fs-exists-cached`).sync\nconst createNodeId = require(`../../utils/create-node-id`)\nconst createRequireFromPath = require(`../../utils/create-require-from-path`)\n\nfunction createFileContentHash(root, globPattern) {\n  const hash = crypto.createHash(`md5`)\n  const files = glob.sync(`${root}/${globPattern}`, { nodir: true })\n\n  files.forEach(filepath => {\n    hash.update(fs.readFileSync(filepath))\n  })\n\n  return hash.digest(`hex`)\n}\n\n/**\n * Make sure key is unique to plugin options. E.g there could\n * be multiple source-filesystem plugins, with different names\n * (docs, blogs).\n * @param {*} name Name of the plugin\n * @param {*} pluginObject\n */\nconst createPluginId = (name, pluginObject = null) =>\n  createNodeId(\n    name + (pluginObject ? JSON.stringify(pluginObject.options) : ``),\n    `Plugin`\n  )\n\n/**\n * @typedef {Object} PluginInfo\n * @property {string} resolve The absolute path to the plugin\n * @property {string} name The plugin name\n * @property {string} version The plugin version (can be content hash)\n */\n\n/**\n * resolvePlugin\n * @param {string} pluginName\n * This can be a name of a local plugin, the name of a plugin located in\n * node_modules, or a Gatsby internal plugin. In the last case the pluginName\n * will be an absolute path.\n * @param {string} rootDir\n * This is the project location, from which are found the plugins\n * @return {PluginInfo}\n */\nfunction resolvePlugin(pluginName, rootDir) {\n  // Only find plugins when we're not given an absolute path\n  if (!existsSync(pluginName)) {\n    // Find the plugin in the local plugins folder\n    const resolvedPath = slash(path.resolve(`./plugins/${pluginName}`))\n\n    if (existsSync(resolvedPath)) {\n      if (existsSync(`${resolvedPath}/package.json`)) {\n        const packageJSON = JSON.parse(\n          fs.readFileSync(`${resolvedPath}/package.json`, `utf-8`)\n        )\n        const name = packageJSON.name || pluginName\n        warnOnIncompatiblePeerDependency(name, packageJSON)\n\n        return {\n          resolve: resolvedPath,\n          name,\n          id: createPluginId(name),\n          version:\n            packageJSON.version || createFileContentHash(resolvedPath, `**`),\n        }\n      } else {\n        // Make package.json a requirement for local plugins too\n        throw new Error(`Plugin ${pluginName} requires a package.json file`)\n      }\n    }\n  }\n\n  /**\n   * Here we have an absolute path to an internal plugin, or a name of a module\n   * which should be located in node_modules.\n   */\n  try {\n    const requireSource =\n      rootDir !== null\n        ? createRequireFromPath(`${rootDir}/:internal:`)\n        : require\n    const resolvedPath = slash(path.dirname(requireSource.resolve(pluginName)))\n\n    const packageJSON = JSON.parse(\n      fs.readFileSync(`${resolvedPath}/package.json`, `utf-8`)\n    )\n    warnOnIncompatiblePeerDependency(packageJSON.name, packageJSON)\n\n    return {\n      resolve: resolvedPath,\n      id: createPluginId(packageJSON.name),\n      name: packageJSON.name,\n      version: packageJSON.version,\n    }\n  } catch (err) {\n    throw new Error(\n      `Unable to find plugin \"${pluginName}\". Perhaps you need to install its package?`\n    )\n  }\n}\n\nmodule.exports = (config = {}, rootDir = null) => {\n  // Instantiate plugins.\n  const plugins = []\n\n  // Create fake little site with a plugin for testing this\n  // w/ snapshots. Move plugin processing to its own module.\n  // Also test adding to redux store.\n  const processPlugin = plugin => {\n    if (_.isString(plugin)) {\n      const info = resolvePlugin(plugin, rootDir)\n\n      return {\n        ...info,\n        pluginOptions: {\n          plugins: [],\n        },\n      }\n    } else {\n      plugin.options = plugin.options || {}\n\n      // Plugins can have plugins.\n      const subplugins = []\n      if (plugin.options.plugins) {\n        plugin.options.plugins.forEach(p => {\n          subplugins.push(processPlugin(p))\n        })\n\n        plugin.options.plugins = subplugins\n      }\n\n      // Add some default values for tests as we don't actually\n      // want to try to load anything during tests.\n      if (plugin.resolve === `___TEST___`) {\n        const name = `TEST`\n\n        return {\n          id: createPluginId(name, plugin),\n          name,\n          pluginOptions: {\n            plugins: [],\n          },\n        }\n      }\n\n      const info = resolvePlugin(plugin.resolve, rootDir)\n\n      return {\n        ...info,\n        id: createPluginId(info.name, plugin),\n        pluginOptions: _.merge({ plugins: [] }, plugin.options),\n      }\n    }\n  }\n\n  // Add internal plugins\n  const internalPlugins = [\n    `../../internal-plugins/dev-404-page`,\n    `../../internal-plugins/load-babel-config`,\n    `../../internal-plugins/internal-data-bridge`,\n    `../../internal-plugins/prod-404`,\n    `../../internal-plugins/webpack-theme-component-shadowing`,\n  ]\n  internalPlugins.forEach(relPath => {\n    const absPath = path.join(__dirname, relPath)\n    plugins.push(processPlugin(absPath))\n  })\n\n  // Add plugins from the site config.\n  if (config.plugins) {\n    config.plugins.forEach(plugin => {\n      plugins.push(processPlugin(plugin))\n    })\n  }\n\n  // Add the site's default \"plugin\" i.e. gatsby-x files in root of site.\n  plugins.push({\n    resolve: slash(process.cwd()),\n    id: createPluginId(`default-site-plugin`),\n    name: `default-site-plugin`,\n    version: createFileContentHash(process.cwd(), `gatsby-*`),\n    pluginOptions: {\n      plugins: [],\n    },\n  })\n\n  const program = store.getState().program\n  plugins.push(\n    processPlugin({\n      resolve: require.resolve(`gatsby-plugin-page-creator`),\n      options: {\n        path: slash(path.join(program.directory, `src/pages`)),\n        pathCheck: false,\n      },\n    })\n  )\n\n  return plugins\n}\n"],"file":"load.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/bootstrap/load-plugins/validate.js b/node_modules/gatsby/dist/bootstrap/load-plugins/validate.js
index f0484bb..80af318 100644
--- a/node_modules/gatsby/dist/bootstrap/load-plugins/validate.js
+++ b/node_modules/gatsby/dist/bootstrap/load-plugins/validate.js
@@ -4,8 +4,9 @@ const _ = require(`lodash`);
 
 const semver = require(`semver`);
 
-const _require = require(`gatsby/package.json`),
-      gatsbyVersion = _require.version;
+const {
+  version: gatsbyVersion
+} = require(`gatsby/package.json`);
 
 const reporter = require(`gatsby-cli/lib/reporter`);
 
@@ -27,8 +28,9 @@ const getBadExports = (plugin, pluginAPIKeys, apis) => {
 };
 
 const getBadExportsMessage = (badExports, exportType, apis) => {
-  const _require2 = require(`common-tags`),
-        stripIndent = _require2.stripIndent;
+  const {
+    stripIndent
+  } = require(`common-tags`);
 
   const stringSimiliarity = require(`string-similarity`);
 
@@ -58,9 +60,10 @@ const getBadExportsMessage = (badExports, exportType, apis) => {
     const isOldAPI = Object.keys(badExportsMigrationMap).includes(bady.exportName);
 
     if (isDefaultPlugin && isOldAPI) {
-      const _badExportsMigrationM = badExportsMigrationMap[bady.exportName],
-            replacement = _badExportsMigrationM.replacement,
-            migrationLink = _badExportsMigrationM.migrationLink;
+      const {
+        replacement,
+        migrationLink
+      } = badExportsMigrationMap[bady.exportName];
       message += stripIndent`
         - Your site's gatsby-${exportType}.js is exporting "${bady.exportName}" which was removed in Gatsby v2. Refer to the migration guide for more info on upgrading to "${replacement}":
       `;
@@ -89,8 +92,7 @@ const handleBadExports = ({
 }) => {
   // Output error messages for all bad exports
   _.toPairs(badExports).forEach(badItem => {
-    const exportType = badItem[0],
-          entries = badItem[1];
+    const [exportType, entries] = badItem;
 
     if (entries.length > 0) {
       reporter.panicOnBuild(getBadExportsMessage(entries, exportType, apis[exportType]));
@@ -106,12 +108,7 @@ const collatePluginAPIs = ({
   apis,
   flattenedPlugins
 }) => {
-  const allAPIs = [...apis.node, ...apis.browser, ...apis.ssr];
-  const apiToPlugins = allAPIs.reduce((acc, value) => {
-    acc[value] = [];
-    return acc;
-  }, {}); // Get a list of bad exports
-
+  // Get a list of bad exports
   const badExports = {
     node: [],
     browser: [],
@@ -124,43 +121,40 @@ const collatePluginAPIs = ({
     // the plugin node itself *and* in an API to plugins map for faster lookups
     // later.
 
-    const pluginNodeExports = resolveModuleExports(`${plugin.resolve}/gatsby-node`);
+    const pluginNodeExports = resolveModuleExports(`${plugin.resolve}/gatsby-node`, {
+      mode: `require`
+    });
     const pluginBrowserExports = resolveModuleExports(`${plugin.resolve}/gatsby-browser`);
     const pluginSSRExports = resolveModuleExports(`${plugin.resolve}/gatsby-ssr`);
 
     if (pluginNodeExports.length > 0) {
       plugin.nodeAPIs = _.intersection(pluginNodeExports, apis.node);
-      plugin.nodeAPIs.map(nodeAPI => apiToPlugins[nodeAPI].push(plugin.name));
       badExports.node = badExports.node.concat(getBadExports(plugin, pluginNodeExports, apis.node)); // Collate any bad exports
     }
 
     if (pluginBrowserExports.length > 0) {
       plugin.browserAPIs = _.intersection(pluginBrowserExports, apis.browser);
-      plugin.browserAPIs.map(browserAPI => apiToPlugins[browserAPI].push(plugin.name));
       badExports.browser = badExports.browser.concat(getBadExports(plugin, pluginBrowserExports, apis.browser)); // Collate any bad exports
     }
 
     if (pluginSSRExports.length > 0) {
       plugin.ssrAPIs = _.intersection(pluginSSRExports, apis.ssr);
-      plugin.ssrAPIs.map(ssrAPI => apiToPlugins[ssrAPI].push(plugin.name));
       badExports.ssr = badExports.ssr.concat(getBadExports(plugin, pluginSSRExports, apis.ssr)); // Collate any bad exports
     }
   });
   return {
-    apiToPlugins,
     flattenedPlugins,
     badExports
   };
 };
 
 const handleMultipleReplaceRenderers = ({
-  apiToPlugins,
   flattenedPlugins
 }) => {
   // multiple replaceRenderers may cause problems at build time
-  if (apiToPlugins.replaceRenderer.length > 1) {
-    const rendererPlugins = [...apiToPlugins.replaceRenderer];
+  const rendererPlugins = flattenedPlugins.filter(plugin => plugin.ssrAPIs.includes(`replaceRenderer`)).map(plugin => plugin.name);
 
+  if (rendererPlugins.length > 1) {
     if (rendererPlugins.includes(`default-site-plugin`)) {
       reporter.warn(`replaceRenderer API found in these plugins:`);
       reporter.warn(rendererPlugins.join(`, `));
diff --git a/node_modules/gatsby/dist/bootstrap/load-plugins/validate.js.map b/node_modules/gatsby/dist/bootstrap/load-plugins/validate.js.map
index e5d5ba3..bc15b68 100644
--- a/node_modules/gatsby/dist/bootstrap/load-plugins/validate.js.map
+++ b/node_modules/gatsby/dist/bootstrap/load-plugins/validate.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/bootstrap/load-plugins/validate.js"],"names":["_","require","semver","gatsbyVersion","version","reporter","resolveModuleExports","getBadExports","plugin","pluginAPIKeys","apis","badExports","concat","difference","map","e","exportName","pluginName","name","pluginVersion","getBadExportsMessage","exportType","stripIndent","stringSimiliarity","capitalized","toUpperCase","slice","message","forEach","bady","similarities","findBestMatch","isDefaultPlugin","badExportsMigrationMap","modifyWebpackConfig","replacement","migrationLink","wrapRootComponent","isOldAPI","Object","keys","includes","bestMatch","rating","target","handleBadExports","toPairs","badItem","entries","length","panicOnBuild","collatePluginAPIs","flattenedPlugins","allAPIs","node","browser","ssr","apiToPlugins","reduce","acc","value","nodeAPIs","browserAPIs","ssrAPIs","pluginNodeExports","resolve","pluginBrowserExports","pluginSSRExports","intersection","nodeAPI","push","browserAPI","ssrAPI","handleMultipleReplaceRenderers","replaceRenderer","rendererPlugins","warn","join","console","log","error","process","env","NODE_ENV","exit","ignorable","messages","fp","i","skipSSR","m","warnOnIncompatiblePeerDependency","packageJSON","gatsbyPeerDependency","get","satisfies","module","exports"],"mappings":"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","sourcesContent":["const _ = require(`lodash`)\nconst semver = require(`semver`)\nconst { version: gatsbyVersion } = require(`gatsby/package.json`)\nconst reporter = require(`gatsby-cli/lib/reporter`)\nconst resolveModuleExports = require(`../resolve-module-exports`)\n\n// Given a plugin object, an array of the API names it exports and an\n// array of valid API names, return an array of invalid API exports.\nconst getBadExports = (plugin, pluginAPIKeys, apis) => {\n  let badExports = []\n  // Discover any exports from plugins which are not \"known\"\n  badExports = badExports.concat(\n    _.difference(pluginAPIKeys, apis).map(e => {\n      return {\n        exportName: e,\n        pluginName: plugin.name,\n        pluginVersion: plugin.version,\n      }\n    })\n  )\n  return badExports\n}\n\nconst getBadExportsMessage = (badExports, exportType, apis) => {\n  const { stripIndent } = require(`common-tags`)\n  const stringSimiliarity = require(`string-similarity`)\n  let capitalized = `${exportType[0].toUpperCase()}${exportType.slice(1)}`\n  if (capitalized === `Ssr`) capitalized = `SSR`\n\n  let message = `\\n`\n  message += stripIndent`\n    Your plugins must export known APIs from their gatsby-${exportType}.js.\n    The following exports aren't APIs. Perhaps you made a typo or your plugin is outdated?\n\n    See https://www.gatsbyjs.org/docs/${exportType}-apis/ for the list of Gatsby ${capitalized} APIs\n  `\n\n  badExports.forEach(bady => {\n    message += `\\n\\n`\n    const similarities = stringSimiliarity.findBestMatch(bady.exportName, apis)\n    const isDefaultPlugin = bady.pluginName == `default-site-plugin`\n    const badExportsMigrationMap = {\n      modifyWebpackConfig: {\n        replacement: `onCreateWebpackConfig`,\n        migrationLink: `https://gatsby.dev/update-webpack-config`,\n      },\n      wrapRootComponent: {\n        replacement: `wrapRootElement`,\n        migrationLink: `https://gatsby.dev/update-wraprootcomponent`,\n      },\n    }\n    const isOldAPI = Object.keys(badExportsMigrationMap).includes(\n      bady.exportName\n    )\n\n    if (isDefaultPlugin && isOldAPI) {\n      const { replacement, migrationLink } = badExportsMigrationMap[\n        bady.exportName\n      ]\n      message += stripIndent`\n        - Your site's gatsby-${exportType}.js is exporting \"${\n        bady.exportName\n      }\" which was removed in Gatsby v2. Refer to the migration guide for more info on upgrading to \"${replacement}\":\n      `\n      message += `\\n ${migrationLink}`\n    } else if (isDefaultPlugin) {\n      message += stripIndent`\n        - Your site's gatsby-${exportType}.js is exporting a variable named \"${\n        bady.exportName\n      }\" which isn't an API.\n      `\n    } else {\n      message += stripIndent`\n        - The plugin \"${bady.pluginName}@${\n        bady.pluginVersion\n      }\" is exporting a variable named \"${bady.exportName}\" which isn't an API.\n      `\n    }\n\n    if (similarities.bestMatch.rating > 0.5 && !isOldAPI) {\n      message += `\\n\\n`\n      message += `Perhaps you meant to export \"${\n        similarities.bestMatch.target\n      }\"?`\n    }\n  })\n\n  return message\n}\n\nconst handleBadExports = ({ apis, badExports }) => {\n  // Output error messages for all bad exports\n  _.toPairs(badExports).forEach(badItem => {\n    const [exportType, entries] = badItem\n    if (entries.length > 0) {\n      reporter.panicOnBuild(\n        getBadExportsMessage(entries, exportType, apis[exportType])\n      )\n    }\n  })\n}\n\n/**\n * Identify which APIs each plugin exports\n */\nconst collatePluginAPIs = ({ apis, flattenedPlugins }) => {\n  const allAPIs = [...apis.node, ...apis.browser, ...apis.ssr]\n  const apiToPlugins = allAPIs.reduce((acc, value) => {\n    acc[value] = []\n    return acc\n  }, {})\n\n  // Get a list of bad exports\n  const badExports = {\n    node: [],\n    browser: [],\n    ssr: [],\n  }\n\n  flattenedPlugins.forEach(plugin => {\n    plugin.nodeAPIs = []\n    plugin.browserAPIs = []\n    plugin.ssrAPIs = []\n\n    // Discover which APIs this plugin implements and store an array against\n    // the plugin node itself *and* in an API to plugins map for faster lookups\n    // later.\n    const pluginNodeExports = resolveModuleExports(\n      `${plugin.resolve}/gatsby-node`\n    )\n    const pluginBrowserExports = resolveModuleExports(\n      `${plugin.resolve}/gatsby-browser`\n    )\n    const pluginSSRExports = resolveModuleExports(\n      `${plugin.resolve}/gatsby-ssr`\n    )\n\n    if (pluginNodeExports.length > 0) {\n      plugin.nodeAPIs = _.intersection(pluginNodeExports, apis.node)\n      plugin.nodeAPIs.map(nodeAPI => apiToPlugins[nodeAPI].push(plugin.name))\n      badExports.node = badExports.node.concat(\n        getBadExports(plugin, pluginNodeExports, apis.node)\n      ) // Collate any bad exports\n    }\n\n    if (pluginBrowserExports.length > 0) {\n      plugin.browserAPIs = _.intersection(pluginBrowserExports, apis.browser)\n      plugin.browserAPIs.map(browserAPI =>\n        apiToPlugins[browserAPI].push(plugin.name)\n      )\n      badExports.browser = badExports.browser.concat(\n        getBadExports(plugin, pluginBrowserExports, apis.browser)\n      ) // Collate any bad exports\n    }\n\n    if (pluginSSRExports.length > 0) {\n      plugin.ssrAPIs = _.intersection(pluginSSRExports, apis.ssr)\n      plugin.ssrAPIs.map(ssrAPI => apiToPlugins[ssrAPI].push(plugin.name))\n      badExports.ssr = badExports.ssr.concat(\n        getBadExports(plugin, pluginSSRExports, apis.ssr)\n      ) // Collate any bad exports\n    }\n  })\n\n  return { apiToPlugins, flattenedPlugins, badExports }\n}\n\nconst handleMultipleReplaceRenderers = ({ apiToPlugins, flattenedPlugins }) => {\n  // multiple replaceRenderers may cause problems at build time\n  if (apiToPlugins.replaceRenderer.length > 1) {\n    const rendererPlugins = [...apiToPlugins.replaceRenderer]\n\n    if (rendererPlugins.includes(`default-site-plugin`)) {\n      reporter.warn(`replaceRenderer API found in these plugins:`)\n      reporter.warn(rendererPlugins.join(`, `))\n      reporter.warn(\n        `This might be an error, see: https://www.gatsbyjs.org/docs/debugging-replace-renderer-api/`\n      )\n    } else {\n      console.log(``)\n      reporter.error(\n        `Gatsby's replaceRenderer API is implemented by multiple plugins:`\n      )\n      reporter.error(rendererPlugins.join(`, `))\n      reporter.error(`This will break your build`)\n      reporter.error(\n        `See: https://www.gatsbyjs.org/docs/debugging-replace-renderer-api/`\n      )\n      if (process.env.NODE_ENV === `production`) process.exit(1)\n    }\n\n    // Now update plugin list so only final replaceRenderer will run\n    const ignorable = rendererPlugins.slice(0, -1)\n\n    // For each plugin in ignorable, set a skipSSR flag to true\n    // This prevents apiRunnerSSR() from attempting to run it later\n    const messages = []\n    flattenedPlugins.forEach((fp, i) => {\n      if (ignorable.includes(fp.name)) {\n        messages.push(\n          `Duplicate replaceRenderer found, skipping gatsby-ssr.js for plugin: ${\n            fp.name\n          }`\n        )\n        flattenedPlugins[i].skipSSR = true\n      }\n    })\n    if (messages.length > 0) {\n      console.log(``)\n      messages.forEach(m => reporter.warn(m))\n      console.log(``)\n    }\n  }\n\n  return flattenedPlugins\n}\n\nfunction warnOnIncompatiblePeerDependency(name, packageJSON) {\n  // Note: In the future the peer dependency should be enforced for all plugins.\n  const gatsbyPeerDependency = _.get(packageJSON, `peerDependencies.gatsby`)\n  if (\n    gatsbyPeerDependency &&\n    !semver.satisfies(gatsbyVersion, gatsbyPeerDependency)\n  ) {\n    reporter.warn(\n      `Plugin ${name} is not compatible with your gatsby version ${gatsbyVersion} - It requires gatsby@${gatsbyPeerDependency}`\n    )\n  }\n}\n\nmodule.exports = {\n  collatePluginAPIs,\n  handleBadExports,\n  handleMultipleReplaceRenderers,\n  warnOnIncompatiblePeerDependency,\n}\n"],"file":"validate.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/bootstrap/load-plugins/validate.js"],"names":["_","require","semver","version","gatsbyVersion","reporter","resolveModuleExports","getBadExports","plugin","pluginAPIKeys","apis","badExports","concat","difference","map","e","exportName","pluginName","name","pluginVersion","getBadExportsMessage","exportType","stripIndent","stringSimiliarity","capitalized","toUpperCase","slice","message","forEach","bady","similarities","findBestMatch","isDefaultPlugin","badExportsMigrationMap","modifyWebpackConfig","replacement","migrationLink","wrapRootComponent","isOldAPI","Object","keys","includes","bestMatch","rating","target","handleBadExports","toPairs","badItem","entries","length","panicOnBuild","collatePluginAPIs","flattenedPlugins","node","browser","ssr","nodeAPIs","browserAPIs","ssrAPIs","pluginNodeExports","resolve","mode","pluginBrowserExports","pluginSSRExports","intersection","handleMultipleReplaceRenderers","rendererPlugins","filter","warn","join","console","log","error","process","env","NODE_ENV","exit","ignorable","messages","fp","i","push","skipSSR","m","warnOnIncompatiblePeerDependency","packageJSON","gatsbyPeerDependency","get","satisfies","module","exports"],"mappings":"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","sourcesContent":["const _ = require(`lodash`)\nconst semver = require(`semver`)\nconst { version: gatsbyVersion } = require(`gatsby/package.json`)\nconst reporter = require(`gatsby-cli/lib/reporter`)\nconst resolveModuleExports = require(`../resolve-module-exports`)\n\n// Given a plugin object, an array of the API names it exports and an\n// array of valid API names, return an array of invalid API exports.\nconst getBadExports = (plugin, pluginAPIKeys, apis) => {\n  let badExports = []\n  // Discover any exports from plugins which are not \"known\"\n  badExports = badExports.concat(\n    _.difference(pluginAPIKeys, apis).map(e => {\n      return {\n        exportName: e,\n        pluginName: plugin.name,\n        pluginVersion: plugin.version,\n      }\n    })\n  )\n  return badExports\n}\n\nconst getBadExportsMessage = (badExports, exportType, apis) => {\n  const { stripIndent } = require(`common-tags`)\n  const stringSimiliarity = require(`string-similarity`)\n  let capitalized = `${exportType[0].toUpperCase()}${exportType.slice(1)}`\n  if (capitalized === `Ssr`) capitalized = `SSR`\n\n  let message = `\\n`\n  message += stripIndent`\n    Your plugins must export known APIs from their gatsby-${exportType}.js.\n    The following exports aren't APIs. Perhaps you made a typo or your plugin is outdated?\n\n    See https://www.gatsbyjs.org/docs/${exportType}-apis/ for the list of Gatsby ${capitalized} APIs\n  `\n\n  badExports.forEach(bady => {\n    message += `\\n\\n`\n    const similarities = stringSimiliarity.findBestMatch(bady.exportName, apis)\n    const isDefaultPlugin = bady.pluginName == `default-site-plugin`\n    const badExportsMigrationMap = {\n      modifyWebpackConfig: {\n        replacement: `onCreateWebpackConfig`,\n        migrationLink: `https://gatsby.dev/update-webpack-config`,\n      },\n      wrapRootComponent: {\n        replacement: `wrapRootElement`,\n        migrationLink: `https://gatsby.dev/update-wraprootcomponent`,\n      },\n    }\n    const isOldAPI = Object.keys(badExportsMigrationMap).includes(\n      bady.exportName\n    )\n\n    if (isDefaultPlugin && isOldAPI) {\n      const { replacement, migrationLink } = badExportsMigrationMap[\n        bady.exportName\n      ]\n      message += stripIndent`\n        - Your site's gatsby-${exportType}.js is exporting \"${\n        bady.exportName\n      }\" which was removed in Gatsby v2. Refer to the migration guide for more info on upgrading to \"${replacement}\":\n      `\n      message += `\\n ${migrationLink}`\n    } else if (isDefaultPlugin) {\n      message += stripIndent`\n        - Your site's gatsby-${exportType}.js is exporting a variable named \"${\n        bady.exportName\n      }\" which isn't an API.\n      `\n    } else {\n      message += stripIndent`\n        - The plugin \"${bady.pluginName}@${\n        bady.pluginVersion\n      }\" is exporting a variable named \"${bady.exportName}\" which isn't an API.\n      `\n    }\n\n    if (similarities.bestMatch.rating > 0.5 && !isOldAPI) {\n      message += `\\n\\n`\n      message += `Perhaps you meant to export \"${\n        similarities.bestMatch.target\n      }\"?`\n    }\n  })\n\n  return message\n}\n\nconst handleBadExports = ({ apis, badExports }) => {\n  // Output error messages for all bad exports\n  _.toPairs(badExports).forEach(badItem => {\n    const [exportType, entries] = badItem\n    if (entries.length > 0) {\n      reporter.panicOnBuild(\n        getBadExportsMessage(entries, exportType, apis[exportType])\n      )\n    }\n  })\n}\n\n/**\n * Identify which APIs each plugin exports\n */\nconst collatePluginAPIs = ({ apis, flattenedPlugins }) => {\n  // Get a list of bad exports\n  const badExports = {\n    node: [],\n    browser: [],\n    ssr: [],\n  }\n\n  flattenedPlugins.forEach(plugin => {\n    plugin.nodeAPIs = []\n    plugin.browserAPIs = []\n    plugin.ssrAPIs = []\n\n    // Discover which APIs this plugin implements and store an array against\n    // the plugin node itself *and* in an API to plugins map for faster lookups\n    // later.\n    const pluginNodeExports = resolveModuleExports(\n      `${plugin.resolve}/gatsby-node`,\n      {\n        mode: `require`,\n      }\n    )\n    const pluginBrowserExports = resolveModuleExports(\n      `${plugin.resolve}/gatsby-browser`\n    )\n    const pluginSSRExports = resolveModuleExports(\n      `${plugin.resolve}/gatsby-ssr`\n    )\n\n    if (pluginNodeExports.length > 0) {\n      plugin.nodeAPIs = _.intersection(pluginNodeExports, apis.node)\n      badExports.node = badExports.node.concat(\n        getBadExports(plugin, pluginNodeExports, apis.node)\n      ) // Collate any bad exports\n    }\n\n    if (pluginBrowserExports.length > 0) {\n      plugin.browserAPIs = _.intersection(pluginBrowserExports, apis.browser)\n      badExports.browser = badExports.browser.concat(\n        getBadExports(plugin, pluginBrowserExports, apis.browser)\n      ) // Collate any bad exports\n    }\n\n    if (pluginSSRExports.length > 0) {\n      plugin.ssrAPIs = _.intersection(pluginSSRExports, apis.ssr)\n      badExports.ssr = badExports.ssr.concat(\n        getBadExports(plugin, pluginSSRExports, apis.ssr)\n      ) // Collate any bad exports\n    }\n  })\n\n  return { flattenedPlugins, badExports }\n}\n\nconst handleMultipleReplaceRenderers = ({ flattenedPlugins }) => {\n  // multiple replaceRenderers may cause problems at build time\n  const rendererPlugins = flattenedPlugins\n    .filter(plugin => plugin.ssrAPIs.includes(`replaceRenderer`))\n    .map(plugin => plugin.name)\n  if (rendererPlugins.length > 1) {\n    if (rendererPlugins.includes(`default-site-plugin`)) {\n      reporter.warn(`replaceRenderer API found in these plugins:`)\n      reporter.warn(rendererPlugins.join(`, `))\n      reporter.warn(\n        `This might be an error, see: https://www.gatsbyjs.org/docs/debugging-replace-renderer-api/`\n      )\n    } else {\n      console.log(``)\n      reporter.error(\n        `Gatsby's replaceRenderer API is implemented by multiple plugins:`\n      )\n      reporter.error(rendererPlugins.join(`, `))\n      reporter.error(`This will break your build`)\n      reporter.error(\n        `See: https://www.gatsbyjs.org/docs/debugging-replace-renderer-api/`\n      )\n      if (process.env.NODE_ENV === `production`) process.exit(1)\n    }\n\n    // Now update plugin list so only final replaceRenderer will run\n    const ignorable = rendererPlugins.slice(0, -1)\n\n    // For each plugin in ignorable, set a skipSSR flag to true\n    // This prevents apiRunnerSSR() from attempting to run it later\n    const messages = []\n    flattenedPlugins.forEach((fp, i) => {\n      if (ignorable.includes(fp.name)) {\n        messages.push(\n          `Duplicate replaceRenderer found, skipping gatsby-ssr.js for plugin: ${\n            fp.name\n          }`\n        )\n        flattenedPlugins[i].skipSSR = true\n      }\n    })\n    if (messages.length > 0) {\n      console.log(``)\n      messages.forEach(m => reporter.warn(m))\n      console.log(``)\n    }\n  }\n\n  return flattenedPlugins\n}\n\nfunction warnOnIncompatiblePeerDependency(name, packageJSON) {\n  // Note: In the future the peer dependency should be enforced for all plugins.\n  const gatsbyPeerDependency = _.get(packageJSON, `peerDependencies.gatsby`)\n  if (\n    gatsbyPeerDependency &&\n    !semver.satisfies(gatsbyVersion, gatsbyPeerDependency)\n  ) {\n    reporter.warn(\n      `Plugin ${name} is not compatible with your gatsby version ${gatsbyVersion} - It requires gatsby@${gatsbyPeerDependency}`\n    )\n  }\n}\n\nmodule.exports = {\n  collatePluginAPIs,\n  handleBadExports,\n  handleMultipleReplaceRenderers,\n  warnOnIncompatiblePeerDependency,\n}\n"],"file":"validate.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/bootstrap/load-themes/index.js b/node_modules/gatsby/dist/bootstrap/load-themes/index.js
index ef6dda9..bd2e677 100644
--- a/node_modules/gatsby/dist/bootstrap/load-themes/index.js
+++ b/node_modules/gatsby/dist/bootstrap/load-themes/index.js
@@ -1,9 +1,5 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const path = require(`path`);
 
 const mergeGatsbyConfig = require(`../../utils/merge-gatsby-config`);
@@ -19,32 +15,24 @@ const preferDefault = require(`../prefer-default`);
 const getConfigFile = require(`../get-config-file`); // get the gatsby-config file for a theme
 
 
-const resolveTheme =
-/*#__PURE__*/
-function () {
-  var _ref = (0, _asyncToGenerator2.default)(function* (themeSpec) {
-    const themeName = themeSpec.resolve || themeSpec;
-    const themeDir = path.dirname(require.resolve(themeName));
-    const theme = yield preferDefault(getConfigFile(themeDir, `gatsby-config`)); // if theme is a function, call it with the themeConfig
-
-    let themeConfig = theme;
+const resolveTheme = async themeSpec => {
+  const themeName = themeSpec.resolve || themeSpec;
+  const themeDir = path.dirname(require.resolve(themeName));
+  const theme = await preferDefault(getConfigFile(themeDir, `gatsby-config`)); // if theme is a function, call it with the themeConfig
 
-    if (_.isFunction(theme)) {
-      themeConfig = theme(themeSpec.options || {});
-    }
+  let themeConfig = theme;
 
-    return {
-      themeName,
-      themeConfig,
-      themeSpec,
-      themeDir
-    };
-  });
+  if (_.isFunction(theme)) {
+    themeConfig = theme(themeSpec.options || {});
+  }
 
-  return function resolveTheme(_x) {
-    return _ref.apply(this, arguments);
+  return {
+    themeName,
+    themeConfig,
+    themeSpec,
+    themeDir
   };
-}(); // single iteration of a recursive function that resolve parent themes
+}; // single iteration of a recursive function that resolve parent themes
 // It's recursive because we support child themes declaring parents and
 // have to resolve all the way `up the tree` of parent/children relationships
 //
@@ -65,18 +53,10 @@ const processTheme = ({
   if (themeConfig && themeConfig.__experimentalThemes) {
     // for every parent theme a theme defines, resolve the parent's
     // gatsby config and return it in order [parentA, parentB, child]
-    return Promise.mapSeries(themeConfig.__experimentalThemes,
-    /*#__PURE__*/
-    function () {
-      var _ref2 = (0, _asyncToGenerator2.default)(function* (spec) {
-        const themeObj = yield resolveTheme(spec);
-        return processTheme(themeObj);
-      });
-
-      return function (_x2) {
-        return _ref2.apply(this, arguments);
-      };
-    }()).then(arr => arr.concat([{
+    return Promise.mapSeries(themeConfig.__experimentalThemes, async spec => {
+      const themeObj = await resolveTheme(spec);
+      return processTheme(themeObj);
+    }).then(arr => arr.concat([{
       themeName,
       themeConfig,
       themeSpec,
@@ -93,56 +73,40 @@ const processTheme = ({
   }
 };
 
-module.exports =
-/*#__PURE__*/
-function () {
-  var _ref3 = (0, _asyncToGenerator2.default)(function* (config) {
-    const themesA = yield Promise.mapSeries(config.__experimentalThemes,
-    /*#__PURE__*/
-    function () {
-      var _ref4 = (0, _asyncToGenerator2.default)(function* (themeSpec) {
-        const themeObj = yield resolveTheme(themeSpec);
-        return processTheme(themeObj);
-      });
-
-      return function (_x4) {
-        return _ref4.apply(this, arguments);
-      };
-    }()).then(arr => _.flattenDeep(arr)); // log out flattened themes list to aid in debugging
-
-    debug(themesA); // map over each theme, adding the theme itself to the plugins
-    // list in the config for the theme. This enables the usage of
-    // gatsby-node, etc in themes.
-
-    return Promise.mapSeries(themesA, ({
-      themeName,
-      themeConfig = {},
-      themeSpec
-    }) => {
-      return Object.assign({}, themeConfig, {
-        plugins: [...(themeConfig.plugins || []), // theme plugin is last so it's gatsby-node, etc can override it's declared plugins, like a normal site.
-        {
-          resolve: themeName,
-          options: themeSpec.options || {}
-        }]
-      });
-    })
-    /**
-     * themes resolve to a gatsby-config, so here we merge all of the configs
-     * into a single config, making sure to maintain the order in which
-     * they were defined so that later configs, like the user's site and
-     * children, can override functionality in earlier themes.
-     */
-    .reduce(mergeGatsbyConfig, {}).then(newConfig => {
-      return {
-        config: mergeGatsbyConfig(newConfig, config),
-        themes: themesA
-      };
-    });
+module.exports = async config => {
+  const themesA = await Promise.mapSeries(config.__experimentalThemes, async themeSpec => {
+    const themeObj = await resolveTheme(themeSpec);
+    return processTheme(themeObj);
+  }).then(arr => _.flattenDeep(arr)); // log out flattened themes list to aid in debugging
+
+  debug(themesA); // map over each theme, adding the theme itself to the plugins
+  // list in the config for the theme. This enables the usage of
+  // gatsby-node, etc in themes.
+
+  return Promise.mapSeries(themesA, ({
+    themeName,
+    themeConfig = {},
+    themeSpec
+  }) => {
+    return { ...themeConfig,
+      plugins: [...(themeConfig.plugins || []), // theme plugin is last so it's gatsby-node, etc can override it's declared plugins, like a normal site.
+      {
+        resolve: themeName,
+        options: themeSpec.options || {}
+      }]
+    };
+  })
+  /**
+   * themes resolve to a gatsby-config, so here we merge all of the configs
+   * into a single config, making sure to maintain the order in which
+   * they were defined so that later configs, like the user's site and
+   * children, can override functionality in earlier themes.
+   */
+  .reduce(mergeGatsbyConfig, {}).then(newConfig => {
+    return {
+      config: mergeGatsbyConfig(newConfig, config),
+      themes: themesA
+    };
   });
-
-  return function (_x3) {
-    return _ref3.apply(this, arguments);
-  };
-}();
+};
 //# sourceMappingURL=index.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/bootstrap/load-themes/index.js.map b/node_modules/gatsby/dist/bootstrap/load-themes/index.js.map
index 869518a..caa5e42 100644
--- a/node_modules/gatsby/dist/bootstrap/load-themes/index.js.map
+++ b/node_modules/gatsby/dist/bootstrap/load-themes/index.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/bootstrap/load-themes/index.js"],"names":["path","require","mergeGatsbyConfig","Promise","_","debug","preferDefault","getConfigFile","resolveTheme","themeSpec","themeName","resolve","themeDir","dirname","theme","themeConfig","isFunction","options","processTheme","__experimentalThemes","mapSeries","spec","themeObj","then","arr","concat","module","exports","config","themesA","flattenDeep","plugins","reduce","newConfig","themes"],"mappings":"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","sourcesContent":["const path = require(`path`)\nconst mergeGatsbyConfig = require(`../../utils/merge-gatsby-config`)\nconst Promise = require(`bluebird`)\nconst _ = require(`lodash`)\nconst debug = require(`debug`)(`gatsby:load-themes`)\nconst preferDefault = require(`../prefer-default`)\nconst getConfigFile = require(`../get-config-file`)\n\n// get the gatsby-config file for a theme\nconst resolveTheme = async themeSpec => {\n  const themeName = themeSpec.resolve || themeSpec\n  const themeDir = path.dirname(require.resolve(themeName))\n  const theme = await preferDefault(getConfigFile(themeDir, `gatsby-config`))\n  // if theme is a function, call it with the themeConfig\n  let themeConfig = theme\n  if (_.isFunction(theme)) {\n    themeConfig = theme(themeSpec.options || {})\n  }\n  return { themeName, themeConfig, themeSpec, themeDir }\n}\n\n// single iteration of a recursive function that resolve parent themes\n// It's recursive because we support child themes declaring parents and\n// have to resolve all the way `up the tree` of parent/children relationships\n//\n// Theoretically, there could be an infinite loop here but in practice there is\n// no use case for a loop so I expect that to only happen if someone is very\n// off track and creating their own set of themes\nconst processTheme = ({ themeName, themeConfig, themeSpec, themeDir }) => {\n  // gatsby themes don't have to specify a gatsby-config.js (they might only use gatsby-node, etc)\n  // in this case they're technically plugins, but we should support it anyway\n  // because we can't guarentee which files theme creators create first\n  if (themeConfig && themeConfig.__experimentalThemes) {\n    // for every parent theme a theme defines, resolve the parent's\n    // gatsby config and return it in order [parentA, parentB, child]\n    return Promise.mapSeries(themeConfig.__experimentalThemes, async spec => {\n      const themeObj = await resolveTheme(spec)\n      return processTheme(themeObj)\n    }).then(arr =>\n      arr.concat([{ themeName, themeConfig, themeSpec, themeDir }])\n    )\n  } else {\n    // if a theme doesn't define additional themes, return the original theme\n    return [{ themeName, themeConfig, themeSpec, themeDir }]\n  }\n}\n\nmodule.exports = async config => {\n  const themesA = await Promise.mapSeries(\n    config.__experimentalThemes,\n    async themeSpec => {\n      const themeObj = await resolveTheme(themeSpec)\n      return processTheme(themeObj)\n    }\n  ).then(arr => _.flattenDeep(arr))\n\n  // log out flattened themes list to aid in debugging\n  debug(themesA)\n\n  // map over each theme, adding the theme itself to the plugins\n  // list in the config for the theme. This enables the usage of\n  // gatsby-node, etc in themes.\n  return (\n    Promise.mapSeries(themesA, ({ themeName, themeConfig = {}, themeSpec }) => {\n      return {\n        ...themeConfig,\n        plugins: [\n          ...(themeConfig.plugins || []),\n          // theme plugin is last so it's gatsby-node, etc can override it's declared plugins, like a normal site.\n          { resolve: themeName, options: themeSpec.options || {} },\n        ],\n      }\n    })\n      /**\n       * themes resolve to a gatsby-config, so here we merge all of the configs\n       * into a single config, making sure to maintain the order in which\n       * they were defined so that later configs, like the user's site and\n       * children, can override functionality in earlier themes.\n       */\n      .reduce(mergeGatsbyConfig, {})\n      .then(newConfig => {\n        return {\n          config: mergeGatsbyConfig(newConfig, config),\n          themes: themesA,\n        }\n      })\n  )\n}\n"],"file":"index.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/bootstrap/load-themes/index.js"],"names":["path","require","mergeGatsbyConfig","Promise","_","debug","preferDefault","getConfigFile","resolveTheme","themeSpec","themeName","resolve","themeDir","dirname","theme","themeConfig","isFunction","options","processTheme","__experimentalThemes","mapSeries","spec","themeObj","then","arr","concat","module","exports","config","themesA","flattenDeep","plugins","reduce","newConfig","themes"],"mappings":"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","sourcesContent":["const path = require(`path`)\nconst mergeGatsbyConfig = require(`../../utils/merge-gatsby-config`)\nconst Promise = require(`bluebird`)\nconst _ = require(`lodash`)\nconst debug = require(`debug`)(`gatsby:load-themes`)\nconst preferDefault = require(`../prefer-default`)\nconst getConfigFile = require(`../get-config-file`)\n\n// get the gatsby-config file for a theme\nconst resolveTheme = async themeSpec => {\n  const themeName = themeSpec.resolve || themeSpec\n  const themeDir = path.dirname(require.resolve(themeName))\n  const theme = await preferDefault(getConfigFile(themeDir, `gatsby-config`))\n  // if theme is a function, call it with the themeConfig\n  let themeConfig = theme\n  if (_.isFunction(theme)) {\n    themeConfig = theme(themeSpec.options || {})\n  }\n  return { themeName, themeConfig, themeSpec, themeDir }\n}\n\n// single iteration of a recursive function that resolve parent themes\n// It's recursive because we support child themes declaring parents and\n// have to resolve all the way `up the tree` of parent/children relationships\n//\n// Theoretically, there could be an infinite loop here but in practice there is\n// no use case for a loop so I expect that to only happen if someone is very\n// off track and creating their own set of themes\nconst processTheme = ({ themeName, themeConfig, themeSpec, themeDir }) => {\n  // gatsby themes don't have to specify a gatsby-config.js (they might only use gatsby-node, etc)\n  // in this case they're technically plugins, but we should support it anyway\n  // because we can't guarentee which files theme creators create first\n  if (themeConfig && themeConfig.__experimentalThemes) {\n    // for every parent theme a theme defines, resolve the parent's\n    // gatsby config and return it in order [parentA, parentB, child]\n    return Promise.mapSeries(themeConfig.__experimentalThemes, async spec => {\n      const themeObj = await resolveTheme(spec)\n      return processTheme(themeObj)\n    }).then(arr =>\n      arr.concat([{ themeName, themeConfig, themeSpec, themeDir }])\n    )\n  } else {\n    // if a theme doesn't define additional themes, return the original theme\n    return [{ themeName, themeConfig, themeSpec, themeDir }]\n  }\n}\n\nmodule.exports = async config => {\n  const themesA = await Promise.mapSeries(\n    config.__experimentalThemes,\n    async themeSpec => {\n      const themeObj = await resolveTheme(themeSpec)\n      return processTheme(themeObj)\n    }\n  ).then(arr => _.flattenDeep(arr))\n\n  // log out flattened themes list to aid in debugging\n  debug(themesA)\n\n  // map over each theme, adding the theme itself to the plugins\n  // list in the config for the theme. This enables the usage of\n  // gatsby-node, etc in themes.\n  return (\n    Promise.mapSeries(themesA, ({ themeName, themeConfig = {}, themeSpec }) => {\n      return {\n        ...themeConfig,\n        plugins: [\n          ...(themeConfig.plugins || []),\n          // theme plugin is last so it's gatsby-node, etc can override it's declared plugins, like a normal site.\n          { resolve: themeName, options: themeSpec.options || {} },\n        ],\n      }\n    })\n      /**\n       * themes resolve to a gatsby-config, so here we merge all of the configs\n       * into a single config, making sure to maintain the order in which\n       * they were defined so that later configs, like the user's site and\n       * children, can override functionality in earlier themes.\n       */\n      .reduce(mergeGatsbyConfig, {})\n      .then(newConfig => {\n        return {\n          config: mergeGatsbyConfig(newConfig, config),\n          themes: themesA,\n        }\n      })\n  )\n}\n"],"file":"index.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/bootstrap/page-hot-reloader.js b/node_modules/gatsby/dist/bootstrap/page-hot-reloader.js
index 08d1372..6fdc3d2 100644
--- a/node_modules/gatsby/dist/bootstrap/page-hot-reloader.js
+++ b/node_modules/gatsby/dist/bootstrap/page-hot-reloader.js
@@ -1,20 +1,20 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
-const _require = require(`../redux`),
-      emitter = _require.emitter,
-      store = _require.store;
+const {
+  emitter,
+  store
+} = require(`../redux`);
 
 const apiRunnerNode = require(`../utils/api-runner-node`);
 
-const _require2 = require(`../redux/actions`),
-      boundActionCreators = _require2.boundActionCreators;
+const {
+  boundActionCreators
+} = require(`../redux/actions`);
 
-const deletePage = boundActionCreators.deletePage,
-      deleteComponentsDependencies = boundActionCreators.deleteComponentsDependencies;
+const {
+  deletePage,
+  deleteComponentsDependencies
+} = boundActionCreators;
 let pagesDirty = false;
 let graphql;
 emitter.on(`CREATE_NODE`, action => {
@@ -38,31 +38,23 @@ emitter.on(`API_RUNNING_QUEUE_EMPTY`, () => {
   }
 });
 
-const runCreatePages =
-/*#__PURE__*/
-function () {
-  var _ref = (0, _asyncToGenerator2.default)(function* () {
-    pagesDirty = false;
-    const timestamp = Date.now();
-    yield apiRunnerNode(`createPages`, {
-      graphql,
-      traceId: `createPages`,
-      waitForCascadingActions: true
-    }); // Delete pages that weren't updated when running createPages.
-
-    Array.from(store.getState().pages.values()).forEach(page => {
-      if (!page.isCreatedByStatefulCreatePages && page.updatedAt < timestamp && page.path !== `/404.html`) {
-        deleteComponentsDependencies([page.path]);
-        deletePage(page);
-      }
-    });
-    emitter.emit(`CREATE_PAGE_END`);
+const runCreatePages = async () => {
+  pagesDirty = false;
+  const timestamp = Date.now();
+  await apiRunnerNode(`createPages`, {
+    graphql,
+    traceId: `createPages`,
+    waitForCascadingActions: true
+  }); // Delete pages that weren't updated when running createPages.
+
+  Array.from(store.getState().pages.values()).forEach(page => {
+    if (!page.isCreatedByStatefulCreatePages && page.updatedAt < timestamp && page.path !== `/404.html`) {
+      deleteComponentsDependencies([page.path]);
+      deletePage(page);
+    }
   });
-
-  return function runCreatePages() {
-    return _ref.apply(this, arguments);
-  };
-}();
+  emitter.emit(`CREATE_PAGE_END`);
+};
 
 module.exports = graphqlRunner => {
   graphql = graphqlRunner;
diff --git a/node_modules/gatsby/dist/bootstrap/page-hot-reloader.js.map b/node_modules/gatsby/dist/bootstrap/page-hot-reloader.js.map
index 12781b8..6fdde63 100644
--- a/node_modules/gatsby/dist/bootstrap/page-hot-reloader.js.map
+++ b/node_modules/gatsby/dist/bootstrap/page-hot-reloader.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/bootstrap/page-hot-reloader.js"],"names":["require","emitter","store","apiRunnerNode","boundActionCreators","deletePage","deleteComponentsDependencies","pagesDirty","graphql","on","action","payload","internal","type","runCreatePages","timestamp","Date","now","traceId","waitForCascadingActions","Array","from","getState","pages","values","forEach","page","isCreatedByStatefulCreatePages","updatedAt","path","emit","module","exports","graphqlRunner"],"mappings":";;;;;;iBAA2BA,OAAO,CAAE,UAAF,C;MAA1BC,O,YAAAA,O;MAASC,K,YAAAA,K;;AACjB,MAAMC,aAAa,GAAGH,OAAO,CAAE,0BAAF,CAA7B;;kBACgCA,OAAO,CAAE,kBAAF,C;MAA/BI,mB,aAAAA,mB;;MACAC,U,GAA6CD,mB,CAA7CC,U;MAAYC,4B,GAAiCF,mB,CAAjCE,4B;AAEpB,IAAIC,UAAU,GAAG,KAAjB;AACA,IAAIC,OAAJ;AAEAP,OAAO,CAACQ,EAAR,CAAY,aAAZ,EAA0BC,MAAM,IAAI;AAClC,MAAIA,MAAM,CAACC,OAAP,CAAeC,QAAf,CAAwBC,IAAxB,KAAkC,UAAtC,EAAiD;AAC/CN,IAAAA,UAAU,GAAG,IAAb;AACD;AACF,CAJD;AAKAN,OAAO,CAACQ,EAAR,CAAY,aAAZ,EAA0BC,MAAM,IAAI;AAClC,MAAIA,MAAM,CAACC,OAAP,CAAeC,QAAf,CAAwBC,IAAxB,KAAkC,UAAtC,EAAiD;AAC/CN,IAAAA,UAAU,GAAG,IAAb,CAD+C,CAE/C;AACA;AACA;AACA;;AACAJ,IAAAA,aAAa,CAAE,eAAF,CAAb;AACD;AACF,CATD;AAWAF,OAAO,CAACQ,EAAR,CAAY,yBAAZ,EAAsC,MAAM;AAC1C,MAAIF,UAAJ,EAAgB;AACdO,IAAAA,cAAc;AACf;AACF,CAJD;;AAMA,MAAMA,cAAc;AAAA;AAAA;AAAA,6CAAG,aAAY;AACjCP,IAAAA,UAAU,GAAG,KAAb;AAEA,UAAMQ,SAAS,GAAGC,IAAI,CAACC,GAAL,EAAlB;AAEA,UAAMd,aAAa,CAAE,aAAF,EAAgB;AACjCK,MAAAA,OADiC;AAEjCU,MAAAA,OAAO,EAAG,aAFuB;AAGjCC,MAAAA,uBAAuB,EAAE;AAHQ,KAAhB,CAAnB,CALiC,CAWjC;;AACAC,IAAAA,KAAK,CAACC,IAAN,CAAWnB,KAAK,CAACoB,QAAN,GAAiBC,KAAjB,CAAuBC,MAAvB,EAAX,EAA4CC,OAA5C,CAAoDC,IAAI,IAAI;AAC1D,UACE,CAACA,IAAI,CAACC,8BAAN,IACAD,IAAI,CAACE,SAAL,GAAiBb,SADjB,IAEAW,IAAI,CAACG,IAAL,KAAe,WAHjB,EAIE;AACAvB,QAAAA,4BAA4B,CAAC,CAACoB,IAAI,CAACG,IAAN,CAAD,CAA5B;AACAxB,QAAAA,UAAU,CAACqB,IAAD,CAAV;AACD;AACF,KATD;AAWAzB,IAAAA,OAAO,CAAC6B,IAAR,CAAc,iBAAd;AACD,GAxBmB;;AAAA,kBAAdhB,cAAc;AAAA;AAAA;AAAA,GAApB;;AA0BAiB,MAAM,CAACC,OAAP,GAAiBC,aAAa,IAAI;AAChCzB,EAAAA,OAAO,GAAGyB,aAAV;AACD,CAFD","sourcesContent":["const { emitter, store } = require(`../redux`)\nconst apiRunnerNode = require(`../utils/api-runner-node`)\nconst { boundActionCreators } = require(`../redux/actions`)\nconst { deletePage, deleteComponentsDependencies } = boundActionCreators\n\nlet pagesDirty = false\nlet graphql\n\nemitter.on(`CREATE_NODE`, action => {\n  if (action.payload.internal.type !== `SitePage`) {\n    pagesDirty = true\n  }\n})\nemitter.on(`DELETE_NODE`, action => {\n  if (action.payload.internal.type !== `SitePage`) {\n    pagesDirty = true\n    // Make a fake API call to trigger `API_RUNNING_QUEUE_EMPTY` being called.\n    // We don't want to call runCreatePages here as there might be work in\n    // progress. So this is a safe way to make sure runCreatePages gets called\n    // at a safe time.\n    apiRunnerNode(`FAKE_API_CALL`)\n  }\n})\n\nemitter.on(`API_RUNNING_QUEUE_EMPTY`, () => {\n  if (pagesDirty) {\n    runCreatePages()\n  }\n})\n\nconst runCreatePages = async () => {\n  pagesDirty = false\n\n  const timestamp = Date.now()\n\n  await apiRunnerNode(`createPages`, {\n    graphql,\n    traceId: `createPages`,\n    waitForCascadingActions: true,\n  })\n\n  // Delete pages that weren't updated when running createPages.\n  Array.from(store.getState().pages.values()).forEach(page => {\n    if (\n      !page.isCreatedByStatefulCreatePages &&\n      page.updatedAt < timestamp &&\n      page.path !== `/404.html`\n    ) {\n      deleteComponentsDependencies([page.path])\n      deletePage(page)\n    }\n  })\n\n  emitter.emit(`CREATE_PAGE_END`)\n}\n\nmodule.exports = graphqlRunner => {\n  graphql = graphqlRunner\n}\n"],"file":"page-hot-reloader.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/bootstrap/page-hot-reloader.js"],"names":["emitter","store","require","apiRunnerNode","boundActionCreators","deletePage","deleteComponentsDependencies","pagesDirty","graphql","on","action","payload","internal","type","runCreatePages","timestamp","Date","now","traceId","waitForCascadingActions","Array","from","getState","pages","values","forEach","page","isCreatedByStatefulCreatePages","updatedAt","path","emit","module","exports","graphqlRunner"],"mappings":";;AAAA,MAAM;AAAEA,EAAAA,OAAF;AAAWC,EAAAA;AAAX,IAAqBC,OAAO,CAAE,UAAF,CAAlC;;AACA,MAAMC,aAAa,GAAGD,OAAO,CAAE,0BAAF,CAA7B;;AACA,MAAM;AAAEE,EAAAA;AAAF,IAA0BF,OAAO,CAAE,kBAAF,CAAvC;;AACA,MAAM;AAAEG,EAAAA,UAAF;AAAcC,EAAAA;AAAd,IAA+CF,mBAArD;AAEA,IAAIG,UAAU,GAAG,KAAjB;AACA,IAAIC,OAAJ;AAEAR,OAAO,CAACS,EAAR,CAAY,aAAZ,EAA0BC,MAAM,IAAI;AAClC,MAAIA,MAAM,CAACC,OAAP,CAAeC,QAAf,CAAwBC,IAAxB,KAAkC,UAAtC,EAAiD;AAC/CN,IAAAA,UAAU,GAAG,IAAb;AACD;AACF,CAJD;AAKAP,OAAO,CAACS,EAAR,CAAY,aAAZ,EAA0BC,MAAM,IAAI;AAClC,MAAIA,MAAM,CAACC,OAAP,CAAeC,QAAf,CAAwBC,IAAxB,KAAkC,UAAtC,EAAiD;AAC/CN,IAAAA,UAAU,GAAG,IAAb,CAD+C,CAE/C;AACA;AACA;AACA;;AACAJ,IAAAA,aAAa,CAAE,eAAF,CAAb;AACD;AACF,CATD;AAWAH,OAAO,CAACS,EAAR,CAAY,yBAAZ,EAAsC,MAAM;AAC1C,MAAIF,UAAJ,EAAgB;AACdO,IAAAA,cAAc;AACf;AACF,CAJD;;AAMA,MAAMA,cAAc,GAAG,YAAY;AACjCP,EAAAA,UAAU,GAAG,KAAb;AAEA,QAAMQ,SAAS,GAAGC,IAAI,CAACC,GAAL,EAAlB;AAEA,QAAMd,aAAa,CAAE,aAAF,EAAgB;AACjCK,IAAAA,OADiC;AAEjCU,IAAAA,OAAO,EAAG,aAFuB;AAGjCC,IAAAA,uBAAuB,EAAE;AAHQ,GAAhB,CAAnB,CALiC,CAWjC;;AACAC,EAAAA,KAAK,CAACC,IAAN,CAAWpB,KAAK,CAACqB,QAAN,GAAiBC,KAAjB,CAAuBC,MAAvB,EAAX,EAA4CC,OAA5C,CAAoDC,IAAI,IAAI;AAC1D,QACE,CAACA,IAAI,CAACC,8BAAN,IACAD,IAAI,CAACE,SAAL,GAAiBb,SADjB,IAEAW,IAAI,CAACG,IAAL,KAAe,WAHjB,EAIE;AACAvB,MAAAA,4BAA4B,CAAC,CAACoB,IAAI,CAACG,IAAN,CAAD,CAA5B;AACAxB,MAAAA,UAAU,CAACqB,IAAD,CAAV;AACD;AACF,GATD;AAWA1B,EAAAA,OAAO,CAAC8B,IAAR,CAAc,iBAAd;AACD,CAxBD;;AA0BAC,MAAM,CAACC,OAAP,GAAiBC,aAAa,IAAI;AAChCzB,EAAAA,OAAO,GAAGyB,aAAV;AACD,CAFD","sourcesContent":["const { emitter, store } = require(`../redux`)\nconst apiRunnerNode = require(`../utils/api-runner-node`)\nconst { boundActionCreators } = require(`../redux/actions`)\nconst { deletePage, deleteComponentsDependencies } = boundActionCreators\n\nlet pagesDirty = false\nlet graphql\n\nemitter.on(`CREATE_NODE`, action => {\n  if (action.payload.internal.type !== `SitePage`) {\n    pagesDirty = true\n  }\n})\nemitter.on(`DELETE_NODE`, action => {\n  if (action.payload.internal.type !== `SitePage`) {\n    pagesDirty = true\n    // Make a fake API call to trigger `API_RUNNING_QUEUE_EMPTY` being called.\n    // We don't want to call runCreatePages here as there might be work in\n    // progress. So this is a safe way to make sure runCreatePages gets called\n    // at a safe time.\n    apiRunnerNode(`FAKE_API_CALL`)\n  }\n})\n\nemitter.on(`API_RUNNING_QUEUE_EMPTY`, () => {\n  if (pagesDirty) {\n    runCreatePages()\n  }\n})\n\nconst runCreatePages = async () => {\n  pagesDirty = false\n\n  const timestamp = Date.now()\n\n  await apiRunnerNode(`createPages`, {\n    graphql,\n    traceId: `createPages`,\n    waitForCascadingActions: true,\n  })\n\n  // Delete pages that weren't updated when running createPages.\n  Array.from(store.getState().pages.values()).forEach(page => {\n    if (\n      !page.isCreatedByStatefulCreatePages &&\n      page.updatedAt < timestamp &&\n      page.path !== `/404.html`\n    ) {\n      deleteComponentsDependencies([page.path])\n      deletePage(page)\n    }\n  })\n\n  emitter.emit(`CREATE_PAGE_END`)\n}\n\nmodule.exports = graphqlRunner => {\n  graphql = graphqlRunner\n}\n"],"file":"page-hot-reloader.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/bootstrap/resolve-module-exports.js b/node_modules/gatsby/dist/bootstrap/resolve-module-exports.js
index 1fca200..8a90d53 100644
--- a/node_modules/gatsby/dist/bootstrap/resolve-module-exports.js
+++ b/node_modules/gatsby/dist/bootstrap/resolve-module-exports.js
@@ -6,25 +6,17 @@ const traverse = require(`@babel/traverse`).default;
 
 const get = require(`lodash/get`);
 
-const _require = require(`@babel/code-frame`),
-      codeFrameColumns = _require.codeFrameColumns;
+const {
+  codeFrameColumns
+} = require(`@babel/code-frame`);
 
-const _require2 = require(`../utils/babel-parse-to-ast`),
-      babelParseToAst = _require2.babelParseToAst;
+const {
+  babelParseToAst
+} = require(`../utils/babel-parse-to-ast`);
 
 const report = require(`gatsby-cli/lib/reporter`);
-/**
- * Given a `require.resolve()` compatible path pointing to a JS module,
- * return an array listing the names of the module's exports.
- *
- * Returns [] for invalid paths and modules without exports.
- *
- * @param {string} modulePath
- * @param {function} resolver
- */
 
-
-module.exports = (modulePath, resolver = require.resolve) => {
+const staticallyAnalyzeExports = (modulePath, resolver = require.resolve) => {
   let absPath;
   const exportNames = [];
 
@@ -108,4 +100,30 @@ https://gatsby.dev/no-mixed-modules
 
   return exportNames;
 };
+/**
+ * Given a `require.resolve()` compatible path pointing to a JS module,
+ * return an array listing the names of the module's exports.
+ *
+ * Returns [] for invalid paths and modules without exports.
+ *
+ * @param {string} modulePath
+ * @param {string} mode
+ * @param {function} resolver
+ */
+
+
+module.exports = (modulePath, {
+  mode = `analysis`,
+  resolver
+} = {}) => {
+  if (mode === `require`) {
+    try {
+      return Object.keys(require(modulePath)).filter(exportName => exportName !== `__esModule`);
+    } catch {
+      return [];
+    }
+  } else {
+    return staticallyAnalyzeExports(modulePath, resolver);
+  }
+};
 //# sourceMappingURL=resolve-module-exports.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/bootstrap/resolve-module-exports.js.map b/node_modules/gatsby/dist/bootstrap/resolve-module-exports.js.map
index b9da3b8..cc996b1 100644
--- a/node_modules/gatsby/dist/bootstrap/resolve-module-exports.js.map
+++ b/node_modules/gatsby/dist/bootstrap/resolve-module-exports.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/bootstrap/resolve-module-exports.js"],"names":["fs","require","traverse","default","get","codeFrameColumns","babelParseToAst","report","module","exports","modulePath","resolver","resolve","absPath","exportNames","err","code","readFileSync","ast","SyntaxError","codeFrame","start","loc","highlightCode","panic","message","isCommonJS","isES6","ImportDeclaration","astPath","ExportNamedDeclaration","exportName","push","ExportSpecifier","AssignmentExpression","nodeLeft","node","left","type","property","name","process","env","NODE_ENV"],"mappings":"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","sourcesContent":["// @flow\nconst fs = require(`fs`)\nconst traverse = require(`@babel/traverse`).default\nconst get = require(`lodash/get`)\nconst { codeFrameColumns } = require(`@babel/code-frame`)\nconst { babelParseToAst } = require(`../utils/babel-parse-to-ast`)\nconst report = require(`gatsby-cli/lib/reporter`)\n\n/**\n * Given a `require.resolve()` compatible path pointing to a JS module,\n * return an array listing the names of the module's exports.\n *\n * Returns [] for invalid paths and modules without exports.\n *\n * @param {string} modulePath\n * @param {function} resolver\n */\nmodule.exports = (modulePath, resolver = require.resolve) => {\n  let absPath\n  const exportNames = []\n\n  try {\n    absPath = resolver(modulePath)\n  } catch (err) {\n    return exportNames // doesn't exist\n  }\n  const code = fs.readFileSync(absPath, `utf8`) // get file contents\n\n  let ast\n  try {\n    ast = babelParseToAst(code, absPath)\n  } catch (err) {\n    if (err instanceof SyntaxError) {\n      // Pretty print syntax errors\n      const codeFrame = codeFrameColumns(\n        code,\n        {\n          start: err.loc,\n        },\n        {\n          highlightCode: true,\n        }\n      )\n\n      report.panic(\n        `Syntax error in \"${absPath}\":\\n${err.message}\\n${codeFrame}`\n      )\n    } else {\n      // if it's not syntax error, just throw it\n      throw err\n    }\n  }\n\n  let isCommonJS = false\n  let isES6 = false\n\n  // extract names of exports from file\n  traverse(ast, {\n    // Check if the file is using ES6 imports\n    ImportDeclaration: function ImportDeclaration(astPath) {\n      isES6 = true\n    },\n\n    // get foo from `export const foo = bar`\n    ExportNamedDeclaration: function ExportNamedDeclaration(astPath) {\n      const exportName = get(\n        astPath,\n        `node.declaration.declarations[0].id.name`\n      )\n      isES6 = true\n      if (exportName) exportNames.push(exportName)\n    },\n\n    // get foo from `export { foo } from 'bar'`\n    // get foo from `export { foo }`\n    ExportSpecifier: function ExportSpecifier(astPath) {\n      const exportName = get(astPath, `node.exported.name`)\n      isES6 = true\n      if (exportName) exportNames.push(exportName)\n    },\n\n    AssignmentExpression: function AssignmentExpression(astPath) {\n      const nodeLeft = astPath.node.left\n\n      if (nodeLeft.type !== `MemberExpression`) return\n\n      // ignore marker property `__esModule`\n      if (get(nodeLeft, `property.name`) === `__esModule`) return\n\n      // get foo from `exports.foo = bar`\n      if (get(nodeLeft, `object.name`) === `exports`) {\n        isCommonJS = true\n        exportNames.push(nodeLeft.property.name)\n      }\n\n      // get foo from `module.exports.foo = bar`\n      if (\n        get(nodeLeft, `object.object.name`) === `module` &&\n        get(nodeLeft, `object.property.name`) === `exports`\n      ) {\n        isCommonJS = true\n        exportNames.push(nodeLeft.property.name)\n      }\n    },\n  })\n\n  if (isES6 && isCommonJS && process.env.NODE_ENV !== `test`) {\n    report.panic(\n      `This plugin file is using both CommonJS and ES6 module systems together which we don't support.\nYou'll need to edit the file to use just one or the other.\n\nplugin: ${modulePath}.js\n\nThis didn't cause a problem in Gatsby v1 so you might want to review the migration doc for this:\nhttps://gatsby.dev/no-mixed-modules\n      `\n    )\n  }\n  return exportNames\n}\n"],"file":"resolve-module-exports.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/bootstrap/resolve-module-exports.js"],"names":["fs","require","traverse","default","get","codeFrameColumns","babelParseToAst","report","staticallyAnalyzeExports","modulePath","resolver","resolve","absPath","exportNames","err","code","readFileSync","ast","SyntaxError","codeFrame","start","loc","highlightCode","panic","message","isCommonJS","isES6","ImportDeclaration","astPath","ExportNamedDeclaration","exportName","push","ExportSpecifier","AssignmentExpression","nodeLeft","node","left","type","property","name","process","env","NODE_ENV","module","exports","mode","Object","keys","filter"],"mappings":"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","sourcesContent":["// @flow\nconst fs = require(`fs`)\nconst traverse = require(`@babel/traverse`).default\nconst get = require(`lodash/get`)\nconst { codeFrameColumns } = require(`@babel/code-frame`)\nconst { babelParseToAst } = require(`../utils/babel-parse-to-ast`)\nconst report = require(`gatsby-cli/lib/reporter`)\n\nconst staticallyAnalyzeExports = (modulePath, resolver = require.resolve) => {\n  let absPath\n  const exportNames = []\n\n  try {\n    absPath = resolver(modulePath)\n  } catch (err) {\n    return exportNames // doesn't exist\n  }\n  const code = fs.readFileSync(absPath, `utf8`) // get file contents\n\n  let ast\n  try {\n    ast = babelParseToAst(code, absPath)\n  } catch (err) {\n    if (err instanceof SyntaxError) {\n      // Pretty print syntax errors\n      const codeFrame = codeFrameColumns(\n        code,\n        {\n          start: err.loc,\n        },\n        {\n          highlightCode: true,\n        }\n      )\n\n      report.panic(\n        `Syntax error in \"${absPath}\":\\n${err.message}\\n${codeFrame}`\n      )\n    } else {\n      // if it's not syntax error, just throw it\n      throw err\n    }\n  }\n\n  let isCommonJS = false\n  let isES6 = false\n\n  // extract names of exports from file\n  traverse(ast, {\n    // Check if the file is using ES6 imports\n    ImportDeclaration: function ImportDeclaration(astPath) {\n      isES6 = true\n    },\n\n    // get foo from `export const foo = bar`\n    ExportNamedDeclaration: function ExportNamedDeclaration(astPath) {\n      const exportName = get(\n        astPath,\n        `node.declaration.declarations[0].id.name`\n      )\n      isES6 = true\n      if (exportName) exportNames.push(exportName)\n    },\n\n    // get foo from `export { foo } from 'bar'`\n    // get foo from `export { foo }`\n    ExportSpecifier: function ExportSpecifier(astPath) {\n      const exportName = get(astPath, `node.exported.name`)\n      isES6 = true\n      if (exportName) exportNames.push(exportName)\n    },\n\n    AssignmentExpression: function AssignmentExpression(astPath) {\n      const nodeLeft = astPath.node.left\n\n      if (nodeLeft.type !== `MemberExpression`) return\n\n      // ignore marker property `__esModule`\n      if (get(nodeLeft, `property.name`) === `__esModule`) return\n\n      // get foo from `exports.foo = bar`\n      if (get(nodeLeft, `object.name`) === `exports`) {\n        isCommonJS = true\n        exportNames.push(nodeLeft.property.name)\n      }\n\n      // get foo from `module.exports.foo = bar`\n      if (\n        get(nodeLeft, `object.object.name`) === `module` &&\n        get(nodeLeft, `object.property.name`) === `exports`\n      ) {\n        isCommonJS = true\n        exportNames.push(nodeLeft.property.name)\n      }\n    },\n  })\n\n  if (isES6 && isCommonJS && process.env.NODE_ENV !== `test`) {\n    report.panic(\n      `This plugin file is using both CommonJS and ES6 module systems together which we don't support.\nYou'll need to edit the file to use just one or the other.\n\nplugin: ${modulePath}.js\n\nThis didn't cause a problem in Gatsby v1 so you might want to review the migration doc for this:\nhttps://gatsby.dev/no-mixed-modules\n      `\n    )\n  }\n  return exportNames\n}\n\n/**\n * Given a `require.resolve()` compatible path pointing to a JS module,\n * return an array listing the names of the module's exports.\n *\n * Returns [] for invalid paths and modules without exports.\n *\n * @param {string} modulePath\n * @param {string} mode\n * @param {function} resolver\n */\nmodule.exports = (modulePath, { mode = `analysis`, resolver } = {}) => {\n  if (mode === `require`) {\n    try {\n      return Object.keys(require(modulePath)).filter(\n        exportName => exportName !== `__esModule`\n      )\n    } catch {\n      return []\n    }\n  } else {\n    return staticallyAnalyzeExports(modulePath, resolver)\n  }\n}\n"],"file":"resolve-module-exports.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/commands/build-html.js b/node_modules/gatsby/dist/commands/build-html.js
index 48b79c3..47c796f 100644
--- a/node_modules/gatsby/dist/commands/build-html.js
+++ b/node_modules/gatsby/dist/commands/build-html.js
@@ -1,68 +1,98 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const webpack = require(`webpack`);
 
-const fs = require(`fs`);
-
-const debug = require(`debug`)(`gatsby:html`);
+const fs = require(`fs-extra`);
 
 const webpackConfig = require(`../utils/webpack.config`);
 
-const _require = require(`../redux`),
-      store = _require.store;
-
-const _require2 = require(`gatsby-cli/lib/reporter/errors`),
-      createErrorFromString = _require2.createErrorFromString;
+const {
+  createErrorFromString
+} = require(`gatsby-cli/lib/reporter/errors`);
 
 const renderHTMLQueue = require(`../utils/html-renderer-queue`);
 
-module.exports =
-/*#__PURE__*/
-function () {
-  var _ref = (0, _asyncToGenerator2.default)(function* (program, activity) {
-    const directory = program.directory;
-    debug(`generating static HTML`); // Reduce pages objects to an array of paths.
-
-    const pages = Array.from(store.getState().pages.values(), page => page.path); // Static site generation.
-
-    const compilerConfig = yield webpackConfig(program, directory, `build-html`, null);
-    return new Promise((resolve, reject) => {
-      webpack(compilerConfig).run((e, stats) => {
-        if (e) {
-          return reject(e);
-        }
-
-        const outputFile = `${directory}/public/render-page.js`;
-
-        if (stats.hasErrors()) {
-          let webpackErrors = stats.toJson().errors.filter(Boolean);
-          return reject(webpackErrors.length ? createErrorFromString(webpackErrors[0], `${outputFile}.map`) : new Error(`There was an issue while building the site: ` + `\n\n${stats.toString()}`));
-        }
-
-        return renderHTMLQueue(outputFile, pages, activity).then(() => {
-          // Remove the temp JS bundle file built for the static-site-generator-plugin
-          try {
-            fs.unlinkSync(outputFile);
-            fs.unlinkSync(`${outputFile}.map`);
-          } catch (e) {// This function will fail on Windows with no further consequences.
-          }
-
-          return resolve(null, stats);
-        }).catch(e => {
-          const prettyError = createErrorFromString(e.stack, `${outputFile}.map`);
-          prettyError.context = e.context;
-          reject(prettyError);
-        });
-      });
-    });
+const telemetry = require(`gatsby-telemetry`);
+
+const runWebpack = compilerConfig => new Promise((resolve, reject) => {
+  webpack(compilerConfig).run((err, stats) => {
+    if (err) {
+      reject(err);
+    } else {
+      resolve(stats);
+    }
+  });
+});
+
+const doBuildRenderer = async (program, webpackConfig) => {
+  const {
+    directory
+  } = program;
+  const stats = await runWebpack(webpackConfig); // render-page.js is hard coded in webpack.config
+
+  const outputFile = `${directory}/public/render-page.js`;
+
+  if (stats.hasErrors()) {
+    let webpackErrors = stats.toJson().errors.filter(Boolean);
+    const error = webpackErrors.length ? createErrorFromString(webpackErrors[0], `${outputFile}.map`) : new Error(`There was an issue while building the site: ` + `\n\n${stats.toString()}`);
+    throw error;
+  }
+
+  return outputFile;
+};
+
+const buildRenderer = async (program, stage) => {
+  const {
+    directory
+  } = program;
+  const config = await webpackConfig(program, directory, stage, null);
+  return await doBuildRenderer(program, config);
+};
+
+const deleteRenderer = async rendererPath => {
+  try {
+    await fs.remove(rendererPath);
+    await fs.remove(`${rendererPath}.map`);
+  } catch (e) {// This function will fail on Windows with no further consequences.
+  }
+};
+
+const doBuildPages = async ({
+  rendererPath,
+  pagePaths,
+  activity
+}) => {
+  telemetry.decorateEvent(`BUILD_END`, {
+    siteMeasurements: {
+      pagesCount: pagePaths.length
+    }
+  });
+
+  try {
+    await renderHTMLQueue(rendererPath, pagePaths, activity);
+  } catch (e) {
+    const prettyError = createErrorFromString(e.stack, `${rendererPath}.map`);
+    prettyError.context = e.context;
+    throw prettyError;
+  }
+};
+
+const buildPages = async ({
+  program,
+  stage,
+  pagePaths,
+  activity
+}) => {
+  const rendererPath = await buildRenderer(program, stage);
+  await doBuildPages({
+    rendererPath,
+    pagePaths,
+    activity
   });
+  await deleteRenderer(rendererPath);
+};
 
-  return function (_x, _x2) {
-    return _ref.apply(this, arguments);
-  };
-}();
+module.exports = {
+  buildPages
+};
 //# sourceMappingURL=build-html.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/commands/build-html.js.map b/node_modules/gatsby/dist/commands/build-html.js.map
index 7e2ce27..f7b904e 100644
--- a/node_modules/gatsby/dist/commands/build-html.js.map
+++ b/node_modules/gatsby/dist/commands/build-html.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/commands/build-html.js"],"names":["webpack","require","fs","debug","webpackConfig","store","createErrorFromString","renderHTMLQueue","module","exports","program","activity","directory","pages","Array","from","getState","values","page","path","compilerConfig","Promise","resolve","reject","run","e","stats","outputFile","hasErrors","webpackErrors","toJson","errors","filter","Boolean","length","Error","toString","then","unlinkSync","catch","prettyError","stack","context"],"mappings":";;;;;;AACA,MAAMA,OAAO,GAAGC,OAAO,CAAE,SAAF,CAAvB;;AACA,MAAMC,EAAE,GAAGD,OAAO,CAAE,IAAF,CAAlB;;AACA,MAAME,KAAK,GAAGF,OAAO,CAAE,OAAF,CAAP,CAAkB,aAAlB,CAAd;;AAEA,MAAMG,aAAa,GAAGH,OAAO,CAAE,yBAAF,CAA7B;;iBACkBA,OAAO,CAAE,UAAF,C;MAAjBI,K,YAAAA,K;;kBAC0BJ,OAAO,CAAE,gCAAF,C;MAAjCK,qB,aAAAA,qB;;AACR,MAAMC,eAAe,GAAGN,OAAO,CAAE,8BAAF,CAA/B;;AAEAO,MAAM,CAACC,OAAP;AAAA;AAAA;AAAA,6CAAiB,WAAOC,OAAP,EAAqBC,QAArB,EAAuC;AAAA,UAC9CC,SAD8C,GAChCF,OADgC,CAC9CE,SAD8C;AAGtDT,IAAAA,KAAK,CAAE,wBAAF,CAAL,CAHsD,CAItD;;AACA,UAAMU,KAAK,GAAGC,KAAK,CAACC,IAAN,CAAWV,KAAK,CAACW,QAAN,GAAiBH,KAAjB,CAAuBI,MAAvB,EAAX,EAA4CC,IAAI,IAAIA,IAAI,CAACC,IAAzD,CAAd,CALsD,CAOtD;;AACA,UAAMC,cAAc,SAAShB,aAAa,CACxCM,OADwC,EAExCE,SAFwC,EAGvC,YAHuC,EAIxC,IAJwC,CAA1C;AAOA,WAAO,IAAIS,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtCvB,MAAAA,OAAO,CAACoB,cAAD,CAAP,CAAwBI,GAAxB,CAA4B,CAACC,CAAD,EAAIC,KAAJ,KAAc;AACxC,YAAID,CAAJ,EAAO;AACL,iBAAOF,MAAM,CAACE,CAAD,CAAb;AACD;;AACD,cAAME,UAAU,GAAI,GAAEf,SAAU,wBAAhC;;AACA,YAAIc,KAAK,CAACE,SAAN,EAAJ,EAAuB;AACrB,cAAIC,aAAa,GAAGH,KAAK,CAACI,MAAN,GAAeC,MAAf,CAAsBC,MAAtB,CAA6BC,OAA7B,CAApB;AACA,iBAAOV,MAAM,CACXM,aAAa,CAACK,MAAd,GACI5B,qBAAqB,CAACuB,aAAa,CAAC,CAAD,CAAd,EAAoB,GAAEF,UAAW,MAAjC,CADzB,GAEI,IAAIQ,KAAJ,CACG,8CAAD,GACG,OAAMT,KAAK,CAACU,QAAN,EAAiB,EAF5B,CAHO,CAAb;AAQD;;AAED,eAAO7B,eAAe,CAACoB,UAAD,EAAad,KAAb,EAAoBF,QAApB,CAAf,CACJ0B,IADI,CACC,MAAM;AACV;AACA,cAAI;AACFnC,YAAAA,EAAE,CAACoC,UAAH,CAAcX,UAAd;AACAzB,YAAAA,EAAE,CAACoC,UAAH,CAAe,GAAEX,UAAW,MAA5B;AACD,WAHD,CAGE,OAAOF,CAAP,EAAU,CACV;AACD;;AACD,iBAAOH,OAAO,CAAC,IAAD,EAAOI,KAAP,CAAd;AACD,SAVI,EAWJa,KAXI,CAWEd,CAAC,IAAI;AACV,gBAAMe,WAAW,GAAGlC,qBAAqB,CACvCmB,CAAC,CAACgB,KADqC,EAEtC,GAAEd,UAAW,MAFyB,CAAzC;AAIAa,UAAAA,WAAW,CAACE,OAAZ,GAAsBjB,CAAC,CAACiB,OAAxB;AACAnB,UAAAA,MAAM,CAACiB,WAAD,CAAN;AACD,SAlBI,CAAP;AAmBD,OApCD;AAqCD,KAtCM,CAAP;AAuCD,GAtDD;;AAAA;AAAA;AAAA;AAAA","sourcesContent":["/* @flow */\nconst webpack = require(`webpack`)\nconst fs = require(`fs`)\nconst debug = require(`debug`)(`gatsby:html`)\n\nconst webpackConfig = require(`../utils/webpack.config`)\nconst { store } = require(`../redux`)\nconst { createErrorFromString } = require(`gatsby-cli/lib/reporter/errors`)\nconst renderHTMLQueue = require(`../utils/html-renderer-queue`)\n\nmodule.exports = async (program: any, activity: any) => {\n  const { directory } = program\n\n  debug(`generating static HTML`)\n  // Reduce pages objects to an array of paths.\n  const pages = Array.from(store.getState().pages.values(), page => page.path)\n\n  // Static site generation.\n  const compilerConfig = await webpackConfig(\n    program,\n    directory,\n    `build-html`,\n    null\n  )\n\n  return new Promise((resolve, reject) => {\n    webpack(compilerConfig).run((e, stats) => {\n      if (e) {\n        return reject(e)\n      }\n      const outputFile = `${directory}/public/render-page.js`\n      if (stats.hasErrors()) {\n        let webpackErrors = stats.toJson().errors.filter(Boolean)\n        return reject(\n          webpackErrors.length\n            ? createErrorFromString(webpackErrors[0], `${outputFile}.map`)\n            : new Error(\n                `There was an issue while building the site: ` +\n                  `\\n\\n${stats.toString()}`\n              )\n        )\n      }\n\n      return renderHTMLQueue(outputFile, pages, activity)\n        .then(() => {\n          // Remove the temp JS bundle file built for the static-site-generator-plugin\n          try {\n            fs.unlinkSync(outputFile)\n            fs.unlinkSync(`${outputFile}.map`)\n          } catch (e) {\n            // This function will fail on Windows with no further consequences.\n          }\n          return resolve(null, stats)\n        })\n        .catch(e => {\n          const prettyError = createErrorFromString(\n            e.stack,\n            `${outputFile}.map`\n          )\n          prettyError.context = e.context\n          reject(prettyError)\n        })\n    })\n  })\n}\n"],"file":"build-html.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/commands/build-html.js"],"names":["webpack","require","fs","webpackConfig","createErrorFromString","renderHTMLQueue","telemetry","runWebpack","compilerConfig","Promise","resolve","reject","run","err","stats","doBuildRenderer","program","directory","outputFile","hasErrors","webpackErrors","toJson","errors","filter","Boolean","error","length","Error","toString","buildRenderer","stage","config","deleteRenderer","rendererPath","remove","e","doBuildPages","pagePaths","activity","decorateEvent","siteMeasurements","pagesCount","prettyError","stack","context","buildPages","module","exports"],"mappings":"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","sourcesContent":["/* @flow */\nconst webpack = require(`webpack`)\nconst fs = require(`fs-extra`)\n\nconst webpackConfig = require(`../utils/webpack.config`)\nconst { createErrorFromString } = require(`gatsby-cli/lib/reporter/errors`)\nconst renderHTMLQueue = require(`../utils/html-renderer-queue`)\nconst telemetry = require(`gatsby-telemetry`)\n\nconst runWebpack = compilerConfig =>\n  new Promise((resolve, reject) => {\n    webpack(compilerConfig).run((err, stats) => {\n      if (err) {\n        reject(err)\n      } else {\n        resolve(stats)\n      }\n    })\n  })\n\nconst doBuildRenderer = async (program, webpackConfig) => {\n  const { directory } = program\n  const stats = await runWebpack(webpackConfig)\n  // render-page.js is hard coded in webpack.config\n  const outputFile = `${directory}/public/render-page.js`\n  if (stats.hasErrors()) {\n    let webpackErrors = stats.toJson().errors.filter(Boolean)\n    const error = webpackErrors.length\n      ? createErrorFromString(webpackErrors[0], `${outputFile}.map`)\n      : new Error(\n          `There was an issue while building the site: ` +\n            `\\n\\n${stats.toString()}`\n        )\n    throw error\n  }\n  return outputFile\n}\n\nconst buildRenderer = async (program, stage) => {\n  const { directory } = program\n  const config = await webpackConfig(program, directory, stage, null)\n  return await doBuildRenderer(program, config)\n}\n\nconst deleteRenderer = async rendererPath => {\n  try {\n    await fs.remove(rendererPath)\n    await fs.remove(`${rendererPath}.map`)\n  } catch (e) {\n    // This function will fail on Windows with no further consequences.\n  }\n}\n\nconst doBuildPages = async ({ rendererPath, pagePaths, activity }) => {\n  telemetry.decorateEvent(`BUILD_END`, {\n    siteMeasurements: { pagesCount: pagePaths.length },\n  })\n\n  try {\n    await renderHTMLQueue(rendererPath, pagePaths, activity)\n  } catch (e) {\n    const prettyError = createErrorFromString(e.stack, `${rendererPath}.map`)\n    prettyError.context = e.context\n    throw prettyError\n  }\n}\n\nconst buildPages = async ({ program, stage, pagePaths, activity }) => {\n  const rendererPath = await buildRenderer(program, stage)\n  await doBuildPages({ rendererPath, pagePaths, activity })\n  await deleteRenderer(rendererPath)\n}\n\nmodule.exports = {\n  buildPages,\n}\n"],"file":"build-html.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/commands/build-javascript.js b/node_modules/gatsby/dist/commands/build-javascript.js
index 12487b5..80e2aad 100644
--- a/node_modules/gatsby/dist/commands/build-javascript.js
+++ b/node_modules/gatsby/dist/commands/build-javascript.js
@@ -1,40 +1,30 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const webpack = require(`webpack`);
 
 const webpackConfig = require(`../utils/webpack.config`);
 
-module.exports =
-/*#__PURE__*/
-function () {
-  var _ref = (0, _asyncToGenerator2.default)(function* (program) {
-    const directory = program.directory;
-    const compilerConfig = yield webpackConfig(program, directory, `build-javascript`);
-    return new Promise((resolve, reject) => {
-      webpack(compilerConfig).run((err, stats) => {
-        if (err) {
-          reject(err);
-          return;
-        }
-
-        const jsonStats = stats.toJson();
-
-        if (jsonStats.errors && jsonStats.errors.length > 0) {
-          reject(jsonStats.errors);
-          return;
-        }
-
-        resolve();
-      });
+module.exports = async program => {
+  const {
+    directory
+  } = program;
+  const compilerConfig = await webpackConfig(program, directory, `build-javascript`);
+  return new Promise((resolve, reject) => {
+    webpack(compilerConfig).run((err, stats) => {
+      if (err) {
+        reject(err);
+        return;
+      }
+
+      const jsonStats = stats.toJson();
+
+      if (jsonStats.errors && jsonStats.errors.length > 0) {
+        reject(jsonStats.errors);
+        return;
+      }
+
+      resolve();
     });
   });
-
-  return function (_x) {
-    return _ref.apply(this, arguments);
-  };
-}();
+};
 //# sourceMappingURL=build-javascript.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/commands/build-javascript.js.map b/node_modules/gatsby/dist/commands/build-javascript.js.map
index 9a12ee1..a4224ba 100644
--- a/node_modules/gatsby/dist/commands/build-javascript.js.map
+++ b/node_modules/gatsby/dist/commands/build-javascript.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/commands/build-javascript.js"],"names":["webpack","require","webpackConfig","module","exports","program","directory","compilerConfig","Promise","resolve","reject","run","err","stats","jsonStats","toJson","errors","length"],"mappings":";;;;;;AACA,MAAMA,OAAO,GAAGC,OAAO,CAAE,SAAF,CAAvB;;AACA,MAAMC,aAAa,GAAGD,OAAO,CAAE,yBAAF,CAA7B;;AAEAE,MAAM,CAACC,OAAP;AAAA;AAAA;AAAA,6CAAiB,WAAMC,OAAN,EAAiB;AAAA,UACxBC,SADwB,GACVD,OADU,CACxBC,SADwB;AAGhC,UAAMC,cAAc,SAASL,aAAa,CACxCG,OADwC,EAExCC,SAFwC,EAGvC,kBAHuC,CAA1C;AAMA,WAAO,IAAIE,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtCV,MAAAA,OAAO,CAACO,cAAD,CAAP,CAAwBI,GAAxB,CAA4B,CAACC,GAAD,EAAMC,KAAN,KAAgB;AAC1C,YAAID,GAAJ,EAAS;AACPF,UAAAA,MAAM,CAACE,GAAD,CAAN;AACA;AACD;;AAED,cAAME,SAAS,GAAGD,KAAK,CAACE,MAAN,EAAlB;;AACA,YAAID,SAAS,CAACE,MAAV,IAAoBF,SAAS,CAACE,MAAV,CAAiBC,MAAjB,GAA0B,CAAlD,EAAqD;AACnDP,UAAAA,MAAM,CAACI,SAAS,CAACE,MAAX,CAAN;AACA;AACD;;AAEDP,QAAAA,OAAO;AACR,OAbD;AAcD,KAfM,CAAP;AAgBD,GAzBD;;AAAA;AAAA;AAAA;AAAA","sourcesContent":["/* @flow */\nconst webpack = require(`webpack`)\nconst webpackConfig = require(`../utils/webpack.config`)\n\nmodule.exports = async program => {\n  const { directory } = program\n\n  const compilerConfig = await webpackConfig(\n    program,\n    directory,\n    `build-javascript`\n  )\n\n  return new Promise((resolve, reject) => {\n    webpack(compilerConfig).run((err, stats) => {\n      if (err) {\n        reject(err)\n        return\n      }\n\n      const jsonStats = stats.toJson()\n      if (jsonStats.errors && jsonStats.errors.length > 0) {\n        reject(jsonStats.errors)\n        return\n      }\n\n      resolve()\n    })\n  })\n}\n"],"file":"build-javascript.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/commands/build-javascript.js"],"names":["webpack","require","webpackConfig","module","exports","program","directory","compilerConfig","Promise","resolve","reject","run","err","stats","jsonStats","toJson","errors","length"],"mappings":";;AACA,MAAMA,OAAO,GAAGC,OAAO,CAAE,SAAF,CAAvB;;AACA,MAAMC,aAAa,GAAGD,OAAO,CAAE,yBAAF,CAA7B;;AAEAE,MAAM,CAACC,OAAP,GAAiB,MAAMC,OAAN,IAAiB;AAChC,QAAM;AAAEC,IAAAA;AAAF,MAAgBD,OAAtB;AAEA,QAAME,cAAc,GAAG,MAAML,aAAa,CACxCG,OADwC,EAExCC,SAFwC,EAGvC,kBAHuC,CAA1C;AAMA,SAAO,IAAIE,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtCV,IAAAA,OAAO,CAACO,cAAD,CAAP,CAAwBI,GAAxB,CAA4B,CAACC,GAAD,EAAMC,KAAN,KAAgB;AAC1C,UAAID,GAAJ,EAAS;AACPF,QAAAA,MAAM,CAACE,GAAD,CAAN;AACA;AACD;;AAED,YAAME,SAAS,GAAGD,KAAK,CAACE,MAAN,EAAlB;;AACA,UAAID,SAAS,CAACE,MAAV,IAAoBF,SAAS,CAACE,MAAV,CAAiBC,MAAjB,GAA0B,CAAlD,EAAqD;AACnDP,QAAAA,MAAM,CAACI,SAAS,CAACE,MAAX,CAAN;AACA;AACD;;AAEDP,MAAAA,OAAO;AACR,KAbD;AAcD,GAfM,CAAP;AAgBD,CAzBD","sourcesContent":["/* @flow */\nconst webpack = require(`webpack`)\nconst webpackConfig = require(`../utils/webpack.config`)\n\nmodule.exports = async program => {\n  const { directory } = program\n\n  const compilerConfig = await webpackConfig(\n    program,\n    directory,\n    `build-javascript`\n  )\n\n  return new Promise((resolve, reject) => {\n    webpack(compilerConfig).run((err, stats) => {\n      if (err) {\n        reject(err)\n        return\n      }\n\n      const jsonStats = stats.toJson()\n      if (jsonStats.errors && jsonStats.errors.length > 0) {\n        reject(jsonStats.errors)\n        return\n      }\n\n      resolve()\n    })\n  })\n}\n"],"file":"build-javascript.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/commands/build.js b/node_modules/gatsby/dist/commands/build.js
index 7214cd1..60aceca 100644
--- a/node_modules/gatsby/dist/commands/build.js
+++ b/node_modules/gatsby/dist/commands/build.js
@@ -1,9 +1,5 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const report = require(`gatsby-cli/lib/reporter`);
 
 const buildHTML = require(`./build-html`);
@@ -14,74 +10,91 @@ const bootstrap = require(`../bootstrap`);
 
 const apiRunnerNode = require(`../utils/api-runner-node`);
 
-const _require = require(`../utils/get-static-dir`),
-      copyStaticDir = _require.copyStaticDir;
+const {
+  copyStaticDirs
+} = require(`../utils/get-static-dir`);
+
+const {
+  initTracer,
+  stopTracer
+} = require(`../utils/tracer`);
 
-const _require2 = require(`../utils/tracer`),
-      initTracer = _require2.initTracer,
-      stopTracer = _require2.stopTracer;
+const db = require(`../db`);
 
 const chalk = require(`chalk`);
 
 const tracer = require(`opentracing`).globalTracer();
 
+const signalExit = require(`signal-exit`);
+
+const telemetry = require(`gatsby-telemetry`);
+
+const {
+  store
+} = require(`../redux`);
+
 function reportFailure(msg, err) {
   report.log(``);
   report.panic(msg, err);
 }
 
-module.exports =
-/*#__PURE__*/
-function () {
-  var _build = (0, _asyncToGenerator2.default)(function* (program) {
-    initTracer(program.openTracingConfigFile);
-    const buildSpan = tracer.startSpan(`build`);
-    buildSpan.setTag(`directory`, program.directory);
-
-    const _ref = yield bootstrap(Object.assign({}, program, {
-      parentSpan: buildSpan
-    })),
-          graphqlRunner = _ref.graphqlRunner;
-
-    yield apiRunnerNode(`onPreBuild`, {
-      graphql: graphqlRunner,
-      parentSpan: buildSpan
-    }); // Copy files from the static directory to
-    // an equivalent static directory within public.
-
-    copyStaticDir();
-    let activity;
-    activity = report.activityTimer(`Building production JavaScript and CSS bundles`, {
-      parentSpan: buildSpan
-    });
-    activity.start();
-    yield buildProductionBundle(program).catch(err => {
-      reportFailure(`Generating JavaScript bundles failed`, err);
-    });
-    activity.end();
-    activity = report.activityTimer(`Building static HTML for pages`, {
-      parentSpan: buildSpan
+module.exports = async function build(program) {
+  initTracer(program.openTracingConfigFile);
+  telemetry.trackCli(`BUILD_START`);
+  signalExit(() => {
+    telemetry.trackCli(`BUILD_END`);
+  });
+  const buildSpan = tracer.startSpan(`build`);
+  buildSpan.setTag(`directory`, program.directory);
+  const {
+    graphqlRunner
+  } = await bootstrap({ ...program,
+    parentSpan: buildSpan
+  });
+  await db.saveState();
+  await apiRunnerNode(`onPreBuild`, {
+    graphql: graphqlRunner,
+    parentSpan: buildSpan
+  }); // Copy files from the static directory to
+  // an equivalent static directory within public.
+
+  copyStaticDirs();
+  let activity;
+  activity = report.activityTimer(`Building production JavaScript and CSS bundles`, {
+    parentSpan: buildSpan
+  });
+  activity.start();
+  await buildProductionBundle(program).catch(err => {
+    reportFailure(`Generating JavaScript bundles failed`, err);
+  });
+  activity.end();
+  activity = report.activityTimer(`Building static HTML for pages`, {
+    parentSpan: buildSpan
+  });
+  activity.start();
+
+  try {
+    await buildHTML.buildPages({
+      program,
+      stage: `build-html`,
+      pagePaths: [...store.getState().pages.keys()],
+      activity
     });
-    activity.start();
-    yield buildHTML(program, activity).catch(err => {
-      reportFailure(report.stripIndent`
+  } catch (err) {
+    reportFailure(report.stripIndent`
         Building static HTML failed${err.context && err.context.path ? ` for path "${chalk.bold(err.context.path)}"` : ``}
 
         See our docs page on debugging HTML builds for help https://gatsby.dev/debug-html
       `, err);
-    });
-    activity.end();
-    yield apiRunnerNode(`onPostBuild`, {
-      graphql: graphqlRunner,
-      parentSpan: buildSpan
-    });
-    report.info(`Done building in ${process.uptime()} sec`);
-    buildSpan.finish();
-    yield stopTracer();
-  });
+  }
 
-  return function build(_x) {
-    return _build.apply(this, arguments);
-  };
-}();
+  activity.end();
+  await apiRunnerNode(`onPostBuild`, {
+    graphql: graphqlRunner,
+    parentSpan: buildSpan
+  });
+  report.info(`Done building in ${process.uptime()} sec`);
+  buildSpan.finish();
+  await stopTracer();
+};
 //# sourceMappingURL=build.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/commands/build.js.map b/node_modules/gatsby/dist/commands/build.js.map
index c2ec84e..0833e74 100644
--- a/node_modules/gatsby/dist/commands/build.js.map
+++ b/node_modules/gatsby/dist/commands/build.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/commands/build.js"],"names":["report","require","buildHTML","buildProductionBundle","bootstrap","apiRunnerNode","copyStaticDir","initTracer","stopTracer","chalk","tracer","globalTracer","reportFailure","msg","err","log","panic","module","exports","program","openTracingConfigFile","buildSpan","startSpan","setTag","directory","parentSpan","graphqlRunner","graphql","activity","activityTimer","start","catch","end","stripIndent","context","path","bold","info","process","uptime","finish","build"],"mappings":"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","sourcesContent":["/* @flow */\n\nconst report = require(`gatsby-cli/lib/reporter`)\nconst buildHTML = require(`./build-html`)\nconst buildProductionBundle = require(`./build-javascript`)\nconst bootstrap = require(`../bootstrap`)\nconst apiRunnerNode = require(`../utils/api-runner-node`)\nconst { copyStaticDir } = require(`../utils/get-static-dir`)\nconst { initTracer, stopTracer } = require(`../utils/tracer`)\nconst chalk = require(`chalk`)\nconst tracer = require(`opentracing`).globalTracer()\n\nfunction reportFailure(msg, err: Error) {\n  report.log(``)\n  report.panic(msg, err)\n}\n\ntype BuildArgs = {\n  directory: string,\n  sitePackageJson: object,\n  prefixPaths: boolean,\n  noUglify: boolean,\n  openTracingConfigFile: string,\n}\n\nmodule.exports = async function build(program: BuildArgs) {\n  initTracer(program.openTracingConfigFile)\n\n  const buildSpan = tracer.startSpan(`build`)\n  buildSpan.setTag(`directory`, program.directory)\n\n  const { graphqlRunner } = await bootstrap({\n    ...program,\n    parentSpan: buildSpan,\n  })\n\n  await apiRunnerNode(`onPreBuild`, {\n    graphql: graphqlRunner,\n    parentSpan: buildSpan,\n  })\n\n  // Copy files from the static directory to\n  // an equivalent static directory within public.\n  copyStaticDir()\n\n  let activity\n  activity = report.activityTimer(\n    `Building production JavaScript and CSS bundles`,\n    { parentSpan: buildSpan }\n  )\n  activity.start()\n  await buildProductionBundle(program).catch(err => {\n    reportFailure(`Generating JavaScript bundles failed`, err)\n  })\n  activity.end()\n\n  activity = report.activityTimer(`Building static HTML for pages`, {\n    parentSpan: buildSpan,\n  })\n  activity.start()\n  await buildHTML(program, activity).catch(err => {\n    reportFailure(\n      report.stripIndent`\n        Building static HTML failed${\n          err.context && err.context.path\n            ? ` for path \"${chalk.bold(err.context.path)}\"`\n            : ``\n        }\n\n        See our docs page on debugging HTML builds for help https://gatsby.dev/debug-html\n      `,\n      err\n    )\n  })\n  activity.end()\n\n  await apiRunnerNode(`onPostBuild`, {\n    graphql: graphqlRunner,\n    parentSpan: buildSpan,\n  })\n\n  report.info(`Done building in ${process.uptime()} sec`)\n\n  buildSpan.finish()\n\n  await stopTracer()\n}\n"],"file":"build.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/commands/build.js"],"names":["report","require","buildHTML","buildProductionBundle","bootstrap","apiRunnerNode","copyStaticDirs","initTracer","stopTracer","db","chalk","tracer","globalTracer","signalExit","telemetry","store","reportFailure","msg","err","log","panic","module","exports","build","program","openTracingConfigFile","trackCli","buildSpan","startSpan","setTag","directory","graphqlRunner","parentSpan","saveState","graphql","activity","activityTimer","start","catch","end","buildPages","stage","pagePaths","getState","pages","keys","stripIndent","context","path","bold","info","process","uptime","finish"],"mappings":"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","sourcesContent":["/* @flow */\n\nconst report = require(`gatsby-cli/lib/reporter`)\nconst buildHTML = require(`./build-html`)\nconst buildProductionBundle = require(`./build-javascript`)\nconst bootstrap = require(`../bootstrap`)\nconst apiRunnerNode = require(`../utils/api-runner-node`)\nconst { copyStaticDirs } = require(`../utils/get-static-dir`)\nconst { initTracer, stopTracer } = require(`../utils/tracer`)\nconst db = require(`../db`)\nconst chalk = require(`chalk`)\nconst tracer = require(`opentracing`).globalTracer()\nconst signalExit = require(`signal-exit`)\nconst telemetry = require(`gatsby-telemetry`)\nconst { store } = require(`../redux`)\n\nfunction reportFailure(msg, err: Error) {\n  report.log(``)\n  report.panic(msg, err)\n}\n\ntype BuildArgs = {\n  directory: string,\n  sitePackageJson: object,\n  prefixPaths: boolean,\n  noUglify: boolean,\n  openTracingConfigFile: string,\n}\n\nmodule.exports = async function build(program: BuildArgs) {\n  initTracer(program.openTracingConfigFile)\n\n  telemetry.trackCli(`BUILD_START`)\n  signalExit(() => {\n    telemetry.trackCli(`BUILD_END`)\n  })\n\n  const buildSpan = tracer.startSpan(`build`)\n  buildSpan.setTag(`directory`, program.directory)\n\n  const { graphqlRunner } = await bootstrap({\n    ...program,\n    parentSpan: buildSpan,\n  })\n\n  await db.saveState()\n\n  await apiRunnerNode(`onPreBuild`, {\n    graphql: graphqlRunner,\n    parentSpan: buildSpan,\n  })\n\n  // Copy files from the static directory to\n  // an equivalent static directory within public.\n  copyStaticDirs()\n\n  let activity\n  activity = report.activityTimer(\n    `Building production JavaScript and CSS bundles`,\n    { parentSpan: buildSpan }\n  )\n  activity.start()\n  await buildProductionBundle(program).catch(err => {\n    reportFailure(`Generating JavaScript bundles failed`, err)\n  })\n  activity.end()\n\n  activity = report.activityTimer(`Building static HTML for pages`, {\n    parentSpan: buildSpan,\n  })\n  activity.start()\n  try {\n    await buildHTML.buildPages({\n      program,\n      stage: `build-html`,\n      pagePaths: [...store.getState().pages.keys()],\n      activity,\n    })\n  } catch (err) {\n    reportFailure(\n      report.stripIndent`\n        Building static HTML failed${\n          err.context && err.context.path\n            ? ` for path \"${chalk.bold(err.context.path)}\"`\n            : ``\n        }\n\n        See our docs page on debugging HTML builds for help https://gatsby.dev/debug-html\n      `,\n      err\n    )\n  }\n  activity.end()\n\n  await apiRunnerNode(`onPostBuild`, {\n    graphql: graphqlRunner,\n    parentSpan: buildSpan,\n  })\n\n  report.info(`Done building in ${process.uptime()} sec`)\n\n  buildSpan.finish()\n  await stopTracer()\n}\n"],"file":"build.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/commands/clean.js b/node_modules/gatsby/dist/commands/clean.js
index 3fd176e..343b545 100644
--- a/node_modules/gatsby/dist/commands/clean.js
+++ b/node_modules/gatsby/dist/commands/clean.js
@@ -1,27 +1,17 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const fs = require(`fs-extra`);
 
 const path = require(`path`);
 
-module.exports =
-/*#__PURE__*/
-function () {
-  var _clean = (0, _asyncToGenerator2.default)(function* (args) {
-    const directory = args.directory,
-          report = args.report;
-    const directories = [`.cache`, `public`];
-    report.info(`Deleting ${directories.join(`, `)}`);
-    yield Promise.all(directories.map(dir => fs.remove(path.join(directory, dir))));
-    report.info(`Successfully deleted directories`);
-  });
-
-  return function clean(_x) {
-    return _clean.apply(this, arguments);
-  };
-}();
+module.exports = async function clean(args) {
+  const {
+    directory,
+    report
+  } = args;
+  const directories = [`.cache`, `public`];
+  report.info(`Deleting ${directories.join(`, `)}`);
+  await Promise.all(directories.map(dir => fs.remove(path.join(directory, dir))));
+  report.info(`Successfully deleted directories`);
+};
 //# sourceMappingURL=clean.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/commands/clean.js.map b/node_modules/gatsby/dist/commands/clean.js.map
index fa5f100..e6903e0 100644
--- a/node_modules/gatsby/dist/commands/clean.js.map
+++ b/node_modules/gatsby/dist/commands/clean.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/commands/clean.js"],"names":["fs","require","path","module","exports","args","directory","report","directories","info","join","Promise","all","map","dir","remove","clean"],"mappings":";;;;;;AAAA,MAAMA,EAAE,GAAGC,OAAO,CAAE,UAAF,CAAlB;;AACA,MAAMC,IAAI,GAAGD,OAAO,CAAE,MAAF,CAApB;;AAEAE,MAAM,CAACC,OAAP;AAAA;AAAA;AAAA,+CAAiB,WAAqBC,IAArB,EAA2B;AAAA,UAClCC,SADkC,GACZD,IADY,CAClCC,SADkC;AAAA,UACvBC,MADuB,GACZF,IADY,CACvBE,MADuB;AAG1C,UAAMC,WAAW,GAAG,CAAE,QAAF,EAAY,QAAZ,CAApB;AAEAD,IAAAA,MAAM,CAACE,IAAP,CAAa,YAAWD,WAAW,CAACE,IAAZ,CAAkB,IAAlB,CAAuB,EAA/C;AAEA,UAAMC,OAAO,CAACC,GAAR,CACJJ,WAAW,CAACK,GAAZ,CAAgBC,GAAG,IAAId,EAAE,CAACe,MAAH,CAAUb,IAAI,CAACQ,IAAL,CAAUJ,SAAV,EAAqBQ,GAArB,CAAV,CAAvB,CADI,CAAN;AAIAP,IAAAA,MAAM,CAACE,IAAP,CAAa,kCAAb;AACD,GAZD;;AAAA,kBAAgCO,KAAhC;AAAA;AAAA;AAAA","sourcesContent":["const fs = require(`fs-extra`)\nconst path = require(`path`)\n\nmodule.exports = async function clean(args) {\n  const { directory, report } = args\n\n  const directories = [`.cache`, `public`]\n\n  report.info(`Deleting ${directories.join(`, `)}`)\n\n  await Promise.all(\n    directories.map(dir => fs.remove(path.join(directory, dir)))\n  )\n\n  report.info(`Successfully deleted directories`)\n}\n"],"file":"clean.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/commands/clean.js"],"names":["fs","require","path","module","exports","clean","args","directory","report","directories","info","join","Promise","all","map","dir","remove"],"mappings":";;AAAA,MAAMA,EAAE,GAAGC,OAAO,CAAE,UAAF,CAAlB;;AACA,MAAMC,IAAI,GAAGD,OAAO,CAAE,MAAF,CAApB;;AAEAE,MAAM,CAACC,OAAP,GAAiB,eAAeC,KAAf,CAAqBC,IAArB,EAA2B;AAC1C,QAAM;AAAEC,IAAAA,SAAF;AAAaC,IAAAA;AAAb,MAAwBF,IAA9B;AAEA,QAAMG,WAAW,GAAG,CAAE,QAAF,EAAY,QAAZ,CAApB;AAEAD,EAAAA,MAAM,CAACE,IAAP,CAAa,YAAWD,WAAW,CAACE,IAAZ,CAAkB,IAAlB,CAAuB,EAA/C;AAEA,QAAMC,OAAO,CAACC,GAAR,CACJJ,WAAW,CAACK,GAAZ,CAAgBC,GAAG,IAAIf,EAAE,CAACgB,MAAH,CAAUd,IAAI,CAACS,IAAL,CAAUJ,SAAV,EAAqBQ,GAArB,CAAV,CAAvB,CADI,CAAN;AAIAP,EAAAA,MAAM,CAACE,IAAP,CAAa,kCAAb;AACD,CAZD","sourcesContent":["const fs = require(`fs-extra`)\nconst path = require(`path`)\n\nmodule.exports = async function clean(args) {\n  const { directory, report } = args\n\n  const directories = [`.cache`, `public`]\n\n  report.info(`Deleting ${directories.join(`, `)}`)\n\n  await Promise.all(\n    directories.map(dir => fs.remove(path.join(directory, dir)))\n  )\n\n  report.info(`Successfully deleted directories`)\n}\n"],"file":"clean.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/commands/data-explorer.js b/node_modules/gatsby/dist/commands/data-explorer.js
index 503c9ed..ff2f0e5 100644
--- a/node_modules/gatsby/dist/commands/data-explorer.js
+++ b/node_modules/gatsby/dist/commands/data-explorer.js
@@ -1,39 +1,30 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const express = require(`express`);
 
 const graphqlHTTP = require(`express-graphql`);
 
-const _require = require(`../redux`),
-      store = _require.store;
+const {
+  store
+} = require(`../redux`);
 
 const bootstrap = require(`../bootstrap`);
 
-module.exports =
-/*#__PURE__*/
-function () {
-  var _ref = (0, _asyncToGenerator2.default)(function* (program) {
-    let port = program.port,
-        host = program.host;
-    port = typeof port === `string` ? parseInt(port, 10) : port; // bootstrap to ensure schema is in the store
-
-    yield bootstrap(program);
-    const schema = store.getState().schema;
-    const app = express();
-    app.use(`/`, graphqlHTTP({
-      schema,
-      graphiql: true
-    }));
-    console.log(`Gatsby data explorer running at`, `http://${host}:${port}`);
-    app.listen(port, host);
-  });
-
-  return function (_x) {
-    return _ref.apply(this, arguments);
-  };
-}();
+module.exports = async program => {
+  let {
+    port,
+    host
+  } = program;
+  port = typeof port === `string` ? parseInt(port, 10) : port; // bootstrap to ensure schema is in the store
+
+  await bootstrap(program);
+  const schema = store.getState().schema;
+  const app = express();
+  app.use(`/`, graphqlHTTP({
+    schema,
+    graphiql: true
+  }));
+  console.log(`Gatsby data explorer running at`, `http://${host}:${port}`);
+  app.listen(port, host);
+};
 //# sourceMappingURL=data-explorer.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/commands/data-explorer.js.map b/node_modules/gatsby/dist/commands/data-explorer.js.map
index 5a043ca..5319bfe 100644
--- a/node_modules/gatsby/dist/commands/data-explorer.js.map
+++ b/node_modules/gatsby/dist/commands/data-explorer.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/commands/data-explorer.js"],"names":["express","require","graphqlHTTP","store","bootstrap","module","exports","program","port","host","parseInt","schema","getState","app","use","graphiql","console","log","listen"],"mappings":";;;;;;AAEA,MAAMA,OAAO,GAAGC,OAAO,CAAE,SAAF,CAAvB;;AACA,MAAMC,WAAW,GAAGD,OAAO,CAAE,iBAAF,CAA3B;;iBACkBA,OAAO,CAAE,UAAF,C;MAAjBE,K,YAAAA,K;;AACR,MAAMC,SAAS,GAAGH,OAAO,CAAE,cAAF,CAAzB;;AAEAI,MAAM,CAACC,OAAP;AAAA;AAAA;AAAA,6CAAiB,WAAOC,OAAP,EAAwB;AAAA,QACjCC,IADiC,GAClBD,OADkB,CACjCC,IADiC;AAAA,QAC3BC,IAD2B,GAClBF,OADkB,CAC3BE,IAD2B;AAEvCD,IAAAA,IAAI,GAAG,OAAOA,IAAP,KAAiB,QAAjB,GAA2BE,QAAQ,CAACF,IAAD,EAAO,EAAP,CAAnC,GAAgDA,IAAvD,CAFuC,CAIvC;;AACA,UAAMJ,SAAS,CAACG,OAAD,CAAf;AAEA,UAAMI,MAAM,GAAGR,KAAK,CAACS,QAAN,GAAiBD,MAAhC;AAEA,UAAME,GAAG,GAAGb,OAAO,EAAnB;AACAa,IAAAA,GAAG,CAACC,GAAJ,CACG,GADH,EAEEZ,WAAW,CAAC;AACVS,MAAAA,MADU;AAEVI,MAAAA,QAAQ,EAAE;AAFA,KAAD,CAFb;AAQAC,IAAAA,OAAO,CAACC,GAAR,CAAa,iCAAb,EAAgD,UAASR,IAAK,IAAGD,IAAK,EAAtE;AACAK,IAAAA,GAAG,CAACK,MAAJ,CAAWV,IAAX,EAAiBC,IAAjB;AACD,GApBD;;AAAA;AAAA;AAAA;AAAA","sourcesContent":["/* @flow */\n\nconst express = require(`express`)\nconst graphqlHTTP = require(`express-graphql`)\nconst { store } = require(`../redux`)\nconst bootstrap = require(`../bootstrap`)\n\nmodule.exports = async (program: any) => {\n  let { port, host } = program\n  port = typeof port === `string` ? parseInt(port, 10) : port\n\n  // bootstrap to ensure schema is in the store\n  await bootstrap(program)\n\n  const schema = store.getState().schema\n\n  const app = express()\n  app.use(\n    `/`,\n    graphqlHTTP({\n      schema,\n      graphiql: true,\n    })\n  )\n\n  console.log(`Gatsby data explorer running at`, `http://${host}:${port}`)\n  app.listen(port, host)\n}\n"],"file":"data-explorer.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/commands/data-explorer.js"],"names":["express","require","graphqlHTTP","store","bootstrap","module","exports","program","port","host","parseInt","schema","getState","app","use","graphiql","console","log","listen"],"mappings":";;AAEA,MAAMA,OAAO,GAAGC,OAAO,CAAE,SAAF,CAAvB;;AACA,MAAMC,WAAW,GAAGD,OAAO,CAAE,iBAAF,CAA3B;;AACA,MAAM;AAAEE,EAAAA;AAAF,IAAYF,OAAO,CAAE,UAAF,CAAzB;;AACA,MAAMG,SAAS,GAAGH,OAAO,CAAE,cAAF,CAAzB;;AAEAI,MAAM,CAACC,OAAP,GAAiB,MAAOC,OAAP,IAAwB;AACvC,MAAI;AAAEC,IAAAA,IAAF;AAAQC,IAAAA;AAAR,MAAiBF,OAArB;AACAC,EAAAA,IAAI,GAAG,OAAOA,IAAP,KAAiB,QAAjB,GAA2BE,QAAQ,CAACF,IAAD,EAAO,EAAP,CAAnC,GAAgDA,IAAvD,CAFuC,CAIvC;;AACA,QAAMJ,SAAS,CAACG,OAAD,CAAf;AAEA,QAAMI,MAAM,GAAGR,KAAK,CAACS,QAAN,GAAiBD,MAAhC;AAEA,QAAME,GAAG,GAAGb,OAAO,EAAnB;AACAa,EAAAA,GAAG,CAACC,GAAJ,CACG,GADH,EAEEZ,WAAW,CAAC;AACVS,IAAAA,MADU;AAEVI,IAAAA,QAAQ,EAAE;AAFA,GAAD,CAFb;AAQAC,EAAAA,OAAO,CAACC,GAAR,CAAa,iCAAb,EAAgD,UAASR,IAAK,IAAGD,IAAK,EAAtE;AACAK,EAAAA,GAAG,CAACK,MAAJ,CAAWV,IAAX,EAAiBC,IAAjB;AACD,CApBD","sourcesContent":["/* @flow */\n\nconst express = require(`express`)\nconst graphqlHTTP = require(`express-graphql`)\nconst { store } = require(`../redux`)\nconst bootstrap = require(`../bootstrap`)\n\nmodule.exports = async (program: any) => {\n  let { port, host } = program\n  port = typeof port === `string` ? parseInt(port, 10) : port\n\n  // bootstrap to ensure schema is in the store\n  await bootstrap(program)\n\n  const schema = store.getState().schema\n\n  const app = express()\n  app.use(\n    `/`,\n    graphqlHTTP({\n      schema,\n      graphiql: true,\n    })\n  )\n\n  console.log(`Gatsby data explorer running at`, `http://${host}:${port}`)\n  app.listen(port, host)\n}\n"],"file":"data-explorer.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/commands/develop.js b/node_modules/gatsby/dist/commands/develop.js
index 5e10445..27e808f 100644
--- a/node_modules/gatsby/dist/commands/develop.js
+++ b/node_modules/gatsby/dist/commands/develop.js
@@ -1,9 +1,5 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const url = require(`url`);
 
 const glob = require(`glob`);
@@ -20,8 +16,9 @@ const graphqlHTTP = require(`express-graphql`);
 
 const graphqlPlayground = require(`graphql-playground-middleware-express`).default;
 
-const _require = require(`graphql`),
-      formatError = _require.formatError;
+const {
+  formatError
+} = require(`graphql`);
 
 const request = require(`request`);
 
@@ -33,16 +30,19 @@ const webpackConfig = require(`../utils/webpack.config`);
 
 const bootstrap = require(`../bootstrap`);
 
-const _require2 = require(`../redux`),
-      store = _require2.store;
+const {
+  store
+} = require(`../redux`);
 
-const _require3 = require(`../utils/get-static-dir`),
-      syncStaticDir = _require3.syncStaticDir;
+const {
+  syncStaticDir
+} = require(`../utils/get-static-dir`);
 
-const developHtml = require(`./develop-html`);
+const buildHTML = require(`./build-html`);
 
-const _require4 = require(`../utils/path`),
-      withBasePath = _require4.withBasePath;
+const {
+  withBasePath
+} = require(`../utils/path`);
 
 const report = require(`gatsby-cli/lib/reporter`);
 
@@ -64,10 +64,25 @@ const getSslCert = require(`../utils/get-ssl-cert`);
 
 const slash = require(`slash`);
 
-const _require5 = require(`../utils/tracer`),
-      initTracer = _require5.initTracer;
+const {
+  initTracer
+} = require(`../utils/tracer`);
+
+const apiRunnerNode = require(`../utils/api-runner-node`);
+
+const db = require(`../db`);
+
+const telemetry = require(`gatsby-telemetry`);
+
+const detectPortInUseAndPrompt = require(`../utils/detect-port-in-use-and-prompt`);
+
+const onExit = require(`signal-exit`);
+
+const pageQueryRunner = require(`../query/page-query-runner`);
+
+const queryQueue = require(`../query/queue`);
 
-const apiRunnerNode = require(`../utils/api-runner-node`); // const isInteractive = process.stdout.isTTY
+const queryWatcher = require(`../query/query-watcher`); // const isInteractive = process.stdout.isTTY
 // Watch the static directory and copy files to public as they're added or
 // changed. Wait 10 seconds so copying doesn't interfere with the regular
 // bootstrap.
@@ -84,17 +99,22 @@ const rlInterface = rl.createInterface({
 rlInterface.on(`SIGINT`, () => {
   process.exit();
 });
+onExit(() => {
+  telemetry.trackCli(`DEVELOP_STOP`);
+});
 
-function startServer(_x) {
-  return _startServer.apply(this, arguments);
-}
-
-function _startServer() {
-  _startServer = (0, _asyncToGenerator2.default)(function* (program) {
-    const directory = program.directory;
-    const directoryPath = withBasePath(directory);
+async function startServer(program) {
+  const directory = program.directory;
+  const directoryPath = withBasePath(directory);
 
-    const createIndexHtml = () => developHtml(program).catch(err => {
+  const createIndexHtml = async () => {
+    try {
+      await buildHTML.buildPages({
+        program,
+        stage: `develop-html`,
+        pagePaths: [`/`]
+      });
+    } catch (err) {
       if (err.name !== `WebpackError`) {
         report.panic(err);
         return;
@@ -105,376 +125,348 @@ function _startServer() {
 
           See our docs page on debugging HTML builds for help https://gatsby.dev/debug-html
         `, err);
-    }); // Start bootstrap process.
-
-
-    yield bootstrap(program);
-    yield createIndexHtml();
-    const devConfig = yield webpackConfig(program, directory, `develop`, program.port);
-    const compiler = webpack(devConfig);
-    /**
-     * Set up the express app.
-     **/
-
-    const app = express();
-    app.use(require(`webpack-hot-middleware`)(compiler, {
-      log: false,
-      path: `/__webpack_hmr`,
-      heartbeat: 10 * 1000
-    }));
-
-    if (process.env.GATSBY_GRAPHQL_IDE === `playground`) {
-      app.get(`/___graphql`, graphqlPlayground({
-        endpoint: `/___graphql`
-      }), () => {});
     }
-
-    app.use(`/___graphql`, graphqlHTTP(() => {
-      const schema = store.getState().schema;
-      return {
-        schema,
-        graphiql: process.env.GATSBY_GRAPHQL_IDE === `playground` ? false : true,
-        context: withResolverContext({}, schema),
-
-        formatError(err) {
-          return Object.assign({}, formatError(err), {
-            stack: err.stack ? err.stack.split(`\n`) : []
-          });
-        }
-
-      };
-    })); // Allow requests from any origin. Avoids CORS issues when using the `--host` flag.
-
-    app.use((req, res, next) => {
-      res.header(`Access-Control-Allow-Origin`, `*`);
-      res.header(`Access-Control-Allow-Headers`, `Origin, X-Requested-With, Content-Type, Accept`);
-      next();
-    });
-    /**
-     * Refresh external data sources.
-     * This behavior is disabled by default, but the ENABLE_REFRESH_ENDPOINT env var enables it
-     * If no GATSBY_REFRESH_TOKEN env var is available, then no Authorization header is required
-     **/
-
-    app.post(`/__refresh`, (req, res) => {
-      const enableRefresh = process.env.ENABLE_GATSBY_REFRESH_ENDPOINT;
-      const refreshToken = process.env.GATSBY_REFRESH_TOKEN;
-      const authorizedRefresh = !refreshToken || req.headers.authorization === refreshToken;
-
-      if (enableRefresh && authorizedRefresh) {
-        console.log(`Refreshing source data`);
-        sourceNodes();
+  }; // Start bootstrap process.
+
+
+  await bootstrap(program);
+  db.startAutosave();
+  pageQueryRunner.startListening(queryQueue.makeDevelop());
+  queryWatcher.startWatchDeletePage();
+  await createIndexHtml();
+  const devConfig = await webpackConfig(program, directory, `develop`, program.port);
+  const compiler = webpack(devConfig);
+  /**
+   * Set up the express app.
+   **/
+
+  const app = express();
+  app.use(telemetry.expressMiddleware(`DEVELOP`));
+  app.use(require(`webpack-hot-middleware`)(compiler, {
+    log: false,
+    path: `/__webpack_hmr`,
+    heartbeat: 10 * 1000
+  }));
+
+  if (process.env.GATSBY_GRAPHQL_IDE === `playground`) {
+    app.get(`/___graphql`, graphqlPlayground({
+      endpoint: `/___graphql`
+    }), () => {});
+  }
+
+  app.use(`/___graphql`, graphqlHTTP(() => {
+    const schema = store.getState().schema;
+    return {
+      schema,
+      graphiql: process.env.GATSBY_GRAPHQL_IDE === `playground` ? false : true,
+      context: withResolverContext({}, schema),
+
+      formatError(err) {
+        return { ...formatError(err),
+          stack: err.stack ? err.stack.split(`\n`) : []
+        };
       }
 
-      res.end();
-    });
-    app.get(`/__open-stack-frame-in-editor`, (req, res) => {
-      launchEditor(req.query.fileName, req.query.lineNumber);
-      res.end();
-    }); // Disable directory indexing i.e. serving index.html from a directory.
-    // This can lead to serving stale html files during development.
-    //
-    // We serve by default an empty index.html that sets up the dev environment.
-
-    app.use(require(`./develop-static`)(`public`, {
-      index: false
-    }));
-    app.use(require(`webpack-dev-middleware`)(compiler, {
-      logLevel: `trace`,
-      publicPath: devConfig.output.publicPath,
-      stats: `errors-only`
-    })); // Expose access to app for advanced use cases
-
-    const developMiddleware = store.getState().config.developMiddleware;
-
-    if (developMiddleware) {
-      developMiddleware(app);
-    } // Set up API proxy.
-
-
-    const proxy = store.getState().config.proxy;
-
-    if (proxy) {
-      const prefix = proxy.prefix,
-            url = proxy.url;
-      app.use(`${prefix}/*`, (req, res) => {
-        const proxiedUrl = url + req.originalUrl;
-        req.pipe(request(proxiedUrl).on(`error`, err => {
-          const message = `Error when trying to proxy request "${req.originalUrl}" to "${proxiedUrl}"`;
-          report.error(message, err);
-          res.status(500).end();
-        })).pipe(res);
-      });
-    }
+    };
+  })); // Allow requests from any origin. Avoids CORS issues when using the `--host` flag.
 
-    yield apiRunnerNode(`onCreateDevServer`, {
-      app
-    }); // Render an HTML page and serve it.
+  app.use((req, res, next) => {
+    res.header(`Access-Control-Allow-Origin`, `*`);
+    res.header(`Access-Control-Allow-Headers`, `Origin, X-Requested-With, Content-Type, Accept`);
+    next();
+  });
+  /**
+   * Refresh external data sources.
+   * This behavior is disabled by default, but the ENABLE_REFRESH_ENDPOINT env var enables it
+   * If no GATSBY_REFRESH_TOKEN env var is available, then no Authorization header is required
+   **/
+
+  app.post(`/__refresh`, (req, res) => {
+    const enableRefresh = process.env.ENABLE_GATSBY_REFRESH_ENDPOINT;
+    const refreshToken = process.env.GATSBY_REFRESH_TOKEN;
+    const authorizedRefresh = !refreshToken || req.headers.authorization === refreshToken;
+
+    if (enableRefresh && authorizedRefresh) {
+      console.log(`Refreshing source data`);
+      sourceNodes();
+    }
 
-    app.use((req, res, next) => {
-      res.sendFile(directoryPath(`public/index.html`), err => {
-        if (err) {
-          res.status(500).end();
-        }
-      });
+    res.end();
+  });
+  app.get(`/__open-stack-frame-in-editor`, (req, res) => {
+    launchEditor(req.query.fileName, req.query.lineNumber);
+    res.end();
+  }); // Disable directory indexing i.e. serving index.html from a directory.
+  // This can lead to serving stale html files during development.
+  //
+  // We serve by default an empty index.html that sets up the dev environment.
+
+  app.use(require(`./develop-static`)(`public`, {
+    index: false
+  }));
+  app.use(require(`webpack-dev-middleware`)(compiler, {
+    logLevel: `trace`,
+    publicPath: devConfig.output.publicPath,
+    stats: `errors-only`
+  })); // Expose access to app for advanced use cases
+
+  const {
+    developMiddleware
+  } = store.getState().config;
+
+  if (developMiddleware) {
+    developMiddleware(app);
+  } // Set up API proxy.
+
+
+  const {
+    proxy
+  } = store.getState().config;
+
+  if (proxy) {
+    const {
+      prefix,
+      url
+    } = proxy;
+    app.use(`${prefix}/*`, (req, res) => {
+      const proxiedUrl = url + req.originalUrl;
+      req.pipe(request(proxiedUrl).on(`error`, err => {
+        const message = `Error when trying to proxy request "${req.originalUrl}" to "${proxiedUrl}"`;
+        report.error(message, err);
+        res.status(500).end();
+      })).pipe(res);
     });
-    /**
-     * Set up the HTTP server and socket.io.
-     **/
-
-    let server = require(`http`).Server(app); // If a SSL cert exists in program, use it with `createServer`.
+  }
 
+  await apiRunnerNode(`onCreateDevServer`, {
+    app
+  }); // Render an HTML page and serve it.
 
-    if (program.ssl) {
-      server = require(`https`).createServer(program.ssl, app);
-    }
-
-    websocketManager.init({
-      server,
-      directory: program.directory
-    });
-    const socket = websocketManager.getSocket();
-    const listener = server.listen(program.port, program.host, err => {
+  app.use((req, res, next) => {
+    res.sendFile(directoryPath(`public/index.html`), err => {
       if (err) {
-        if (err.code === `EADDRINUSE`) {
-          // eslint-disable-next-line max-len
-          report.panic(`Unable to start Gatsby on port ${program.port} as there's already a process listening on that port.`);
-          return;
-        }
-
-        report.panic(`There was a problem starting the development server`, err);
+        res.status(500).end();
       }
-    }); // Register watcher that rebuilds index.html every time html.js changes.
-
-    const watchGlobs = [`src/html.js`, `plugins/**/gatsby-ssr.js`].map(path => slash(directoryPath(path)));
-    chokidar.watch(watchGlobs).on(`change`,
-    /*#__PURE__*/
-    (0, _asyncToGenerator2.default)(function* () {
-      yield createIndexHtml();
-      socket.to(`clients`).emit(`reload`);
-    }));
-    return [compiler, listener];
+    });
   });
-  return _startServer.apply(this, arguments);
-}
+  /**
+   * Set up the HTTP server and socket.io.
+   **/
 
-module.exports =
-/*#__PURE__*/
-function () {
-  var _ref = (0, _asyncToGenerator2.default)(function* (program) {
-    initTracer(program.openTracingConfigFile);
+  let server = require(`http`).Server(app); // If a SSL cert exists in program, use it with `createServer`.
 
-    const detect = require(`detect-port`);
 
-    const port = typeof program.port === `string` ? parseInt(program.port, 10) : program.port; // In order to enable custom ssl, --cert-file --key-file and -https flags must all be
-    // used together
-
-    if ((program[`cert-file`] || program[`key-file`]) && !program.https) {
-      report.panic(`for custom ssl --https, --cert-file, and --key-file must be used together`);
-    } // Check if https is enabled, then create or get SSL cert.
-    // Certs are named after `name` inside the project's package.json.
-    // Scoped names are converted from @npm/package-name to npm--package-name
+  if (program.ssl) {
+    server = require(`https`).createServer(program.ssl, app);
+  }
 
+  websocketManager.init({
+    server,
+    directory: program.directory
+  });
+  const socket = websocketManager.getSocket();
+  const listener = server.listen(program.port, program.host, err => {
+    if (err) {
+      if (err.code === `EADDRINUSE`) {
+        // eslint-disable-next-line max-len
+        report.panic(`Unable to start Gatsby on port ${program.port} as there's already a process listening on that port.`);
+        return;
+      }
 
-    if (program.https) {
-      program.ssl = yield getSslCert({
-        name: program.sitePackageJson.name.replace(`@`, ``).replace(`/`, `--`),
-        certFile: program[`cert-file`],
-        keyFile: program[`key-file`],
-        directory: program.directory
-      });
+      report.panic(`There was a problem starting the development server`, err);
     }
+  }); // Register watcher that rebuilds index.html every time html.js changes.
 
-    let compiler;
-    yield new Promise(resolve => {
-      detect(port, (err, _port) => {
-        if (err) {
-          report.panic(err);
-        }
+  const watchGlobs = [`src/html.js`, `plugins/**/gatsby-ssr.js`].map(path => slash(directoryPath(path)));
+  chokidar.watch(watchGlobs).on(`change`, async () => {
+    await createIndexHtml();
+    socket.to(`clients`).emit(`reload`);
+  });
+  return [compiler, listener];
+}
 
-        if (port !== _port) {
-          // eslint-disable-next-line max-len
-          const question = `Something is already running at port ${port} \nWould you like to run the app at another port instead? [Y/n] `;
-          rlInterface.question(question, answer => {
-            if (answer.length === 0 || answer.match(/^yes|y$/i)) {
-              program.port = _port; // eslint-disable-line no-param-reassign
-            }
-
-            startServer(program).then(([c, l]) => {
-              compiler = c;
-              resolve();
-            });
-          });
-        } else {
-          startServer(program).then(([c, l]) => {
-            compiler = c;
-            resolve();
-          });
-        }
-      });
+module.exports = async program => {
+  initTracer(program.openTracingConfigFile);
+  telemetry.trackCli(`DEVELOP_START`);
+  telemetry.startBackgroundUpdate();
+  const port = typeof program.port === `string` ? parseInt(program.port, 10) : program.port; // In order to enable custom ssl, --cert-file --key-file and -https flags must all be
+  // used together
+
+  if ((program[`cert-file`] || program[`key-file`]) && !program.https) {
+    report.panic(`for custom ssl --https, --cert-file, and --key-file must be used together`);
+  } // Check if https is enabled, then create or get SSL cert.
+  // Certs are named after `name` inside the project's package.json.
+  // Scoped names are converted from @npm/package-name to npm--package-name
+
+
+  if (program.https) {
+    program.ssl = await getSslCert({
+      name: program.sitePackageJson.name.replace(`@`, ``).replace(`/`, `--`),
+      certFile: program[`cert-file`],
+      keyFile: program[`key-file`],
+      directory: program.directory
     });
+  }
 
-    function prepareUrls(protocol, host, port) {
-      const formatUrl = hostname => url.format({
-        protocol,
-        hostname,
-        port,
-        pathname: `/`
-      });
+  program.port = await detectPortInUseAndPrompt(port, rlInterface);
+  const [compiler] = await startServer(program);
 
-      const prettyPrintUrl = hostname => url.format({
-        protocol,
-        hostname,
-        port: chalk.bold(port),
-        pathname: `/`
-      });
+  function prepareUrls(protocol, host, port) {
+    const formatUrl = hostname => url.format({
+      protocol,
+      hostname,
+      port,
+      pathname: `/`
+    });
+
+    const prettyPrintUrl = hostname => url.format({
+      protocol,
+      hostname,
+      port: chalk.bold(port),
+      pathname: `/`
+    });
 
-      const isUnspecifiedHost = host === `0.0.0.0` || host === `::`;
-      let lanUrlForConfig, lanUrlForTerminal;
-
-      if (isUnspecifiedHost) {
-        try {
-          // This can only return an IPv4 address
-          lanUrlForConfig = address.ip();
-
-          if (lanUrlForConfig) {
-            // Check if the address is a private ip
-            // https://en.wikipedia.org/wiki/Private_network#Private_IPv4_address_spaces
-            if (/^10[.]|^172[.](1[6-9]|2[0-9]|3[0-1])[.]|^192[.]168[.]/.test(lanUrlForConfig)) {
-              // Address is private, format it for later use
-              lanUrlForTerminal = prettyPrintUrl(lanUrlForConfig);
-            } else {
-              // Address is not private, so we will discard it
-              lanUrlForConfig = undefined;
-            }
+    const isUnspecifiedHost = host === `0.0.0.0` || host === `::`;
+    let lanUrlForConfig, lanUrlForTerminal;
+
+    if (isUnspecifiedHost) {
+      try {
+        // This can only return an IPv4 address
+        lanUrlForConfig = address.ip();
+
+        if (lanUrlForConfig) {
+          // Check if the address is a private ip
+          // https://en.wikipedia.org/wiki/Private_network#Private_IPv4_address_spaces
+          if (/^10[.]|^172[.](1[6-9]|2[0-9]|3[0-1])[.]|^192[.]168[.]/.test(lanUrlForConfig)) {
+            // Address is private, format it for later use
+            lanUrlForTerminal = prettyPrintUrl(lanUrlForConfig);
+          } else {
+            // Address is not private, so we will discard it
+            lanUrlForConfig = undefined;
           }
-        } catch (_e) {// ignored
         }
-      } // TODO collect errors (GraphQL + Webpack) in Redux so we
-      // can clear terminal and print them out on every compile.
-      // Borrow pretty printing code from webpack plugin.
-
-
-      const localUrlForTerminal = prettyPrintUrl(host);
-      const localUrlForBrowser = formatUrl(host);
-      return {
-        lanUrlForConfig,
-        lanUrlForTerminal,
-        localUrlForTerminal,
-        localUrlForBrowser
-      };
-    }
-
-    function printInstructions(appName, urls, useYarn) {
-      console.log();
-      console.log(`You can now view ${chalk.bold(appName)} in the browser.`);
-      console.log();
-
-      if (urls.lanUrlForTerminal) {
-        console.log(`  ${chalk.bold(`Local:`)}            ${urls.localUrlForTerminal}`);
-        console.log(`  ${chalk.bold(`On Your Network:`)}  ${urls.lanUrlForTerminal}`);
-      } else {
-        console.log(`  ${urls.localUrlForTerminal}`);
+      } catch (_e) {// ignored
       }
-
-      console.log();
-      console.log(`View ${process.env.GATSBY_GRAPHQL_IDE === `playground` ? `the GraphQL Playground` : `GraphiQL`}, an in-browser IDE, to explore your site's data and schema`);
-      console.log();
-      console.log(`  ${urls.localUrlForTerminal}___graphql`);
-      console.log();
-      console.log(`Note that the development build is not optimized.`);
-      console.log(`To create a production build, use ` + `${chalk.cyan(`npm run build`)}`);
-      console.log();
-    }
-
-    function printDeprecationWarnings() {
-      const deprecatedApis = [`boundActionCreators`, `pathContext`];
-      const fixMap = {
-        boundActionCreators: {
-          newName: `actions`,
-          docsLink: `https://gatsby.dev/boundActionCreators`
-        },
-        pathContext: {
-          newName: `pageContext`,
-          docsLink: `https://gatsby.dev/pathContext`
-        }
-      };
-      const deprecatedLocations = {};
-      deprecatedApis.forEach(api => deprecatedLocations[api] = []);
-      glob.sync(`{,!(node_modules|public)/**/}*.js`, {
-        nodir: true
-      }).forEach(file => {
-        const fileText = fs.readFileSync(file);
-        const matchingApis = deprecatedApis.filter(api => fileText.indexOf(api) !== -1);
-        matchingApis.forEach(api => deprecatedLocations[api].push(file));
-      });
-      deprecatedApis.forEach(api => {
-        if (deprecatedLocations[api].length) {
-          console.log(`%s %s %s %s`, chalk.cyan(api), chalk.yellow(`is deprecated. Please use`), chalk.cyan(fixMap[api].newName), chalk.yellow(`instead. For migration instructions, see ${fixMap[api].docsLink}\nCheck the following files:`));
-          console.log();
-          deprecatedLocations[api].forEach(file => console.log(file));
-          console.log();
-        }
-      });
+    } // TODO collect errors (GraphQL + Webpack) in Redux so we
+    // can clear terminal and print them out on every compile.
+    // Borrow pretty printing code from webpack plugin.
+
+
+    const localUrlForTerminal = prettyPrintUrl(host);
+    const localUrlForBrowser = formatUrl(host);
+    return {
+      lanUrlForConfig,
+      lanUrlForTerminal,
+      localUrlForTerminal,
+      localUrlForBrowser
+    };
+  }
+
+  function printInstructions(appName, urls, useYarn) {
+    console.log();
+    console.log(`You can now view ${chalk.bold(appName)} in the browser.`);
+    console.log();
+
+    if (urls.lanUrlForTerminal) {
+      console.log(`  ${chalk.bold(`Local:`)}            ${urls.localUrlForTerminal}`);
+      console.log(`  ${chalk.bold(`On Your Network:`)}  ${urls.lanUrlForTerminal}`);
+    } else {
+      console.log(`  ${urls.localUrlForTerminal}`);
     }
 
-    let isFirstCompile = true; // "done" event fires when Webpack has finished recompiling the bundle.
-    // Whether or not you have warnings or errors, you will get this event.
-
-    compiler.hooks.done.tapAsync(`print getsby instructions`, (stats, done) => {
-      // We have switched off the default Webpack output in WebpackDevServer
-      // options so we are going to "massage" the warnings and errors and present
-      // them in a readable focused way.
-      const messages = formatWebpackMessages(stats.toJson({}, true));
-      const urls = prepareUrls(program.ssl ? `https` : `http`, program.host, program.port);
-      const isSuccessful = !messages.errors.length; // if (isSuccessful) {
-      // console.log(chalk.green(`Compiled successfully!`))
-      // }
-      // if (isSuccessful && (isInteractive || isFirstCompile)) {
-
-      if (isSuccessful && isFirstCompile) {
-        printInstructions(program.sitePackageJson.name, urls, program.useYarn);
-        printDeprecationWarnings();
-
-        if (program.open) {
-          Promise.resolve(openurl(urls.localUrlForBrowser)).catch(err => console.log(`${chalk.yellow(`warn`)} Browser not opened because no browser was found`));
-        }
+    console.log();
+    console.log(`View ${process.env.GATSBY_GRAPHQL_IDE === `playground` ? `the GraphQL Playground` : `GraphiQL`}, an in-browser IDE, to explore your site's data and schema`);
+    console.log();
+    console.log(`  ${urls.localUrlForTerminal}___graphql`);
+    console.log();
+    console.log(`Note that the development build is not optimized.`);
+    console.log(`To create a production build, use ` + `${chalk.cyan(`npm run build`)}`);
+    console.log();
+  }
+
+  function printDeprecationWarnings() {
+    const deprecatedApis = [`boundActionCreators`, `pathContext`];
+    const fixMap = {
+      boundActionCreators: {
+        newName: `actions`,
+        docsLink: `https://gatsby.dev/boundActionCreators`
+      },
+      pathContext: {
+        newName: `pageContext`,
+        docsLink: `https://gatsby.dev/pathContext`
       }
-
-      isFirstCompile = false; // If errors exist, only show errors.
-      // if (messages.errors.length) {
-      // // Only keep the first error. Others are often indicative
-      // // of the same problem, but confuse the reader with noise.
-      // if (messages.errors.length > 1) {
-      // messages.errors.length = 1
-      // }
-      // console.log(chalk.red("Failed to compile.\n"))
-      // console.log(messages.errors.join("\n\n"))
-      // return
-      // }
-      // Show warnings if no errors were found.
-      // if (messages.warnings.length) {
-      // console.log(chalk.yellow("Compiled with warnings.\n"))
-      // console.log(messages.warnings.join("\n\n"))
-      // // Teach some ESLint tricks.
-      // console.log(
-      // "\nSearch for the " +
-      // chalk.underline(chalk.yellow("keywords")) +
-      // " to learn more about each warning."
-      // )
-      // console.log(
-      // "To ignore, add " +
-      // chalk.cyan("// eslint-disable-next-line") +
-      // " to the line before.\n"
-      // )
-      // }
-
-      done();
+    };
+    const deprecatedLocations = {};
+    deprecatedApis.forEach(api => deprecatedLocations[api] = []);
+    glob.sync(`{,!(node_modules|public)/**/}*.js`, {
+      nodir: true
+    }).forEach(file => {
+      const fileText = fs.readFileSync(file);
+      const matchingApis = deprecatedApis.filter(api => fileText.indexOf(api) !== -1);
+      matchingApis.forEach(api => deprecatedLocations[api].push(file));
     });
-  });
+    deprecatedApis.forEach(api => {
+      if (deprecatedLocations[api].length) {
+        console.log(`%s %s %s %s`, chalk.cyan(api), chalk.yellow(`is deprecated. Please use`), chalk.cyan(fixMap[api].newName), chalk.yellow(`instead. For migration instructions, see ${fixMap[api].docsLink}\nCheck the following files:`));
+        console.log();
+        deprecatedLocations[api].forEach(file => console.log(file));
+        console.log();
+      }
+    });
+  }
+
+  let isFirstCompile = true; // "done" event fires when Webpack has finished recompiling the bundle.
+  // Whether or not you have warnings or errors, you will get this event.
+
+  compiler.hooks.done.tapAsync(`print getsby instructions`, (stats, done) => {
+    // We have switched off the default Webpack output in WebpackDevServer
+    // options so we are going to "massage" the warnings and errors and present
+    // them in a readable focused way.
+    const messages = formatWebpackMessages(stats.toJson({}, true));
+    const urls = prepareUrls(program.ssl ? `https` : `http`, program.host, program.port);
+    const isSuccessful = !messages.errors.length; // if (isSuccessful) {
+    // console.log(chalk.green(`Compiled successfully!`))
+    // }
+    // if (isSuccessful && (isInteractive || isFirstCompile)) {
+
+    if (isSuccessful && isFirstCompile) {
+      printInstructions(program.sitePackageJson.name, urls, program.useYarn);
+      printDeprecationWarnings();
+
+      if (program.open) {
+        Promise.resolve(openurl(urls.localUrlForBrowser)).catch(err => console.log(`${chalk.yellow(`warn`)} Browser not opened because no browser was found`));
+      }
+    }
 
-  return function (_x2) {
-    return _ref.apply(this, arguments);
-  };
-}();
+    isFirstCompile = false; // If errors exist, only show errors.
+    // if (messages.errors.length) {
+    // // Only keep the first error. Others are often indicative
+    // // of the same problem, but confuse the reader with noise.
+    // if (messages.errors.length > 1) {
+    // messages.errors.length = 1
+    // }
+    // console.log(chalk.red("Failed to compile.\n"))
+    // console.log(messages.errors.join("\n\n"))
+    // return
+    // }
+    // Show warnings if no errors were found.
+    // if (messages.warnings.length) {
+    // console.log(chalk.yellow("Compiled with warnings.\n"))
+    // console.log(messages.warnings.join("\n\n"))
+    // // Teach some ESLint tricks.
+    // console.log(
+    // "\nSearch for the " +
+    // chalk.underline(chalk.yellow("keywords")) +
+    // " to learn more about each warning."
+    // )
+    // console.log(
+    // "To ignore, add " +
+    // chalk.cyan("// eslint-disable-next-line") +
+    // " to the line before.\n"
+    // )
+    // }
+
+    done();
+  });
+};
 //# sourceMappingURL=develop.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/commands/develop.js.map b/node_modules/gatsby/dist/commands/develop.js.map
index b75cdff..736e85d 100644
--- a/node_modules/gatsby/dist/commands/develop.js.map
+++ b/node_modules/gatsby/dist/commands/develop.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/commands/develop.js"],"names":["url","require","glob","fs","openurl","chokidar","express","graphqlHTTP","graphqlPlayground","default","formatError","request","rl","webpack","webpackConfig","bootstrap","store","syncStaticDir","developHtml","withBasePath","report","launchEditor","formatWebpackMessages","chalk","address","withResolverContext","sourceNodes","websocketManager","getSslCert","slash","initTracer","apiRunnerNode","setTimeout","rlInterface","createInterface","input","process","stdin","output","stdout","on","exit","startServer","program","directory","directoryPath","createIndexHtml","catch","err","name","panic","stripIndent","devConfig","port","compiler","app","use","log","path","heartbeat","env","GATSBY_GRAPHQL_IDE","get","endpoint","schema","getState","graphiql","context","stack","split","req","res","next","header","post","enableRefresh","ENABLE_GATSBY_REFRESH_ENDPOINT","refreshToken","GATSBY_REFRESH_TOKEN","authorizedRefresh","headers","authorization","console","end","query","fileName","lineNumber","index","logLevel","publicPath","stats","developMiddleware","config","proxy","prefix","proxiedUrl","originalUrl","pipe","message","error","status","sendFile","server","Server","ssl","createServer","init","socket","getSocket","listener","listen","host","code","watchGlobs","map","watch","to","emit","module","exports","openTracingConfigFile","detect","parseInt","https","sitePackageJson","replace","certFile","keyFile","Promise","resolve","_port","question","answer","length","match","then","c","l","prepareUrls","protocol","formatUrl","hostname","format","pathname","prettyPrintUrl","bold","isUnspecifiedHost","lanUrlForConfig","lanUrlForTerminal","ip","test","undefined","_e","localUrlForTerminal","localUrlForBrowser","printInstructions","appName","urls","useYarn","cyan","printDeprecationWarnings","deprecatedApis","fixMap","boundActionCreators","newName","docsLink","pathContext","deprecatedLocations","forEach","api","sync","nodir","file","fileText","readFileSync","matchingApis","filter","indexOf","push","yellow","isFirstCompile","hooks","done","tapAsync","messages","toJson","isSuccessful","errors","open"],"mappings":"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","sourcesContent":["/* @flow */\n\nconst url = require(`url`)\nconst glob = require(`glob`)\nconst fs = require(`fs`)\nconst openurl = require(`better-opn`)\nconst chokidar = require(`chokidar`)\nconst express = require(`express`)\nconst graphqlHTTP = require(`express-graphql`)\nconst graphqlPlayground = require(`graphql-playground-middleware-express`)\n  .default\nconst { formatError } = require(`graphql`)\nconst request = require(`request`)\nconst rl = require(`readline`)\nconst webpack = require(`webpack`)\nconst webpackConfig = require(`../utils/webpack.config`)\nconst bootstrap = require(`../bootstrap`)\nconst { store } = require(`../redux`)\nconst { syncStaticDir } = require(`../utils/get-static-dir`)\nconst developHtml = require(`./develop-html`)\nconst { withBasePath } = require(`../utils/path`)\nconst report = require(`gatsby-cli/lib/reporter`)\nconst launchEditor = require(`react-dev-utils/launchEditor`)\nconst formatWebpackMessages = require(`react-dev-utils/formatWebpackMessages`)\nconst chalk = require(`chalk`)\nconst address = require(`address`)\nconst withResolverContext = require(`../schema/context`)\nconst sourceNodes = require(`../utils/source-nodes`)\nconst websocketManager = require(`../utils/websocket-manager`)\nconst getSslCert = require(`../utils/get-ssl-cert`)\nconst slash = require(`slash`)\nconst { initTracer } = require(`../utils/tracer`)\nconst apiRunnerNode = require(`../utils/api-runner-node`)\n\n// const isInteractive = process.stdout.isTTY\n\n// Watch the static directory and copy files to public as they're added or\n// changed. Wait 10 seconds so copying doesn't interfere with the regular\n// bootstrap.\nsetTimeout(() => {\n  syncStaticDir()\n}, 10000)\n\nconst rlInterface = rl.createInterface({\n  input: process.stdin,\n  output: process.stdout,\n})\n\n// Quit immediately on hearing ctrl-c\nrlInterface.on(`SIGINT`, () => {\n  process.exit()\n})\n\nasync function startServer(program) {\n  const directory = program.directory\n  const directoryPath = withBasePath(directory)\n  const createIndexHtml = () =>\n    developHtml(program).catch(err => {\n      if (err.name !== `WebpackError`) {\n        report.panic(err)\n        return\n      }\n      report.panic(\n        report.stripIndent`\n          There was an error compiling the html.js component for the development server.\n\n          See our docs page on debugging HTML builds for help https://gatsby.dev/debug-html\n        `,\n        err\n      )\n    })\n\n  // Start bootstrap process.\n  await bootstrap(program)\n\n  await createIndexHtml()\n\n  const devConfig = await webpackConfig(\n    program,\n    directory,\n    `develop`,\n    program.port\n  )\n\n  const compiler = webpack(devConfig)\n\n  /**\n   * Set up the express app.\n   **/\n  const app = express()\n  app.use(\n    require(`webpack-hot-middleware`)(compiler, {\n      log: false,\n      path: `/__webpack_hmr`,\n      heartbeat: 10 * 1000,\n    })\n  )\n\n  if (process.env.GATSBY_GRAPHQL_IDE === `playground`) {\n    app.get(\n      `/___graphql`,\n      graphqlPlayground({\n        endpoint: `/___graphql`,\n      }),\n      () => {}\n    )\n  }\n\n  app.use(\n    `/___graphql`,\n    graphqlHTTP(() => {\n      const schema = store.getState().schema\n      return {\n        schema,\n        graphiql:\n          process.env.GATSBY_GRAPHQL_IDE === `playground` ? false : true,\n        context: withResolverContext({}, schema),\n        formatError(err) {\n          return {\n            ...formatError(err),\n            stack: err.stack ? err.stack.split(`\\n`) : [],\n          }\n        },\n      }\n    })\n  )\n\n  // Allow requests from any origin. Avoids CORS issues when using the `--host` flag.\n  app.use((req, res, next) => {\n    res.header(`Access-Control-Allow-Origin`, `*`)\n    res.header(\n      `Access-Control-Allow-Headers`,\n      `Origin, X-Requested-With, Content-Type, Accept`\n    )\n    next()\n  })\n\n  /**\n   * Refresh external data sources.\n   * This behavior is disabled by default, but the ENABLE_REFRESH_ENDPOINT env var enables it\n   * If no GATSBY_REFRESH_TOKEN env var is available, then no Authorization header is required\n   **/\n  app.post(`/__refresh`, (req, res) => {\n    const enableRefresh = process.env.ENABLE_GATSBY_REFRESH_ENDPOINT\n    const refreshToken = process.env.GATSBY_REFRESH_TOKEN\n    const authorizedRefresh =\n      !refreshToken || req.headers.authorization === refreshToken\n\n    if (enableRefresh && authorizedRefresh) {\n      console.log(`Refreshing source data`)\n      sourceNodes()\n    }\n    res.end()\n  })\n\n  app.get(`/__open-stack-frame-in-editor`, (req, res) => {\n    launchEditor(req.query.fileName, req.query.lineNumber)\n    res.end()\n  })\n\n  // Disable directory indexing i.e. serving index.html from a directory.\n  // This can lead to serving stale html files during development.\n  //\n  // We serve by default an empty index.html that sets up the dev environment.\n  app.use(require(`./develop-static`)(`public`, { index: false }))\n\n  app.use(\n    require(`webpack-dev-middleware`)(compiler, {\n      logLevel: `trace`,\n      publicPath: devConfig.output.publicPath,\n      stats: `errors-only`,\n    })\n  )\n\n  // Expose access to app for advanced use cases\n  const { developMiddleware } = store.getState().config\n\n  if (developMiddleware) {\n    developMiddleware(app)\n  }\n\n  // Set up API proxy.\n  const { proxy } = store.getState().config\n  if (proxy) {\n    const { prefix, url } = proxy\n    app.use(`${prefix}/*`, (req, res) => {\n      const proxiedUrl = url + req.originalUrl\n      req\n        .pipe(\n          request(proxiedUrl).on(`error`, err => {\n            const message = `Error when trying to proxy request \"${\n              req.originalUrl\n            }\" to \"${proxiedUrl}\"`\n\n            report.error(message, err)\n            res.status(500).end()\n          })\n        )\n        .pipe(res)\n    })\n  }\n\n  await apiRunnerNode(`onCreateDevServer`, { app })\n\n  // Render an HTML page and serve it.\n  app.use((req, res, next) => {\n    res.sendFile(directoryPath(`public/index.html`), err => {\n      if (err) {\n        res.status(500).end()\n      }\n    })\n  })\n\n  /**\n   * Set up the HTTP server and socket.io.\n   **/\n  let server = require(`http`).Server(app)\n\n  // If a SSL cert exists in program, use it with `createServer`.\n  if (program.ssl) {\n    server = require(`https`).createServer(program.ssl, app)\n  }\n  websocketManager.init({ server, directory: program.directory })\n  const socket = websocketManager.getSocket()\n\n  const listener = server.listen(program.port, program.host, err => {\n    if (err) {\n      if (err.code === `EADDRINUSE`) {\n        // eslint-disable-next-line max-len\n        report.panic(\n          `Unable to start Gatsby on port ${\n            program.port\n          } as there's already a process listening on that port.`\n        )\n        return\n      }\n\n      report.panic(`There was a problem starting the development server`, err)\n    }\n  })\n\n  // Register watcher that rebuilds index.html every time html.js changes.\n  const watchGlobs = [`src/html.js`, `plugins/**/gatsby-ssr.js`].map(path =>\n    slash(directoryPath(path))\n  )\n\n  chokidar.watch(watchGlobs).on(`change`, async () => {\n    await createIndexHtml()\n    socket.to(`clients`).emit(`reload`)\n  })\n\n  return [compiler, listener]\n}\n\nmodule.exports = async (program: any) => {\n  initTracer(program.openTracingConfigFile)\n\n  const detect = require(`detect-port`)\n  const port =\n    typeof program.port === `string` ? parseInt(program.port, 10) : program.port\n\n  // In order to enable custom ssl, --cert-file --key-file and -https flags must all be\n  // used together\n  if ((program[`cert-file`] || program[`key-file`]) && !program.https) {\n    report.panic(\n      `for custom ssl --https, --cert-file, and --key-file must be used together`\n    )\n  }\n\n  // Check if https is enabled, then create or get SSL cert.\n  // Certs are named after `name` inside the project's package.json.\n  // Scoped names are converted from @npm/package-name to npm--package-name\n  if (program.https) {\n    program.ssl = await getSslCert({\n      name: program.sitePackageJson.name.replace(`@`, ``).replace(`/`, `--`),\n      certFile: program[`cert-file`],\n      keyFile: program[`key-file`],\n      directory: program.directory,\n    })\n  }\n\n  let compiler\n  await new Promise(resolve => {\n    detect(port, (err, _port) => {\n      if (err) {\n        report.panic(err)\n      }\n\n      if (port !== _port) {\n        // eslint-disable-next-line max-len\n        const question = `Something is already running at port ${port} \\nWould you like to run the app at another port instead? [Y/n] `\n\n        rlInterface.question(question, answer => {\n          if (answer.length === 0 || answer.match(/^yes|y$/i)) {\n            program.port = _port // eslint-disable-line no-param-reassign\n          }\n\n          startServer(program).then(([c, l]) => {\n            compiler = c\n            resolve()\n          })\n        })\n      } else {\n        startServer(program).then(([c, l]) => {\n          compiler = c\n          resolve()\n        })\n      }\n    })\n  })\n\n  function prepareUrls(protocol, host, port) {\n    const formatUrl = hostname =>\n      url.format({\n        protocol,\n        hostname,\n        port,\n        pathname: `/`,\n      })\n    const prettyPrintUrl = hostname =>\n      url.format({\n        protocol,\n        hostname,\n        port: chalk.bold(port),\n        pathname: `/`,\n      })\n\n    const isUnspecifiedHost = host === `0.0.0.0` || host === `::`\n    let lanUrlForConfig, lanUrlForTerminal\n    if (isUnspecifiedHost) {\n      try {\n        // This can only return an IPv4 address\n        lanUrlForConfig = address.ip()\n        if (lanUrlForConfig) {\n          // Check if the address is a private ip\n          // https://en.wikipedia.org/wiki/Private_network#Private_IPv4_address_spaces\n          if (\n            /^10[.]|^172[.](1[6-9]|2[0-9]|3[0-1])[.]|^192[.]168[.]/.test(\n              lanUrlForConfig\n            )\n          ) {\n            // Address is private, format it for later use\n            lanUrlForTerminal = prettyPrintUrl(lanUrlForConfig)\n          } else {\n            // Address is not private, so we will discard it\n            lanUrlForConfig = undefined\n          }\n        }\n      } catch (_e) {\n        // ignored\n      }\n    }\n    // TODO collect errors (GraphQL + Webpack) in Redux so we\n    // can clear terminal and print them out on every compile.\n    // Borrow pretty printing code from webpack plugin.\n    const localUrlForTerminal = prettyPrintUrl(host)\n    const localUrlForBrowser = formatUrl(host)\n    return {\n      lanUrlForConfig,\n      lanUrlForTerminal,\n      localUrlForTerminal,\n      localUrlForBrowser,\n    }\n  }\n\n  function printInstructions(appName, urls, useYarn) {\n    console.log()\n    console.log(`You can now view ${chalk.bold(appName)} in the browser.`)\n    console.log()\n\n    if (urls.lanUrlForTerminal) {\n      console.log(\n        `  ${chalk.bold(`Local:`)}            ${urls.localUrlForTerminal}`\n      )\n      console.log(\n        `  ${chalk.bold(`On Your Network:`)}  ${urls.lanUrlForTerminal}`\n      )\n    } else {\n      console.log(`  ${urls.localUrlForTerminal}`)\n    }\n\n    console.log()\n    console.log(\n      `View ${\n        process.env.GATSBY_GRAPHQL_IDE === `playground`\n          ? `the GraphQL Playground`\n          : `GraphiQL`\n      }, an in-browser IDE, to explore your site's data and schema`\n    )\n    console.log()\n    console.log(`  ${urls.localUrlForTerminal}___graphql`)\n\n    console.log()\n    console.log(`Note that the development build is not optimized.`)\n    console.log(\n      `To create a production build, use ` + `${chalk.cyan(`npm run build`)}`\n    )\n    console.log()\n  }\n\n  function printDeprecationWarnings() {\n    const deprecatedApis = [`boundActionCreators`, `pathContext`]\n    const fixMap = {\n      boundActionCreators: {\n        newName: `actions`,\n        docsLink: `https://gatsby.dev/boundActionCreators`,\n      },\n      pathContext: {\n        newName: `pageContext`,\n        docsLink: `https://gatsby.dev/pathContext`,\n      },\n    }\n    const deprecatedLocations = {}\n    deprecatedApis.forEach(api => (deprecatedLocations[api] = []))\n\n    glob\n      .sync(`{,!(node_modules|public)/**/}*.js`, { nodir: true })\n      .forEach(file => {\n        const fileText = fs.readFileSync(file)\n        const matchingApis = deprecatedApis.filter(\n          api => fileText.indexOf(api) !== -1\n        )\n        matchingApis.forEach(api => deprecatedLocations[api].push(file))\n      })\n\n    deprecatedApis.forEach(api => {\n      if (deprecatedLocations[api].length) {\n        console.log(\n          `%s %s %s %s`,\n          chalk.cyan(api),\n          chalk.yellow(`is deprecated. Please use`),\n          chalk.cyan(fixMap[api].newName),\n          chalk.yellow(\n            `instead. For migration instructions, see ${\n              fixMap[api].docsLink\n            }\\nCheck the following files:`\n          )\n        )\n        console.log()\n        deprecatedLocations[api].forEach(file => console.log(file))\n        console.log()\n      }\n    })\n  }\n\n  let isFirstCompile = true\n  // \"done\" event fires when Webpack has finished recompiling the bundle.\n  // Whether or not you have warnings or errors, you will get this event.\n  compiler.hooks.done.tapAsync(`print getsby instructions`, (stats, done) => {\n    // We have switched off the default Webpack output in WebpackDevServer\n    // options so we are going to \"massage\" the warnings and errors and present\n    // them in a readable focused way.\n    const messages = formatWebpackMessages(stats.toJson({}, true))\n    const urls = prepareUrls(\n      program.ssl ? `https` : `http`,\n      program.host,\n      program.port\n    )\n    const isSuccessful = !messages.errors.length\n    // if (isSuccessful) {\n    // console.log(chalk.green(`Compiled successfully!`))\n    // }\n    // if (isSuccessful && (isInteractive || isFirstCompile)) {\n    if (isSuccessful && isFirstCompile) {\n      printInstructions(program.sitePackageJson.name, urls, program.useYarn)\n      printDeprecationWarnings()\n      if (program.open) {\n        Promise.resolve(openurl(urls.localUrlForBrowser)).catch(err =>\n          console.log(\n            `${chalk.yellow(\n              `warn`\n            )} Browser not opened because no browser was found`\n          )\n        )\n      }\n    }\n\n    isFirstCompile = false\n\n    // If errors exist, only show errors.\n    // if (messages.errors.length) {\n    // // Only keep the first error. Others are often indicative\n    // // of the same problem, but confuse the reader with noise.\n    // if (messages.errors.length > 1) {\n    // messages.errors.length = 1\n    // }\n    // console.log(chalk.red(\"Failed to compile.\\n\"))\n    // console.log(messages.errors.join(\"\\n\\n\"))\n    // return\n    // }\n\n    // Show warnings if no errors were found.\n    // if (messages.warnings.length) {\n    // console.log(chalk.yellow(\"Compiled with warnings.\\n\"))\n    // console.log(messages.warnings.join(\"\\n\\n\"))\n\n    // // Teach some ESLint tricks.\n    // console.log(\n    // \"\\nSearch for the \" +\n    // chalk.underline(chalk.yellow(\"keywords\")) +\n    // \" to learn more about each warning.\"\n    // )\n    // console.log(\n    // \"To ignore, add \" +\n    // chalk.cyan(\"// eslint-disable-next-line\") +\n    // \" to the line before.\\n\"\n    // )\n    // }\n\n    done()\n  })\n}\n"],"file":"develop.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/commands/develop.js"],"names":["url","require","glob","fs","openurl","chokidar","express","graphqlHTTP","graphqlPlayground","default","formatError","request","rl","webpack","webpackConfig","bootstrap","store","syncStaticDir","buildHTML","withBasePath","report","launchEditor","formatWebpackMessages","chalk","address","withResolverContext","sourceNodes","websocketManager","getSslCert","slash","initTracer","apiRunnerNode","db","telemetry","detectPortInUseAndPrompt","onExit","pageQueryRunner","queryQueue","queryWatcher","setTimeout","rlInterface","createInterface","input","process","stdin","output","stdout","on","exit","trackCli","startServer","program","directory","directoryPath","createIndexHtml","buildPages","stage","pagePaths","err","name","panic","stripIndent","startAutosave","startListening","makeDevelop","startWatchDeletePage","devConfig","port","compiler","app","use","expressMiddleware","log","path","heartbeat","env","GATSBY_GRAPHQL_IDE","get","endpoint","schema","getState","graphiql","context","stack","split","req","res","next","header","post","enableRefresh","ENABLE_GATSBY_REFRESH_ENDPOINT","refreshToken","GATSBY_REFRESH_TOKEN","authorizedRefresh","headers","authorization","console","end","query","fileName","lineNumber","index","logLevel","publicPath","stats","developMiddleware","config","proxy","prefix","proxiedUrl","originalUrl","pipe","message","error","status","sendFile","server","Server","ssl","createServer","init","socket","getSocket","listener","listen","host","code","watchGlobs","map","watch","to","emit","module","exports","openTracingConfigFile","startBackgroundUpdate","parseInt","https","sitePackageJson","replace","certFile","keyFile","prepareUrls","protocol","formatUrl","hostname","format","pathname","prettyPrintUrl","bold","isUnspecifiedHost","lanUrlForConfig","lanUrlForTerminal","ip","test","undefined","_e","localUrlForTerminal","localUrlForBrowser","printInstructions","appName","urls","useYarn","cyan","printDeprecationWarnings","deprecatedApis","fixMap","boundActionCreators","newName","docsLink","pathContext","deprecatedLocations","forEach","api","sync","nodir","file","fileText","readFileSync","matchingApis","filter","indexOf","push","length","yellow","isFirstCompile","hooks","done","tapAsync","messages","toJson","isSuccessful","errors","open","Promise","resolve","catch"],"mappings":"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","sourcesContent":["/* @flow */\n\nconst url = require(`url`)\nconst glob = require(`glob`)\nconst fs = require(`fs`)\nconst openurl = require(`better-opn`)\nconst chokidar = require(`chokidar`)\nconst express = require(`express`)\nconst graphqlHTTP = require(`express-graphql`)\nconst graphqlPlayground = require(`graphql-playground-middleware-express`)\n  .default\nconst { formatError } = require(`graphql`)\nconst request = require(`request`)\nconst rl = require(`readline`)\nconst webpack = require(`webpack`)\nconst webpackConfig = require(`../utils/webpack.config`)\nconst bootstrap = require(`../bootstrap`)\nconst { store } = require(`../redux`)\nconst { syncStaticDir } = require(`../utils/get-static-dir`)\nconst buildHTML = require(`./build-html`)\nconst { withBasePath } = require(`../utils/path`)\nconst report = require(`gatsby-cli/lib/reporter`)\nconst launchEditor = require(`react-dev-utils/launchEditor`)\nconst formatWebpackMessages = require(`react-dev-utils/formatWebpackMessages`)\nconst chalk = require(`chalk`)\nconst address = require(`address`)\nconst withResolverContext = require(`../schema/context`)\nconst sourceNodes = require(`../utils/source-nodes`)\nconst websocketManager = require(`../utils/websocket-manager`)\nconst getSslCert = require(`../utils/get-ssl-cert`)\nconst slash = require(`slash`)\nconst { initTracer } = require(`../utils/tracer`)\nconst apiRunnerNode = require(`../utils/api-runner-node`)\nconst db = require(`../db`)\nconst telemetry = require(`gatsby-telemetry`)\nconst detectPortInUseAndPrompt = require(`../utils/detect-port-in-use-and-prompt`)\nconst onExit = require(`signal-exit`)\nconst pageQueryRunner = require(`../query/page-query-runner`)\nconst queryQueue = require(`../query/queue`)\nconst queryWatcher = require(`../query/query-watcher`)\n\n// const isInteractive = process.stdout.isTTY\n\n// Watch the static directory and copy files to public as they're added or\n// changed. Wait 10 seconds so copying doesn't interfere with the regular\n// bootstrap.\nsetTimeout(() => {\n  syncStaticDir()\n}, 10000)\n\nconst rlInterface = rl.createInterface({\n  input: process.stdin,\n  output: process.stdout,\n})\n\n// Quit immediately on hearing ctrl-c\nrlInterface.on(`SIGINT`, () => {\n  process.exit()\n})\n\nonExit(() => {\n  telemetry.trackCli(`DEVELOP_STOP`)\n})\n\nasync function startServer(program) {\n  const directory = program.directory\n  const directoryPath = withBasePath(directory)\n  const createIndexHtml = async () => {\n    try {\n      await buildHTML.buildPages({\n        program,\n        stage: `develop-html`,\n        pagePaths: [`/`],\n      })\n    } catch (err) {\n      if (err.name !== `WebpackError`) {\n        report.panic(err)\n        return\n      }\n      report.panic(\n        report.stripIndent`\n          There was an error compiling the html.js component for the development server.\n\n          See our docs page on debugging HTML builds for help https://gatsby.dev/debug-html\n        `,\n        err\n      )\n    }\n  }\n\n  // Start bootstrap process.\n  await bootstrap(program)\n\n  db.startAutosave()\n  pageQueryRunner.startListening(queryQueue.makeDevelop())\n  queryWatcher.startWatchDeletePage()\n\n  await createIndexHtml()\n\n  const devConfig = await webpackConfig(\n    program,\n    directory,\n    `develop`,\n    program.port\n  )\n\n  const compiler = webpack(devConfig)\n\n  /**\n   * Set up the express app.\n   **/\n  const app = express()\n  app.use(telemetry.expressMiddleware(`DEVELOP`))\n  app.use(\n    require(`webpack-hot-middleware`)(compiler, {\n      log: false,\n      path: `/__webpack_hmr`,\n      heartbeat: 10 * 1000,\n    })\n  )\n\n  if (process.env.GATSBY_GRAPHQL_IDE === `playground`) {\n    app.get(\n      `/___graphql`,\n      graphqlPlayground({\n        endpoint: `/___graphql`,\n      }),\n      () => {}\n    )\n  }\n\n  app.use(\n    `/___graphql`,\n    graphqlHTTP(() => {\n      const schema = store.getState().schema\n      return {\n        schema,\n        graphiql:\n          process.env.GATSBY_GRAPHQL_IDE === `playground` ? false : true,\n        context: withResolverContext({}, schema),\n        formatError(err) {\n          return {\n            ...formatError(err),\n            stack: err.stack ? err.stack.split(`\\n`) : [],\n          }\n        },\n      }\n    })\n  )\n\n  // Allow requests from any origin. Avoids CORS issues when using the `--host` flag.\n  app.use((req, res, next) => {\n    res.header(`Access-Control-Allow-Origin`, `*`)\n    res.header(\n      `Access-Control-Allow-Headers`,\n      `Origin, X-Requested-With, Content-Type, Accept`\n    )\n    next()\n  })\n\n  /**\n   * Refresh external data sources.\n   * This behavior is disabled by default, but the ENABLE_REFRESH_ENDPOINT env var enables it\n   * If no GATSBY_REFRESH_TOKEN env var is available, then no Authorization header is required\n   **/\n  app.post(`/__refresh`, (req, res) => {\n    const enableRefresh = process.env.ENABLE_GATSBY_REFRESH_ENDPOINT\n    const refreshToken = process.env.GATSBY_REFRESH_TOKEN\n    const authorizedRefresh =\n      !refreshToken || req.headers.authorization === refreshToken\n\n    if (enableRefresh && authorizedRefresh) {\n      console.log(`Refreshing source data`)\n      sourceNodes()\n    }\n    res.end()\n  })\n\n  app.get(`/__open-stack-frame-in-editor`, (req, res) => {\n    launchEditor(req.query.fileName, req.query.lineNumber)\n    res.end()\n  })\n\n  // Disable directory indexing i.e. serving index.html from a directory.\n  // This can lead to serving stale html files during development.\n  //\n  // We serve by default an empty index.html that sets up the dev environment.\n  app.use(require(`./develop-static`)(`public`, { index: false }))\n\n  app.use(\n    require(`webpack-dev-middleware`)(compiler, {\n      logLevel: `trace`,\n      publicPath: devConfig.output.publicPath,\n      stats: `errors-only`,\n    })\n  )\n\n  // Expose access to app for advanced use cases\n  const { developMiddleware } = store.getState().config\n\n  if (developMiddleware) {\n    developMiddleware(app)\n  }\n\n  // Set up API proxy.\n  const { proxy } = store.getState().config\n  if (proxy) {\n    const { prefix, url } = proxy\n    app.use(`${prefix}/*`, (req, res) => {\n      const proxiedUrl = url + req.originalUrl\n      req\n        .pipe(\n          request(proxiedUrl).on(`error`, err => {\n            const message = `Error when trying to proxy request \"${\n              req.originalUrl\n            }\" to \"${proxiedUrl}\"`\n\n            report.error(message, err)\n            res.status(500).end()\n          })\n        )\n        .pipe(res)\n    })\n  }\n\n  await apiRunnerNode(`onCreateDevServer`, { app })\n\n  // Render an HTML page and serve it.\n  app.use((req, res, next) => {\n    res.sendFile(directoryPath(`public/index.html`), err => {\n      if (err) {\n        res.status(500).end()\n      }\n    })\n  })\n\n  /**\n   * Set up the HTTP server and socket.io.\n   **/\n  let server = require(`http`).Server(app)\n\n  // If a SSL cert exists in program, use it with `createServer`.\n  if (program.ssl) {\n    server = require(`https`).createServer(program.ssl, app)\n  }\n  websocketManager.init({ server, directory: program.directory })\n  const socket = websocketManager.getSocket()\n\n  const listener = server.listen(program.port, program.host, err => {\n    if (err) {\n      if (err.code === `EADDRINUSE`) {\n        // eslint-disable-next-line max-len\n        report.panic(\n          `Unable to start Gatsby on port ${\n            program.port\n          } as there's already a process listening on that port.`\n        )\n        return\n      }\n\n      report.panic(`There was a problem starting the development server`, err)\n    }\n  })\n\n  // Register watcher that rebuilds index.html every time html.js changes.\n  const watchGlobs = [`src/html.js`, `plugins/**/gatsby-ssr.js`].map(path =>\n    slash(directoryPath(path))\n  )\n\n  chokidar.watch(watchGlobs).on(`change`, async () => {\n    await createIndexHtml()\n    socket.to(`clients`).emit(`reload`)\n  })\n\n  return [compiler, listener]\n}\n\nmodule.exports = async (program: any) => {\n  initTracer(program.openTracingConfigFile)\n  telemetry.trackCli(`DEVELOP_START`)\n  telemetry.startBackgroundUpdate()\n\n  const port =\n    typeof program.port === `string` ? parseInt(program.port, 10) : program.port\n\n  // In order to enable custom ssl, --cert-file --key-file and -https flags must all be\n  // used together\n  if ((program[`cert-file`] || program[`key-file`]) && !program.https) {\n    report.panic(\n      `for custom ssl --https, --cert-file, and --key-file must be used together`\n    )\n  }\n\n  // Check if https is enabled, then create or get SSL cert.\n  // Certs are named after `name` inside the project's package.json.\n  // Scoped names are converted from @npm/package-name to npm--package-name\n  if (program.https) {\n    program.ssl = await getSslCert({\n      name: program.sitePackageJson.name.replace(`@`, ``).replace(`/`, `--`),\n      certFile: program[`cert-file`],\n      keyFile: program[`key-file`],\n      directory: program.directory,\n    })\n  }\n\n  program.port = await detectPortInUseAndPrompt(port, rlInterface)\n\n  const [compiler] = await startServer(program)\n\n  function prepareUrls(protocol, host, port) {\n    const formatUrl = hostname =>\n      url.format({\n        protocol,\n        hostname,\n        port,\n        pathname: `/`,\n      })\n    const prettyPrintUrl = hostname =>\n      url.format({\n        protocol,\n        hostname,\n        port: chalk.bold(port),\n        pathname: `/`,\n      })\n\n    const isUnspecifiedHost = host === `0.0.0.0` || host === `::`\n    let lanUrlForConfig, lanUrlForTerminal\n    if (isUnspecifiedHost) {\n      try {\n        // This can only return an IPv4 address\n        lanUrlForConfig = address.ip()\n        if (lanUrlForConfig) {\n          // Check if the address is a private ip\n          // https://en.wikipedia.org/wiki/Private_network#Private_IPv4_address_spaces\n          if (\n            /^10[.]|^172[.](1[6-9]|2[0-9]|3[0-1])[.]|^192[.]168[.]/.test(\n              lanUrlForConfig\n            )\n          ) {\n            // Address is private, format it for later use\n            lanUrlForTerminal = prettyPrintUrl(lanUrlForConfig)\n          } else {\n            // Address is not private, so we will discard it\n            lanUrlForConfig = undefined\n          }\n        }\n      } catch (_e) {\n        // ignored\n      }\n    }\n    // TODO collect errors (GraphQL + Webpack) in Redux so we\n    // can clear terminal and print them out on every compile.\n    // Borrow pretty printing code from webpack plugin.\n    const localUrlForTerminal = prettyPrintUrl(host)\n    const localUrlForBrowser = formatUrl(host)\n    return {\n      lanUrlForConfig,\n      lanUrlForTerminal,\n      localUrlForTerminal,\n      localUrlForBrowser,\n    }\n  }\n\n  function printInstructions(appName, urls, useYarn) {\n    console.log()\n    console.log(`You can now view ${chalk.bold(appName)} in the browser.`)\n    console.log()\n\n    if (urls.lanUrlForTerminal) {\n      console.log(\n        `  ${chalk.bold(`Local:`)}            ${urls.localUrlForTerminal}`\n      )\n      console.log(\n        `  ${chalk.bold(`On Your Network:`)}  ${urls.lanUrlForTerminal}`\n      )\n    } else {\n      console.log(`  ${urls.localUrlForTerminal}`)\n    }\n\n    console.log()\n    console.log(\n      `View ${\n        process.env.GATSBY_GRAPHQL_IDE === `playground`\n          ? `the GraphQL Playground`\n          : `GraphiQL`\n      }, an in-browser IDE, to explore your site's data and schema`\n    )\n    console.log()\n    console.log(`  ${urls.localUrlForTerminal}___graphql`)\n\n    console.log()\n    console.log(`Note that the development build is not optimized.`)\n    console.log(\n      `To create a production build, use ` + `${chalk.cyan(`npm run build`)}`\n    )\n    console.log()\n  }\n\n  function printDeprecationWarnings() {\n    const deprecatedApis = [`boundActionCreators`, `pathContext`]\n    const fixMap = {\n      boundActionCreators: {\n        newName: `actions`,\n        docsLink: `https://gatsby.dev/boundActionCreators`,\n      },\n      pathContext: {\n        newName: `pageContext`,\n        docsLink: `https://gatsby.dev/pathContext`,\n      },\n    }\n    const deprecatedLocations = {}\n    deprecatedApis.forEach(api => (deprecatedLocations[api] = []))\n\n    glob\n      .sync(`{,!(node_modules|public)/**/}*.js`, { nodir: true })\n      .forEach(file => {\n        const fileText = fs.readFileSync(file)\n        const matchingApis = deprecatedApis.filter(\n          api => fileText.indexOf(api) !== -1\n        )\n        matchingApis.forEach(api => deprecatedLocations[api].push(file))\n      })\n\n    deprecatedApis.forEach(api => {\n      if (deprecatedLocations[api].length) {\n        console.log(\n          `%s %s %s %s`,\n          chalk.cyan(api),\n          chalk.yellow(`is deprecated. Please use`),\n          chalk.cyan(fixMap[api].newName),\n          chalk.yellow(\n            `instead. For migration instructions, see ${\n              fixMap[api].docsLink\n            }\\nCheck the following files:`\n          )\n        )\n        console.log()\n        deprecatedLocations[api].forEach(file => console.log(file))\n        console.log()\n      }\n    })\n  }\n\n  let isFirstCompile = true\n  // \"done\" event fires when Webpack has finished recompiling the bundle.\n  // Whether or not you have warnings or errors, you will get this event.\n  compiler.hooks.done.tapAsync(`print getsby instructions`, (stats, done) => {\n    // We have switched off the default Webpack output in WebpackDevServer\n    // options so we are going to \"massage\" the warnings and errors and present\n    // them in a readable focused way.\n    const messages = formatWebpackMessages(stats.toJson({}, true))\n    const urls = prepareUrls(\n      program.ssl ? `https` : `http`,\n      program.host,\n      program.port\n    )\n    const isSuccessful = !messages.errors.length\n    // if (isSuccessful) {\n    // console.log(chalk.green(`Compiled successfully!`))\n    // }\n    // if (isSuccessful && (isInteractive || isFirstCompile)) {\n    if (isSuccessful && isFirstCompile) {\n      printInstructions(program.sitePackageJson.name, urls, program.useYarn)\n      printDeprecationWarnings()\n      if (program.open) {\n        Promise.resolve(openurl(urls.localUrlForBrowser)).catch(err =>\n          console.log(\n            `${chalk.yellow(\n              `warn`\n            )} Browser not opened because no browser was found`\n          )\n        )\n      }\n    }\n\n    isFirstCompile = false\n\n    // If errors exist, only show errors.\n    // if (messages.errors.length) {\n    // // Only keep the first error. Others are often indicative\n    // // of the same problem, but confuse the reader with noise.\n    // if (messages.errors.length > 1) {\n    // messages.errors.length = 1\n    // }\n    // console.log(chalk.red(\"Failed to compile.\\n\"))\n    // console.log(messages.errors.join(\"\\n\\n\"))\n    // return\n    // }\n\n    // Show warnings if no errors were found.\n    // if (messages.warnings.length) {\n    // console.log(chalk.yellow(\"Compiled with warnings.\\n\"))\n    // console.log(messages.warnings.join(\"\\n\\n\"))\n\n    // // Teach some ESLint tricks.\n    // console.log(\n    // \"\\nSearch for the \" +\n    // chalk.underline(chalk.yellow(\"keywords\")) +\n    // \" to learn more about each warning.\"\n    // )\n    // console.log(\n    // \"To ignore, add \" +\n    // chalk.cyan(\"// eslint-disable-next-line\") +\n    // \" to the line before.\\n\"\n    // )\n    // }\n\n    done()\n  })\n}\n"],"file":"develop.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/commands/repl.js b/node_modules/gatsby/dist/commands/repl.js
index a05de8e..771c3da 100644
--- a/node_modules/gatsby/dist/commands/repl.js
+++ b/node_modules/gatsby/dist/commands/repl.js
@@ -1,81 +1,64 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const repl = require(`repl`);
 
-const _require = require(`graphql`),
-      graphql = _require.graphql;
+const {
+  graphql
+} = require(`graphql`);
 
 const bootstrap = require(`../bootstrap`);
 
-const _require2 = require(`../db/nodes`),
-      loadNodeContent = _require2.loadNodeContent,
-      getNodes = _require2.getNodes,
-      getNode = _require2.getNode,
-      getNodesByType = _require2.getNodesByType;
-
-const _require3 = require(`../redux`),
-      store = _require3.store;
-
-module.exports =
-/*#__PURE__*/
-function () {
-  var _ref = (0, _asyncToGenerator2.default)(function* (program) {
-    // run bootstrap
-    yield bootstrap(program); // get all the goodies from the store
-
-    const _store$getState = store.getState(),
-          schema = _store$getState.schema,
-          config = _store$getState.config,
-          babelrc = _store$getState.babelrc,
-          jsonDataPaths = _store$getState.jsonDataPaths,
-          pages = _store$getState.pages,
-          components = _store$getState.components,
-          staticQueryComponents = _store$getState.staticQueryComponents;
-
-    const nodes = getNodes();
-
-    const query =
-    /*#__PURE__*/
-    function () {
-      var _ref2 = (0, _asyncToGenerator2.default)(function* (_query) {
-        const result = yield graphql(schema, _query, {}, {}, {});
-        console.log(`query result: ${JSON.stringify(result)}`);
-      });
-
-      return function query(_x2) {
-        return _ref2.apply(this, arguments);
-      };
-    }(); // init new repl
-
-
-    const _ = repl.start({
-      prompt: `gatsby > `
-    }); // set some globals to make life easier
-
-
-    _.context.babelrc = babelrc;
-    _.context.components = components;
-    _.context.dataPaths = jsonDataPaths;
-    _.context.getNode = getNode;
-    _.context.getNodes = getNodes;
-    _.context.getNodesByType = getNodesByType;
-    _.context.loadNodeContent = loadNodeContent;
-    _.context.nodes = [...nodes.entries()];
-    _.context.pages = [...pages.entries()];
-    _.context.graphql = query;
-    _.context.schema = schema;
-    _.context.siteConfig = config;
-    _.context.staticQueries = staticQueryComponents;
-
-    _.on(`exit`, () => process.exit(0));
-  });
-
-  return function (_x) {
-    return _ref.apply(this, arguments);
-  };
-}();
+const {
+  loadNodeContent,
+  getNodes,
+  getNode,
+  getNodesByType
+} = require(`../db/nodes`);
+
+const {
+  store
+} = require(`../redux`);
+
+module.exports = async program => {
+  // run bootstrap
+  await bootstrap(program); // get all the goodies from the store
+
+  const {
+    schema,
+    config,
+    babelrc,
+    jsonDataPaths,
+    pages,
+    components,
+    staticQueryComponents
+  } = store.getState();
+  const nodes = getNodes();
+
+  const query = async query => {
+    const result = await graphql(schema, query, {}, {}, {});
+    console.log(`query result: ${JSON.stringify(result)}`);
+  }; // init new repl
+
+
+  const _ = repl.start({
+    prompt: `gatsby > `
+  }); // set some globals to make life easier
+
+
+  _.context.babelrc = babelrc;
+  _.context.components = components;
+  _.context.dataPaths = jsonDataPaths;
+  _.context.getNode = getNode;
+  _.context.getNodes = getNodes;
+  _.context.getNodesByType = getNodesByType;
+  _.context.loadNodeContent = loadNodeContent;
+  _.context.nodes = [...nodes.entries()];
+  _.context.pages = [...pages.entries()];
+  _.context.graphql = query;
+  _.context.schema = schema;
+  _.context.siteConfig = config;
+  _.context.staticQueries = staticQueryComponents;
+
+  _.on(`exit`, () => process.exit(0));
+};
 //# sourceMappingURL=repl.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/commands/repl.js.map b/node_modules/gatsby/dist/commands/repl.js.map
index eadfa46..103cbce 100644
--- a/node_modules/gatsby/dist/commands/repl.js.map
+++ b/node_modules/gatsby/dist/commands/repl.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/commands/repl.js"],"names":["repl","require","graphql","bootstrap","loadNodeContent","getNodes","getNode","getNodesByType","store","module","exports","program","getState","schema","config","babelrc","jsonDataPaths","pages","components","staticQueryComponents","nodes","query","result","console","log","JSON","stringify","_","start","prompt","context","dataPaths","entries","siteConfig","staticQueries","on","process","exit"],"mappings":";;;;;;AAAA,MAAMA,IAAI,GAAGC,OAAO,CAAE,MAAF,CAApB;;iBACoBA,OAAO,CAAE,SAAF,C;MAAnBC,O,YAAAA,O;;AACR,MAAMC,SAAS,GAAGF,OAAO,CAAE,cAAF,CAAzB;;kBAMIA,OAAO,CAAE,aAAF,C;MAJTG,e,aAAAA,e;MACAC,Q,aAAAA,Q;MACAC,O,aAAAA,O;MACAC,c,aAAAA,c;;kBAEgBN,OAAO,CAAE,UAAF,C;MAAjBO,K,aAAAA,K;;AAERC,MAAM,CAACC,OAAP;AAAA;AAAA;AAAA,6CAAiB,WAAMC,OAAN,EAAiB;AAChC;AACA,UAAMR,SAAS,CAACQ,OAAD,CAAf,CAFgC,CAIhC;;AAJgC,4BAa5BH,KAAK,CAACI,QAAN,EAb4B;AAAA,UAM9BC,MAN8B,mBAM9BA,MAN8B;AAAA,UAO9BC,MAP8B,mBAO9BA,MAP8B;AAAA,UAQ9BC,OAR8B,mBAQ9BA,OAR8B;AAAA,UAS9BC,aAT8B,mBAS9BA,aAT8B;AAAA,UAU9BC,KAV8B,mBAU9BA,KAV8B;AAAA,UAW9BC,UAX8B,mBAW9BA,UAX8B;AAAA,UAY9BC,qBAZ8B,mBAY9BA,qBAZ8B;;AAehC,UAAMC,KAAK,GAAGf,QAAQ,EAAtB;;AAEA,UAAMgB,KAAK;AAAA;AAAA;AAAA,kDAAG,WAAMA,MAAN,EAAe;AAC3B,cAAMC,MAAM,SAASpB,OAAO,CAACW,MAAD,EAASQ,MAAT,EAAgB,EAAhB,EAAoB,EAApB,EAAwB,EAAxB,CAA5B;AACAE,QAAAA,OAAO,CAACC,GAAR,CAAa,iBAAgBC,IAAI,CAACC,SAAL,CAAeJ,MAAf,CAAuB,EAApD;AACD,OAHU;;AAAA;AAAA;AAAA;AAAA,OAAX,CAjBgC,CAsBhC;;;AACA,UAAMK,CAAC,GAAG3B,IAAI,CAAC4B,KAAL,CAAW;AACnBC,MAAAA,MAAM,EAAG;AADU,KAAX,CAAV,CAvBgC,CA2BhC;;;AACAF,IAAAA,CAAC,CAACG,OAAF,CAAUf,OAAV,GAAoBA,OAApB;AACAY,IAAAA,CAAC,CAACG,OAAF,CAAUZ,UAAV,GAAuBA,UAAvB;AACAS,IAAAA,CAAC,CAACG,OAAF,CAAUC,SAAV,GAAsBf,aAAtB;AACAW,IAAAA,CAAC,CAACG,OAAF,CAAUxB,OAAV,GAAoBA,OAApB;AACAqB,IAAAA,CAAC,CAACG,OAAF,CAAUzB,QAAV,GAAqBA,QAArB;AACAsB,IAAAA,CAAC,CAACG,OAAF,CAAUvB,cAAV,GAA2BA,cAA3B;AACAoB,IAAAA,CAAC,CAACG,OAAF,CAAU1B,eAAV,GAA4BA,eAA5B;AACAuB,IAAAA,CAAC,CAACG,OAAF,CAAUV,KAAV,GAAkB,CAAC,GAAGA,KAAK,CAACY,OAAN,EAAJ,CAAlB;AACAL,IAAAA,CAAC,CAACG,OAAF,CAAUb,KAAV,GAAkB,CAAC,GAAGA,KAAK,CAACe,OAAN,EAAJ,CAAlB;AACAL,IAAAA,CAAC,CAACG,OAAF,CAAU5B,OAAV,GAAoBmB,KAApB;AACAM,IAAAA,CAAC,CAACG,OAAF,CAAUjB,MAAV,GAAmBA,MAAnB;AACAc,IAAAA,CAAC,CAACG,OAAF,CAAUG,UAAV,GAAuBnB,MAAvB;AACAa,IAAAA,CAAC,CAACG,OAAF,CAAUI,aAAV,GAA0Bf,qBAA1B;;AAEAQ,IAAAA,CAAC,CAACQ,EAAF,CAAM,MAAN,EAAa,MAAMC,OAAO,CAACC,IAAR,CAAa,CAAb,CAAnB;AACD,GA3CD;;AAAA;AAAA;AAAA;AAAA","sourcesContent":["const repl = require(`repl`)\nconst { graphql } = require(`graphql`)\nconst bootstrap = require(`../bootstrap`)\nconst {\n  loadNodeContent,\n  getNodes,\n  getNode,\n  getNodesByType,\n} = require(`../db/nodes`)\nconst { store } = require(`../redux`)\n\nmodule.exports = async program => {\n  // run bootstrap\n  await bootstrap(program)\n\n  // get all the goodies from the store\n  const {\n    schema,\n    config,\n    babelrc,\n    jsonDataPaths,\n    pages,\n    components,\n    staticQueryComponents,\n  } = store.getState()\n\n  const nodes = getNodes()\n\n  const query = async query => {\n    const result = await graphql(schema, query, {}, {}, {})\n    console.log(`query result: ${JSON.stringify(result)}`)\n  }\n\n  // init new repl\n  const _ = repl.start({\n    prompt: `gatsby > `,\n  })\n\n  // set some globals to make life easier\n  _.context.babelrc = babelrc\n  _.context.components = components\n  _.context.dataPaths = jsonDataPaths\n  _.context.getNode = getNode\n  _.context.getNodes = getNodes\n  _.context.getNodesByType = getNodesByType\n  _.context.loadNodeContent = loadNodeContent\n  _.context.nodes = [...nodes.entries()]\n  _.context.pages = [...pages.entries()]\n  _.context.graphql = query\n  _.context.schema = schema\n  _.context.siteConfig = config\n  _.context.staticQueries = staticQueryComponents\n\n  _.on(`exit`, () => process.exit(0))\n}\n"],"file":"repl.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/commands/repl.js"],"names":["repl","require","graphql","bootstrap","loadNodeContent","getNodes","getNode","getNodesByType","store","module","exports","program","schema","config","babelrc","jsonDataPaths","pages","components","staticQueryComponents","getState","nodes","query","result","console","log","JSON","stringify","_","start","prompt","context","dataPaths","entries","siteConfig","staticQueries","on","process","exit"],"mappings":";;AAAA,MAAMA,IAAI,GAAGC,OAAO,CAAE,MAAF,CAApB;;AACA,MAAM;AAAEC,EAAAA;AAAF,IAAcD,OAAO,CAAE,SAAF,CAA3B;;AACA,MAAME,SAAS,GAAGF,OAAO,CAAE,cAAF,CAAzB;;AACA,MAAM;AACJG,EAAAA,eADI;AAEJC,EAAAA,QAFI;AAGJC,EAAAA,OAHI;AAIJC,EAAAA;AAJI,IAKFN,OAAO,CAAE,aAAF,CALX;;AAMA,MAAM;AAAEO,EAAAA;AAAF,IAAYP,OAAO,CAAE,UAAF,CAAzB;;AAEAQ,MAAM,CAACC,OAAP,GAAiB,MAAMC,OAAN,IAAiB;AAChC;AACA,QAAMR,SAAS,CAACQ,OAAD,CAAf,CAFgC,CAIhC;;AACA,QAAM;AACJC,IAAAA,MADI;AAEJC,IAAAA,MAFI;AAGJC,IAAAA,OAHI;AAIJC,IAAAA,aAJI;AAKJC,IAAAA,KALI;AAMJC,IAAAA,UANI;AAOJC,IAAAA;AAPI,MAQFV,KAAK,CAACW,QAAN,EARJ;AAUA,QAAMC,KAAK,GAAGf,QAAQ,EAAtB;;AAEA,QAAMgB,KAAK,GAAG,MAAMA,KAAN,IAAe;AAC3B,UAAMC,MAAM,GAAG,MAAMpB,OAAO,CAACU,MAAD,EAASS,KAAT,EAAgB,EAAhB,EAAoB,EAApB,EAAwB,EAAxB,CAA5B;AACAE,IAAAA,OAAO,CAACC,GAAR,CAAa,iBAAgBC,IAAI,CAACC,SAAL,CAAeJ,MAAf,CAAuB,EAApD;AACD,GAHD,CAjBgC,CAsBhC;;;AACA,QAAMK,CAAC,GAAG3B,IAAI,CAAC4B,KAAL,CAAW;AACnBC,IAAAA,MAAM,EAAG;AADU,GAAX,CAAV,CAvBgC,CA2BhC;;;AACAF,EAAAA,CAAC,CAACG,OAAF,CAAUhB,OAAV,GAAoBA,OAApB;AACAa,EAAAA,CAAC,CAACG,OAAF,CAAUb,UAAV,GAAuBA,UAAvB;AACAU,EAAAA,CAAC,CAACG,OAAF,CAAUC,SAAV,GAAsBhB,aAAtB;AACAY,EAAAA,CAAC,CAACG,OAAF,CAAUxB,OAAV,GAAoBA,OAApB;AACAqB,EAAAA,CAAC,CAACG,OAAF,CAAUzB,QAAV,GAAqBA,QAArB;AACAsB,EAAAA,CAAC,CAACG,OAAF,CAAUvB,cAAV,GAA2BA,cAA3B;AACAoB,EAAAA,CAAC,CAACG,OAAF,CAAU1B,eAAV,GAA4BA,eAA5B;AACAuB,EAAAA,CAAC,CAACG,OAAF,CAAUV,KAAV,GAAkB,CAAC,GAAGA,KAAK,CAACY,OAAN,EAAJ,CAAlB;AACAL,EAAAA,CAAC,CAACG,OAAF,CAAUd,KAAV,GAAkB,CAAC,GAAGA,KAAK,CAACgB,OAAN,EAAJ,CAAlB;AACAL,EAAAA,CAAC,CAACG,OAAF,CAAU5B,OAAV,GAAoBmB,KAApB;AACAM,EAAAA,CAAC,CAACG,OAAF,CAAUlB,MAAV,GAAmBA,MAAnB;AACAe,EAAAA,CAAC,CAACG,OAAF,CAAUG,UAAV,GAAuBpB,MAAvB;AACAc,EAAAA,CAAC,CAACG,OAAF,CAAUI,aAAV,GAA0BhB,qBAA1B;;AAEAS,EAAAA,CAAC,CAACQ,EAAF,CAAM,MAAN,EAAa,MAAMC,OAAO,CAACC,IAAR,CAAa,CAAb,CAAnB;AACD,CA3CD","sourcesContent":["const repl = require(`repl`)\nconst { graphql } = require(`graphql`)\nconst bootstrap = require(`../bootstrap`)\nconst {\n  loadNodeContent,\n  getNodes,\n  getNode,\n  getNodesByType,\n} = require(`../db/nodes`)\nconst { store } = require(`../redux`)\n\nmodule.exports = async program => {\n  // run bootstrap\n  await bootstrap(program)\n\n  // get all the goodies from the store\n  const {\n    schema,\n    config,\n    babelrc,\n    jsonDataPaths,\n    pages,\n    components,\n    staticQueryComponents,\n  } = store.getState()\n\n  const nodes = getNodes()\n\n  const query = async query => {\n    const result = await graphql(schema, query, {}, {}, {})\n    console.log(`query result: ${JSON.stringify(result)}`)\n  }\n\n  // init new repl\n  const _ = repl.start({\n    prompt: `gatsby > `,\n  })\n\n  // set some globals to make life easier\n  _.context.babelrc = babelrc\n  _.context.components = components\n  _.context.dataPaths = jsonDataPaths\n  _.context.getNode = getNode\n  _.context.getNodes = getNodes\n  _.context.getNodesByType = getNodesByType\n  _.context.loadNodeContent = loadNodeContent\n  _.context.nodes = [...nodes.entries()]\n  _.context.pages = [...pages.entries()]\n  _.context.graphql = query\n  _.context.schema = schema\n  _.context.siteConfig = config\n  _.context.staticQueries = staticQueryComponents\n\n  _.on(`exit`, () => process.exit(0))\n}\n"],"file":"repl.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/commands/serve.js b/node_modules/gatsby/dist/commands/serve.js
index cd58788..c66e175 100644
--- a/node_modules/gatsby/dist/commands/serve.js
+++ b/node_modules/gatsby/dist/commands/serve.js
@@ -1,18 +1,11 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
-/*  weak */
 const path = require(`path`);
 
 const openurl = require(`better-opn`);
 
 const fs = require(`fs-extra`);
 
-const signalExit = require(`signal-exit`);
-
 const compression = require(`compression`);
 
 const express = require(`express`);
@@ -23,18 +16,46 @@ const preferDefault = require(`../bootstrap/prefer-default`);
 
 const chalk = require(`chalk`);
 
-const _require = require(`@reach/router/lib/utils`),
-      reachMatch = _require.match;
+const detectPortInUseAndPrompt = require(`../utils/detect-port-in-use-and-prompt`);
+
+const rl = require(`readline`);
+
+const onExit = require(`signal-exit`);
+
+const {
+  matchPathFactory
+} = require(`../../cache-dir/path-matcher`);
 
-const getPages = directory => fs.readFile(path.join(directory, `.cache`, `pages.json`)).then(contents => JSON.parse(contents)).catch(() => []);
+const telemetry = require(`gatsby-telemetry`);
+
+const rlInterface = rl.createInterface({
+  input: process.stdin,
+  output: process.stdout
+}); // Quit immediately on hearing ctrl-c
+
+rlInterface.on(`SIGINT`, () => {
+  process.exit();
+});
+onExit(() => {
+  telemetry.trackCli(`SERVE_STOP`);
+});
+
+const getPages = directory => fs.readFile(path.join(directory, `.cache`, `pages.json`)).then(contents => JSON.parse(contents)).catch(() => {
+  return {
+    v: undefined,
+    c: {}
+  };
+});
 
 const clientOnlyPathsRouter = (pages, options) => {
-  const clientOnlyRoutes = pages.filter(page => page.matchPath);
+  const matchPath = matchPathFactory(pages);
   return (req, res, next) => {
-    const url = req.url;
+    const {
+      url
+    } = req;
 
     if (req.accepts(`html`)) {
-      const route = clientOnlyRoutes.find(clientRoute => reachMatch(clientRoute.matchPath, url) !== null);
+      const route = matchPath(url);
 
       if (route && route.path) {
         return res.sendFile(path.join(route.path, `index.html`), options, err => {
@@ -49,38 +70,42 @@ const clientOnlyPathsRouter = (pages, options) => {
   };
 };
 
-module.exports =
-/*#__PURE__*/
-function () {
-  var _ref = (0, _asyncToGenerator2.default)(function* (program) {
-    let prefixPaths = program.prefixPaths,
-        port = program.port,
-        open = program.open,
-        host = program.host;
-    port = typeof port === `string` ? parseInt(port, 10) : port;
-    const config = yield preferDefault(getConfigFile(program.directory, `gatsby-config`));
-    let pathPrefix = config && config.pathPrefix;
-    pathPrefix = prefixPaths && pathPrefix ? pathPrefix : `/`;
-    const root = path.join(program.directory, `public`);
-    const pages = yield getPages(program.directory);
-    const app = express();
-    const router = express.Router();
-    router.use(compression());
-    router.use(express.static(`public`));
-    router.use(clientOnlyPathsRouter(pages, {
-      root
-    }));
-    router.use((req, res, next) => {
-      if (req.accepts(`html`)) {
-        return res.status(404).sendFile(`404.html`, {
-          root
-        });
-      }
+module.exports = async program => {
+  telemetry.trackCli(`SERVE_START`);
+  telemetry.startBackgroundUpdate();
+  let {
+    prefixPaths,
+    port,
+    open,
+    host
+  } = program;
+  port = typeof port === `string` ? parseInt(port, 10) : port;
+  const config = await preferDefault(getConfigFile(program.directory, `gatsby-config`));
+  let pathPrefix = config && config.pathPrefix;
+  pathPrefix = prefixPaths && pathPrefix ? pathPrefix : `/`;
+  const root = path.join(program.directory, `public`);
+  const pages = await getPages(program.directory);
+  const app = express();
+  const router = express.Router();
+  app.use(telemetry.expressMiddleware(`SERVE`));
+  router.use(compression());
+  router.use(express.static(`public`));
+  router.use(clientOnlyPathsRouter(pages, {
+    root
+  }));
+  router.use((req, res, next) => {
+    if (req.accepts(`html`)) {
+      return res.status(404).sendFile(`404.html`, {
+        root
+      });
+    }
 
-      return next();
-    });
-    app.use(pathPrefix, router);
-    const server = app.listen(port, host, () => {
+    return next();
+  });
+  app.use(pathPrefix, router);
+
+  const startListening = () => {
+    app.listen(port, host, () => {
       let openUrlString = `http://${host}:${port}${pathPrefix}`;
       console.log(`${chalk.blue(`info`)} gatsby serve running at: ${chalk.bold(openUrlString)}`);
 
@@ -89,11 +114,9 @@ function () {
         Promise.resolve(openurl(openUrlString)).catch(err => console.log(`${chalk.yellow(`warn`)} Browser not opened because no browser was found`));
       }
     });
-    signalExit(() => server.close());
-  });
-
-  return function (_x) {
-    return _ref.apply(this, arguments);
   };
-}();
+
+  port = await detectPortInUseAndPrompt(port, rlInterface);
+  startListening();
+};
 //# sourceMappingURL=serve.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/commands/serve.js.map b/node_modules/gatsby/dist/commands/serve.js.map
index a6e89f4..7ce2f4a 100644
--- a/node_modules/gatsby/dist/commands/serve.js.map
+++ b/node_modules/gatsby/dist/commands/serve.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/commands/serve.js"],"names":["path","require","openurl","fs","signalExit","compression","express","getConfigFile","preferDefault","chalk","reachMatch","match","getPages","directory","readFile","join","then","contents","JSON","parse","catch","clientOnlyPathsRouter","pages","options","clientOnlyRoutes","filter","page","matchPath","req","res","next","url","accepts","route","find","clientRoute","sendFile","err","module","exports","program","prefixPaths","port","open","host","parseInt","config","pathPrefix","root","app","router","Router","use","static","status","server","listen","openUrlString","console","log","blue","bold","Promise","resolve","yellow","close"],"mappings":"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","sourcesContent":["/* @flow weak */\nconst path = require(`path`)\nconst openurl = require(`better-opn`)\nconst fs = require(`fs-extra`)\nconst signalExit = require(`signal-exit`)\nconst compression = require(`compression`)\nconst express = require(`express`)\nconst getConfigFile = require(`../bootstrap/get-config-file`)\nconst preferDefault = require(`../bootstrap/prefer-default`)\nconst chalk = require(`chalk`)\nconst { match: reachMatch } = require(`@reach/router/lib/utils`)\n\nconst getPages = directory =>\n  fs\n    .readFile(path.join(directory, `.cache`, `pages.json`))\n    .then(contents => JSON.parse(contents))\n    .catch(() => [])\n\nconst clientOnlyPathsRouter = (pages, options) => {\n  const clientOnlyRoutes = pages.filter(page => page.matchPath)\n  return (req, res, next) => {\n    const { url } = req\n    if (req.accepts(`html`)) {\n      const route = clientOnlyRoutes.find(\n        clientRoute => reachMatch(clientRoute.matchPath, url) !== null\n      )\n      if (route && route.path) {\n        return res.sendFile(\n          path.join(route.path, `index.html`),\n          options,\n          err => {\n            if (err) {\n              next()\n            }\n          }\n        )\n      }\n    }\n    return next()\n  }\n}\n\nmodule.exports = async program => {\n  let { prefixPaths, port, open, host } = program\n  port = typeof port === `string` ? parseInt(port, 10) : port\n\n  const config = await preferDefault(\n    getConfigFile(program.directory, `gatsby-config`)\n  )\n\n  let pathPrefix = config && config.pathPrefix\n  pathPrefix = prefixPaths && pathPrefix ? pathPrefix : `/`\n\n  const root = path.join(program.directory, `public`)\n  const pages = await getPages(program.directory)\n\n  const app = express()\n  const router = express.Router()\n  router.use(compression())\n  router.use(express.static(`public`))\n  router.use(clientOnlyPathsRouter(pages, { root }))\n  router.use((req, res, next) => {\n    if (req.accepts(`html`)) {\n      return res.status(404).sendFile(`404.html`, { root })\n    }\n    return next()\n  })\n  app.use(pathPrefix, router)\n\n  const server = app.listen(port, host, () => {\n    let openUrlString = `http://${host}:${port}${pathPrefix}`\n    console.log(\n      `${chalk.blue(`info`)} gatsby serve running at: ${chalk.bold(\n        openUrlString\n      )}`\n    )\n    if (open) {\n      console.log(`${chalk.blue(`info`)} Opening browser...`)\n      Promise.resolve(openurl(openUrlString)).catch(err =>\n        console.log(\n          `${chalk.yellow(\n            `warn`\n          )} Browser not opened because no browser was found`\n        )\n      )\n    }\n  })\n\n  signalExit(() => server.close())\n}\n"],"file":"serve.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/commands/serve.js"],"names":["path","require","openurl","fs","compression","express","getConfigFile","preferDefault","chalk","detectPortInUseAndPrompt","rl","onExit","matchPathFactory","telemetry","rlInterface","createInterface","input","process","stdin","output","stdout","on","exit","trackCli","getPages","directory","readFile","join","then","contents","JSON","parse","catch","v","undefined","c","clientOnlyPathsRouter","pages","options","matchPath","req","res","next","url","accepts","route","sendFile","err","module","exports","program","startBackgroundUpdate","prefixPaths","port","open","host","parseInt","config","pathPrefix","root","app","router","Router","use","expressMiddleware","static","status","startListening","listen","openUrlString","console","log","blue","bold","Promise","resolve","yellow"],"mappings":"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","sourcesContent":["/* @flow weak */\nconst path = require(`path`)\nconst openurl = require(`better-opn`)\nconst fs = require(`fs-extra`)\nconst compression = require(`compression`)\nconst express = require(`express`)\nconst getConfigFile = require(`../bootstrap/get-config-file`)\nconst preferDefault = require(`../bootstrap/prefer-default`)\nconst chalk = require(`chalk`)\nconst detectPortInUseAndPrompt = require(`../utils/detect-port-in-use-and-prompt`)\nconst rl = require(`readline`)\nconst onExit = require(`signal-exit`)\nconst { matchPathFactory } = require(`../../cache-dir/path-matcher`)\n\nconst telemetry = require(`gatsby-telemetry`)\n\nconst rlInterface = rl.createInterface({\n  input: process.stdin,\n  output: process.stdout,\n})\n\n// Quit immediately on hearing ctrl-c\nrlInterface.on(`SIGINT`, () => {\n  process.exit()\n})\n\nonExit(() => {\n  telemetry.trackCli(`SERVE_STOP`)\n})\n\nconst getPages = directory =>\n  fs\n    .readFile(path.join(directory, `.cache`, `pages.json`))\n    .then(contents => JSON.parse(contents))\n    .catch(() => {\n      return {\n        v: undefined,\n        c: {},\n      }\n    })\n\nconst clientOnlyPathsRouter = (pages, options) => {\n  const matchPath = matchPathFactory(pages)\n  return (req, res, next) => {\n    const { url } = req\n    if (req.accepts(`html`)) {\n      const route = matchPath(url)\n      if (route && route.path) {\n        return res.sendFile(\n          path.join(route.path, `index.html`),\n          options,\n          err => {\n            if (err) {\n              next()\n            }\n          }\n        )\n      }\n    }\n    return next()\n  }\n}\n\nmodule.exports = async program => {\n  telemetry.trackCli(`SERVE_START`)\n  telemetry.startBackgroundUpdate()\n  let { prefixPaths, port, open, host } = program\n  port = typeof port === `string` ? parseInt(port, 10) : port\n\n  const config = await preferDefault(\n    getConfigFile(program.directory, `gatsby-config`)\n  )\n\n  let pathPrefix = config && config.pathPrefix\n  pathPrefix = prefixPaths && pathPrefix ? pathPrefix : `/`\n\n  const root = path.join(program.directory, `public`)\n  const pages = await getPages(program.directory)\n\n  const app = express()\n  const router = express.Router()\n\n  app.use(telemetry.expressMiddleware(`SERVE`))\n\n  router.use(compression())\n  router.use(express.static(`public`))\n  router.use(\n    clientOnlyPathsRouter(pages, {\n      root,\n    })\n  )\n  router.use((req, res, next) => {\n    if (req.accepts(`html`)) {\n      return res.status(404).sendFile(`404.html`, {\n        root,\n      })\n    }\n    return next()\n  })\n  app.use(pathPrefix, router)\n\n  const startListening = () => {\n    app.listen(port, host, () => {\n      let openUrlString = `http://${host}:${port}${pathPrefix}`\n      console.log(\n        `${chalk.blue(`info`)} gatsby serve running at: ${chalk.bold(\n          openUrlString\n        )}`\n      )\n      if (open) {\n        console.log(`${chalk.blue(`info`)} Opening browser...`)\n        Promise.resolve(openurl(openUrlString)).catch(err =>\n          console.log(\n            `${chalk.yellow(\n              `warn`\n            )} Browser not opened because no browser was found`\n          )\n        )\n      }\n    })\n  }\n\n  port = await detectPortInUseAndPrompt(port, rlInterface)\n  startListening()\n}\n"],"file":"serve.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/db/index.js b/node_modules/gatsby/dist/db/index.js
index 65d46f6..b9a9f17 100644
--- a/node_modules/gatsby/dist/db/index.js
+++ b/node_modules/gatsby/dist/db/index.js
@@ -1,16 +1,14 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const _ = require(`lodash`);
 
 const report = require(`gatsby-cli/lib/reporter`);
 
 const redux = require(`../redux`);
 
-const emitter = redux.emitter; // Even if we are using loki, we still include redux in the list of
+const {
+  emitter
+} = redux; // Even if we are using loki, we still include redux in the list of
 // dbs since it still has pages, config, etc.
 
 const dbs = [redux];
@@ -22,59 +20,33 @@ if (process.env.GATSBY_DB_NODES === `loki`) {
 
 let saveInProgress = false;
 
-function saveState() {
-  return _saveState.apply(this, arguments);
-}
+async function saveState() {
+  if (saveInProgress) return;
+  saveInProgress = true;
 
-function _saveState() {
-  _saveState = (0, _asyncToGenerator2.default)(function* () {
-    if (saveInProgress) return;
-    saveInProgress = true;
-
-    try {
-      yield Promise.all(dbs.map(db => db.saveState()));
-    } catch (err) {
-      report.warn(`Error persisting state: ${err && err.message || err}`);
-    }
+  try {
+    await Promise.all(dbs.map(db => db.saveState()));
+  } catch (err) {
+    report.warn(`Error persisting state: ${err && err.message || err}`);
+  }
 
-    saveInProgress = false;
-  });
-  return _saveState.apply(this, arguments);
+  saveInProgress = false;
 }
 
 const saveStateDebounced = _.debounce(saveState, 1000);
 /**
- * Sets up listeners so that once bootstrap has finished, all
- * databases save their state to disk. If we're in `develop` mode,
- * then any new event triggers a debounced save as well.
+ * Starts listening to redux actions and triggers a database save to
+ * disk upon any action (debounced to every 1 second)
  */
 
 
 function startAutosave() {
-  // During development, once bootstrap is finished, persist state on changes.
-  let bootstrapFinished = false;
-
-  if (process.env.gatsby_executing_command === `develop`) {
-    emitter.on(`BOOTSTRAP_FINISHED`, () => {
-      bootstrapFinished = true;
-      saveState();
-    });
-    emitter.on(`*`, () => {
-      if (bootstrapFinished) {
-        saveStateDebounced();
-      }
-    });
-  } // During builds, persist state once bootstrap has finished.
-
-
-  if (process.env.gatsby_executing_command === `build`) {
-    emitter.on(`BOOTSTRAP_FINISHED`, () => {
-      saveState();
-    });
-  }
+  saveStateDebounced();
+  emitter.on(`*`, () => saveStateDebounced());
 }
 
 module.exports = {
-  startAutosave
+  startAutosave,
+  saveState
 };
 //# sourceMappingURL=index.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/db/index.js.map b/node_modules/gatsby/dist/db/index.js.map
index 22c8129..b511f4e 100644
--- a/node_modules/gatsby/dist/db/index.js.map
+++ b/node_modules/gatsby/dist/db/index.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/db/index.js"],"names":["_","require","report","redux","emitter","dbs","process","env","GATSBY_DB_NODES","push","saveInProgress","saveState","Promise","all","map","db","err","warn","message","saveStateDebounced","debounce","startAutosave","bootstrapFinished","gatsby_executing_command","on","module","exports"],"mappings":";;;;;;AAAA,MAAMA,CAAC,GAAGC,OAAO,CAAE,QAAF,CAAjB;;AACA,MAAMC,MAAM,GAAGD,OAAO,CAAE,yBAAF,CAAtB;;AACA,MAAME,KAAK,GAAGF,OAAO,CAAE,UAAF,CAArB;;MACQG,O,GAAYD,K,CAAZC,O,EAER;AACA;;AACA,MAAMC,GAAG,GAAG,CAACF,KAAD,CAAZ;;AACA,IAAIG,OAAO,CAACC,GAAR,CAAYC,eAAZ,KAAiC,MAArC,EAA4C;AAC1CH,EAAAA,GAAG,CAACI,IAAJ,CAASR,OAAO,CAAE,QAAF,CAAhB;AACD,C,CAED;;;AACA,IAAIS,cAAc,GAAG,KAArB;;SACeC,S;;;;;+CAAf,aAA2B;AACzB,QAAID,cAAJ,EAAoB;AACpBA,IAAAA,cAAc,GAAG,IAAjB;;AAEA,QAAI;AACF,YAAME,OAAO,CAACC,GAAR,CAAYR,GAAG,CAACS,GAAJ,CAAQC,EAAE,IAAIA,EAAE,CAACJ,SAAH,EAAd,CAAZ,CAAN;AACD,KAFD,CAEE,OAAOK,GAAP,EAAY;AACZd,MAAAA,MAAM,CAACe,IAAP,CAAa,2BAA2BD,GAAG,IAAIA,GAAG,CAACE,OAAZ,IAAwBF,GAAI,EAAnE;AACD;;AAEDN,IAAAA,cAAc,GAAG,KAAjB;AACD,G;;;;AACD,MAAMS,kBAAkB,GAAGnB,CAAC,CAACoB,QAAF,CAAWT,SAAX,EAAsB,IAAtB,CAA3B;AAEA;;;;;;;AAKA,SAASU,aAAT,GAAyB;AACvB;AACA,MAAIC,iBAAiB,GAAG,KAAxB;;AACA,MAAIhB,OAAO,CAACC,GAAR,CAAYgB,wBAAZ,KAA0C,SAA9C,EAAwD;AACtDnB,IAAAA,OAAO,CAACoB,EAAR,CAAY,oBAAZ,EAAiC,MAAM;AACrCF,MAAAA,iBAAiB,GAAG,IAApB;AACAX,MAAAA,SAAS;AACV,KAHD;AAIAP,IAAAA,OAAO,CAACoB,EAAR,CAAY,GAAZ,EAAgB,MAAM;AACpB,UAAIF,iBAAJ,EAAuB;AACrBH,QAAAA,kBAAkB;AACnB;AACF,KAJD;AAKD,GAbsB,CAevB;;;AACA,MAAIb,OAAO,CAACC,GAAR,CAAYgB,wBAAZ,KAA0C,OAA9C,EAAsD;AACpDnB,IAAAA,OAAO,CAACoB,EAAR,CAAY,oBAAZ,EAAiC,MAAM;AACrCb,MAAAA,SAAS;AACV,KAFD;AAGD;AACF;;AAEDc,MAAM,CAACC,OAAP,GAAiB;AACfL,EAAAA;AADe,CAAjB","sourcesContent":["const _ = require(`lodash`)\nconst report = require(`gatsby-cli/lib/reporter`)\nconst redux = require(`../redux`)\nconst { emitter } = redux\n\n// Even if we are using loki, we still include redux in the list of\n// dbs since it still has pages, config, etc.\nconst dbs = [redux]\nif (process.env.GATSBY_DB_NODES === `loki`) {\n  dbs.push(require(`./loki`))\n}\n\n// calls `saveState()` on all DBs\nlet saveInProgress = false\nasync function saveState() {\n  if (saveInProgress) return\n  saveInProgress = true\n\n  try {\n    await Promise.all(dbs.map(db => db.saveState()))\n  } catch (err) {\n    report.warn(`Error persisting state: ${(err && err.message) || err}`)\n  }\n\n  saveInProgress = false\n}\nconst saveStateDebounced = _.debounce(saveState, 1000)\n\n/**\n * Sets up listeners so that once bootstrap has finished, all\n * databases save their state to disk. If we're in `develop` mode,\n * then any new event triggers a debounced save as well.\n */\nfunction startAutosave() {\n  // During development, once bootstrap is finished, persist state on changes.\n  let bootstrapFinished = false\n  if (process.env.gatsby_executing_command === `develop`) {\n    emitter.on(`BOOTSTRAP_FINISHED`, () => {\n      bootstrapFinished = true\n      saveState()\n    })\n    emitter.on(`*`, () => {\n      if (bootstrapFinished) {\n        saveStateDebounced()\n      }\n    })\n  }\n\n  // During builds, persist state once bootstrap has finished.\n  if (process.env.gatsby_executing_command === `build`) {\n    emitter.on(`BOOTSTRAP_FINISHED`, () => {\n      saveState()\n    })\n  }\n}\n\nmodule.exports = {\n  startAutosave,\n}\n"],"file":"index.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/db/index.js"],"names":["_","require","report","redux","emitter","dbs","process","env","GATSBY_DB_NODES","push","saveInProgress","saveState","Promise","all","map","db","err","warn","message","saveStateDebounced","debounce","startAutosave","on","module","exports"],"mappings":";;AAAA,MAAMA,CAAC,GAAGC,OAAO,CAAE,QAAF,CAAjB;;AACA,MAAMC,MAAM,GAAGD,OAAO,CAAE,yBAAF,CAAtB;;AACA,MAAME,KAAK,GAAGF,OAAO,CAAE,UAAF,CAArB;;AACA,MAAM;AAAEG,EAAAA;AAAF,IAAcD,KAApB,C,CAEA;AACA;;AACA,MAAME,GAAG,GAAG,CAACF,KAAD,CAAZ;;AACA,IAAIG,OAAO,CAACC,GAAR,CAAYC,eAAZ,KAAiC,MAArC,EAA4C;AAC1CH,EAAAA,GAAG,CAACI,IAAJ,CAASR,OAAO,CAAE,QAAF,CAAhB;AACD,C,CAED;;;AACA,IAAIS,cAAc,GAAG,KAArB;;AACA,eAAeC,SAAf,GAA2B;AACzB,MAAID,cAAJ,EAAoB;AACpBA,EAAAA,cAAc,GAAG,IAAjB;;AAEA,MAAI;AACF,UAAME,OAAO,CAACC,GAAR,CAAYR,GAAG,CAACS,GAAJ,CAAQC,EAAE,IAAIA,EAAE,CAACJ,SAAH,EAAd,CAAZ,CAAN;AACD,GAFD,CAEE,OAAOK,GAAP,EAAY;AACZd,IAAAA,MAAM,CAACe,IAAP,CAAa,2BAA2BD,GAAG,IAAIA,GAAG,CAACE,OAAZ,IAAwBF,GAAI,EAAnE;AACD;;AAEDN,EAAAA,cAAc,GAAG,KAAjB;AACD;;AACD,MAAMS,kBAAkB,GAAGnB,CAAC,CAACoB,QAAF,CAAWT,SAAX,EAAsB,IAAtB,CAA3B;AAEA;;;;;;AAIA,SAASU,aAAT,GAAyB;AACvBF,EAAAA,kBAAkB;AAClBf,EAAAA,OAAO,CAACkB,EAAR,CAAY,GAAZ,EAAgB,MAAMH,kBAAkB,EAAxC;AACD;;AAEDI,MAAM,CAACC,OAAP,GAAiB;AACfH,EAAAA,aADe;AAEfV,EAAAA;AAFe,CAAjB","sourcesContent":["const _ = require(`lodash`)\nconst report = require(`gatsby-cli/lib/reporter`)\nconst redux = require(`../redux`)\nconst { emitter } = redux\n\n// Even if we are using loki, we still include redux in the list of\n// dbs since it still has pages, config, etc.\nconst dbs = [redux]\nif (process.env.GATSBY_DB_NODES === `loki`) {\n  dbs.push(require(`./loki`))\n}\n\n// calls `saveState()` on all DBs\nlet saveInProgress = false\nasync function saveState() {\n  if (saveInProgress) return\n  saveInProgress = true\n\n  try {\n    await Promise.all(dbs.map(db => db.saveState()))\n  } catch (err) {\n    report.warn(`Error persisting state: ${(err && err.message) || err}`)\n  }\n\n  saveInProgress = false\n}\nconst saveStateDebounced = _.debounce(saveState, 1000)\n\n/**\n * Starts listening to redux actions and triggers a database save to\n * disk upon any action (debounced to every 1 second)\n */\nfunction startAutosave() {\n  saveStateDebounced()\n  emitter.on(`*`, () => saveStateDebounced())\n}\n\nmodule.exports = {\n  startAutosave,\n  saveState,\n}\n"],"file":"index.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/db/loki/index.js b/node_modules/gatsby/dist/db/loki/index.js
index 9b73a7d..11756a2 100644
--- a/node_modules/gatsby/dist/db/loki/index.js
+++ b/node_modules/gatsby/dist/db/loki/index.js
@@ -1,16 +1,12 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const _ = require(`lodash`);
 
 const fs = require(`fs-extra`);
 
 const path = require(`path`);
 
-const loki = require(`lokijs`);
+const loki = require(`@stefanprobst/lokijs`);
 
 const uuidv4 = require(`uuid/v4`);
 
@@ -64,8 +60,10 @@ let db;
 
 function ensureNodeCollections(db) {
   _.forEach(colls, collInfo => {
-    const name = collInfo.name,
-          options = collInfo.options;
+    const {
+      name,
+      options
+    } = collInfo;
     db.addCollection(name, options);
   });
 }
@@ -86,8 +84,9 @@ function startFileDb(saveFile) {
   });
 }
 
-function startInMemory() {
-  return _startInMemory.apply(this, arguments);
+async function startInMemory() {
+  // Use uuid purely for a random name
+  db = new loki(uuidv4());
 }
 /**
  * Starts a loki database. If the file already exists, it will be
@@ -103,41 +102,26 @@ function startInMemory() {
  */
 
 
-function _startInMemory() {
-  _startInMemory = (0, _asyncToGenerator2.default)(function* () {
-    // Use uuid purely for a random name
-    db = new loki(uuidv4());
-  });
-  return _startInMemory.apply(this, arguments);
-}
+async function start({
+  saveFile
+} = {}) {
+  if (saveFile && !_.isString(saveFile)) {
+    throw new Error(`saveFile must be a path`);
+  }
 
-function start() {
-  return _start.apply(this, arguments);
+  if (saveFile) {
+    const saveDir = path.dirname(saveFile);
+    await fs.ensureDir(saveDir);
+    await startFileDb(saveFile);
+  } else {
+    await startInMemory();
+  }
+
+  ensureNodeCollections(db);
 } // Saves the database to disk and returns a promise that will be
 // resolved once the save has finished
 
 
-function _start() {
-  _start = (0, _asyncToGenerator2.default)(function* ({
-    saveFile
-  } = {}) {
-    if (saveFile && !_.isString(saveFile)) {
-      throw new Error(`saveFile must be a path`);
-    }
-
-    if (saveFile) {
-      const saveDir = path.dirname(saveFile);
-      yield fs.ensureDir(saveDir);
-      yield startFileDb(saveFile);
-    } else {
-      yield startInMemory();
-    }
-
-    ensureNodeCollections(db);
-  });
-  return _start.apply(this, arguments);
-}
-
 function saveState() {
   return new Promise((resolve, reject) => {
     if (db) {
diff --git a/node_modules/gatsby/dist/db/loki/index.js.map b/node_modules/gatsby/dist/db/loki/index.js.map
index 7fa8000..a4d2261 100644
--- a/node_modules/gatsby/dist/db/loki/index.js.map
+++ b/node_modules/gatsby/dist/db/loki/index.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/db/loki/index.js"],"names":["_","require","fs","path","loki","uuidv4","customComparators","Comparators","lt","ltHelper","gt","gtHelper","colls","nodeMeta","name","options","unique","indices","nodeTypes","db","ensureNodeCollections","forEach","collInfo","addCollection","startFileDb","saveFile","Promise","resolve","reject","dbOptions","autoload","autoloadCallback","err","startInMemory","start","isString","Error","saveDir","dirname","ensureDir","saveState","saveDatabase","getDb","module","exports"],"mappings":"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","sourcesContent":["const _ = require(`lodash`)\nconst fs = require(`fs-extra`)\nconst path = require(`path`)\nconst loki = require(`lokijs`)\nconst uuidv4 = require(`uuid/v4`)\nconst customComparators = require(`./custom-comparators`)\n\n// Ensure sorting behavior matches old lodash `orderBy`\n// implementation. See `custom-comparators.js` for why.\nloki.Comparators.lt = customComparators.ltHelper\nloki.Comparators.gt = customComparators.gtHelper\n\n// Loki is a document store with the same semantics as mongo. This\n// means there are no tables or relationships. Just a bunch of\n// collections, each with objects.\n//\n// Gatsby stores nodes in collections by splitting them up by their\n// `node.internal.type`. All nodes of a particular type go in 1\n// collection. The below `colls` object contains the metadata for\n// these collections, and the \"meta collections\" used to track them.\n//\n// You won't use these directly. They are used by the collection\n// functions in `./nodes.js`. E.g `getTypeCollName()` and\n// `getNodeTypeCollection`\nconst colls = {\n  // Each object has keys `id` and `typeCollName`. It's a way of\n  // quickly looking up the collection that a node is contained in.\n  // E.g { id: `someNodeId`, typeCollName: `gatsby:nodeType:myType` }\n  nodeMeta: {\n    name: `gatsby:nodeMeta`,\n    options: {\n      unique: [`id`],\n      indices: [`id`],\n    },\n  },\n  // The list of all node type collections. Each object has keys\n  // `type` and `collName` so you can quickly look up the collection\n  // name for a node type.\n  // e.g { type: `myType`, collName: `gatsby:nodeType:myType` }\n  nodeTypes: {\n    name: `gatsby:nodeTypes`,\n    options: {\n      unique: [`type`, `collName`],\n      indices: [`type`],\n    },\n  },\n}\n\n// Must be set using `start()`\nlet db\n\n/**\n * Ensures that the collections that support nodes have been\n * created. See `colls` var in this file\n */\nfunction ensureNodeCollections(db) {\n  _.forEach(colls, collInfo => {\n    const { name, options } = collInfo\n    db.addCollection(name, options)\n  })\n}\n\nfunction startFileDb(saveFile) {\n  return new Promise((resolve, reject) => {\n    const dbOptions = {\n      autoload: true,\n      autoloadCallback: err => {\n        if (err) {\n          reject(err)\n        } else {\n          resolve()\n        }\n      },\n    }\n    db = new loki(saveFile, dbOptions)\n  })\n}\n\nasync function startInMemory() {\n  // Use uuid purely for a random name\n  db = new loki(uuidv4())\n}\n\n/**\n * Starts a loki database. If the file already exists, it will be\n * loaded as the database state. If not, a new database will be\n * created. If `saveFile` is omitted, an in-memory DB will be created.\n *\n * @param {string} saveFile on disk file that the database will be\n * saved and loaded from. If this is omitted, an in-memory database\n * will be created instead\n * @returns {Promise} promise that is resolved once the database and\n * the existing state has been loaded (if there was an existing\n * saveFile)\n */\nasync function start({ saveFile } = {}) {\n  if (saveFile && !_.isString(saveFile)) {\n    throw new Error(`saveFile must be a path`)\n  }\n  if (saveFile) {\n    const saveDir = path.dirname(saveFile)\n    await fs.ensureDir(saveDir)\n    await startFileDb(saveFile)\n  } else {\n    await startInMemory()\n  }\n  ensureNodeCollections(db)\n}\n\n// Saves the database to disk and returns a promise that will be\n// resolved once the save has finished\nfunction saveState() {\n  return new Promise((resolve, reject) => {\n    if (db) {\n      db.saveDatabase(err => {\n        if (err) {\n          reject(err)\n        } else {\n          resolve()\n        }\n      })\n    } else {\n      reject(`No database found.`)\n    }\n  })\n}\n\n/**\n * Returns a reference to the database. If undefined, the db has not been\n * initalized yet. Call `start()`\n *\n * @returns {Object} database, or undefined\n */\nfunction getDb() {\n  return db\n}\n\nmodule.exports = {\n  start,\n  getDb,\n  colls,\n  saveState,\n}\n"],"file":"index.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/db/loki/index.js"],"names":["_","require","fs","path","loki","uuidv4","customComparators","Comparators","lt","ltHelper","gt","gtHelper","colls","nodeMeta","name","options","unique","indices","nodeTypes","db","ensureNodeCollections","forEach","collInfo","addCollection","startFileDb","saveFile","Promise","resolve","reject","dbOptions","autoload","autoloadCallback","err","startInMemory","start","isString","Error","saveDir","dirname","ensureDir","saveState","saveDatabase","getDb","module","exports"],"mappings":"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","sourcesContent":["const _ = require(`lodash`)\nconst fs = require(`fs-extra`)\nconst path = require(`path`)\nconst loki = require(`@stefanprobst/lokijs`)\nconst uuidv4 = require(`uuid/v4`)\nconst customComparators = require(`./custom-comparators`)\n\n// Ensure sorting behavior matches old lodash `orderBy`\n// implementation. See `custom-comparators.js` for why.\nloki.Comparators.lt = customComparators.ltHelper\nloki.Comparators.gt = customComparators.gtHelper\n\n// Loki is a document store with the same semantics as mongo. This\n// means there are no tables or relationships. Just a bunch of\n// collections, each with objects.\n//\n// Gatsby stores nodes in collections by splitting them up by their\n// `node.internal.type`. All nodes of a particular type go in 1\n// collection. The below `colls` object contains the metadata for\n// these collections, and the \"meta collections\" used to track them.\n//\n// You won't use these directly. They are used by the collection\n// functions in `./nodes.js`. E.g `getTypeCollName()` and\n// `getNodeTypeCollection`\nconst colls = {\n  // Each object has keys `id` and `typeCollName`. It's a way of\n  // quickly looking up the collection that a node is contained in.\n  // E.g { id: `someNodeId`, typeCollName: `gatsby:nodeType:myType` }\n  nodeMeta: {\n    name: `gatsby:nodeMeta`,\n    options: {\n      unique: [`id`],\n      indices: [`id`],\n    },\n  },\n  // The list of all node type collections. Each object has keys\n  // `type` and `collName` so you can quickly look up the collection\n  // name for a node type.\n  // e.g { type: `myType`, collName: `gatsby:nodeType:myType` }\n  nodeTypes: {\n    name: `gatsby:nodeTypes`,\n    options: {\n      unique: [`type`, `collName`],\n      indices: [`type`],\n    },\n  },\n}\n\n// Must be set using `start()`\nlet db\n\n/**\n * Ensures that the collections that support nodes have been\n * created. See `colls` var in this file\n */\nfunction ensureNodeCollections(db) {\n  _.forEach(colls, collInfo => {\n    const { name, options } = collInfo\n    db.addCollection(name, options)\n  })\n}\n\nfunction startFileDb(saveFile) {\n  return new Promise((resolve, reject) => {\n    const dbOptions = {\n      autoload: true,\n      autoloadCallback: err => {\n        if (err) {\n          reject(err)\n        } else {\n          resolve()\n        }\n      },\n    }\n    db = new loki(saveFile, dbOptions)\n  })\n}\n\nasync function startInMemory() {\n  // Use uuid purely for a random name\n  db = new loki(uuidv4())\n}\n\n/**\n * Starts a loki database. If the file already exists, it will be\n * loaded as the database state. If not, a new database will be\n * created. If `saveFile` is omitted, an in-memory DB will be created.\n *\n * @param {string} saveFile on disk file that the database will be\n * saved and loaded from. If this is omitted, an in-memory database\n * will be created instead\n * @returns {Promise} promise that is resolved once the database and\n * the existing state has been loaded (if there was an existing\n * saveFile)\n */\nasync function start({ saveFile } = {}) {\n  if (saveFile && !_.isString(saveFile)) {\n    throw new Error(`saveFile must be a path`)\n  }\n  if (saveFile) {\n    const saveDir = path.dirname(saveFile)\n    await fs.ensureDir(saveDir)\n    await startFileDb(saveFile)\n  } else {\n    await startInMemory()\n  }\n  ensureNodeCollections(db)\n}\n\n// Saves the database to disk and returns a promise that will be\n// resolved once the save has finished\nfunction saveState() {\n  return new Promise((resolve, reject) => {\n    if (db) {\n      db.saveDatabase(err => {\n        if (err) {\n          reject(err)\n        } else {\n          resolve()\n        }\n      })\n    } else {\n      reject(`No database found.`)\n    }\n  })\n}\n\n/**\n * Returns a reference to the database. If undefined, the db has not been\n * initalized yet. Call `start()`\n *\n * @returns {Object} database, or undefined\n */\nfunction getDb() {\n  return db\n}\n\nmodule.exports = {\n  start,\n  getDb,\n  colls,\n  saveState,\n}\n"],"file":"index.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/db/loki/nodes-query.js b/node_modules/gatsby/dist/db/loki/nodes-query.js
index 6bddabd..22a66bc 100644
--- a/node_modules/gatsby/dist/db/loki/nodes-query.js
+++ b/node_modules/gatsby/dist/db/loki/nodes-query.js
@@ -1,20 +1,16 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const _ = require(`lodash`);
 
 const prepareRegex = require(`../../utils/prepare-regex`);
 
-const _require = require(`./nodes`),
-      getNodeTypeCollection = _require.getNodeTypeCollection;
-
-const sift = require(`sift`);
+const {
+  getNodeTypeCollection
+} = require(`./nodes`);
 
-const _require2 = require(`../../redux`),
-      emitter = _require2.emitter; // Cleared on DELETE_CACHE
+const {
+  emitter
+} = require(`../../redux`); // Cleared on DELETE_CACHE
 
 
 const fieldUsages = {};
@@ -24,52 +20,6 @@ emitter.on(`DELETE_CACHE`, () => {
     delete fieldUsages[field];
   }
 }); // Takes a raw graphql filter and converts it into a mongo-like args
-// object that can be understood by the `sift` library. E.g `eq`
-// becomes `$eq`
-
-function siftifyArgs(object) {
-  const newObject = {};
-
-  _.each(object, (v, k) => {
-    if (_.isPlainObject(v)) {
-      if (k === `elemMatch`) {
-        k = `$elemMatch`;
-      }
-
-      newObject[k] = siftifyArgs(v);
-    } else {
-      // Compile regex first.
-      if (k === `regex`) {
-        newObject[`$regex`] = prepareRegex(v);
-      } else if (k === `glob`) {
-        const Minimatch = require(`minimatch`).Minimatch;
-
-        const mm = new Minimatch(v);
-        newObject[`$regex`] = mm.makeRe();
-      } else {
-        newObject[`$${k}`] = v;
-      }
-    }
-  });
-
-  return newObject;
-} // filter nodes using the `sift` library. But isn't this a loki query
-// file? Yes, but we need to support all functionality provided by
-// `run-sift`, and there are some operators that loki can't
-// support. Like `elemMatch`, so for those fields, we fall back to
-// sift
-
-
-function runSift(nodes, query) {
-  if (nodes) {
-    const siftQuery = {
-      $elemMatch: siftifyArgs(query)
-    };
-    return sift(siftQuery, nodes);
-  } else {
-    return null;
-  }
-} // Takes a raw graphql filter and converts it into a mongo-like args
 // object that can be understood by loki. E.g `eq` becomes
 // `$eq`. gqlFilter should be the raw graphql filter returned from
 // graphql-js. e.g gqlFilter:
@@ -104,19 +54,14 @@ function runSift(nodes, query) {
 //   }
 // }
 
-
 function toMongoArgs(gqlFilter, lastFieldType) {
   const mongoArgs = {};
 
   _.each(gqlFilter, (v, k) => {
     if (_.isPlainObject(v)) {
       if (k === `elemMatch`) {
-        // loki doesn't support elemMatch, so use sift (see runSift
-        // comment above)
-        mongoArgs[`$where`] = obj => {
-          const result = runSift(obj, v);
-          return result && result.length > 0;
-        };
+        const gqlFieldType = lastFieldType.ofType;
+        mongoArgs[`$elemMatch`] = toMongoArgs(v, gqlFieldType);
       } else {
         const gqlFieldType = lastFieldType.getFields()[k].type;
         mongoArgs[k] = toMongoArgs(v, gqlFieldType);
@@ -191,7 +136,11 @@ const toDottedFields = (filter, acc = {}, path = []) => {
     const value = filter[key];
     const nextValue = _.isPlainObject(value) && value[Object.keys(value)[0]];
 
-    if (_.isPlainObject(nextValue)) {
+    if (key === `$elemMatch`) {
+      acc[path.join(`.`)] = {
+        [`$elemMatch`]: toDottedFields(value)
+      };
+    } else if (_.isPlainObject(nextValue)) {
       toDottedFields(value, acc, path.concat(key));
     } else {
       acc[path.concat(key).join(`.`)] = value;
@@ -209,8 +158,7 @@ const toDottedFields = (filter, acc = {}, path = []) => {
 
 const isNeTrue = (obj, path) => {
   if (path.length) {
-    const first = path[0],
-          rest = path.slice(1);
+    const [first, ...rest] = path;
     return obj == null || obj[first] == null || isNeTrue(obj[first], rest);
   } else {
     return obj !== true;
@@ -221,10 +169,7 @@ const fixNeTrue = filter => Object.keys(filter).reduce((acc, key) => {
   const value = filter[key];
 
   if (value[`$ne`] === true) {
-    const _key$split = key.split(`.`),
-          first = _key$split[0],
-          path = _key$split.slice(1);
-
+    const [first, ...path] = key.split(`.`);
     acc[first] = {
       [`$where`]: obj => isNeTrue(obj, path)
     };
@@ -238,8 +183,7 @@ const fixNeTrue = filter => Object.keys(filter).reduce((acc, key) => {
 
 const convertArgs = (gqlArgs, gqlType) => fixNeTrue(toDottedFields(toMongoArgs(gqlArgs.filter, gqlType))); // Converts graphql Sort args into the form expected by loki, which is
 // a vector where the first value is a field name, and the second is a
-// boolean `isDesc`. Nested fields delimited by `___` are replaced by
-// periods. E.g
+// boolean `isDesc`. E.g
 //
 // {
 //   fields: [ `frontmatter___date`, `id` ],
@@ -253,8 +197,10 @@ const convertArgs = (gqlArgs, gqlType) => fixNeTrue(toDottedFields(toMongoArgs(g
 
 
 function toSortFields(sortArgs) {
-  const fields = sortArgs.fields,
-        order = sortArgs.order;
+  const {
+    fields,
+    order
+  } = sortArgs;
   const lokiSortFields = [];
 
   for (let i = 0; i < fields.length; i++) {
@@ -289,7 +235,7 @@ function ensureFieldIndexes(coll, lokiArgs) {
  *
  * @param {Object} args. Object with:
  *
- * {Object} gqlType: built during `./build-node-types.js`
+ * {Object} gqlType: A GraphQL type
  *
  * {Object} queryArgs: The raw graphql query as a js object. E.g `{
  * filter: { fields { slug: { eq: "/somepath" } } } }`
@@ -304,51 +250,32 @@ function ensureFieldIndexes(coll, lokiArgs) {
  */
 
 
-function runQuery(_x) {
-  return _runQuery.apply(this, arguments);
-}
-
-function _runQuery() {
-  _runQuery = (0, _asyncToGenerator2.default)(function* ({
-    gqlType,
-    queryArgs,
-    firstOnly
-  }) {
-    // Clone args as for some reason graphql-js removes the constructor
-    // from nested objects which breaks a check in sift.js.
-    const gqlArgs = JSON.parse(JSON.stringify(queryArgs));
-    const lokiArgs = convertArgs(gqlArgs, gqlType);
-    const coll = getNodeTypeCollection(gqlType.name);
-    ensureFieldIndexes(coll, lokiArgs);
-    let chain = coll.chain().find(lokiArgs, firstOnly);
-
-    if (queryArgs.sort) {
-      const sortFields = toSortFields(queryArgs.sort); // Create an index for each sort field. Indexing requires sorting
-      // so we lose nothing by ensuring an index is added for each sort
-      // field. Loki ensures this is a noop if the index already exists
-
-      for (var _iterator = sortFields, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
-        var _ref;
-
-        if (_isArray) {
-          if (_i >= _iterator.length) break;
-          _ref = _iterator[_i++];
-        } else {
-          _i = _iterator.next();
-          if (_i.done) break;
-          _ref = _i.value;
-        }
-
-        const sortField = _ref;
-        coll.ensureIndex(sortField[0]);
-      }
-
-      chain = chain.compoundsort(sortFields);
+async function runQuery({
+  gqlType,
+  queryArgs,
+  firstOnly
+}) {
+  // Clone args as for some reason graphql-js removes the constructor
+  // from nested objects which breaks a check in sift.js.
+  const gqlArgs = JSON.parse(JSON.stringify(queryArgs));
+  const lokiArgs = convertArgs(gqlArgs, gqlType);
+  const coll = getNodeTypeCollection(gqlType.name);
+  ensureFieldIndexes(coll, lokiArgs);
+  let chain = coll.chain().find(lokiArgs, firstOnly);
+
+  if (queryArgs.sort) {
+    const sortFields = toSortFields(queryArgs.sort); // Create an index for each sort field. Indexing requires sorting
+    // so we lose nothing by ensuring an index is added for each sort
+    // field. Loki ensures this is a noop if the index already exists
+
+    for (const sortField of sortFields) {
+      coll.ensureIndex(sortField[0]);
     }
 
-    return chain.data();
-  });
-  return _runQuery.apply(this, arguments);
+    chain = chain.compoundsort(sortFields);
+  }
+
+  return chain.data();
 }
 
 module.exports = runQuery;
diff --git a/node_modules/gatsby/dist/db/loki/nodes-query.js.map b/node_modules/gatsby/dist/db/loki/nodes-query.js.map
index 78b0c1a..11bcd9e 100644
--- a/node_modules/gatsby/dist/db/loki/nodes-query.js.map
+++ b/node_modules/gatsby/dist/db/loki/nodes-query.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/db/loki/nodes-query.js"],"names":["_","require","prepareRegex","getNodeTypeCollection","sift","emitter","fieldUsages","FIELD_INDEX_THRESHOLD","on","field","siftifyArgs","object","newObject","each","v","k","isPlainObject","Minimatch","mm","makeRe","runSift","nodes","query","siftQuery","$elemMatch","toMongoArgs","gqlFilter","lastFieldType","mongoArgs","obj","result","length","gqlFieldType","getFields","type","re","isUndefined","test","undefined","constructor","name","concat","toDottedFields","filter","acc","path","Object","keys","forEach","key","value","nextValue","join","isNeTrue","first","rest","fixNeTrue","reduce","split","convertArgs","gqlArgs","gqlType","toSortFields","sortArgs","fields","order","lokiSortFields","i","dottedField","isDesc","toLowerCase","push","ensureFieldIndexes","coll","lokiArgs","fieldName","update","n","get","ensureIndex","runQuery","queryArgs","firstOnly","JSON","parse","stringify","chain","find","sort","sortFields","sortField","compoundsort","data","module","exports"],"mappings":"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","sourcesContent":["const _ = require(`lodash`)\nconst prepareRegex = require(`../../utils/prepare-regex`)\nconst { getNodeTypeCollection } = require(`./nodes`)\nconst sift = require(`sift`)\nconst { emitter } = require(`../../redux`)\n\n// Cleared on DELETE_CACHE\nconst fieldUsages = {}\nconst FIELD_INDEX_THRESHOLD = 5\n\nemitter.on(`DELETE_CACHE`, () => {\n  for (var field in fieldUsages) {\n    delete fieldUsages[field]\n  }\n})\n\n// Takes a raw graphql filter and converts it into a mongo-like args\n// object that can be understood by the `sift` library. E.g `eq`\n// becomes `$eq`\nfunction siftifyArgs(object) {\n  const newObject = {}\n  _.each(object, (v, k) => {\n    if (_.isPlainObject(v)) {\n      if (k === `elemMatch`) {\n        k = `$elemMatch`\n      }\n      newObject[k] = siftifyArgs(v)\n    } else {\n      // Compile regex first.\n      if (k === `regex`) {\n        newObject[`$regex`] = prepareRegex(v)\n      } else if (k === `glob`) {\n        const Minimatch = require(`minimatch`).Minimatch\n        const mm = new Minimatch(v)\n        newObject[`$regex`] = mm.makeRe()\n      } else {\n        newObject[`$${k}`] = v\n      }\n    }\n  })\n  return newObject\n}\n\n// filter nodes using the `sift` library. But isn't this a loki query\n// file? Yes, but we need to support all functionality provided by\n// `run-sift`, and there are some operators that loki can't\n// support. Like `elemMatch`, so for those fields, we fall back to\n// sift\nfunction runSift(nodes, query) {\n  if (nodes) {\n    const siftQuery = {\n      $elemMatch: siftifyArgs(query),\n    }\n    return sift(siftQuery, nodes)\n  } else {\n    return null\n  }\n}\n\n// Takes a raw graphql filter and converts it into a mongo-like args\n// object that can be understood by loki. E.g `eq` becomes\n// `$eq`. gqlFilter should be the raw graphql filter returned from\n// graphql-js. e.g gqlFilter:\n//\n// {\n//   internal: {\n//     type: {\n//       eq: \"TestNode\"\n//     },\n//     content: {\n//       glob: \"et\"\n//     }\n//   },\n//   id: {\n//     glob: \"12*\"\n//   }\n// }\n//\n// would return\n//\n// {\n//   internal: {\n//     type: {\n//       $eq: \"TestNode\"  // append $ to eq\n//     },\n//     content: {\n//       $regex: new MiniMatch(v) // convert glob to regex\n//     }\n//   },\n//   id: {\n//     $regex: // as above\n//   }\n// }\nfunction toMongoArgs(gqlFilter, lastFieldType) {\n  const mongoArgs = {}\n  _.each(gqlFilter, (v, k) => {\n    if (_.isPlainObject(v)) {\n      if (k === `elemMatch`) {\n        // loki doesn't support elemMatch, so use sift (see runSift\n        // comment above)\n        mongoArgs[`$where`] = obj => {\n          const result = runSift(obj, v)\n          return result && result.length > 0\n        }\n      } else {\n        const gqlFieldType = lastFieldType.getFields()[k].type\n        mongoArgs[k] = toMongoArgs(v, gqlFieldType)\n      }\n    } else {\n      if (k === `regex`) {\n        const re = prepareRegex(v)\n        // To ensure that false is returned if a field doesn't\n        // exist. E.g `{nested.field: {$regex: /.*/}}`\n        mongoArgs[`$where`] = obj => !_.isUndefined(obj) && re.test(obj)\n      } else if (k === `glob`) {\n        const Minimatch = require(`minimatch`).Minimatch\n        const mm = new Minimatch(v)\n        mongoArgs[`$regex`] = mm.makeRe()\n      } else if (k === `eq` && v === null) {\n        mongoArgs[`$in`] = [null, undefined]\n      } else if (\n        k === `eq` &&\n        lastFieldType &&\n        lastFieldType.constructor.name === `GraphQLList`\n      ) {\n        mongoArgs[`$contains`] = v\n      } else if (\n        k === `ne` &&\n        lastFieldType &&\n        lastFieldType.constructor.name === `GraphQLList`\n      ) {\n        mongoArgs[`$containsNone`] = v\n      } else if (\n        k === `in` &&\n        lastFieldType &&\n        lastFieldType.constructor.name === `GraphQLList`\n      ) {\n        mongoArgs[`$containsAny`] = v\n      } else if (\n        k === `nin` &&\n        lastFieldType &&\n        lastFieldType.constructor.name === `GraphQLList`\n      ) {\n        mongoArgs[`$containsNone`] = v\n      } else if (k === `ne` && v === null) {\n        mongoArgs[`$ne`] = undefined\n      } else if (k === `nin` && lastFieldType.name === `Boolean`) {\n        mongoArgs[`$nin`] = v.concat([undefined])\n      } else {\n        mongoArgs[`$${k}`] = v\n      }\n    }\n  })\n  return mongoArgs\n}\n\n// Converts a nested mongo args object into a dotted notation. acc\n// (accumulator) must be a reference to an empty object. The converted\n// fields will be added to it. E.g\n//\n// {\n//   internal: {\n//     type: {\n//       $eq: \"TestNode\"\n//     },\n//     content: {\n//       $regex: new MiniMatch(v)\n//     }\n//   },\n//   id: {\n//     $regex: newMiniMatch(v)\n//   }\n// }\n//\n// After execution, acc would be:\n//\n// {\n//   \"internal.type\": {\n//     $eq: \"TestNode\"\n//   },\n//   \"internal.content\": {\n//     $regex: new MiniMatch(v)\n//   },\n//   \"id\": {\n//     $regex: // as above\n//   }\n// }\nconst toDottedFields = (filter, acc = {}, path = []) => {\n  Object.keys(filter).forEach(key => {\n    const value = filter[key]\n    const nextValue = _.isPlainObject(value) && value[Object.keys(value)[0]]\n    if (_.isPlainObject(nextValue)) {\n      toDottedFields(value, acc, path.concat(key))\n    } else {\n      acc[path.concat(key).join(`.`)] = value\n    }\n  })\n  return acc\n}\n\n// The query language that Gatsby has used since day 1 is `sift`. Both\n// sift and loki are mongo-like query languages, but they have some\n// subtle differences. One is that in sift, a nested filter such as\n// `{foo: {bar: {ne: true} } }` will return true if the foo field\n// doesn't exist, is null, or bar is null. Whereas loki will return\n// false if the foo field doesn't exist or is null. This ensures that\n// loki queries behave like sift\nconst isNeTrue = (obj, path) => {\n  if (path.length) {\n    const [first, ...rest] = path\n    return obj == null || obj[first] == null || isNeTrue(obj[first], rest)\n  } else {\n    return obj !== true\n  }\n}\n\nconst fixNeTrue = filter =>\n  Object.keys(filter).reduce((acc, key) => {\n    const value = filter[key]\n    if (value[`$ne`] === true) {\n      const [first, ...path] = key.split(`.`)\n      acc[first] = { [`$where`]: obj => isNeTrue(obj, path) }\n    } else {\n      acc[key] = value\n    }\n    return acc\n  }, {})\n\n// Converts graphQL args to a loki filter\nconst convertArgs = (gqlArgs, gqlType) =>\n  fixNeTrue(toDottedFields(toMongoArgs(gqlArgs.filter, gqlType)))\n\n// Converts graphql Sort args into the form expected by loki, which is\n// a vector where the first value is a field name, and the second is a\n// boolean `isDesc`. Nested fields delimited by `___` are replaced by\n// periods. E.g\n//\n// {\n//   fields: [ `frontmatter___date`, `id` ],\n//   order: [`desc`]\n// }\n//\n// would return\n//\n// [ [ `frontmatter.date`, true ], [ `id`, false ] ]\n//\nfunction toSortFields(sortArgs) {\n  const { fields, order } = sortArgs\n  const lokiSortFields = []\n  for (let i = 0; i < fields.length; i++) {\n    const dottedField = fields[i]\n    const isDesc = order[i] && order[i].toLowerCase() === `desc`\n    lokiSortFields.push([dottedField, isDesc])\n  }\n  return lokiSortFields\n}\n\n// Every time we run a query, we increment a counter for each of its\n// fields, so that we can determine which fields are used the\n// most. Any time a field is seen more than `FIELD_INDEX_THRESHOLD`\n// times, we create a loki index so that future queries with that\n// field will execute faster.\nfunction ensureFieldIndexes(coll, lokiArgs) {\n  _.forEach(lokiArgs, (v, fieldName) => {\n    // Increment the usages of the field\n    _.update(fieldUsages, fieldName, n => (n ? n + 1 : 1))\n    // If we have crossed the threshold, then create the index\n    if (_.get(fieldUsages, fieldName) === FIELD_INDEX_THRESHOLD) {\n      // Loki ensures that this is a noop if index already exists. E.g\n      // if it was previously added via a sort field\n      coll.ensureIndex(fieldName)\n    }\n  })\n}\n\n/**\n * Runs the graphql query over the loki nodes db.\n *\n * @param {Object} args. Object with:\n *\n * {Object} gqlType: built during `./build-node-types.js`\n *\n * {Object} queryArgs: The raw graphql query as a js object. E.g `{\n * filter: { fields { slug: { eq: \"/somepath\" } } } }`\n *\n * {Object} context: The context from the QueryJob\n *\n * {boolean} firstOnly: Whether to return the first found match, or\n * all matching results\n *\n * @returns {promise} A promise that will eventually be resolved with\n * a collection of matching objects (even if `firstOnly` is true)\n */\nasync function runQuery({ gqlType, queryArgs, firstOnly }) {\n  // Clone args as for some reason graphql-js removes the constructor\n  // from nested objects which breaks a check in sift.js.\n  const gqlArgs = JSON.parse(JSON.stringify(queryArgs))\n  const lokiArgs = convertArgs(gqlArgs, gqlType)\n  const coll = getNodeTypeCollection(gqlType.name)\n  ensureFieldIndexes(coll, lokiArgs)\n  let chain = coll.chain().find(lokiArgs, firstOnly)\n\n  if (queryArgs.sort) {\n    const sortFields = toSortFields(queryArgs.sort)\n\n    // Create an index for each sort field. Indexing requires sorting\n    // so we lose nothing by ensuring an index is added for each sort\n    // field. Loki ensures this is a noop if the index already exists\n    for (const sortField of sortFields) {\n      coll.ensureIndex(sortField[0])\n    }\n    chain = chain.compoundsort(sortFields)\n  }\n\n  return chain.data()\n}\n\nmodule.exports = runQuery\n"],"file":"nodes-query.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/db/loki/nodes-query.js"],"names":["_","require","prepareRegex","getNodeTypeCollection","emitter","fieldUsages","FIELD_INDEX_THRESHOLD","on","field","toMongoArgs","gqlFilter","lastFieldType","mongoArgs","each","v","k","isPlainObject","gqlFieldType","ofType","getFields","type","re","obj","isUndefined","test","Minimatch","mm","makeRe","undefined","constructor","name","concat","toDottedFields","filter","acc","path","Object","keys","forEach","key","value","nextValue","join","isNeTrue","length","first","rest","fixNeTrue","reduce","split","convertArgs","gqlArgs","gqlType","toSortFields","sortArgs","fields","order","lokiSortFields","i","dottedField","isDesc","toLowerCase","push","ensureFieldIndexes","coll","lokiArgs","fieldName","update","n","get","ensureIndex","runQuery","queryArgs","firstOnly","JSON","parse","stringify","chain","find","sort","sortFields","sortField","compoundsort","data","module","exports"],"mappings":"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","sourcesContent":["const _ = require(`lodash`)\nconst prepareRegex = require(`../../utils/prepare-regex`)\nconst { getNodeTypeCollection } = require(`./nodes`)\nconst { emitter } = require(`../../redux`)\n\n// Cleared on DELETE_CACHE\nconst fieldUsages = {}\nconst FIELD_INDEX_THRESHOLD = 5\n\nemitter.on(`DELETE_CACHE`, () => {\n  for (var field in fieldUsages) {\n    delete fieldUsages[field]\n  }\n})\n\n// Takes a raw graphql filter and converts it into a mongo-like args\n// object that can be understood by loki. E.g `eq` becomes\n// `$eq`. gqlFilter should be the raw graphql filter returned from\n// graphql-js. e.g gqlFilter:\n//\n// {\n//   internal: {\n//     type: {\n//       eq: \"TestNode\"\n//     },\n//     content: {\n//       glob: \"et\"\n//     }\n//   },\n//   id: {\n//     glob: \"12*\"\n//   }\n// }\n//\n// would return\n//\n// {\n//   internal: {\n//     type: {\n//       $eq: \"TestNode\"  // append $ to eq\n//     },\n//     content: {\n//       $regex: new MiniMatch(v) // convert glob to regex\n//     }\n//   },\n//   id: {\n//     $regex: // as above\n//   }\n// }\nfunction toMongoArgs(gqlFilter, lastFieldType) {\n  const mongoArgs = {}\n  _.each(gqlFilter, (v, k) => {\n    if (_.isPlainObject(v)) {\n      if (k === `elemMatch`) {\n        const gqlFieldType = lastFieldType.ofType\n        mongoArgs[`$elemMatch`] = toMongoArgs(v, gqlFieldType)\n      } else {\n        const gqlFieldType = lastFieldType.getFields()[k].type\n        mongoArgs[k] = toMongoArgs(v, gqlFieldType)\n      }\n    } else {\n      if (k === `regex`) {\n        const re = prepareRegex(v)\n        // To ensure that false is returned if a field doesn't\n        // exist. E.g `{nested.field: {$regex: /.*/}}`\n        mongoArgs[`$where`] = obj => !_.isUndefined(obj) && re.test(obj)\n      } else if (k === `glob`) {\n        const Minimatch = require(`minimatch`).Minimatch\n        const mm = new Minimatch(v)\n        mongoArgs[`$regex`] = mm.makeRe()\n      } else if (k === `eq` && v === null) {\n        mongoArgs[`$in`] = [null, undefined]\n      } else if (\n        k === `eq` &&\n        lastFieldType &&\n        lastFieldType.constructor.name === `GraphQLList`\n      ) {\n        mongoArgs[`$contains`] = v\n      } else if (\n        k === `ne` &&\n        lastFieldType &&\n        lastFieldType.constructor.name === `GraphQLList`\n      ) {\n        mongoArgs[`$containsNone`] = v\n      } else if (\n        k === `in` &&\n        lastFieldType &&\n        lastFieldType.constructor.name === `GraphQLList`\n      ) {\n        mongoArgs[`$containsAny`] = v\n      } else if (\n        k === `nin` &&\n        lastFieldType &&\n        lastFieldType.constructor.name === `GraphQLList`\n      ) {\n        mongoArgs[`$containsNone`] = v\n      } else if (k === `ne` && v === null) {\n        mongoArgs[`$ne`] = undefined\n      } else if (k === `nin` && lastFieldType.name === `Boolean`) {\n        mongoArgs[`$nin`] = v.concat([undefined])\n      } else {\n        mongoArgs[`$${k}`] = v\n      }\n    }\n  })\n  return mongoArgs\n}\n\n// Converts a nested mongo args object into a dotted notation. acc\n// (accumulator) must be a reference to an empty object. The converted\n// fields will be added to it. E.g\n//\n// {\n//   internal: {\n//     type: {\n//       $eq: \"TestNode\"\n//     },\n//     content: {\n//       $regex: new MiniMatch(v)\n//     }\n//   },\n//   id: {\n//     $regex: newMiniMatch(v)\n//   }\n// }\n//\n// After execution, acc would be:\n//\n// {\n//   \"internal.type\": {\n//     $eq: \"TestNode\"\n//   },\n//   \"internal.content\": {\n//     $regex: new MiniMatch(v)\n//   },\n//   \"id\": {\n//     $regex: // as above\n//   }\n// }\nconst toDottedFields = (filter, acc = {}, path = []) => {\n  Object.keys(filter).forEach(key => {\n    const value = filter[key]\n    const nextValue = _.isPlainObject(value) && value[Object.keys(value)[0]]\n    if (key === `$elemMatch`) {\n      acc[path.join(`.`)] = { [`$elemMatch`]: toDottedFields(value) }\n    } else if (_.isPlainObject(nextValue)) {\n      toDottedFields(value, acc, path.concat(key))\n    } else {\n      acc[path.concat(key).join(`.`)] = value\n    }\n  })\n  return acc\n}\n\n// The query language that Gatsby has used since day 1 is `sift`. Both\n// sift and loki are mongo-like query languages, but they have some\n// subtle differences. One is that in sift, a nested filter such as\n// `{foo: {bar: {ne: true} } }` will return true if the foo field\n// doesn't exist, is null, or bar is null. Whereas loki will return\n// false if the foo field doesn't exist or is null. This ensures that\n// loki queries behave like sift\nconst isNeTrue = (obj, path) => {\n  if (path.length) {\n    const [first, ...rest] = path\n    return obj == null || obj[first] == null || isNeTrue(obj[first], rest)\n  } else {\n    return obj !== true\n  }\n}\n\nconst fixNeTrue = filter =>\n  Object.keys(filter).reduce((acc, key) => {\n    const value = filter[key]\n    if (value[`$ne`] === true) {\n      const [first, ...path] = key.split(`.`)\n      acc[first] = { [`$where`]: obj => isNeTrue(obj, path) }\n    } else {\n      acc[key] = value\n    }\n    return acc\n  }, {})\n\n// Converts graphQL args to a loki filter\nconst convertArgs = (gqlArgs, gqlType) =>\n  fixNeTrue(toDottedFields(toMongoArgs(gqlArgs.filter, gqlType)))\n\n// Converts graphql Sort args into the form expected by loki, which is\n// a vector where the first value is a field name, and the second is a\n// boolean `isDesc`. E.g\n//\n// {\n//   fields: [ `frontmatter___date`, `id` ],\n//   order: [`desc`]\n// }\n//\n// would return\n//\n// [ [ `frontmatter.date`, true ], [ `id`, false ] ]\n//\nfunction toSortFields(sortArgs) {\n  const { fields, order } = sortArgs\n  const lokiSortFields = []\n  for (let i = 0; i < fields.length; i++) {\n    const dottedField = fields[i]\n    const isDesc = order[i] && order[i].toLowerCase() === `desc`\n    lokiSortFields.push([dottedField, isDesc])\n  }\n  return lokiSortFields\n}\n\n// Every time we run a query, we increment a counter for each of its\n// fields, so that we can determine which fields are used the\n// most. Any time a field is seen more than `FIELD_INDEX_THRESHOLD`\n// times, we create a loki index so that future queries with that\n// field will execute faster.\nfunction ensureFieldIndexes(coll, lokiArgs) {\n  _.forEach(lokiArgs, (v, fieldName) => {\n    // Increment the usages of the field\n    _.update(fieldUsages, fieldName, n => (n ? n + 1 : 1))\n    // If we have crossed the threshold, then create the index\n    if (_.get(fieldUsages, fieldName) === FIELD_INDEX_THRESHOLD) {\n      // Loki ensures that this is a noop if index already exists. E.g\n      // if it was previously added via a sort field\n      coll.ensureIndex(fieldName)\n    }\n  })\n}\n\n/**\n * Runs the graphql query over the loki nodes db.\n *\n * @param {Object} args. Object with:\n *\n * {Object} gqlType: A GraphQL type\n *\n * {Object} queryArgs: The raw graphql query as a js object. E.g `{\n * filter: { fields { slug: { eq: \"/somepath\" } } } }`\n *\n * {Object} context: The context from the QueryJob\n *\n * {boolean} firstOnly: Whether to return the first found match, or\n * all matching results\n *\n * @returns {promise} A promise that will eventually be resolved with\n * a collection of matching objects (even if `firstOnly` is true)\n */\nasync function runQuery({ gqlType, queryArgs, firstOnly }) {\n  // Clone args as for some reason graphql-js removes the constructor\n  // from nested objects which breaks a check in sift.js.\n  const gqlArgs = JSON.parse(JSON.stringify(queryArgs))\n  const lokiArgs = convertArgs(gqlArgs, gqlType)\n  const coll = getNodeTypeCollection(gqlType.name)\n  ensureFieldIndexes(coll, lokiArgs)\n  let chain = coll.chain().find(lokiArgs, firstOnly)\n\n  if (queryArgs.sort) {\n    const sortFields = toSortFields(queryArgs.sort)\n\n    // Create an index for each sort field. Indexing requires sorting\n    // so we lose nothing by ensuring an index is added for each sort\n    // field. Loki ensures this is a noop if the index already exists\n    for (const sortField of sortFields) {\n      coll.ensureIndex(sortField[0])\n    }\n    chain = chain.compoundsort(sortFields)\n  }\n\n  return chain.data()\n}\n\nmodule.exports = runQuery\n"],"file":"nodes-query.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/db/loki/nodes.js b/node_modules/gatsby/dist/db/loki/nodes.js
index 42df3c0..e2e5ab6 100644
--- a/node_modules/gatsby/dist/db/loki/nodes.js
+++ b/node_modules/gatsby/dist/db/loki/nodes.js
@@ -4,9 +4,10 @@ const _ = require(`lodash`);
 
 const invariant = require(`invariant`);
 
-const _require = require(`./index`),
-      getDb = _require.getDb,
-      colls = _require.colls; /////////////////////////////////////////////////////////////////////
+const {
+  getDb,
+  colls
+} = require(`./index`); /////////////////////////////////////////////////////////////////////
 // Node collection metadata
 /////////////////////////////////////////////////////////////////////
 
@@ -82,19 +83,7 @@ function deleteNodeTypeCollections(force = false) {
 
   const nodeTypes = nodeTypesColl.find();
 
-  for (var _iterator = nodeTypes, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
-    var _ref;
-
-    if (_isArray) {
-      if (_i >= _iterator.length) break;
-      _ref = _iterator[_i++];
-    } else {
-      _i = _iterator.next();
-      if (_i.done) break;
-      _ref = _i.value;
-    }
-
-    const nodeType = _ref;
+  for (const nodeType of nodeTypes) {
     let coll = getDb().getCollection(nodeType.collName);
 
     if (coll.count() === 0 || force) {
@@ -139,7 +128,9 @@ function getNode(id) {
   if (nodeMeta) {
     // Now get the collection and query it by the `id` field, which
     // has an index on it
-    const typeCollName = nodeMeta.typeCollName;
+    const {
+      typeCollName
+    } = nodeMeta;
     const typeColl = getDb().getCollection(typeCollName);
     invariant(typeColl, `type collection ${typeCollName} referenced by nodeMeta but doesn't exist`);
     return typeColl.by(`id`, id);
@@ -322,19 +313,7 @@ function deleteNode(node) {
 
 
 function deleteNodes(nodes) {
-  for (var _iterator2 = nodes, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {
-    var _ref2;
-
-    if (_isArray2) {
-      if (_i2 >= _iterator2.length) break;
-      _ref2 = _iterator2[_i2++];
-    } else {
-      _i2 = _iterator2.next();
-      if (_i2.done) break;
-      _ref2 = _i2.value;
-    }
-
-    const node = _ref2;
+  for (const node of nodes) {
     deleteNode(node);
   }
 } /////////////////////////////////////////////////////////////////////
@@ -361,7 +340,10 @@ function reducer(state = new Map(), action) {
 
     case `DELETE_NODE`:
       {
-        deleteNode(action.payload);
+        if (action.payload) {
+          deleteNode(action.payload);
+        }
+
         return null;
       }
 
diff --git a/node_modules/gatsby/dist/db/loki/nodes.js.map b/node_modules/gatsby/dist/db/loki/nodes.js.map
index 44a20b7..e4c7704 100644
--- a/node_modules/gatsby/dist/db/loki/nodes.js.map
+++ b/node_modules/gatsby/dist/db/loki/nodes.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/db/loki/nodes.js"],"names":["_","require","invariant","getDb","colls","makeTypeCollName","type","createNodeTypeCollection","collName","nodeTypesColl","getCollection","nodeTypes","name","insert","options","unique","indices","disableMeta","coll","addCollection","getTypeCollName","nodeTypeInfo","by","undefined","getNodeTypeCollection","typeCollName","deleteNodeTypeCollections","force","find","nodeType","count","removeCollection","remove","deleteAll","db","nodeMeta","clear","getNode","id","nodeMetaColl","typeColl","getNodesByType","typeName","data","getNodes","getTypes","flatMap","map","getNodeAndSavePathDependency","path","createPageDependency","node","nodeId","hasNodeChanged","digest","internal","contentDigest","createNode","oldNode","deleteNode","nodeTypeColl","updateNode","update","findAndRemove","deleteNodes","nodes","reducer","state","Map","action","payload","module","exports"],"mappings":"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","sourcesContent":["const _ = require(`lodash`)\nconst invariant = require(`invariant`)\nconst { getDb, colls } = require(`./index`)\n\n/////////////////////////////////////////////////////////////////////\n// Node collection metadata\n/////////////////////////////////////////////////////////////////////\n\nfunction makeTypeCollName(type) {\n  return `gatsby:nodeType:${type}`\n}\n\n/**\n * Creates a collection that will contain nodes of a certain type. The\n * name of the collection for type `MyType` will be something like\n * `gatsby:nodeType:MyType` (see `makeTypeCollName`)\n */\nfunction createNodeTypeCollection(type) {\n  const collName = makeTypeCollName(type)\n  const nodeTypesColl = getDb().getCollection(colls.nodeTypes.name)\n  invariant(nodeTypesColl, `Collection ${colls.nodeTypes.name} should exist`)\n  nodeTypesColl.insert({ type, collName })\n  // TODO what if `addCollection` fails? We will have inserted into\n  // nodeTypesColl but no collection will exist. Need to make this\n  // into a transaction\n  const options = {\n    unique: [`id`],\n    indices: [`id`],\n    disableMeta: true,\n  }\n  const coll = getDb().addCollection(collName, options)\n  return coll\n}\n\n/**\n * Returns the name of the collection that contains nodes of the\n * specified type, where type is the node's `node.internal.type`\n */\nfunction getTypeCollName(type) {\n  const nodeTypesColl = getDb().getCollection(colls.nodeTypes.name)\n  invariant(nodeTypesColl, `Collection ${colls.nodeTypes.name} should exist`)\n  let nodeTypeInfo = nodeTypesColl.by(`type`, type)\n  return nodeTypeInfo ? nodeTypeInfo.collName : undefined\n}\n\n/**\n * Returns a reference to the collection that contains nodes of the\n * specified type, where type is the node's `node.internal.type`\n */\nfunction getNodeTypeCollection(type) {\n  const typeCollName = getTypeCollName(type)\n  let coll\n  if (typeCollName) {\n    coll = getDb().getCollection(typeCollName)\n    invariant(\n      coll,\n      `Type [${type}] Collection doesn't exist for nodeTypeInfo: [${typeCollName}]`\n    )\n    return coll\n  } else {\n    return undefined\n  }\n}\n\n/**\n * Deletes all empty node type collections, unless `force` is true, in\n * which case it deletes the collections even if they have nodes in\n * them\n */\nfunction deleteNodeTypeCollections(force = false) {\n  const nodeTypesColl = getDb().getCollection(colls.nodeTypes.name)\n  // find() returns all objects in collection\n  const nodeTypes = nodeTypesColl.find()\n  for (const nodeType of nodeTypes) {\n    let coll = getDb().getCollection(nodeType.collName)\n    if (coll.count() === 0 || force) {\n      getDb().removeCollection(coll.name)\n      nodeTypesColl.remove(nodeType)\n    }\n  }\n}\n\n/**\n * Deletes all nodes from all the node type collections, including the\n * id -> type metadata. There will be no nodes related data in loki\n * after this is called\n */\nfunction deleteAll() {\n  const db = getDb()\n  if (db) {\n    deleteNodeTypeCollections(true)\n    db.getCollection(colls.nodeMeta.name).clear()\n  }\n}\n\n/////////////////////////////////////////////////////////////////////\n// Queries\n/////////////////////////////////////////////////////////////////////\n\n/**\n * Returns the node with `id` == id, or null if not found\n */\nfunction getNode(id) {\n  if (!id) {\n    return null\n  }\n  // First, find out which collection the node is in\n  const nodeMetaColl = getDb().getCollection(colls.nodeMeta.name)\n  invariant(nodeMetaColl, `nodeMeta collection should exist`)\n  const nodeMeta = nodeMetaColl.by(`id`, id)\n  if (nodeMeta) {\n    // Now get the collection and query it by the `id` field, which\n    // has an index on it\n    const { typeCollName } = nodeMeta\n    const typeColl = getDb().getCollection(typeCollName)\n    invariant(\n      typeColl,\n      `type collection ${typeCollName} referenced by nodeMeta but doesn't exist`\n    )\n    return typeColl.by(`id`, id)\n  } else {\n    return undefined\n  }\n}\n\n/**\n * Returns all nodes of a type (where `typeName ==\n * node.internal.type`). This is an O(1) operation since nodes are\n * already stored in seperate collections by type\n */\nfunction getNodesByType(typeName) {\n  invariant(typeName, `typeName is null`)\n  const collName = getTypeCollName(typeName)\n  const coll = getDb().getCollection(collName)\n  if (!coll) return []\n  return coll.data\n}\n\n/**\n * Returns the collection of all nodes. This should be deprecated and\n * `getNodesByType` should be used instead. Or at least where possible\n */\nfunction getNodes() {\n  const nodeTypes = getTypes()\n  return _.flatMap(nodeTypes, nodeType => getNodesByType(nodeType))\n}\n\n/**\n * Returns the unique collection of all node types\n */\nfunction getTypes() {\n  const nodeTypes = getDb().getCollection(colls.nodeTypes.name).data\n  return nodeTypes.map(nodeType => nodeType.type)\n}\n\n/**\n * Looks up the node by id, records a dependency between the node and\n * the path, and then returns the node\n *\n * @param {string} id node id to lookup\n * @param {string} path the page path to record a node dependency\n * against\n * @returns {Object} node or undefined if not found\n */\nfunction getNodeAndSavePathDependency(id, path) {\n  invariant(id, `id is null`)\n  invariant(id, `path is null`)\n  const createPageDependency = require(`../../redux/actions/add-page-dependency`)\n  const node = getNode(id)\n  createPageDependency({ path, nodeId: id })\n  return node\n}\n\n/**\n * Determine if node has changed (by comparing its\n * `internal.contentDigest`\n *\n * @param {string} id\n * @param {string} digest\n * @returns {boolean}\n */\nfunction hasNodeChanged(id, digest) {\n  const node = getNode(id)\n  if (!node) {\n    return true\n  } else {\n    return node.internal.contentDigest !== digest\n  }\n}\n\n/////////////////////////////////////////////////////////////////////\n// Create/Update/Delete\n/////////////////////////////////////////////////////////////////////\n\n/**\n * Creates a node in the DB. Will create a collection for the node\n * type if one hasn't been created yet\n *\n * @param {Object} node The node to add. Must have an `id` and\n * `internal.type`\n */\nfunction createNode(node, oldNode) {\n  invariant(node.internal, `node has no \"internal\" field`)\n  invariant(node.internal.type, `node has no \"internal.type\" field`)\n  invariant(node.id, `node has no \"id\" field`)\n\n  const type = node.internal.type\n\n  // Loki doesn't provide \"upsert\", so if the node already exists, we\n  // delete and then create it\n  if (oldNode) {\n    deleteNode(oldNode)\n  }\n\n  let nodeTypeColl = getNodeTypeCollection(type)\n  if (!nodeTypeColl) {\n    nodeTypeColl = createNodeTypeCollection(type)\n  }\n\n  const nodeMetaColl = getDb().getCollection(colls.nodeMeta.name)\n  invariant(nodeMetaColl, `Collection ${colls.nodeMeta.name} should exist`)\n  nodeMetaColl.insert({ id: node.id, typeCollName: nodeTypeColl.name })\n  // TODO what if this insert fails? We will have inserted the id ->\n  // collName mapping, but there won't be any nodes in the type\n  // collection. Need to create a transaction around this\n  return nodeTypeColl.insert(node)\n}\n\n/**\n * Updates a node in the DB. The contents of `node` will completely\n * overwrite value in the DB. Note, `node` must be a loki node. i.e it\n * has `$loki` and `meta` fields.\n *\n * @param {Object} node The new node information. This should be all\n * the node information. Not just changes\n */\nfunction updateNode(node) {\n  invariant(node.internal, `node has no \"internal\" field`)\n  invariant(node.internal.type, `node has no \"internal.type\" field`)\n  invariant(node.id, `node has no \"id\" field`)\n\n  const type = node.internal.type\n\n  let coll = getNodeTypeCollection(type)\n  invariant(coll, `${type} collection doesn't exist. When trying to update`)\n  coll.update(node)\n}\n\n/**\n * Deletes a node from its type collection and removes its id ->\n * collName mapping. Function is idempotent. If the node has already\n * been deleted, this is a noop.\n *\n * @param {Object} the node to delete. Must have an `id` and\n * `internal.type`\n */\nfunction deleteNode(node) {\n  invariant(node.internal, `node has no \"internal\" field`)\n  invariant(node.internal.type, `node has no \"internal.type\" field`)\n  invariant(node.id, `node has no \"id\" field`)\n\n  const type = node.internal.type\n\n  let nodeTypeColl = getNodeTypeCollection(type)\n  if (!nodeTypeColl) {\n    invariant(\n      nodeTypeColl,\n      `${type} collection doesn't exist. When trying to delete`\n    )\n  }\n\n  if (nodeTypeColl.by(`id`, node.id)) {\n    const nodeMetaColl = getDb().getCollection(colls.nodeMeta.name)\n    invariant(nodeMetaColl, `Collection ${colls.nodeMeta.name} should exist`)\n    nodeMetaColl.findAndRemove({ id: node.id })\n    // TODO What if this `remove()` fails? We will have removed the id\n    // -> collName mapping, but not the actual node in the\n    // collection. Need to make this into a transaction\n    nodeTypeColl.remove(node)\n  }\n  // idempotent. Do nothing if node wasn't already in DB\n}\n\n/**\n * deprecated\n */\nfunction deleteNodes(nodes) {\n  for (const node of nodes) {\n    deleteNode(node)\n  }\n}\n\n/////////////////////////////////////////////////////////////////////\n// Reducer\n/////////////////////////////////////////////////////////////////////\n\nfunction reducer(state = new Map(), action) {\n  switch (action.type) {\n    case `DELETE_CACHE`:\n      deleteAll()\n      return null\n\n    case `CREATE_NODE`: {\n      createNode(action.payload, action.oldNode)\n      return null\n    }\n\n    case `ADD_FIELD_TO_NODE`:\n    case `ADD_CHILD_NODE_TO_PARENT_NODE`:\n      updateNode(action.payload)\n      return null\n\n    case `DELETE_NODE`: {\n      deleteNode(action.payload)\n      return null\n    }\n\n    case `DELETE_NODES`: {\n      deleteNodes(action.payload)\n      return null\n    }\n\n    default:\n      return null\n  }\n}\n\n/////////////////////////////////////////////////////////////////////\n// Exports\n/////////////////////////////////////////////////////////////////////\n\nmodule.exports = {\n  getNodeTypeCollection,\n\n  getNodes,\n  getNode,\n  getNodesByType,\n  getTypes,\n  hasNodeChanged,\n  getNodeAndSavePathDependency,\n\n  createNode,\n  updateNode,\n  deleteNode,\n\n  deleteNodeTypeCollections,\n  deleteAll,\n\n  reducer,\n}\n"],"file":"nodes.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/db/loki/nodes.js"],"names":["_","require","invariant","getDb","colls","makeTypeCollName","type","createNodeTypeCollection","collName","nodeTypesColl","getCollection","nodeTypes","name","insert","options","unique","indices","disableMeta","coll","addCollection","getTypeCollName","nodeTypeInfo","by","undefined","getNodeTypeCollection","typeCollName","deleteNodeTypeCollections","force","find","nodeType","count","removeCollection","remove","deleteAll","db","nodeMeta","clear","getNode","id","nodeMetaColl","typeColl","getNodesByType","typeName","data","getNodes","getTypes","flatMap","map","getNodeAndSavePathDependency","path","createPageDependency","node","nodeId","hasNodeChanged","digest","internal","contentDigest","createNode","oldNode","deleteNode","nodeTypeColl","updateNode","update","findAndRemove","deleteNodes","nodes","reducer","state","Map","action","payload","module","exports"],"mappings":"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","sourcesContent":["const _ = require(`lodash`)\nconst invariant = require(`invariant`)\nconst { getDb, colls } = require(`./index`)\n\n/////////////////////////////////////////////////////////////////////\n// Node collection metadata\n/////////////////////////////////////////////////////////////////////\n\nfunction makeTypeCollName(type) {\n  return `gatsby:nodeType:${type}`\n}\n\n/**\n * Creates a collection that will contain nodes of a certain type. The\n * name of the collection for type `MyType` will be something like\n * `gatsby:nodeType:MyType` (see `makeTypeCollName`)\n */\nfunction createNodeTypeCollection(type) {\n  const collName = makeTypeCollName(type)\n  const nodeTypesColl = getDb().getCollection(colls.nodeTypes.name)\n  invariant(nodeTypesColl, `Collection ${colls.nodeTypes.name} should exist`)\n  nodeTypesColl.insert({ type, collName })\n  // TODO what if `addCollection` fails? We will have inserted into\n  // nodeTypesColl but no collection will exist. Need to make this\n  // into a transaction\n  const options = {\n    unique: [`id`],\n    indices: [`id`],\n    disableMeta: true,\n  }\n  const coll = getDb().addCollection(collName, options)\n  return coll\n}\n\n/**\n * Returns the name of the collection that contains nodes of the\n * specified type, where type is the node's `node.internal.type`\n */\nfunction getTypeCollName(type) {\n  const nodeTypesColl = getDb().getCollection(colls.nodeTypes.name)\n  invariant(nodeTypesColl, `Collection ${colls.nodeTypes.name} should exist`)\n  let nodeTypeInfo = nodeTypesColl.by(`type`, type)\n  return nodeTypeInfo ? nodeTypeInfo.collName : undefined\n}\n\n/**\n * Returns a reference to the collection that contains nodes of the\n * specified type, where type is the node's `node.internal.type`\n */\nfunction getNodeTypeCollection(type) {\n  const typeCollName = getTypeCollName(type)\n  let coll\n  if (typeCollName) {\n    coll = getDb().getCollection(typeCollName)\n    invariant(\n      coll,\n      `Type [${type}] Collection doesn't exist for nodeTypeInfo: [${typeCollName}]`\n    )\n    return coll\n  } else {\n    return undefined\n  }\n}\n\n/**\n * Deletes all empty node type collections, unless `force` is true, in\n * which case it deletes the collections even if they have nodes in\n * them\n */\nfunction deleteNodeTypeCollections(force = false) {\n  const nodeTypesColl = getDb().getCollection(colls.nodeTypes.name)\n  // find() returns all objects in collection\n  const nodeTypes = nodeTypesColl.find()\n  for (const nodeType of nodeTypes) {\n    let coll = getDb().getCollection(nodeType.collName)\n    if (coll.count() === 0 || force) {\n      getDb().removeCollection(coll.name)\n      nodeTypesColl.remove(nodeType)\n    }\n  }\n}\n\n/**\n * Deletes all nodes from all the node type collections, including the\n * id -> type metadata. There will be no nodes related data in loki\n * after this is called\n */\nfunction deleteAll() {\n  const db = getDb()\n  if (db) {\n    deleteNodeTypeCollections(true)\n    db.getCollection(colls.nodeMeta.name).clear()\n  }\n}\n\n/////////////////////////////////////////////////////////////////////\n// Queries\n/////////////////////////////////////////////////////////////////////\n\n/**\n * Returns the node with `id` == id, or null if not found\n */\nfunction getNode(id) {\n  if (!id) {\n    return null\n  }\n  // First, find out which collection the node is in\n  const nodeMetaColl = getDb().getCollection(colls.nodeMeta.name)\n  invariant(nodeMetaColl, `nodeMeta collection should exist`)\n  const nodeMeta = nodeMetaColl.by(`id`, id)\n  if (nodeMeta) {\n    // Now get the collection and query it by the `id` field, which\n    // has an index on it\n    const { typeCollName } = nodeMeta\n    const typeColl = getDb().getCollection(typeCollName)\n    invariant(\n      typeColl,\n      `type collection ${typeCollName} referenced by nodeMeta but doesn't exist`\n    )\n    return typeColl.by(`id`, id)\n  } else {\n    return undefined\n  }\n}\n\n/**\n * Returns all nodes of a type (where `typeName ==\n * node.internal.type`). This is an O(1) operation since nodes are\n * already stored in seperate collections by type\n */\nfunction getNodesByType(typeName) {\n  invariant(typeName, `typeName is null`)\n  const collName = getTypeCollName(typeName)\n  const coll = getDb().getCollection(collName)\n  if (!coll) return []\n  return coll.data\n}\n\n/**\n * Returns the collection of all nodes. This should be deprecated and\n * `getNodesByType` should be used instead. Or at least where possible\n */\nfunction getNodes() {\n  const nodeTypes = getTypes()\n  return _.flatMap(nodeTypes, nodeType => getNodesByType(nodeType))\n}\n\n/**\n * Returns the unique collection of all node types\n */\nfunction getTypes() {\n  const nodeTypes = getDb().getCollection(colls.nodeTypes.name).data\n  return nodeTypes.map(nodeType => nodeType.type)\n}\n\n/**\n * Looks up the node by id, records a dependency between the node and\n * the path, and then returns the node\n *\n * @param {string} id node id to lookup\n * @param {string} path the page path to record a node dependency\n * against\n * @returns {Object} node or undefined if not found\n */\nfunction getNodeAndSavePathDependency(id, path) {\n  invariant(id, `id is null`)\n  invariant(id, `path is null`)\n  const createPageDependency = require(`../../redux/actions/add-page-dependency`)\n  const node = getNode(id)\n  createPageDependency({ path, nodeId: id })\n  return node\n}\n\n/**\n * Determine if node has changed (by comparing its\n * `internal.contentDigest`\n *\n * @param {string} id\n * @param {string} digest\n * @returns {boolean}\n */\nfunction hasNodeChanged(id, digest) {\n  const node = getNode(id)\n  if (!node) {\n    return true\n  } else {\n    return node.internal.contentDigest !== digest\n  }\n}\n\n/////////////////////////////////////////////////////////////////////\n// Create/Update/Delete\n/////////////////////////////////////////////////////////////////////\n\n/**\n * Creates a node in the DB. Will create a collection for the node\n * type if one hasn't been created yet\n *\n * @param {Object} node The node to add. Must have an `id` and\n * `internal.type`\n */\nfunction createNode(node, oldNode) {\n  invariant(node.internal, `node has no \"internal\" field`)\n  invariant(node.internal.type, `node has no \"internal.type\" field`)\n  invariant(node.id, `node has no \"id\" field`)\n\n  const type = node.internal.type\n\n  // Loki doesn't provide \"upsert\", so if the node already exists, we\n  // delete and then create it\n  if (oldNode) {\n    deleteNode(oldNode)\n  }\n\n  let nodeTypeColl = getNodeTypeCollection(type)\n  if (!nodeTypeColl) {\n    nodeTypeColl = createNodeTypeCollection(type)\n  }\n\n  const nodeMetaColl = getDb().getCollection(colls.nodeMeta.name)\n  invariant(nodeMetaColl, `Collection ${colls.nodeMeta.name} should exist`)\n  nodeMetaColl.insert({ id: node.id, typeCollName: nodeTypeColl.name })\n  // TODO what if this insert fails? We will have inserted the id ->\n  // collName mapping, but there won't be any nodes in the type\n  // collection. Need to create a transaction around this\n  return nodeTypeColl.insert(node)\n}\n\n/**\n * Updates a node in the DB. The contents of `node` will completely\n * overwrite value in the DB. Note, `node` must be a loki node. i.e it\n * has `$loki` and `meta` fields.\n *\n * @param {Object} node The new node information. This should be all\n * the node information. Not just changes\n */\nfunction updateNode(node) {\n  invariant(node.internal, `node has no \"internal\" field`)\n  invariant(node.internal.type, `node has no \"internal.type\" field`)\n  invariant(node.id, `node has no \"id\" field`)\n\n  const type = node.internal.type\n\n  let coll = getNodeTypeCollection(type)\n  invariant(coll, `${type} collection doesn't exist. When trying to update`)\n  coll.update(node)\n}\n\n/**\n * Deletes a node from its type collection and removes its id ->\n * collName mapping. Function is idempotent. If the node has already\n * been deleted, this is a noop.\n *\n * @param {Object} the node to delete. Must have an `id` and\n * `internal.type`\n */\nfunction deleteNode(node) {\n  invariant(node.internal, `node has no \"internal\" field`)\n  invariant(node.internal.type, `node has no \"internal.type\" field`)\n  invariant(node.id, `node has no \"id\" field`)\n\n  const type = node.internal.type\n\n  let nodeTypeColl = getNodeTypeCollection(type)\n  if (!nodeTypeColl) {\n    invariant(\n      nodeTypeColl,\n      `${type} collection doesn't exist. When trying to delete`\n    )\n  }\n\n  if (nodeTypeColl.by(`id`, node.id)) {\n    const nodeMetaColl = getDb().getCollection(colls.nodeMeta.name)\n    invariant(nodeMetaColl, `Collection ${colls.nodeMeta.name} should exist`)\n    nodeMetaColl.findAndRemove({ id: node.id })\n    // TODO What if this `remove()` fails? We will have removed the id\n    // -> collName mapping, but not the actual node in the\n    // collection. Need to make this into a transaction\n    nodeTypeColl.remove(node)\n  }\n  // idempotent. Do nothing if node wasn't already in DB\n}\n\n/**\n * deprecated\n */\nfunction deleteNodes(nodes) {\n  for (const node of nodes) {\n    deleteNode(node)\n  }\n}\n\n/////////////////////////////////////////////////////////////////////\n// Reducer\n/////////////////////////////////////////////////////////////////////\n\nfunction reducer(state = new Map(), action) {\n  switch (action.type) {\n    case `DELETE_CACHE`:\n      deleteAll()\n      return null\n\n    case `CREATE_NODE`: {\n      createNode(action.payload, action.oldNode)\n      return null\n    }\n\n    case `ADD_FIELD_TO_NODE`:\n    case `ADD_CHILD_NODE_TO_PARENT_NODE`:\n      updateNode(action.payload)\n      return null\n\n    case `DELETE_NODE`: {\n      if (action.payload) {\n        deleteNode(action.payload)\n      }\n      return null\n    }\n\n    case `DELETE_NODES`: {\n      deleteNodes(action.payload)\n      return null\n    }\n\n    default:\n      return null\n  }\n}\n\n/////////////////////////////////////////////////////////////////////\n// Exports\n/////////////////////////////////////////////////////////////////////\n\nmodule.exports = {\n  getNodeTypeCollection,\n\n  getNodes,\n  getNode,\n  getNodesByType,\n  getTypes,\n  hasNodeChanged,\n  getNodeAndSavePathDependency,\n\n  createNode,\n  updateNode,\n  deleteNode,\n\n  deleteNodeTypeCollections,\n  deleteAll,\n\n  reducer,\n}\n"],"file":"nodes.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/db/node-tracking.js b/node_modules/gatsby/dist/db/node-tracking.js
index e5cabd1..b979c2d 100644
--- a/node_modules/gatsby/dist/db/node-tracking.js
+++ b/node_modules/gatsby/dist/db/node-tracking.js
@@ -11,21 +11,92 @@ const _ = require(`lodash`);
 const rootNodeMap = new WeakMap();
 
 const getRootNodeId = node => rootNodeMap.get(node);
+/**
+ * @param {Object} data
+ * @returns {Object} data without undefined values
+ */
+
+
+const omitUndefined = data => {
+  const isPlainObject = _.isPlainObject(data);
+
+  if (isPlainObject) {
+    return _.pickBy(data, p => p !== undefined);
+  }
+
+  return data.filter(p => p !== undefined);
+};
+/**
+ * @param {*} data
+ * @return {boolean}
+ */
+
+
+const isTypeSupported = data => {
+  if (data === null) {
+    return true;
+  }
+
+  const type = typeof data;
+  const isSupported = type === `number` || type === `string` || type === `boolean` || data instanceof Date;
+  return isSupported;
+};
 /**
  * Add link between passed data and Node. This function shouldn't be used
  * directly. Use higher level `trackInlineObjectsInRootNode`
  * @see trackInlineObjectsInRootNode
  * @param {(Object|Array)} data Inline object or array
  * @param {string} nodeId Id of node that contains data passed in first parameter
+ * @param {boolean} sanitize Wether to strip objects of unuspported and not serializable fields
+ * @param {string} [ignore] Fieldname that doesn't need to be tracked and sanitized
+ *
  */
 
 
-const addRootNodeToInlineObject = (data, nodeId) => {
-  if (_.isPlainObject(data) || _.isArray(data)) {
-    _.each(data, o => addRootNodeToInlineObject(o, nodeId));
+const addRootNodeToInlineObject = (data, nodeId, sanitize, isNode = false) => {
+  const isPlainObject = _.isPlainObject(data);
+
+  if (isPlainObject || _.isArray(data)) {
+    let returnData = data;
+
+    if (sanitize) {
+      returnData = isPlainObject ? {} : [];
+    }
+
+    let anyFieldChanged = false;
+
+    _.each(data, (o, key) => {
+      if (isNode && key === `internal`) {
+        returnData[key] = o;
+        return;
+      }
+
+      returnData[key] = addRootNodeToInlineObject(o, nodeId, sanitize);
+
+      if (returnData[key] !== o) {
+        anyFieldChanged = true;
+      }
+    });
+
+    if (anyFieldChanged) {
+      data = omitUndefined(returnData);
+    } // don't need to track node itself
+
+
+    if (!isNode) {
+      rootNodeMap.set(data, nodeId);
+    } // arrays and plain objects are supported - no need to to sanitize
+
 
-    rootNodeMap.set(data, nodeId);
+    return data;
   }
+
+  if (sanitize && !isTypeSupported(data)) {
+    return undefined;
+  } // either supported or not sanitizing
+
+
+  return data;
 };
 /**
  * Adds link between inline objects/arrays contained in Node object
@@ -34,18 +105,7 @@ const addRootNodeToInlineObject = (data, nodeId) => {
  */
 
 
-const trackInlineObjectsInRootNode = node => {
-  _.each(node, (v, k) => {
-    // Ignore the node internal object.
-    if (k === `internal`) {
-      return;
-    }
-
-    addRootNodeToInlineObject(v, node.id);
-  });
-
-  return node;
-};
+const trackInlineObjectsInRootNode = (node, sanitize = false) => addRootNodeToInlineObject(node, node.id, sanitize, true);
 
 exports.trackInlineObjectsInRootNode = trackInlineObjectsInRootNode;
 /**
@@ -57,8 +117,9 @@ exports.trackInlineObjectsInRootNode = trackInlineObjectsInRootNode;
  */
 
 const findRootNodeAncestor = (obj, predicate = null) => {
-  const _require = require(`./nodes`),
-        getNode = _require.getNode; // Find the root node.
+  const {
+    getNode
+  } = require(`./nodes`); // Find the root node.
 
 
   let rootNode = obj;
@@ -83,8 +144,9 @@ const findRootNodeAncestor = (obj, predicate = null) => {
 };
 
 function trackDbNodes() {
-  const _require2 = require(`./nodes`),
-        getNodes = _require2.getNodes;
+  const {
+    getNodes
+  } = require(`./nodes`);
 
   _.each(getNodes(), node => {
     trackInlineObjectsInRootNode(node);
diff --git a/node_modules/gatsby/dist/db/node-tracking.js.map b/node_modules/gatsby/dist/db/node-tracking.js.map
index 5a4a4e5..fdcb725 100644
--- a/node_modules/gatsby/dist/db/node-tracking.js.map
+++ b/node_modules/gatsby/dist/db/node-tracking.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/db/node-tracking.js"],"names":["_","require","rootNodeMap","WeakMap","getRootNodeId","node","get","addRootNodeToInlineObject","data","nodeId","isPlainObject","isArray","each","o","set","trackInlineObjectsInRootNode","v","k","id","exports","findRootNodeAncestor","obj","predicate","getNode","rootNode","whileCount","rootNodeId","parent","undefined","console","log","trackDbNodes","getNodes"],"mappings":";;AAAA,MAAMA,CAAC,GAAGC,OAAO,CAAE,QAAF,CAAjB;AAEA;;;;;;;AAKA,MAAMC,WAAW,GAAG,IAAIC,OAAJ,EAApB;;AAEA,MAAMC,aAAa,GAAGC,IAAI,IAAIH,WAAW,CAACI,GAAZ,CAAgBD,IAAhB,CAA9B;AAEA;;;;;;;;;AAOA,MAAME,yBAAyB,GAAG,CAACC,IAAD,EAAOC,MAAP,KAAkB;AAClD,MAAIT,CAAC,CAACU,aAAF,CAAgBF,IAAhB,KAAyBR,CAAC,CAACW,OAAF,CAAUH,IAAV,CAA7B,EAA8C;AAC5CR,IAAAA,CAAC,CAACY,IAAF,CAAOJ,IAAP,EAAaK,CAAC,IAAIN,yBAAyB,CAACM,CAAD,EAAIJ,MAAJ,CAA3C;;AACAP,IAAAA,WAAW,CAACY,GAAZ,CAAgBN,IAAhB,EAAsBC,MAAtB;AACD;AACF,CALD;AAOA;;;;;;;AAKA,MAAMM,4BAA4B,GAAGV,IAAI,IAAI;AAC3CL,EAAAA,CAAC,CAACY,IAAF,CAAOP,IAAP,EAAa,CAACW,CAAD,EAAIC,CAAJ,KAAU;AACrB;AACA,QAAIA,CAAC,KAAM,UAAX,EAAsB;AACpB;AACD;;AACDV,IAAAA,yBAAyB,CAACS,CAAD,EAAIX,IAAI,CAACa,EAAT,CAAzB;AACD,GAND;;AAQA,SAAOb,IAAP;AACD,CAVD;;AAWAc,OAAO,CAACJ,4BAAR,GAAuCA,4BAAvC;AAEA;;;;;;;;AAOA,MAAMK,oBAAoB,GAAG,CAACC,GAAD,EAAMC,SAAS,GAAG,IAAlB,KAA2B;AAAA,mBAClCrB,OAAO,CAAE,SAAF,CAD2B;AAAA,QAC9CsB,OAD8C,YAC9CA,OAD8C,EAGtD;;;AACA,MAAIC,QAAQ,GAAGH,GAAf;AACA,MAAII,UAAU,GAAG,CAAjB;AACA,MAAIC,UAAJ;;AACA,SACE,CAAC,CAACJ,SAAD,IAAc,CAACA,SAAS,CAACE,QAAD,CAAzB,MACCE,UAAU,GAAGtB,aAAa,CAACoB,QAAD,CAAb,IAA2BA,QAAQ,CAACG,MADlD,MAEEH,QAAQ,CAACG,MAAT,IAAmBJ,OAAO,CAACC,QAAQ,CAACG,MAAV,CAAP,KAA6BC,SAAjD,IACCL,OAAO,CAACG,UAAD,CAHT,KAIAD,UAAU,GAAG,GALf,EAME;AACA,QAAIC,UAAJ,EAAgB;AACdF,MAAAA,QAAQ,GAAGD,OAAO,CAACG,UAAD,CAAlB;AACD,KAFD,MAEO;AACLF,MAAAA,QAAQ,GAAGD,OAAO,CAACC,QAAQ,CAACG,MAAV,CAAlB;AACD;;AACDF,IAAAA,UAAU,IAAI,CAAd;;AACA,QAAIA,UAAU,GAAG,GAAjB,EAAsB;AACpBI,MAAAA,OAAO,CAACC,GAAR,CACG,+DADH,EAEEN,QAFF;AAID;AACF;;AAED,SAAO,CAACF,SAAD,IAAcA,SAAS,CAACE,QAAD,CAAvB,GAAoCA,QAApC,GAA+C,IAAtD;AACD,CA7BD;;AA+BA,SAASO,YAAT,GAAwB;AAAA,oBACD9B,OAAO,CAAE,SAAF,CADN;AAAA,QACd+B,QADc,aACdA,QADc;;AAEtBhC,EAAAA,CAAC,CAACY,IAAF,CAAOoB,QAAQ,EAAf,EAAmB3B,IAAI,IAAI;AACzBU,IAAAA,4BAA4B,CAACV,IAAD,CAA5B;AACD,GAFD;AAGD;AAED;;;;;;AAIAc,OAAO,CAACC,oBAAR,GAA+BA,oBAA/B;AACAD,OAAO,CAACY,YAAR,GAAuBA,YAAvB","sourcesContent":["const _ = require(`lodash`)\n\n/**\n * Map containing links between inline objects or arrays\n * and Node that contains them\n * @type {Object.<(Object|Array),string>}\n */\nconst rootNodeMap = new WeakMap()\n\nconst getRootNodeId = node => rootNodeMap.get(node)\n\n/**\n * Add link between passed data and Node. This function shouldn't be used\n * directly. Use higher level `trackInlineObjectsInRootNode`\n * @see trackInlineObjectsInRootNode\n * @param {(Object|Array)} data Inline object or array\n * @param {string} nodeId Id of node that contains data passed in first parameter\n */\nconst addRootNodeToInlineObject = (data, nodeId) => {\n  if (_.isPlainObject(data) || _.isArray(data)) {\n    _.each(data, o => addRootNodeToInlineObject(o, nodeId))\n    rootNodeMap.set(data, nodeId)\n  }\n}\n\n/**\n * Adds link between inline objects/arrays contained in Node object\n * and that Node object.\n * @param {Node} node Root Node\n */\nconst trackInlineObjectsInRootNode = node => {\n  _.each(node, (v, k) => {\n    // Ignore the node internal object.\n    if (k === `internal`) {\n      return\n    }\n    addRootNodeToInlineObject(v, node.id)\n  })\n\n  return node\n}\nexports.trackInlineObjectsInRootNode = trackInlineObjectsInRootNode\n\n/**\n * Finds top most ancestor of node that contains passed Object or Array\n * @param {(Object|Array)} obj Object/Array belonging to Node object or Node object\n * @param {nodePredicate} [predicate] Optional callback to check if ancestor meets defined conditions\n * @returns {Node} Top most ancestor if predicate is not specified\n * or first node that meet predicate conditions if predicate is specified\n */\nconst findRootNodeAncestor = (obj, predicate = null) => {\n  const { getNode } = require(`./nodes`)\n\n  // Find the root node.\n  let rootNode = obj\n  let whileCount = 0\n  let rootNodeId\n  while (\n    (!predicate || !predicate(rootNode)) &&\n    (rootNodeId = getRootNodeId(rootNode) || rootNode.parent) &&\n    ((rootNode.parent && getNode(rootNode.parent) !== undefined) ||\n      getNode(rootNodeId)) &&\n    whileCount < 101\n  ) {\n    if (rootNodeId) {\n      rootNode = getNode(rootNodeId)\n    } else {\n      rootNode = getNode(rootNode.parent)\n    }\n    whileCount += 1\n    if (whileCount > 100) {\n      console.log(\n        `It looks like you have a node that's set its parent as itself`,\n        rootNode\n      )\n    }\n  }\n\n  return !predicate || predicate(rootNode) ? rootNode : null\n}\n\nfunction trackDbNodes() {\n  const { getNodes } = require(`./nodes`)\n  _.each(getNodes(), node => {\n    trackInlineObjectsInRootNode(node)\n  })\n}\n\n/**\n * @callback nodePredicate\n * @param {Node} node Node that is examined\n */\nexports.findRootNodeAncestor = findRootNodeAncestor\nexports.trackDbNodes = trackDbNodes\n"],"file":"node-tracking.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/db/node-tracking.js"],"names":["_","require","rootNodeMap","WeakMap","getRootNodeId","node","get","omitUndefined","data","isPlainObject","pickBy","p","undefined","filter","isTypeSupported","type","isSupported","Date","addRootNodeToInlineObject","nodeId","sanitize","isNode","isArray","returnData","anyFieldChanged","each","o","key","set","trackInlineObjectsInRootNode","id","exports","findRootNodeAncestor","obj","predicate","getNode","rootNode","whileCount","rootNodeId","parent","console","log","trackDbNodes","getNodes"],"mappings":"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","sourcesContent":["const _ = require(`lodash`)\n\n/**\n * Map containing links between inline objects or arrays\n * and Node that contains them\n * @type {Object.<(Object|Array),string>}\n */\nconst rootNodeMap = new WeakMap()\n\nconst getRootNodeId = node => rootNodeMap.get(node)\n\n/**\n * @param {Object} data\n * @returns {Object} data without undefined values\n */\nconst omitUndefined = data => {\n  const isPlainObject = _.isPlainObject(data)\n  if (isPlainObject) {\n    return _.pickBy(data, p => p !== undefined)\n  }\n\n  return data.filter(p => p !== undefined)\n}\n\n/**\n * @param {*} data\n * @return {boolean}\n */\nconst isTypeSupported = data => {\n  if (data === null) {\n    return true\n  }\n\n  const type = typeof data\n  const isSupported =\n    type === `number` ||\n    type === `string` ||\n    type === `boolean` ||\n    data instanceof Date\n\n  return isSupported\n}\n\n/**\n * Add link between passed data and Node. This function shouldn't be used\n * directly. Use higher level `trackInlineObjectsInRootNode`\n * @see trackInlineObjectsInRootNode\n * @param {(Object|Array)} data Inline object or array\n * @param {string} nodeId Id of node that contains data passed in first parameter\n * @param {boolean} sanitize Wether to strip objects of unuspported and not serializable fields\n * @param {string} [ignore] Fieldname that doesn't need to be tracked and sanitized\n *\n */\nconst addRootNodeToInlineObject = (data, nodeId, sanitize, isNode = false) => {\n  const isPlainObject = _.isPlainObject(data)\n\n  if (isPlainObject || _.isArray(data)) {\n    let returnData = data\n    if (sanitize) {\n      returnData = isPlainObject ? {} : []\n    }\n    let anyFieldChanged = false\n    _.each(data, (o, key) => {\n      if (isNode && key === `internal`) {\n        returnData[key] = o\n        return\n      }\n      returnData[key] = addRootNodeToInlineObject(o, nodeId, sanitize)\n\n      if (returnData[key] !== o) {\n        anyFieldChanged = true\n      }\n    })\n\n    if (anyFieldChanged) {\n      data = omitUndefined(returnData)\n    }\n\n    // don't need to track node itself\n    if (!isNode) {\n      rootNodeMap.set(data, nodeId)\n    }\n\n    // arrays and plain objects are supported - no need to to sanitize\n    return data\n  }\n\n  if (sanitize && !isTypeSupported(data)) {\n    return undefined\n  }\n  // either supported or not sanitizing\n  return data\n}\n\n/**\n * Adds link between inline objects/arrays contained in Node object\n * and that Node object.\n * @param {Node} node Root Node\n */\nconst trackInlineObjectsInRootNode = (node, sanitize = false) =>\n  addRootNodeToInlineObject(node, node.id, sanitize, true)\nexports.trackInlineObjectsInRootNode = trackInlineObjectsInRootNode\n\n/**\n * Finds top most ancestor of node that contains passed Object or Array\n * @param {(Object|Array)} obj Object/Array belonging to Node object or Node object\n * @param {nodePredicate} [predicate] Optional callback to check if ancestor meets defined conditions\n * @returns {Node} Top most ancestor if predicate is not specified\n * or first node that meet predicate conditions if predicate is specified\n */\nconst findRootNodeAncestor = (obj, predicate = null) => {\n  const { getNode } = require(`./nodes`)\n\n  // Find the root node.\n  let rootNode = obj\n  let whileCount = 0\n  let rootNodeId\n  while (\n    (!predicate || !predicate(rootNode)) &&\n    (rootNodeId = getRootNodeId(rootNode) || rootNode.parent) &&\n    ((rootNode.parent && getNode(rootNode.parent) !== undefined) ||\n      getNode(rootNodeId)) &&\n    whileCount < 101\n  ) {\n    if (rootNodeId) {\n      rootNode = getNode(rootNodeId)\n    } else {\n      rootNode = getNode(rootNode.parent)\n    }\n    whileCount += 1\n    if (whileCount > 100) {\n      console.log(\n        `It looks like you have a node that's set its parent as itself`,\n        rootNode\n      )\n    }\n  }\n\n  return !predicate || predicate(rootNode) ? rootNode : null\n}\n\nfunction trackDbNodes() {\n  const { getNodes } = require(`./nodes`)\n  _.each(getNodes(), node => {\n    trackInlineObjectsInRootNode(node)\n  })\n}\n\n/**\n * @callback nodePredicate\n * @param {Node} node Node that is examined\n */\nexports.findRootNodeAncestor = findRootNodeAncestor\nexports.trackDbNodes = trackDbNodes\n"],"file":"node-tracking.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/db/nodes-query.js b/node_modules/gatsby/dist/db/nodes-query.js
index 51ad4fe..0598154 100644
--- a/node_modules/gatsby/dist/db/nodes-query.js
+++ b/node_modules/gatsby/dist/db/nodes-query.js
@@ -2,8 +2,9 @@
 
 const _ = require(`lodash`);
 
-const _require = require(`graphql`),
-      getNamedType = _require.getNamedType;
+const {
+  getNamedType
+} = require(`graphql`);
 
 const lokiRunQuery = require(`./loki/nodes-query`);
 
@@ -34,14 +35,19 @@ const hasFieldResolvers = (type, filterFields) => {
 };
 
 function chooseQueryEngine(args) {
-  const _require2 = require(`./nodes`),
-        backend = _require2.backend;
-
-  const queryArgs = args.queryArgs,
-        gqlType = args.gqlType; // TODO: Resolve nodes on sort fields
+  const {
+    backend
+  } = require(`./nodes`);
+
+  const {
+    queryArgs,
+    gqlType
+  } = args; // TODO: Resolve nodes on sort fields
   // TODO: Need to get group and distinct `field` arg from projection
 
-  const filter = queryArgs.filter;
+  const {
+    filter
+  } = queryArgs;
   const fields = filter ? dropQueryOperators(filter) : {}; // NOTE: `hasFieldResolvers` is also true for Date fields
 
   if (backend === `loki` && !args.nodes && !hasFieldResolvers(gqlType, fields)) {
diff --git a/node_modules/gatsby/dist/db/nodes-query.js.map b/node_modules/gatsby/dist/db/nodes-query.js.map
index 1de5468..405567a 100644
--- a/node_modules/gatsby/dist/db/nodes-query.js.map
+++ b/node_modules/gatsby/dist/db/nodes-query.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/db/nodes-query.js"],"names":["_","require","getNamedType","lokiRunQuery","siftRunQuery","dropQueryOperators","filter","Object","keys","reduce","acc","key","value","k","v","isPlainObject","hasFieldResolvers","type","filterFields","fields","getFields","some","fieldName","filterValue","field","Boolean","resolve","chooseQueryEngine","args","backend","queryArgs","gqlType","nodes","run","queryFunction","module","exports"],"mappings":";;AAAA,MAAMA,CAAC,GAAGC,OAAO,CAAE,QAAF,CAAjB;;iBACyBA,OAAO,CAAE,SAAF,C;MAAxBC,Y,YAAAA,Y;;AAER,MAAMC,YAAY,GAAGF,OAAO,CAAE,oBAAF,CAA5B;;AACA,MAAMG,YAAY,GAAGH,OAAO,CAAE,mBAAF,CAA5B,C,CAEA;;;AACA,MAAMI,kBAAkB,GAAGC,MAAM,IAC/BC,MAAM,CAACC,IAAP,CAAYF,MAAZ,EAAoBG,MAApB,CAA2B,CAACC,GAAD,EAAMC,GAAN,KAAc;AACvC,MAAIC,KAAK,GAAGN,MAAM,CAACK,GAAD,CAAlB;AACA,MAAIE,CAAC,GAAGN,MAAM,CAACC,IAAP,CAAYI,KAAZ,EAAmB,CAAnB,CAAR;AACA,MAAIE,CAAC,GAAGF,KAAK,CAACC,CAAD,CAAb;;AACA,MAAIb,CAAC,CAACe,aAAF,CAAgBH,KAAhB,KAA0BZ,CAAC,CAACe,aAAF,CAAgBD,CAAhB,CAA9B,EAAkD;AAChDJ,IAAAA,GAAG,CAACC,GAAD,CAAH,GACEE,CAAC,KAAM,WAAP,GAAoBR,kBAAkB,CAACS,CAAD,CAAtC,GAA4CT,kBAAkB,CAACO,KAAD,CADhE;AAED,GAHD,MAGO;AACLF,IAAAA,GAAG,CAACC,GAAD,CAAH,GAAW,IAAX;AACD;;AACD,SAAOD,GAAP;AACD,CAXD,EAWG,EAXH,CADF;;AAcA,MAAMM,iBAAiB,GAAG,CAACC,IAAD,EAAOC,YAAP,KAAwB;AAChD,QAAMC,MAAM,GAAGF,IAAI,CAACG,SAAL,EAAf;AACA,SAAOb,MAAM,CAACC,IAAP,CAAYU,YAAZ,EAA0BG,IAA1B,CAA+BC,SAAS,IAAI;AACjD,UAAMC,WAAW,GAAGL,YAAY,CAACI,SAAD,CAAhC;AACA,UAAME,KAAK,GAAGL,MAAM,CAACG,SAAD,CAApB;AACA,WACEG,OAAO,CAACD,KAAK,CAACE,OAAP,CAAP,IACCH,WAAW,KAAK,IAAhB,IACCP,iBAAiB,CAACd,YAAY,CAACsB,KAAK,CAACP,IAAP,CAAb,EAA2BM,WAA3B,CAHrB;AAKD,GARM,CAAP;AASD,CAXD;;AAaA,SAASI,iBAAT,CAA2BC,IAA3B,EAAiC;AAAA,oBACX3B,OAAO,CAAE,SAAF,CADI;AAAA,QACvB4B,OADuB,aACvBA,OADuB;;AAAA,QAGvBC,SAHuB,GAGAF,IAHA,CAGvBE,SAHuB;AAAA,QAGZC,OAHY,GAGAH,IAHA,CAGZG,OAHY,EAI/B;AACA;;AAL+B,QAMvBzB,MANuB,GAMZwB,SANY,CAMvBxB,MANuB;AAO/B,QAAMa,MAAM,GAAGb,MAAM,GAAGD,kBAAkB,CAACC,MAAD,CAArB,GAAgC,EAArD,CAP+B,CAS/B;;AACA,MACEuB,OAAO,KAAM,MAAb,IACA,CAACD,IAAI,CAACI,KADN,IAEA,CAAChB,iBAAiB,CAACe,OAAD,EAAUZ,MAAV,CAHpB,EAIE;AACA,WAAOhB,YAAP;AACD,GAND,MAMO;AACL,WAAOC,YAAP;AACD;AACF;AAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA,SAAS6B,GAAT,CAAaL,IAAb,EAAmB;AACjB,QAAMM,aAAa,GAAGP,iBAAiB,CAACC,IAAD,CAAvC;AAEA,SAAOM,aAAa,CAACN,IAAD,CAApB;AACD;;AAEDO,MAAM,CAACC,OAAP,CAAeH,GAAf,GAAqBA,GAArB","sourcesContent":["const _ = require(`lodash`)\nconst { getNamedType } = require(`graphql`)\n\nconst lokiRunQuery = require(`./loki/nodes-query`)\nconst siftRunQuery = require(`../redux/run-sift`)\n\n// FIXME: This is duplicate code (`extractFieldsToSift`)\nconst dropQueryOperators = filter =>\n  Object.keys(filter).reduce((acc, key) => {\n    let value = filter[key]\n    let k = Object.keys(value)[0]\n    let v = value[k]\n    if (_.isPlainObject(value) && _.isPlainObject(v)) {\n      acc[key] =\n        k === `elemMatch` ? dropQueryOperators(v) : dropQueryOperators(value)\n    } else {\n      acc[key] = true\n    }\n    return acc\n  }, {})\n\nconst hasFieldResolvers = (type, filterFields) => {\n  const fields = type.getFields()\n  return Object.keys(filterFields).some(fieldName => {\n    const filterValue = filterFields[fieldName]\n    const field = fields[fieldName]\n    return (\n      Boolean(field.resolve) ||\n      (filterValue !== true &&\n        hasFieldResolvers(getNamedType(field.type), filterValue))\n    )\n  })\n}\n\nfunction chooseQueryEngine(args) {\n  const { backend } = require(`./nodes`)\n\n  const { queryArgs, gqlType } = args\n  // TODO: Resolve nodes on sort fields\n  // TODO: Need to get group and distinct `field` arg from projection\n  const { filter } = queryArgs\n  const fields = filter ? dropQueryOperators(filter) : {}\n\n  // NOTE: `hasFieldResolvers` is also true for Date fields\n  if (\n    backend === `loki` &&\n    !args.nodes &&\n    !hasFieldResolvers(gqlType, fields)\n  ) {\n    return lokiRunQuery\n  } else {\n    return siftRunQuery\n  }\n}\n\n/**\n * Runs the query over all nodes of type. It must first select the\n * appropriate query engine. Sift, or Loki. Sift is used by default,\n * or if the query includes fields with custom resolver functions,\n * those that need to be resolved before being queried.\n * These could be either plugin fields, i.e those declared by plugins during\n * the `setFieldsOnGraphQLNodeType` API, or they could be linked fields.\n * See `../redux/run-sift.js` for more.\n *\n * If the query does *not* include fields with custom resolver functions,\n * and environment variable `GATSBY_DB_NODES` = `loki` then we can perform\n * a much faster pure data query using loki. See `loki/nodes-query.js` for\n * more.\n *\n * @param {Object} args. Object with:\n *\n * {Object} gqlType: built during `./build-node-types.js`\n *\n * {Object} queryArgs: The raw graphql query as a js object. E.g `{\n * filter: { fields { slug: { eq: \"/somepath\" } } } }`\n *\n * {Object} context: The context from the QueryJob\n *\n * {boolean} firstOnly: Whether to return the first found match, or\n * all matching result.\n *\n * @returns {promise} A promise that will eventually be resolved with\n * a collection of matching objects (even if `firstOnly` is true, in\n * which case it will be a collection of length 1 or zero)\n */\nfunction run(args) {\n  const queryFunction = chooseQueryEngine(args)\n\n  return queryFunction(args)\n}\n\nmodule.exports.run = run\n"],"file":"nodes-query.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/db/nodes-query.js"],"names":["_","require","getNamedType","lokiRunQuery","siftRunQuery","dropQueryOperators","filter","Object","keys","reduce","acc","key","value","k","v","isPlainObject","hasFieldResolvers","type","filterFields","fields","getFields","some","fieldName","filterValue","field","Boolean","resolve","chooseQueryEngine","args","backend","queryArgs","gqlType","nodes","run","queryFunction","module","exports"],"mappings":";;AAAA,MAAMA,CAAC,GAAGC,OAAO,CAAE,QAAF,CAAjB;;AACA,MAAM;AAAEC,EAAAA;AAAF,IAAmBD,OAAO,CAAE,SAAF,CAAhC;;AAEA,MAAME,YAAY,GAAGF,OAAO,CAAE,oBAAF,CAA5B;;AACA,MAAMG,YAAY,GAAGH,OAAO,CAAE,mBAAF,CAA5B,C,CAEA;;;AACA,MAAMI,kBAAkB,GAAGC,MAAM,IAC/BC,MAAM,CAACC,IAAP,CAAYF,MAAZ,EAAoBG,MAApB,CAA2B,CAACC,GAAD,EAAMC,GAAN,KAAc;AACvC,MAAIC,KAAK,GAAGN,MAAM,CAACK,GAAD,CAAlB;AACA,MAAIE,CAAC,GAAGN,MAAM,CAACC,IAAP,CAAYI,KAAZ,EAAmB,CAAnB,CAAR;AACA,MAAIE,CAAC,GAAGF,KAAK,CAACC,CAAD,CAAb;;AACA,MAAIb,CAAC,CAACe,aAAF,CAAgBH,KAAhB,KAA0BZ,CAAC,CAACe,aAAF,CAAgBD,CAAhB,CAA9B,EAAkD;AAChDJ,IAAAA,GAAG,CAACC,GAAD,CAAH,GACEE,CAAC,KAAM,WAAP,GAAoBR,kBAAkB,CAACS,CAAD,CAAtC,GAA4CT,kBAAkB,CAACO,KAAD,CADhE;AAED,GAHD,MAGO;AACLF,IAAAA,GAAG,CAACC,GAAD,CAAH,GAAW,IAAX;AACD;;AACD,SAAOD,GAAP;AACD,CAXD,EAWG,EAXH,CADF;;AAcA,MAAMM,iBAAiB,GAAG,CAACC,IAAD,EAAOC,YAAP,KAAwB;AAChD,QAAMC,MAAM,GAAGF,IAAI,CAACG,SAAL,EAAf;AACA,SAAOb,MAAM,CAACC,IAAP,CAAYU,YAAZ,EAA0BG,IAA1B,CAA+BC,SAAS,IAAI;AACjD,UAAMC,WAAW,GAAGL,YAAY,CAACI,SAAD,CAAhC;AACA,UAAME,KAAK,GAAGL,MAAM,CAACG,SAAD,CAApB;AACA,WACEG,OAAO,CAACD,KAAK,CAACE,OAAP,CAAP,IACCH,WAAW,KAAK,IAAhB,IACCP,iBAAiB,CAACd,YAAY,CAACsB,KAAK,CAACP,IAAP,CAAb,EAA2BM,WAA3B,CAHrB;AAKD,GARM,CAAP;AASD,CAXD;;AAaA,SAASI,iBAAT,CAA2BC,IAA3B,EAAiC;AAC/B,QAAM;AAAEC,IAAAA;AAAF,MAAc5B,OAAO,CAAE,SAAF,CAA3B;;AAEA,QAAM;AAAE6B,IAAAA,SAAF;AAAaC,IAAAA;AAAb,MAAyBH,IAA/B,CAH+B,CAI/B;AACA;;AACA,QAAM;AAAEtB,IAAAA;AAAF,MAAawB,SAAnB;AACA,QAAMX,MAAM,GAAGb,MAAM,GAAGD,kBAAkB,CAACC,MAAD,CAArB,GAAgC,EAArD,CAP+B,CAS/B;;AACA,MACEuB,OAAO,KAAM,MAAb,IACA,CAACD,IAAI,CAACI,KADN,IAEA,CAAChB,iBAAiB,CAACe,OAAD,EAAUZ,MAAV,CAHpB,EAIE;AACA,WAAOhB,YAAP;AACD,GAND,MAMO;AACL,WAAOC,YAAP;AACD;AACF;AAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA,SAAS6B,GAAT,CAAaL,IAAb,EAAmB;AACjB,QAAMM,aAAa,GAAGP,iBAAiB,CAACC,IAAD,CAAvC;AAEA,SAAOM,aAAa,CAACN,IAAD,CAApB;AACD;;AAEDO,MAAM,CAACC,OAAP,CAAeH,GAAf,GAAqBA,GAArB","sourcesContent":["const _ = require(`lodash`)\nconst { getNamedType } = require(`graphql`)\n\nconst lokiRunQuery = require(`./loki/nodes-query`)\nconst siftRunQuery = require(`../redux/run-sift`)\n\n// FIXME: This is duplicate code (`extractFieldsToSift`)\nconst dropQueryOperators = filter =>\n  Object.keys(filter).reduce((acc, key) => {\n    let value = filter[key]\n    let k = Object.keys(value)[0]\n    let v = value[k]\n    if (_.isPlainObject(value) && _.isPlainObject(v)) {\n      acc[key] =\n        k === `elemMatch` ? dropQueryOperators(v) : dropQueryOperators(value)\n    } else {\n      acc[key] = true\n    }\n    return acc\n  }, {})\n\nconst hasFieldResolvers = (type, filterFields) => {\n  const fields = type.getFields()\n  return Object.keys(filterFields).some(fieldName => {\n    const filterValue = filterFields[fieldName]\n    const field = fields[fieldName]\n    return (\n      Boolean(field.resolve) ||\n      (filterValue !== true &&\n        hasFieldResolvers(getNamedType(field.type), filterValue))\n    )\n  })\n}\n\nfunction chooseQueryEngine(args) {\n  const { backend } = require(`./nodes`)\n\n  const { queryArgs, gqlType } = args\n  // TODO: Resolve nodes on sort fields\n  // TODO: Need to get group and distinct `field` arg from projection\n  const { filter } = queryArgs\n  const fields = filter ? dropQueryOperators(filter) : {}\n\n  // NOTE: `hasFieldResolvers` is also true for Date fields\n  if (\n    backend === `loki` &&\n    !args.nodes &&\n    !hasFieldResolvers(gqlType, fields)\n  ) {\n    return lokiRunQuery\n  } else {\n    return siftRunQuery\n  }\n}\n\n/**\n * Runs the query over all nodes of type. It must first select the\n * appropriate query engine. Sift, or Loki. Sift is used by default,\n * or if the query includes fields with custom resolver functions,\n * those that need to be resolved before being queried.\n * These could be either plugin fields, i.e those declared by plugins during\n * the `setFieldsOnGraphQLNodeType` API, or they could be linked fields.\n * See `../redux/run-sift.js` for more.\n *\n * If the query does *not* include fields with custom resolver functions,\n * and environment variable `GATSBY_DB_NODES` = `loki` then we can perform\n * a much faster pure data query using loki. See `loki/nodes-query.js` for\n * more.\n *\n * @param {Object} args. Object with:\n *\n * {Object} gqlType: built during `./build-node-types.js`\n *\n * {Object} queryArgs: The raw graphql query as a js object. E.g `{\n * filter: { fields { slug: { eq: \"/somepath\" } } } }`\n *\n * {Object} context: The context from the QueryJob\n *\n * {boolean} firstOnly: Whether to return the first found match, or\n * all matching result.\n *\n * @returns {promise} A promise that will eventually be resolved with\n * a collection of matching objects (even if `firstOnly` is true, in\n * which case it will be a collection of length 1 or zero)\n */\nfunction run(args) {\n  const queryFunction = chooseQueryEngine(args)\n\n  return queryFunction(args)\n}\n\nmodule.exports.run = run\n"],"file":"nodes-query.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/db/nodes.js b/node_modules/gatsby/dist/db/nodes.js
index a7fa117..b79507d 100644
--- a/node_modules/gatsby/dist/db/nodes.js
+++ b/node_modules/gatsby/dist/db/nodes.js
@@ -2,14 +2,17 @@
 
 const _ = require(`lodash`);
 
-const _require = require(`../redux`),
-      store = _require.store;
+const {
+  store
+} = require(`../redux`);
 
-const _require2 = require(`./nodes-query`),
-      runQuery = _require2.run;
+const {
+  run: runQuery
+} = require(`./nodes-query`);
 
-const _require3 = require(`../db/node-tracking`),
-      findRootNodeAncestor = _require3.findRootNodeAncestor;
+const {
+  findRootNodeAncestor
+} = require(`../db/node-tracking`);
 
 const backend = process.env.GATSBY_DB_NODES || `redux`;
 let nodesDb;
@@ -27,10 +30,10 @@ switch (backend) {
     throw new Error(`Unsupported DB nodes backend (value of env var GATSBY_DB_NODES)`);
 }
 
-module.exports = Object.assign({}, nodesDb, {
+module.exports = { ...nodesDb,
   runQuery,
   findRootNodeAncestor
-});
+};
 module.exports.backend = backend;
 /**
  * Get content for a node from the plugin that created it.
@@ -47,8 +50,9 @@ module.exports.loadNodeContent = node => {
       // Load plugin's loader function
       const plugin = store.getState().flattenedPlugins.find(plug => plug.name === node.internal.owner);
 
-      const _require4 = require(plugin.resolve),
-            loadNodeContent = _require4.loadNodeContent;
+      const {
+        loadNodeContent
+      } = require(plugin.resolve);
 
       if (!loadNodeContent) {
         throw new Error(`Could not find function loadNodeContent for plugin ${plugin.name}`);
diff --git a/node_modules/gatsby/dist/db/nodes.js.map b/node_modules/gatsby/dist/db/nodes.js.map
index a49e928..7c6694b 100644
--- a/node_modules/gatsby/dist/db/nodes.js.map
+++ b/node_modules/gatsby/dist/db/nodes.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/db/nodes.js"],"names":["_","require","store","runQuery","run","findRootNodeAncestor","backend","process","env","GATSBY_DB_NODES","nodesDb","Error","module","exports","loadNodeContent","node","isString","internal","content","Promise","resolve","plugin","getState","flattenedPlugins","find","plug","name","owner","then"],"mappings":";;AACA,MAAMA,CAAC,GAAGC,OAAO,CAAE,QAAF,CAAjB;;iBACkBA,OAAO,CAAE,UAAF,C;MAAjBC,K,YAAAA,K;;kBACkBD,OAAO,CAAE,eAAF,C;MAApBE,Q,aAALC,G;;kBACyBH,OAAO,CAAE,qBAAF,C;MAAhCI,oB,aAAAA,oB;;AAcR,MAAMC,OAAO,GAAGC,OAAO,CAACC,GAAR,CAAYC,eAAZ,IAAgC,OAAhD;AACA,IAAIC,OAAJ;;AACA,QAAQJ,OAAR;AACE,OAAM,OAAN;AACEI,IAAAA,OAAO,GAAGT,OAAO,CAAE,gBAAF,CAAjB;AACA;;AACF,OAAM,MAAN;AACES,IAAAA,OAAO,GAAGT,OAAO,CAAE,cAAF,CAAjB;AACA;;AACF;AACE,UAAM,IAAIU,KAAJ,CACH,iEADG,CAAN;AARJ;;AAaAC,MAAM,CAACC,OAAP,qBAAsBH,OAAtB;AAA+BP,EAAAA,QAA/B;AAAyCE,EAAAA;AAAzC;AACAO,MAAM,CAACC,OAAP,CAAeP,OAAf,GAAyBA,OAAzB;AAEA;;;;;;;AAMAM,MAAM,CAACC,OAAP,CAAeC,eAAf,GAAiCC,IAAI,IAAI;AACvC,MAAIf,CAAC,CAACgB,QAAF,CAAWD,IAAI,CAACE,QAAL,CAAcC,OAAzB,CAAJ,EAAuC;AACrC,WAAOC,OAAO,CAACC,OAAR,CAAgBL,IAAI,CAACE,QAAL,CAAcC,OAA9B,CAAP;AACD,GAFD,MAEO;AACL,WAAO,IAAIC,OAAJ,CAAYC,OAAO,IAAI;AAC5B;AACA,YAAMC,MAAM,GAAGnB,KAAK,CACjBoB,QADY,GAEZC,gBAFY,CAEKC,IAFL,CAEUC,IAAI,IAAIA,IAAI,CAACC,IAAL,KAAcX,IAAI,CAACE,QAAL,CAAcU,KAF9C,CAAf;;AAF4B,wBAKA1B,OAAO,CAACoB,MAAM,CAACD,OAAR,CALP;AAAA,YAKpBN,eALoB,aAKpBA,eALoB;;AAM5B,UAAI,CAACA,eAAL,EAAsB;AACpB,cAAM,IAAIH,KAAJ,CACH,sDAAqDU,MAAM,CAACK,IAAK,EAD9D,CAAN;AAGD;;AAED,aAAOZ,eAAe,CAACC,IAAD,CAAf,CAAsBa,IAAtB,CAA2BV,OAAO,IAAI;AAC3C;AACAE,QAAAA,OAAO,CAACF,OAAD,CAAP;AACD,OAHM,CAAP;AAID,KAhBM,CAAP;AAiBD;AACF,CAtBD","sourcesContent":["/* @flow */\nconst _ = require(`lodash`)\nconst { store } = require(`../redux`)\nconst { run: runQuery } = require(`./nodes-query`)\nconst { findRootNodeAncestor } = require(`../db/node-tracking`)\n\ninterface NodeStore {\n  getNodes: () => Array<any>;\n  getNode: (id: string) => any | undefined;\n  getNodesByType: (type: string) => Array<any>;\n  getTypes: () => Array<string>;\n  hasNodeChanged: (id: string, digest: string) => boolean;\n  getNodeAndSavePathDependency: (id: string, path: string) => any | undefined;\n  // XXX(freiksenet): types\n  runQuery: (...args: any) => any | undefined;\n  findRootNodeAncestor: (...args: any) => any | undefined;\n}\n\nconst backend = process.env.GATSBY_DB_NODES || `redux`\nlet nodesDb: NodeStore\nswitch (backend) {\n  case `redux`:\n    nodesDb = require(`../redux/nodes`)\n    break\n  case `loki`:\n    nodesDb = require(`./loki/nodes`)\n    break\n  default:\n    throw new Error(\n      `Unsupported DB nodes backend (value of env var GATSBY_DB_NODES)`\n    )\n}\n\nmodule.exports = { ...nodesDb, runQuery, findRootNodeAncestor }\nmodule.exports.backend = backend\n\n/**\n * Get content for a node from the plugin that created it.\n *\n * @param {Object} node\n * @returns {promise}\n */\nmodule.exports.loadNodeContent = node => {\n  if (_.isString(node.internal.content)) {\n    return Promise.resolve(node.internal.content)\n  } else {\n    return new Promise(resolve => {\n      // Load plugin's loader function\n      const plugin = store\n        .getState()\n        .flattenedPlugins.find(plug => plug.name === node.internal.owner)\n      const { loadNodeContent } = require(plugin.resolve)\n      if (!loadNodeContent) {\n        throw new Error(\n          `Could not find function loadNodeContent for plugin ${plugin.name}`\n        )\n      }\n\n      return loadNodeContent(node).then(content => {\n        // TODO update node's content field here.\n        resolve(content)\n      })\n    })\n  }\n}\n"],"file":"nodes.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/db/nodes.js"],"names":["_","require","store","run","runQuery","findRootNodeAncestor","backend","process","env","GATSBY_DB_NODES","nodesDb","Error","module","exports","loadNodeContent","node","isString","internal","content","Promise","resolve","plugin","getState","flattenedPlugins","find","plug","name","owner","then"],"mappings":";;AACA,MAAMA,CAAC,GAAGC,OAAO,CAAE,QAAF,CAAjB;;AACA,MAAM;AAAEC,EAAAA;AAAF,IAAYD,OAAO,CAAE,UAAF,CAAzB;;AACA,MAAM;AAAEE,EAAAA,GAAG,EAAEC;AAAP,IAAoBH,OAAO,CAAE,eAAF,CAAjC;;AACA,MAAM;AAAEI,EAAAA;AAAF,IAA2BJ,OAAO,CAAE,qBAAF,CAAxC;;AAcA,MAAMK,OAAO,GAAGC,OAAO,CAACC,GAAR,CAAYC,eAAZ,IAAgC,OAAhD;AACA,IAAIC,OAAJ;;AACA,QAAQJ,OAAR;AACE,OAAM,OAAN;AACEI,IAAAA,OAAO,GAAGT,OAAO,CAAE,gBAAF,CAAjB;AACA;;AACF,OAAM,MAAN;AACES,IAAAA,OAAO,GAAGT,OAAO,CAAE,cAAF,CAAjB;AACA;;AACF;AACE,UAAM,IAAIU,KAAJ,CACH,iEADG,CAAN;AARJ;;AAaAC,MAAM,CAACC,OAAP,GAAiB,EAAE,GAAGH,OAAL;AAAcN,EAAAA,QAAd;AAAwBC,EAAAA;AAAxB,CAAjB;AACAO,MAAM,CAACC,OAAP,CAAeP,OAAf,GAAyBA,OAAzB;AAEA;;;;;;;AAMAM,MAAM,CAACC,OAAP,CAAeC,eAAf,GAAiCC,IAAI,IAAI;AACvC,MAAIf,CAAC,CAACgB,QAAF,CAAWD,IAAI,CAACE,QAAL,CAAcC,OAAzB,CAAJ,EAAuC;AACrC,WAAOC,OAAO,CAACC,OAAR,CAAgBL,IAAI,CAACE,QAAL,CAAcC,OAA9B,CAAP;AACD,GAFD,MAEO;AACL,WAAO,IAAIC,OAAJ,CAAYC,OAAO,IAAI;AAC5B;AACA,YAAMC,MAAM,GAAGnB,KAAK,CACjBoB,QADY,GAEZC,gBAFY,CAEKC,IAFL,CAEUC,IAAI,IAAIA,IAAI,CAACC,IAAL,KAAcX,IAAI,CAACE,QAAL,CAAcU,KAF9C,CAAf;;AAGA,YAAM;AAAEb,QAAAA;AAAF,UAAsBb,OAAO,CAACoB,MAAM,CAACD,OAAR,CAAnC;;AACA,UAAI,CAACN,eAAL,EAAsB;AACpB,cAAM,IAAIH,KAAJ,CACH,sDAAqDU,MAAM,CAACK,IAAK,EAD9D,CAAN;AAGD;;AAED,aAAOZ,eAAe,CAACC,IAAD,CAAf,CAAsBa,IAAtB,CAA2BV,OAAO,IAAI;AAC3C;AACAE,QAAAA,OAAO,CAACF,OAAD,CAAP;AACD,OAHM,CAAP;AAID,KAhBM,CAAP;AAiBD;AACF,CAtBD","sourcesContent":["/* @flow */\nconst _ = require(`lodash`)\nconst { store } = require(`../redux`)\nconst { run: runQuery } = require(`./nodes-query`)\nconst { findRootNodeAncestor } = require(`../db/node-tracking`)\n\ninterface NodeStore {\n  getNodes: () => Array<any>;\n  getNode: (id: string) => any | undefined;\n  getNodesByType: (type: string) => Array<any>;\n  getTypes: () => Array<string>;\n  hasNodeChanged: (id: string, digest: string) => boolean;\n  getNodeAndSavePathDependency: (id: string, path: string) => any | undefined;\n  // XXX(freiksenet): types\n  runQuery: (...args: any) => any | undefined;\n  findRootNodeAncestor: (...args: any) => any | undefined;\n}\n\nconst backend = process.env.GATSBY_DB_NODES || `redux`\nlet nodesDb: NodeStore\nswitch (backend) {\n  case `redux`:\n    nodesDb = require(`../redux/nodes`)\n    break\n  case `loki`:\n    nodesDb = require(`./loki/nodes`)\n    break\n  default:\n    throw new Error(\n      `Unsupported DB nodes backend (value of env var GATSBY_DB_NODES)`\n    )\n}\n\nmodule.exports = { ...nodesDb, runQuery, findRootNodeAncestor }\nmodule.exports.backend = backend\n\n/**\n * Get content for a node from the plugin that created it.\n *\n * @param {Object} node\n * @returns {promise}\n */\nmodule.exports.loadNodeContent = node => {\n  if (_.isString(node.internal.content)) {\n    return Promise.resolve(node.internal.content)\n  } else {\n    return new Promise(resolve => {\n      // Load plugin's loader function\n      const plugin = store\n        .getState()\n        .flattenedPlugins.find(plug => plug.name === node.internal.owner)\n      const { loadNodeContent } = require(plugin.resolve)\n      if (!loadNodeContent) {\n        throw new Error(\n          `Could not find function loadNodeContent for plugin ${plugin.name}`\n        )\n      }\n\n      return loadNodeContent(node).then(content => {\n        // TODO update node's content field here.\n        resolve(content)\n      })\n    })\n  }\n}\n"],"file":"nodes.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/internal-plugins/dev-404-page/gatsby-node.js b/node_modules/gatsby/dist/internal-plugins/dev-404-page/gatsby-node.js
index 7e795fd..954ef71 100644
--- a/node_modules/gatsby/dist/internal-plugins/dev-404-page/gatsby-node.js
+++ b/node_modules/gatsby/dist/internal-plugins/dev-404-page/gatsby-node.js
@@ -1,45 +1,35 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const path = require(`path`);
 
 const fs = require(`fs-extra`);
 
 const chokidar = require(`chokidar`);
 
-exports.createPagesStatefully =
-/*#__PURE__*/
-function () {
-  var _ref = (0, _asyncToGenerator2.default)(function* ({
-    store,
-    actions
-  }, options, done) {
-    if (process.env.NODE_ENV !== `production`) {
-      const _store$getState = store.getState(),
-            program = _store$getState.program;
-
-      const createPage = actions.createPage;
-      const source = path.join(__dirname, `./raw_dev-404-page.js`);
-      const destination = path.join(program.directory, `.cache`, `dev-404-page.js`);
-
-      const copy = () => fs.copy(source, destination);
-
-      yield copy();
-      createPage({
-        component: destination,
-        path: `/dev-404-page/`
-      });
-      chokidar.watch(source).on(`change`, () => copy()).on(`ready`, () => done());
-    } else {
-      done();
-    }
-  });
-
-  return function (_x, _x2, _x3) {
-    return _ref.apply(this, arguments);
-  };
-}();
+exports.createPagesStatefully = async ({
+  store,
+  actions
+}, options, done) => {
+  if (process.env.NODE_ENV !== `production`) {
+    const {
+      program
+    } = store.getState();
+    const {
+      createPage
+    } = actions;
+    const source = path.join(__dirname, `./raw_dev-404-page.js`);
+    const destination = path.join(program.directory, `.cache`, `dev-404-page.js`);
+
+    const copy = () => fs.copy(source, destination);
+
+    await copy();
+    createPage({
+      component: destination,
+      path: `/dev-404-page/`
+    });
+    chokidar.watch(source).on(`change`, () => copy()).on(`ready`, () => done());
+  } else {
+    done();
+  }
+};
 //# sourceMappingURL=gatsby-node.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/internal-plugins/dev-404-page/gatsby-node.js.map b/node_modules/gatsby/dist/internal-plugins/dev-404-page/gatsby-node.js.map
index e8d3740..d7c5c73 100644
--- a/node_modules/gatsby/dist/internal-plugins/dev-404-page/gatsby-node.js.map
+++ b/node_modules/gatsby/dist/internal-plugins/dev-404-page/gatsby-node.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/internal-plugins/dev-404-page/gatsby-node.js"],"names":["path","require","fs","chokidar","exports","createPagesStatefully","store","actions","options","done","process","env","NODE_ENV","getState","program","createPage","source","join","__dirname","destination","directory","copy","component","watch","on"],"mappings":";;;;;;AAAA,MAAMA,IAAI,GAAGC,OAAO,CAAE,MAAF,CAApB;;AACA,MAAMC,EAAE,GAAGD,OAAO,CAAE,UAAF,CAAlB;;AACA,MAAME,QAAQ,GAAGF,OAAO,CAAE,UAAF,CAAxB;;AAEAG,OAAO,CAACC,qBAAR;AAAA;AAAA;AAAA,6CAAgC,WAAO;AAAEC,IAAAA,KAAF;AAASC,IAAAA;AAAT,GAAP,EAA2BC,OAA3B,EAAoCC,IAApC,EAA6C;AAC3E,QAAIC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAA0B,YAA9B,EAA2C;AAAA,8BACrBN,KAAK,CAACO,QAAN,EADqB;AAAA,YACjCC,OADiC,mBACjCA,OADiC;;AAAA,YAEjCC,UAFiC,GAElBR,OAFkB,CAEjCQ,UAFiC;AAGzC,YAAMC,MAAM,GAAGhB,IAAI,CAACiB,IAAL,CAAUC,SAAV,EAAsB,uBAAtB,CAAf;AACA,YAAMC,WAAW,GAAGnB,IAAI,CAACiB,IAAL,CAClBH,OAAO,CAACM,SADU,EAEjB,QAFiB,EAGjB,iBAHiB,CAApB;;AAKA,YAAMC,IAAI,GAAG,MAAMnB,EAAE,CAACmB,IAAH,CAAQL,MAAR,EAAgBG,WAAhB,CAAnB;;AACA,YAAME,IAAI,EAAV;AACAN,MAAAA,UAAU,CAAC;AACTO,QAAAA,SAAS,EAAEH,WADF;AAETnB,QAAAA,IAAI,EAAG;AAFE,OAAD,CAAV;AAIAG,MAAAA,QAAQ,CACLoB,KADH,CACSP,MADT,EAEGQ,EAFH,CAEO,QAFP,EAEgB,MAAMH,IAAI,EAF1B,EAGGG,EAHH,CAGO,OAHP,EAGe,MAAMf,IAAI,EAHzB;AAID,KAnBD,MAmBO;AACLA,MAAAA,IAAI;AACL;AACF,GAvBD;;AAAA;AAAA;AAAA;AAAA","sourcesContent":["const path = require(`path`)\nconst fs = require(`fs-extra`)\nconst chokidar = require(`chokidar`)\n\nexports.createPagesStatefully = async ({ store, actions }, options, done) => {\n  if (process.env.NODE_ENV !== `production`) {\n    const { program } = store.getState()\n    const { createPage } = actions\n    const source = path.join(__dirname, `./raw_dev-404-page.js`)\n    const destination = path.join(\n      program.directory,\n      `.cache`,\n      `dev-404-page.js`\n    )\n    const copy = () => fs.copy(source, destination)\n    await copy()\n    createPage({\n      component: destination,\n      path: `/dev-404-page/`,\n    })\n    chokidar\n      .watch(source)\n      .on(`change`, () => copy())\n      .on(`ready`, () => done())\n  } else {\n    done()\n  }\n}\n"],"file":"gatsby-node.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/internal-plugins/dev-404-page/gatsby-node.js"],"names":["path","require","fs","chokidar","exports","createPagesStatefully","store","actions","options","done","process","env","NODE_ENV","program","getState","createPage","source","join","__dirname","destination","directory","copy","component","watch","on"],"mappings":";;AAAA,MAAMA,IAAI,GAAGC,OAAO,CAAE,MAAF,CAApB;;AACA,MAAMC,EAAE,GAAGD,OAAO,CAAE,UAAF,CAAlB;;AACA,MAAME,QAAQ,GAAGF,OAAO,CAAE,UAAF,CAAxB;;AAEAG,OAAO,CAACC,qBAAR,GAAgC,OAAO;AAAEC,EAAAA,KAAF;AAASC,EAAAA;AAAT,CAAP,EAA2BC,OAA3B,EAAoCC,IAApC,KAA6C;AAC3E,MAAIC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAA0B,YAA9B,EAA2C;AACzC,UAAM;AAAEC,MAAAA;AAAF,QAAcP,KAAK,CAACQ,QAAN,EAApB;AACA,UAAM;AAAEC,MAAAA;AAAF,QAAiBR,OAAvB;AACA,UAAMS,MAAM,GAAGhB,IAAI,CAACiB,IAAL,CAAUC,SAAV,EAAsB,uBAAtB,CAAf;AACA,UAAMC,WAAW,GAAGnB,IAAI,CAACiB,IAAL,CAClBJ,OAAO,CAACO,SADU,EAEjB,QAFiB,EAGjB,iBAHiB,CAApB;;AAKA,UAAMC,IAAI,GAAG,MAAMnB,EAAE,CAACmB,IAAH,CAAQL,MAAR,EAAgBG,WAAhB,CAAnB;;AACA,UAAME,IAAI,EAAV;AACAN,IAAAA,UAAU,CAAC;AACTO,MAAAA,SAAS,EAAEH,WADF;AAETnB,MAAAA,IAAI,EAAG;AAFE,KAAD,CAAV;AAIAG,IAAAA,QAAQ,CACLoB,KADH,CACSP,MADT,EAEGQ,EAFH,CAEO,QAFP,EAEgB,MAAMH,IAAI,EAF1B,EAGGG,EAHH,CAGO,OAHP,EAGe,MAAMf,IAAI,EAHzB;AAID,GAnBD,MAmBO;AACLA,IAAAA,IAAI;AACL;AACF,CAvBD","sourcesContent":["const path = require(`path`)\nconst fs = require(`fs-extra`)\nconst chokidar = require(`chokidar`)\n\nexports.createPagesStatefully = async ({ store, actions }, options, done) => {\n  if (process.env.NODE_ENV !== `production`) {\n    const { program } = store.getState()\n    const { createPage } = actions\n    const source = path.join(__dirname, `./raw_dev-404-page.js`)\n    const destination = path.join(\n      program.directory,\n      `.cache`,\n      `dev-404-page.js`\n    )\n    const copy = () => fs.copy(source, destination)\n    await copy()\n    createPage({\n      component: destination,\n      path: `/dev-404-page/`,\n    })\n    chokidar\n      .watch(source)\n      .on(`change`, () => copy())\n      .on(`ready`, () => done())\n  } else {\n    done()\n  }\n}\n"],"file":"gatsby-node.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/internal-plugins/dev-404-page/raw_dev-404-page.js.map b/node_modules/gatsby/dist/internal-plugins/dev-404-page/raw_dev-404-page.js.map
index 0b18a91..2b76227 100644
--- a/node_modules/gatsby/dist/internal-plugins/dev-404-page/raw_dev-404-page.js.map
+++ b/node_modules/gatsby/dist/internal-plugins/dev-404-page/raw_dev-404-page.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/internal-plugins/dev-404-page/raw_dev-404-page.js"],"names":["Dev404Page","React","Component","constructor","props","state","showCustom404","bind","setState","render","pathname","location","pages","filter","p","test","path","newFilePath","slice","custom404","length","map","page","PropTypes","arrayOf","object","element"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AAEA,MAAMA,UAAN,SAAyBC,eAAMC,SAA/B,CAAyC;AAOvCC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;AACA,SAAKC,KAAL,GAAa;AAAEC,MAAAA,aAAa,EAAE;AAAjB,KAAb;AACA,SAAKA,aAAL,GAAqB,KAAKA,aAAL,CAAmBC,IAAnB,CAAwB,IAAxB,CAArB;AACD;;AAEDD,EAAAA,aAAa,GAAG;AACd,SAAKE,QAAL,CAAc;AAAEF,MAAAA,aAAa,EAAE;AAAjB,KAAd;AACD;;AAEDG,EAAAA,MAAM,GAAG;AAAA,UACCC,QADD,GACc,KAAKN,KAAL,CAAWO,QADzB,CACCD,QADD;AAEP,UAAME,KAAK,GAAG,KAAKR,KAAL,CAAWQ,KAAX,CAAiBC,MAAjB,CACZC,CAAC,IAAI,CAAC,qBAAqBC,IAArB,CAA0BD,CAAC,CAACE,IAA5B,CADM,CAAd;AAGA,QAAIC,WAAJ;;AACA,QAAIP,QAAQ,KAAM,GAAlB,EAAsB;AACpBO,MAAAA,WAAW,GAAI,oBAAf;AACD,KAFD,MAEO,IAAIP,QAAQ,CAACQ,KAAT,CAAe,CAAC,CAAhB,MAAwB,GAA5B,EAAgC;AACrCD,MAAAA,WAAW,GAAI,YAAWP,QAAQ,CAACQ,KAAT,CAAe,CAAf,EAAkB,CAAC,CAAnB,CAAsB,KAAhD;AACD,KAFM,MAEA;AACLD,MAAAA,WAAW,GAAI,YAAWP,QAAS,KAAnC;AACD;;AAED,WAAO,KAAKL,KAAL,CAAWC,aAAX,GACL,KAAKF,KAAL,CAAWe,SADN,GAGL,0CACE,0EADF,EAEE,wCACI,4BADJ,EAEE,2CAAOT,QAAP,CAFF,CAFF,EAMG,KAAKN,KAAL,CAAWe,SAAX,GACC,wCACE;AAAQ,MAAA,OAAO,EAAE,KAAKb;AAAtB,iCADF,CADD,GAOC,wCACI,iHADJ,EAEE,8DAFF,MAbJ,EAkBE,iGAEI,GAFJ,EAGE,2CAAOW,WAAP,CAHF,EAII,GAJJ,yFAlBF,EA0BGL,KAAK,CAACQ,MAAN,GAAe,CAAf,IACC,0CACE,mHADF,EAKE,oDAAYR,KAAK,CAACQ,MAAlB,MALF,EAME,yCACGR,KAAK,CAACS,GAAN,CAAUC,IAAI,IACb;AAAI,MAAA,GAAG,EAAEA,IAAI,CAACN;AAAd,OACE,6BAAC,YAAD;AAAM,MAAA,EAAE,EAAEM,IAAI,CAACN;AAAf,OAAsBM,IAAI,CAACN,IAA3B,CADF,CADD,CADH,CANF,CA3BJ,CAHF;AA+CD;;AA9EsC;;8BAAnChB,U,eACe;AACjBY,EAAAA,KAAK,EAAEW,mBAAUC,OAAV,CAAkBD,mBAAUE,MAA5B,CADU;AAEjBN,EAAAA,SAAS,EAAEI,mBAAUG,OAFJ;AAGjBf,EAAAA,QAAQ,EAAEY,mBAAUE;AAHH,C;eAgFNzB,U","sourcesContent":["import React from \"react\"\nimport PropTypes from \"prop-types\"\nimport { Link } from \"gatsby\"\n\nclass Dev404Page extends React.Component {\n  static propTypes = {\n    pages: PropTypes.arrayOf(PropTypes.object),\n    custom404: PropTypes.element,\n    location: PropTypes.object,\n  }\n\n  constructor(props) {\n    super(props)\n    this.state = { showCustom404: false }\n    this.showCustom404 = this.showCustom404.bind(this)\n  }\n\n  showCustom404() {\n    this.setState({ showCustom404: true })\n  }\n\n  render() {\n    const { pathname } = this.props.location\n    const pages = this.props.pages.filter(\n      p => !/^\\/dev-404-page\\/$/.test(p.path)\n    )\n    let newFilePath\n    if (pathname === `/`) {\n      newFilePath = `src/pages/index.js`\n    } else if (pathname.slice(-1) === `/`) {\n      newFilePath = `src/pages${pathname.slice(0, -1)}.js`\n    } else {\n      newFilePath = `src/pages${pathname}.js`\n    }\n\n    return this.state.showCustom404 ? (\n      this.props.custom404\n    ) : (\n      <div>\n        <h1>Gatsby.js development 404 page</h1>\n        <p>\n          {`There's not a page yet at `}\n          <code>{pathname}</code>\n        </p>\n        {this.props.custom404 ? (\n          <p>\n            <button onClick={this.showCustom404}>\n              Preview custom 404 page\n            </button>\n          </p>\n        ) : (\n          <p>\n            {`A custom 404 page wasn't detected - if you would like to add one, create a component in your site directory at `}\n            <code>src/pages/404.js</code>.\n          </p>\n        )}\n        <p>\n          Create a React.js component in your site directory at\n          {` `}\n          <code>{newFilePath}</code>\n          {` `}\n          and this page will automatically refresh to show the new page\n          component you created.\n        </p>\n        {pages.length > 0 && (\n          <div>\n            <p>\n              If you were trying to reach another page, perhaps you can find it\n              below.\n            </p>\n            <h2>Pages ({pages.length})</h2>\n            <ul>\n              {pages.map(page => (\n                <li key={page.path}>\n                  <Link to={page.path}>{page.path}</Link>\n                </li>\n              ))}\n            </ul>\n          </div>\n        )}\n      </div>\n    )\n  }\n}\n\nexport default Dev404Page\n"],"file":"raw_dev-404-page.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/internal-plugins/dev-404-page/raw_dev-404-page.js"],"names":["Dev404Page","React","Component","constructor","props","state","showCustom404","bind","setState","render","pathname","location","pages","filter","p","test","path","newFilePath","slice","custom404","length","map","page","PropTypes","arrayOf","object","element"],"mappings":"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","sourcesContent":["import React from \"react\"\nimport PropTypes from \"prop-types\"\nimport { Link } from \"gatsby\"\n\nclass Dev404Page extends React.Component {\n  static propTypes = {\n    pages: PropTypes.arrayOf(PropTypes.object),\n    custom404: PropTypes.element,\n    location: PropTypes.object,\n  }\n\n  constructor(props) {\n    super(props)\n    this.state = { showCustom404: false }\n    this.showCustom404 = this.showCustom404.bind(this)\n  }\n\n  showCustom404() {\n    this.setState({ showCustom404: true })\n  }\n\n  render() {\n    const { pathname } = this.props.location\n    const pages = this.props.pages.filter(\n      p => !/^\\/dev-404-page\\/$/.test(p.path)\n    )\n    let newFilePath\n    if (pathname === `/`) {\n      newFilePath = `src/pages/index.js`\n    } else if (pathname.slice(-1) === `/`) {\n      newFilePath = `src/pages${pathname.slice(0, -1)}.js`\n    } else {\n      newFilePath = `src/pages${pathname}.js`\n    }\n\n    return this.state.showCustom404 ? (\n      this.props.custom404\n    ) : (\n      <div>\n        <h1>Gatsby.js development 404 page</h1>\n        <p>\n          {`There's not a page yet at `}\n          <code>{pathname}</code>\n        </p>\n        {this.props.custom404 ? (\n          <p>\n            <button onClick={this.showCustom404}>\n              Preview custom 404 page\n            </button>\n          </p>\n        ) : (\n          <p>\n            {`A custom 404 page wasn't detected - if you would like to add one, create a component in your site directory at `}\n            <code>src/pages/404.js</code>.\n          </p>\n        )}\n        <p>\n          Create a React.js component in your site directory at\n          {` `}\n          <code>{newFilePath}</code>\n          {` `}\n          and this page will automatically refresh to show the new page\n          component you created.\n        </p>\n        {pages.length > 0 && (\n          <div>\n            <p>\n              If you were trying to reach another page, perhaps you can find it\n              below.\n            </p>\n            <h2>Pages ({pages.length})</h2>\n            <ul>\n              {pages.map(page => (\n                <li key={page.path}>\n                  <Link to={page.path}>{page.path}</Link>\n                </li>\n              ))}\n            </ul>\n          </div>\n        )}\n      </div>\n    )\n  }\n}\n\nexport default Dev404Page\n"],"file":"raw_dev-404-page.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/internal-plugins/internal-data-bridge/gatsby-node.js b/node_modules/gatsby/dist/internal-plugins/internal-data-bridge/gatsby-node.js
index 5448c47..ecbb32d 100644
--- a/node_modules/gatsby/dist/internal-plugins/internal-data-bridge/gatsby-node.js
+++ b/node_modules/gatsby/dist/internal-plugins/internal-data-bridge/gatsby-node.js
@@ -1,9 +1,5 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _objectWithoutPropertiesLoose2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutPropertiesLoose"));
-
 const moment = require(`moment`);
 
 const chokidar = require(`chokidar`);
@@ -12,14 +8,17 @@ const systemPath = require(`path`);
 
 const _ = require(`lodash`);
 
-const _require = require(`../../redux`),
-      emitter = _require.emitter;
+const {
+  emitter
+} = require(`../../redux`);
 
-const _require2 = require(`../../redux/actions`),
-      boundActionCreators = _require2.boundActionCreators;
+const {
+  boundActionCreators
+} = require(`../../redux/actions`);
 
-const _require3 = require(`../../db/nodes`),
-      getNode = _require3.getNode;
+const {
+  getNode
+} = require(`../../db/nodes`);
 
 function transformPackageJson(json) {
   const transformDeps = deps => _.entries(deps).map(([name, version]) => {
@@ -45,16 +44,22 @@ exports.sourceNodes = ({
   actions,
   store
 }) => {
-  const createNode = actions.createNode;
+  const {
+    createNode
+  } = actions;
   const state = store.getState();
-  const program = state.program;
-  const flattenedPlugins = state.flattenedPlugins; // Add our default development page since we know it's going to
+  const {
+    program
+  } = state;
+  const {
+    flattenedPlugins
+  } = state; // Add our default development page since we know it's going to
   // exist and we need a node to exist so its query works :-)
 
   const page = {
     path: `/dev-404-page/`
   };
-  createNode(Object.assign({}, page, {
+  createNode({ ...page,
     id: createPageId(page.path),
     parent: null,
     children: [],
@@ -62,10 +67,10 @@ exports.sourceNodes = ({
       type: `SitePage`,
       contentDigest: createContentDigest(page)
     }
-  }));
+  });
   flattenedPlugins.forEach(plugin => {
     plugin.pluginFilepath = plugin.resolve;
-    createNode(Object.assign({}, plugin, {
+    createNode({ ...plugin,
       packageJson: transformPackageJson(require(`${plugin.resolve}/package.json`)),
       parent: null,
       children: [],
@@ -73,23 +78,25 @@ exports.sourceNodes = ({
         contentDigest: createContentDigest(plugin),
         type: `SitePlugin`
       }
-    }));
+    });
   }); // Add site node.
 
   const buildTime = moment().subtract(process.uptime(), `seconds`).toJSON();
 
   const createGatsbyConfigNode = (config = {}) => {
     // Delete plugins from the config as we add plugins above.
-    const configCopy = Object.assign({}, config);
+    const configCopy = { ...config
+    };
     delete configCopy.plugins;
-    const node = Object.assign({
-      siteMetadata: Object.assign({}, configCopy.siteMetadata),
+    const node = {
+      siteMetadata: { ...configCopy.siteMetadata
+      },
       port: state.program.port,
-      host: state.program.host
-    }, configCopy, {
+      host: state.program.host,
+      ...configCopy,
       buildTime
-    });
-    createNode(Object.assign({}, node, {
+    };
+    createNode({ ...node,
       id: `Site`,
       parent: null,
       children: [],
@@ -97,7 +104,7 @@ exports.sourceNodes = ({
         contentDigest: createContentDigest(node),
         type: `Site`
       }
-    }));
+    });
   };
 
   createGatsbyConfigNode(state.config);
@@ -126,12 +133,16 @@ exports.onCreatePage = ({
   page,
   actions
 }) => {
-  const createNode = actions.createNode; // eslint-disable-next-line
+  const {
+    createNode
+  } = actions; // eslint-disable-next-line
 
-  const updatedAt = page.updatedAt,
-        pageWithoutUpdated = (0, _objectWithoutPropertiesLoose2.default)(page, ["updatedAt"]); // Add page.
+  const {
+    updatedAt,
+    ...pageWithoutUpdated
+  } = page; // Add page.
 
-  createNode(Object.assign({}, pageWithoutUpdated, {
+  createNode({ ...pageWithoutUpdated,
     id: createPageId(page.path),
     parent: null,
     children: [],
@@ -140,7 +151,7 @@ exports.onCreatePage = ({
       contentDigest: createContentDigest(pageWithoutUpdated),
       description: page.pluginCreatorId === `Plugin default-site-plugin` ? `Your site's "gatsby-node.js"` : page.pluginCreatorId
     }
-  }));
+  });
 }; // Listen for DELETE_PAGE and delete page nodes.
 
 
diff --git a/node_modules/gatsby/dist/internal-plugins/internal-data-bridge/gatsby-node.js.map b/node_modules/gatsby/dist/internal-plugins/internal-data-bridge/gatsby-node.js.map
index b8bd6ae..997a2fe 100644
--- a/node_modules/gatsby/dist/internal-plugins/internal-data-bridge/gatsby-node.js.map
+++ b/node_modules/gatsby/dist/internal-plugins/internal-data-bridge/gatsby-node.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/internal-plugins/internal-data-bridge/gatsby-node.js"],"names":["moment","require","chokidar","systemPath","_","emitter","boundActionCreators","getNode","transformPackageJson","json","transformDeps","deps","entries","map","name","version","pick","dependencies","devDependencies","peerDependencies","optionalDependecies","bundledDependecies","createPageId","path","exports","sourceNodes","createContentDigest","actions","store","createNode","state","getState","program","flattenedPlugins","page","id","parent","children","internal","type","contentDigest","forEach","plugin","pluginFilepath","resolve","packageJson","buildTime","subtract","process","uptime","toJSON","createGatsbyConfigNode","config","configCopy","plugins","node","siteMetadata","port","host","pathToGatsbyConfig","join","directory","watch","on","oldCache","cache","e","undefined","onCreatePage","updatedAt","pageWithoutUpdated","description","pluginCreatorId","action","nodeId","payload","deleteNode"],"mappings":"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","sourcesContent":["const moment = require(`moment`)\nconst chokidar = require(`chokidar`)\nconst systemPath = require(`path`)\nconst _ = require(`lodash`)\n\nconst { emitter } = require(`../../redux`)\nconst { boundActionCreators } = require(`../../redux/actions`)\nconst { getNode } = require(`../../db/nodes`)\n\nfunction transformPackageJson(json) {\n  const transformDeps = deps =>\n    _.entries(deps).map(([name, version]) => {\n      return {\n        name,\n        version,\n      }\n    })\n\n  json = _.pick(json, [\n    `name`,\n    `description`,\n    `version`,\n    `main`,\n    `keywords`,\n    `author`,\n    `license`,\n    `dependencies`,\n    `devDependencies`,\n    `peerDependencies`,\n    `optionalDependecies`,\n    `bundledDependecies`,\n  ])\n  json.dependencies = transformDeps(json.dependencies)\n  json.devDependencies = transformDeps(json.devDependencies)\n  json.peerDependencies = transformDeps(json.peerDependencies)\n  json.optionalDependecies = transformDeps(json.optionalDependecies)\n  json.bundledDependecies = transformDeps(json.bundledDependecies)\n\n  return json\n}\n\nconst createPageId = path => `SitePage ${path}`\n\nexports.sourceNodes = ({ createContentDigest, actions, store }) => {\n  const { createNode } = actions\n  const state = store.getState()\n  const { program } = state\n  const { flattenedPlugins } = state\n\n  // Add our default development page since we know it's going to\n  // exist and we need a node to exist so its query works :-)\n  const page = { path: `/dev-404-page/` }\n  createNode({\n    ...page,\n    id: createPageId(page.path),\n    parent: null,\n    children: [],\n    internal: {\n      type: `SitePage`,\n      contentDigest: createContentDigest(page),\n    },\n  })\n\n  flattenedPlugins.forEach(plugin => {\n    plugin.pluginFilepath = plugin.resolve\n    createNode({\n      ...plugin,\n      packageJson: transformPackageJson(\n        require(`${plugin.resolve}/package.json`)\n      ),\n      parent: null,\n      children: [],\n      internal: {\n        contentDigest: createContentDigest(plugin),\n        type: `SitePlugin`,\n      },\n    })\n  })\n\n  // Add site node.\n  const buildTime = moment()\n    .subtract(process.uptime(), `seconds`)\n    .toJSON()\n\n  const createGatsbyConfigNode = (config = {}) => {\n    // Delete plugins from the config as we add plugins above.\n    const configCopy = { ...config }\n    delete configCopy.plugins\n    const node = {\n      siteMetadata: {\n        ...configCopy.siteMetadata,\n      },\n      port: state.program.port,\n      host: state.program.host,\n      ...configCopy,\n      buildTime,\n    }\n    createNode({\n      ...node,\n      id: `Site`,\n      parent: null,\n      children: [],\n      internal: {\n        contentDigest: createContentDigest(node),\n        type: `Site`,\n      },\n    })\n  }\n\n  createGatsbyConfigNode(state.config)\n\n  const pathToGatsbyConfig = systemPath.join(\n    program.directory,\n    `gatsby-config.js`\n  )\n  chokidar.watch(pathToGatsbyConfig).on(`change`, () => {\n    const oldCache = require.cache[require.resolve(pathToGatsbyConfig)]\n    try {\n      // Delete require cache so we can reload the module.\n      delete require.cache[require.resolve(pathToGatsbyConfig)]\n      const config = require(pathToGatsbyConfig)\n      createGatsbyConfigNode(config)\n    } catch (e) {\n      // Restore the old cache since requiring the new gatsby-config.js failed.\n      if (oldCache !== undefined) {\n        require.cache[require.resolve(pathToGatsbyConfig)] = oldCache\n      }\n    }\n  })\n}\n\nexports.onCreatePage = ({ createContentDigest, page, actions }) => {\n  const { createNode } = actions\n  // eslint-disable-next-line\n  const { updatedAt, ...pageWithoutUpdated } = page\n\n  // Add page.\n  createNode({\n    ...pageWithoutUpdated,\n    id: createPageId(page.path),\n    parent: null,\n    children: [],\n    internal: {\n      type: `SitePage`,\n      contentDigest: createContentDigest(pageWithoutUpdated),\n      description:\n        page.pluginCreatorId === `Plugin default-site-plugin`\n          ? `Your site's \"gatsby-node.js\"`\n          : page.pluginCreatorId,\n    },\n  })\n}\n\n// Listen for DELETE_PAGE and delete page nodes.\nemitter.on(`DELETE_PAGE`, action => {\n  const nodeId = createPageId(action.payload.path)\n  const node = getNode(nodeId)\n  boundActionCreators.deleteNode({ node })\n})\n"],"file":"gatsby-node.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/internal-plugins/internal-data-bridge/gatsby-node.js"],"names":["moment","require","chokidar","systemPath","_","emitter","boundActionCreators","getNode","transformPackageJson","json","transformDeps","deps","entries","map","name","version","pick","dependencies","devDependencies","peerDependencies","optionalDependecies","bundledDependecies","createPageId","path","exports","sourceNodes","createContentDigest","actions","store","createNode","state","getState","program","flattenedPlugins","page","id","parent","children","internal","type","contentDigest","forEach","plugin","pluginFilepath","resolve","packageJson","buildTime","subtract","process","uptime","toJSON","createGatsbyConfigNode","config","configCopy","plugins","node","siteMetadata","port","host","pathToGatsbyConfig","join","directory","watch","on","oldCache","cache","e","undefined","onCreatePage","updatedAt","pageWithoutUpdated","description","pluginCreatorId","action","nodeId","payload","deleteNode"],"mappings":"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","sourcesContent":["const moment = require(`moment`)\nconst chokidar = require(`chokidar`)\nconst systemPath = require(`path`)\nconst _ = require(`lodash`)\n\nconst { emitter } = require(`../../redux`)\nconst { boundActionCreators } = require(`../../redux/actions`)\nconst { getNode } = require(`../../db/nodes`)\n\nfunction transformPackageJson(json) {\n  const transformDeps = deps =>\n    _.entries(deps).map(([name, version]) => {\n      return {\n        name,\n        version,\n      }\n    })\n\n  json = _.pick(json, [\n    `name`,\n    `description`,\n    `version`,\n    `main`,\n    `keywords`,\n    `author`,\n    `license`,\n    `dependencies`,\n    `devDependencies`,\n    `peerDependencies`,\n    `optionalDependecies`,\n    `bundledDependecies`,\n  ])\n  json.dependencies = transformDeps(json.dependencies)\n  json.devDependencies = transformDeps(json.devDependencies)\n  json.peerDependencies = transformDeps(json.peerDependencies)\n  json.optionalDependecies = transformDeps(json.optionalDependecies)\n  json.bundledDependecies = transformDeps(json.bundledDependecies)\n\n  return json\n}\n\nconst createPageId = path => `SitePage ${path}`\n\nexports.sourceNodes = ({ createContentDigest, actions, store }) => {\n  const { createNode } = actions\n  const state = store.getState()\n  const { program } = state\n  const { flattenedPlugins } = state\n\n  // Add our default development page since we know it's going to\n  // exist and we need a node to exist so its query works :-)\n  const page = { path: `/dev-404-page/` }\n  createNode({\n    ...page,\n    id: createPageId(page.path),\n    parent: null,\n    children: [],\n    internal: {\n      type: `SitePage`,\n      contentDigest: createContentDigest(page),\n    },\n  })\n\n  flattenedPlugins.forEach(plugin => {\n    plugin.pluginFilepath = plugin.resolve\n    createNode({\n      ...plugin,\n      packageJson: transformPackageJson(\n        require(`${plugin.resolve}/package.json`)\n      ),\n      parent: null,\n      children: [],\n      internal: {\n        contentDigest: createContentDigest(plugin),\n        type: `SitePlugin`,\n      },\n    })\n  })\n\n  // Add site node.\n  const buildTime = moment()\n    .subtract(process.uptime(), `seconds`)\n    .toJSON()\n\n  const createGatsbyConfigNode = (config = {}) => {\n    // Delete plugins from the config as we add plugins above.\n    const configCopy = { ...config }\n    delete configCopy.plugins\n    const node = {\n      siteMetadata: {\n        ...configCopy.siteMetadata,\n      },\n      port: state.program.port,\n      host: state.program.host,\n      ...configCopy,\n      buildTime,\n    }\n    createNode({\n      ...node,\n      id: `Site`,\n      parent: null,\n      children: [],\n      internal: {\n        contentDigest: createContentDigest(node),\n        type: `Site`,\n      },\n    })\n  }\n\n  createGatsbyConfigNode(state.config)\n\n  const pathToGatsbyConfig = systemPath.join(\n    program.directory,\n    `gatsby-config.js`\n  )\n  chokidar.watch(pathToGatsbyConfig).on(`change`, () => {\n    const oldCache = require.cache[require.resolve(pathToGatsbyConfig)]\n    try {\n      // Delete require cache so we can reload the module.\n      delete require.cache[require.resolve(pathToGatsbyConfig)]\n      const config = require(pathToGatsbyConfig)\n      createGatsbyConfigNode(config)\n    } catch (e) {\n      // Restore the old cache since requiring the new gatsby-config.js failed.\n      if (oldCache !== undefined) {\n        require.cache[require.resolve(pathToGatsbyConfig)] = oldCache\n      }\n    }\n  })\n}\n\nexports.onCreatePage = ({ createContentDigest, page, actions }) => {\n  const { createNode } = actions\n  // eslint-disable-next-line\n  const { updatedAt, ...pageWithoutUpdated } = page\n\n  // Add page.\n  createNode({\n    ...pageWithoutUpdated,\n    id: createPageId(page.path),\n    parent: null,\n    children: [],\n    internal: {\n      type: `SitePage`,\n      contentDigest: createContentDigest(pageWithoutUpdated),\n      description:\n        page.pluginCreatorId === `Plugin default-site-plugin`\n          ? `Your site's \"gatsby-node.js\"`\n          : page.pluginCreatorId,\n    },\n  })\n}\n\n// Listen for DELETE_PAGE and delete page nodes.\nemitter.on(`DELETE_PAGE`, action => {\n  const nodeId = createPageId(action.payload.path)\n  const node = getNode(nodeId)\n  boundActionCreators.deleteNode({ node })\n})\n"],"file":"gatsby-node.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/internal-plugins/load-babel-config/gatsby-node.js b/node_modules/gatsby/dist/internal-plugins/load-babel-config/gatsby-node.js
index 496b383..89e766c 100644
--- a/node_modules/gatsby/dist/internal-plugins/load-babel-config/gatsby-node.js
+++ b/node_modules/gatsby/dist/internal-plugins/load-babel-config/gatsby-node.js
@@ -1,46 +1,36 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const fs = require(`fs-extra`);
 
 const apiRunnerNode = require(`../../utils/api-runner-node`);
 
-const _require = require(`../../utils/path`),
-      withBasePath = _require.withBasePath;
+const {
+  withBasePath
+} = require(`../../utils/path`);
 
-exports.onPreBootstrap =
-/*#__PURE__*/
-function () {
-  var _ref = (0, _asyncToGenerator2.default)(function* ({
-    store
-  }) {
-    const _store$getState$progr = store.getState().program,
-          directory = _store$getState$progr.directory,
-          browserslist = _store$getState$progr.browserslist;
-    const directoryPath = withBasePath(directory);
-    yield apiRunnerNode(`onCreateBabelConfig`, {
-      stage: `develop`
-    });
-    yield apiRunnerNode(`onCreateBabelConfig`, {
-      stage: `develop-html`
-    });
-    yield apiRunnerNode(`onCreateBabelConfig`, {
-      stage: `build-javascript`
-    });
-    yield apiRunnerNode(`onCreateBabelConfig`, {
-      stage: `build-html`
-    });
-    const babelState = JSON.stringify(Object.assign({}, store.getState().babelrc, {
-      browserslist
-    }), null, 2);
-    yield fs.writeFile(directoryPath(`.cache/babelState.json`), babelState);
+exports.onPreBootstrap = async ({
+  store
+}) => {
+  const {
+    directory,
+    browserslist
+  } = store.getState().program;
+  const directoryPath = withBasePath(directory);
+  await apiRunnerNode(`onCreateBabelConfig`, {
+    stage: `develop`
   });
-
-  return function (_x) {
-    return _ref.apply(this, arguments);
-  };
-}();
+  await apiRunnerNode(`onCreateBabelConfig`, {
+    stage: `develop-html`
+  });
+  await apiRunnerNode(`onCreateBabelConfig`, {
+    stage: `build-javascript`
+  });
+  await apiRunnerNode(`onCreateBabelConfig`, {
+    stage: `build-html`
+  });
+  const babelState = JSON.stringify({ ...store.getState().babelrc,
+    browserslist
+  }, null, 2);
+  await fs.writeFile(directoryPath(`.cache/babelState.json`), babelState);
+};
 //# sourceMappingURL=gatsby-node.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/internal-plugins/load-babel-config/gatsby-node.js.map b/node_modules/gatsby/dist/internal-plugins/load-babel-config/gatsby-node.js.map
index cad9941..33b02d7 100644
--- a/node_modules/gatsby/dist/internal-plugins/load-babel-config/gatsby-node.js.map
+++ b/node_modules/gatsby/dist/internal-plugins/load-babel-config/gatsby-node.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/internal-plugins/load-babel-config/gatsby-node.js"],"names":["fs","require","apiRunnerNode","withBasePath","exports","onPreBootstrap","store","getState","program","directory","browserslist","directoryPath","stage","babelState","JSON","stringify","babelrc","writeFile"],"mappings":";;;;;;AAEA,MAAMA,EAAE,GAAGC,OAAO,CAAE,UAAF,CAAlB;;AAEA,MAAMC,aAAa,GAAGD,OAAO,CAAE,6BAAF,CAA7B;;iBACyBA,OAAO,CAAE,kBAAF,C;MAAxBE,Y,YAAAA,Y;;AAERC,OAAO,CAACC,cAAR;AAAA;AAAA;AAAA,6CAAyB,WAAO;AAAEC,IAAAA;AAAF,GAAP,EAAqB;AAAA,kCACRA,KAAK,CAACC,QAAN,GAAiBC,OADT;AAAA,UACpCC,SADoC,yBACpCA,SADoC;AAAA,UACzBC,YADyB,yBACzBA,YADyB;AAE5C,UAAMC,aAAa,GAAGR,YAAY,CAACM,SAAD,CAAlC;AAEA,UAAMP,aAAa,CAAE,qBAAF,EAAwB;AACzCU,MAAAA,KAAK,EAAG;AADiC,KAAxB,CAAnB;AAGA,UAAMV,aAAa,CAAE,qBAAF,EAAwB;AACzCU,MAAAA,KAAK,EAAG;AADiC,KAAxB,CAAnB;AAGA,UAAMV,aAAa,CAAE,qBAAF,EAAwB;AACzCU,MAAAA,KAAK,EAAG;AADiC,KAAxB,CAAnB;AAGA,UAAMV,aAAa,CAAE,qBAAF,EAAwB;AACzCU,MAAAA,KAAK,EAAG;AADiC,KAAxB,CAAnB;AAIA,UAAMC,UAAU,GAAGC,IAAI,CAACC,SAAL,mBAEZT,KAAK,CAACC,QAAN,GAAiBS,OAFL;AAGfN,MAAAA;AAHe,QAKjB,IALiB,EAMjB,CANiB,CAAnB;AASA,UAAMV,EAAE,CAACiB,SAAH,CAAaN,aAAa,CAAE,wBAAF,CAA1B,EAAsDE,UAAtD,CAAN;AACD,GA3BD;;AAAA;AAAA;AAAA;AAAA","sourcesContent":["/* @flow */\n\nconst fs = require(`fs-extra`)\n\nconst apiRunnerNode = require(`../../utils/api-runner-node`)\nconst { withBasePath } = require(`../../utils/path`)\n\nexports.onPreBootstrap = async ({ store }) => {\n  const { directory, browserslist } = store.getState().program\n  const directoryPath = withBasePath(directory)\n\n  await apiRunnerNode(`onCreateBabelConfig`, {\n    stage: `develop`,\n  })\n  await apiRunnerNode(`onCreateBabelConfig`, {\n    stage: `develop-html`,\n  })\n  await apiRunnerNode(`onCreateBabelConfig`, {\n    stage: `build-javascript`,\n  })\n  await apiRunnerNode(`onCreateBabelConfig`, {\n    stage: `build-html`,\n  })\n\n  const babelState = JSON.stringify(\n    {\n      ...store.getState().babelrc,\n      browserslist,\n    },\n    null,\n    2\n  )\n\n  await fs.writeFile(directoryPath(`.cache/babelState.json`), babelState)\n}\n"],"file":"gatsby-node.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/internal-plugins/load-babel-config/gatsby-node.js"],"names":["fs","require","apiRunnerNode","withBasePath","exports","onPreBootstrap","store","directory","browserslist","getState","program","directoryPath","stage","babelState","JSON","stringify","babelrc","writeFile"],"mappings":";;AAEA,MAAMA,EAAE,GAAGC,OAAO,CAAE,UAAF,CAAlB;;AAEA,MAAMC,aAAa,GAAGD,OAAO,CAAE,6BAAF,CAA7B;;AACA,MAAM;AAAEE,EAAAA;AAAF,IAAmBF,OAAO,CAAE,kBAAF,CAAhC;;AAEAG,OAAO,CAACC,cAAR,GAAyB,OAAO;AAAEC,EAAAA;AAAF,CAAP,KAAqB;AAC5C,QAAM;AAAEC,IAAAA,SAAF;AAAaC,IAAAA;AAAb,MAA8BF,KAAK,CAACG,QAAN,GAAiBC,OAArD;AACA,QAAMC,aAAa,GAAGR,YAAY,CAACI,SAAD,CAAlC;AAEA,QAAML,aAAa,CAAE,qBAAF,EAAwB;AACzCU,IAAAA,KAAK,EAAG;AADiC,GAAxB,CAAnB;AAGA,QAAMV,aAAa,CAAE,qBAAF,EAAwB;AACzCU,IAAAA,KAAK,EAAG;AADiC,GAAxB,CAAnB;AAGA,QAAMV,aAAa,CAAE,qBAAF,EAAwB;AACzCU,IAAAA,KAAK,EAAG;AADiC,GAAxB,CAAnB;AAGA,QAAMV,aAAa,CAAE,qBAAF,EAAwB;AACzCU,IAAAA,KAAK,EAAG;AADiC,GAAxB,CAAnB;AAIA,QAAMC,UAAU,GAAGC,IAAI,CAACC,SAAL,CACjB,EACE,GAAGT,KAAK,CAACG,QAAN,GAAiBO,OADtB;AAEER,IAAAA;AAFF,GADiB,EAKjB,IALiB,EAMjB,CANiB,CAAnB;AASA,QAAMR,EAAE,CAACiB,SAAH,CAAaN,aAAa,CAAE,wBAAF,CAA1B,EAAsDE,UAAtD,CAAN;AACD,CA3BD","sourcesContent":["/* @flow */\n\nconst fs = require(`fs-extra`)\n\nconst apiRunnerNode = require(`../../utils/api-runner-node`)\nconst { withBasePath } = require(`../../utils/path`)\n\nexports.onPreBootstrap = async ({ store }) => {\n  const { directory, browserslist } = store.getState().program\n  const directoryPath = withBasePath(directory)\n\n  await apiRunnerNode(`onCreateBabelConfig`, {\n    stage: `develop`,\n  })\n  await apiRunnerNode(`onCreateBabelConfig`, {\n    stage: `develop-html`,\n  })\n  await apiRunnerNode(`onCreateBabelConfig`, {\n    stage: `build-javascript`,\n  })\n  await apiRunnerNode(`onCreateBabelConfig`, {\n    stage: `build-html`,\n  })\n\n  const babelState = JSON.stringify(\n    {\n      ...store.getState().babelrc,\n      browserslist,\n    },\n    null,\n    2\n  )\n\n  await fs.writeFile(directoryPath(`.cache/babelState.json`), babelState)\n}\n"],"file":"gatsby-node.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/internal-plugins/prod-404/gatsby-node.js b/node_modules/gatsby/dist/internal-plugins/prod-404/gatsby-node.js
index 5960ccd..b41a71b 100644
--- a/node_modules/gatsby/dist/internal-plugins/prod-404/gatsby-node.js
+++ b/node_modules/gatsby/dist/internal-plugins/prod-404/gatsby-node.js
@@ -11,9 +11,9 @@ exports.onCreatePage = ({
   // site 404 pages to be named this.
   // https://www.gatsbyjs.org/docs/add-404-page/
   if (!created404 && page.path === `/404/`) {
-    actions.createPage(Object.assign({}, page, {
+    actions.createPage({ ...page,
       path: `/404.html`
-    }));
+    });
     created404 = true;
   }
 };
diff --git a/node_modules/gatsby/dist/internal-plugins/prod-404/gatsby-node.js.map b/node_modules/gatsby/dist/internal-plugins/prod-404/gatsby-node.js.map
index 21826ec..8158e2f 100644
--- a/node_modules/gatsby/dist/internal-plugins/prod-404/gatsby-node.js.map
+++ b/node_modules/gatsby/dist/internal-plugins/prod-404/gatsby-node.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/internal-plugins/prod-404/gatsby-node.js"],"names":["created404","exports","onCreatePage","page","store","actions","path","createPage"],"mappings":";;AAAA,IAAIA,UAAU,GAAG,KAAjB;;AACAC,OAAO,CAACC,YAAR,GAAuB,CAAC;AAAEC,EAAAA,IAAF;AAAQC,EAAAA,KAAR;AAAeC,EAAAA;AAAf,CAAD,KAA8B;AACnD;AACA;AACA;AACA,MAAI,CAACL,UAAD,IAAeG,IAAI,CAACG,IAAL,KAAe,OAAlC,EAA0C;AACxCD,IAAAA,OAAO,CAACE,UAAR,mBACKJ,IADL;AAEEG,MAAAA,IAAI,EAAG;AAFT;AAIAN,IAAAA,UAAU,GAAG,IAAb;AACD;AACF,CAXD","sourcesContent":["let created404 = false\nexports.onCreatePage = ({ page, store, actions }) => {\n  // Copy /404/ to /404.html as many static site hosts expect\n  // site 404 pages to be named this.\n  // https://www.gatsbyjs.org/docs/add-404-page/\n  if (!created404 && page.path === `/404/`) {\n    actions.createPage({\n      ...page,\n      path: `/404.html`,\n    })\n    created404 = true\n  }\n}\n"],"file":"gatsby-node.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/internal-plugins/prod-404/gatsby-node.js"],"names":["created404","exports","onCreatePage","page","store","actions","path","createPage"],"mappings":";;AAAA,IAAIA,UAAU,GAAG,KAAjB;;AACAC,OAAO,CAACC,YAAR,GAAuB,CAAC;AAAEC,EAAAA,IAAF;AAAQC,EAAAA,KAAR;AAAeC,EAAAA;AAAf,CAAD,KAA8B;AACnD;AACA;AACA;AACA,MAAI,CAACL,UAAD,IAAeG,IAAI,CAACG,IAAL,KAAe,OAAlC,EAA0C;AACxCD,IAAAA,OAAO,CAACE,UAAR,CAAmB,EACjB,GAAGJ,IADc;AAEjBG,MAAAA,IAAI,EAAG;AAFU,KAAnB;AAIAN,IAAAA,UAAU,GAAG,IAAb;AACD;AACF,CAXD","sourcesContent":["let created404 = false\nexports.onCreatePage = ({ page, store, actions }) => {\n  // Copy /404/ to /404.html as many static site hosts expect\n  // site 404 pages to be named this.\n  // https://www.gatsbyjs.org/docs/add-404-page/\n  if (!created404 && page.path === `/404/`) {\n    actions.createPage({\n      ...page,\n      path: `/404.html`,\n    })\n    created404 = true\n  }\n}\n"],"file":"gatsby-node.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/internal-plugins/webpack-theme-component-shadowing/gatsby-node.js b/node_modules/gatsby/dist/internal-plugins/webpack-theme-component-shadowing/gatsby-node.js
index 1b02c3a..1691fb2 100644
--- a/node_modules/gatsby/dist/internal-plugins/webpack-theme-component-shadowing/gatsby-node.js
+++ b/node_modules/gatsby/dist/internal-plugins/webpack-theme-component-shadowing/gatsby-node.js
@@ -10,17 +10,16 @@ exports.onCreateWebpackConfig = ({
   loaders,
   actions
 }, pluginOptions) => {
-  const _store$getState = store.getState(),
-        program = _store$getState.program,
-        themes = _store$getState.themes;
+  const {
+    program,
+    themes
+  } = store.getState();
 
   if (themes.themes) {
     actions.setWebpackConfig({
       resolve: {
         plugins: [new GatsbyThemeComponentShadowingResolverPlugin({
-          themes: themes.themes.map(({
-            themeName
-          }) => themeName),
+          themes: themes.themes,
           projectRoot: program.directory
         })]
       }
diff --git a/node_modules/gatsby/dist/internal-plugins/webpack-theme-component-shadowing/gatsby-node.js.map b/node_modules/gatsby/dist/internal-plugins/webpack-theme-component-shadowing/gatsby-node.js.map
index 0bed86c..0bca5f2 100644
--- a/node_modules/gatsby/dist/internal-plugins/webpack-theme-component-shadowing/gatsby-node.js.map
+++ b/node_modules/gatsby/dist/internal-plugins/webpack-theme-component-shadowing/gatsby-node.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/internal-plugins/webpack-theme-component-shadowing/gatsby-node.js"],"names":["GatsbyThemeComponentShadowingResolverPlugin","require","exports","onCreateWebpackConfig","store","stage","getConfig","rules","loaders","actions","pluginOptions","getState","program","themes","setWebpackConfig","resolve","plugins","map","themeName","projectRoot","directory"],"mappings":";;AAAA,MAAMA,2CAA2C,GAAGC,OAAO,CAAE,GAAF,CAA3D;;AAEAC,OAAO,CAACC,qBAAR,GAAgC,CAC9B;AAAEC,EAAAA,KAAF;AAASC,EAAAA,KAAT;AAAgBC,EAAAA,SAAhB;AAA2BC,EAAAA,KAA3B;AAAkCC,EAAAA,OAAlC;AAA2CC,EAAAA;AAA3C,CAD8B,EAE9BC,aAF8B,KAG3B;AAAA,0BACyBN,KAAK,CAACO,QAAN,EADzB;AAAA,QACKC,OADL,mBACKA,OADL;AAAA,QACcC,MADd,mBACcA,MADd;;AAGH,MAAIA,MAAM,CAACA,MAAX,EAAmB;AACjBJ,IAAAA,OAAO,CAACK,gBAAR,CAAyB;AACvBC,MAAAA,OAAO,EAAE;AACPC,QAAAA,OAAO,EAAE,CACP,IAAIhB,2CAAJ,CAAgD;AAC9Ca,UAAAA,MAAM,EAAEA,MAAM,CAACA,MAAP,CAAcI,GAAd,CAAkB,CAAC;AAAEC,YAAAA;AAAF,WAAD,KAAmBA,SAArC,CADsC;AAE9CC,UAAAA,WAAW,EAAEP,OAAO,CAACQ;AAFyB,SAAhD,CADO;AADF;AADc,KAAzB;AAUD;AACF,CAlBD","sourcesContent":["const GatsbyThemeComponentShadowingResolverPlugin = require(`.`)\n\nexports.onCreateWebpackConfig = (\n  { store, stage, getConfig, rules, loaders, actions },\n  pluginOptions\n) => {\n  const { program, themes } = store.getState()\n\n  if (themes.themes) {\n    actions.setWebpackConfig({\n      resolve: {\n        plugins: [\n          new GatsbyThemeComponentShadowingResolverPlugin({\n            themes: themes.themes.map(({ themeName }) => themeName),\n            projectRoot: program.directory,\n          }),\n        ],\n      },\n    })\n  }\n}\n"],"file":"gatsby-node.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/internal-plugins/webpack-theme-component-shadowing/gatsby-node.js"],"names":["GatsbyThemeComponentShadowingResolverPlugin","require","exports","onCreateWebpackConfig","store","stage","getConfig","rules","loaders","actions","pluginOptions","program","themes","getState","setWebpackConfig","resolve","plugins","projectRoot","directory"],"mappings":";;AAAA,MAAMA,2CAA2C,GAAGC,OAAO,CAAE,GAAF,CAA3D;;AAEAC,OAAO,CAACC,qBAAR,GAAgC,CAC9B;AAAEC,EAAAA,KAAF;AAASC,EAAAA,KAAT;AAAgBC,EAAAA,SAAhB;AAA2BC,EAAAA,KAA3B;AAAkCC,EAAAA,OAAlC;AAA2CC,EAAAA;AAA3C,CAD8B,EAE9BC,aAF8B,KAG3B;AACH,QAAM;AAAEC,IAAAA,OAAF;AAAWC,IAAAA;AAAX,MAAsBR,KAAK,CAACS,QAAN,EAA5B;;AAEA,MAAID,MAAM,CAACA,MAAX,EAAmB;AACjBH,IAAAA,OAAO,CAACK,gBAAR,CAAyB;AACvBC,MAAAA,OAAO,EAAE;AACPC,QAAAA,OAAO,EAAE,CACP,IAAIhB,2CAAJ,CAAgD;AAC9CY,UAAAA,MAAM,EAAEA,MAAM,CAACA,MAD+B;AAE9CK,UAAAA,WAAW,EAAEN,OAAO,CAACO;AAFyB,SAAhD,CADO;AADF;AADc,KAAzB;AAUD;AACF,CAlBD","sourcesContent":["const GatsbyThemeComponentShadowingResolverPlugin = require(`.`)\n\nexports.onCreateWebpackConfig = (\n  { store, stage, getConfig, rules, loaders, actions },\n  pluginOptions\n) => {\n  const { program, themes } = store.getState()\n\n  if (themes.themes) {\n    actions.setWebpackConfig({\n      resolve: {\n        plugins: [\n          new GatsbyThemeComponentShadowingResolverPlugin({\n            themes: themes.themes,\n            projectRoot: program.directory,\n          }),\n        ],\n      },\n    })\n  }\n}\n"],"file":"gatsby-node.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/internal-plugins/webpack-theme-component-shadowing/index.js b/node_modules/gatsby/dist/internal-plugins/webpack-theme-component-shadowing/index.js
index 6500979..8e78eec 100644
--- a/node_modules/gatsby/dist/internal-plugins/webpack-theme-component-shadowing/index.js
+++ b/node_modules/gatsby/dist/internal-plugins/webpack-theme-component-shadowing/index.js
@@ -4,27 +4,37 @@ var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefau
 
 var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));
 
+var _temp;
+
 const path = require(`path`);
 
 const debug = require(`debug`)(`gatsby:component-shadowing`);
 
 const fs = require(`fs`);
 
-module.exports = class GatsbyThemeComponentShadowingResolverPlugin {
+const _ = require(`lodash`);
+
+const pathWithoutExtension = fullPath => {
+  const parsed = path.parse(fullPath);
+  return path.join(parsed.dir, parsed.name);
+};
+
+module.exports = (_temp = class GatsbyThemeComponentShadowingResolverPlugin {
   constructor({
     projectRoot,
     themes
   }) {
     (0, _defineProperty2.default)(this, "cache", {});
-    debug(`themes list`, themes);
+    debug(`themes list`, themes.map(({
+      themeName
+    }) => themeName));
     this.themes = themes;
     this.projectRoot = projectRoot;
   }
 
   apply(resolver) {
     resolver.plugin(`relative`, (request, callback) => {
-      // find out which theme's src/components dir we're requiring from
-      const matchingThemes = this.themes.filter(name => request.path.includes(path.join(name, `src`))); // 0 matching themes happens a lot fo rpaths we don't want to handle
+      const matchingThemes = this.getMatchingThemesForPath(request.path); // 0 matching themes happens a lot for paths we don't want to handle
       // > 1 matching theme means we have a path like
       //   `gatsby-theme-blog/src/components/gatsby-theme-something/src/components`
 
@@ -37,10 +47,11 @@ module.exports = class GatsbyThemeComponentShadowingResolverPlugin {
       } // theme is the theme package from which we're requiring the relative component
 
 
-      const theme = matchingThemes[0]; // get the location of the component relative to src/
+      const [theme] = matchingThemes; // get the location of the component relative to src/
 
-      const _request$path$split = request.path.split(path.join(theme, `src`)),
-            component = _request$path$split[1];
+      const [, component] = request.path.split(path.join(theme, `src`));
+
+      if (
       /**
        * if someone adds
        * ```
@@ -51,25 +62,30 @@ module.exports = class GatsbyThemeComponentShadowingResolverPlugin {
        * like this in a theme, but we also shouldn't artificially break
        * people that do.
        */
+      request.context.issuer &&
+      /**
+       * An issuer is the file making the require request. It can
+       * be in a user's site or a theme. If the issuer is requesting
+       * a path in the shadow chain that it participates in, then we
+       * will let the request through as normal. Otherwise, we
+       * engage the shadowing algorithm.
+       */
+      this.requestPathIsIssuerShadowPath({
+        requestPath: request.path,
+        issuerPath: request.context.issuer
+      })) {
+        return resolver.doResolve(`describedRelative`, request, null, {}, callback);
+      } // This is the shadowing algorithm.
 
 
-      if (request.context.issuer) {
-        const issuerExtension = path.extname(request.context.issuer);
-
-        if (request.context.issuer.slice(0, -issuerExtension.length).endsWith(component)) {
-          return resolver.doResolve(`describedRelative`, request, null, {}, callback);
-        }
-      }
-
       const builtComponentPath = this.resolveComponentPath({
         matchingTheme: theme,
         themes: this.themes,
-        component,
-        projectRoot: this.projectRoot
+        component
       });
-      return resolver.doResolve(`describedRelative`, Object.assign({}, request, {
+      return resolver.doResolve(`describedRelative`, { ...request,
         path: builtComponentPath || request.path
-      }), null, {}, callback);
+      }, null, {}, callback);
     });
   } // check the cache, the user's project, and finally the theme files
 
@@ -77,14 +93,17 @@ module.exports = class GatsbyThemeComponentShadowingResolverPlugin {
   resolveComponentPath({
     matchingTheme: theme,
     themes: ogThemes,
-    component,
-    projectRoot
+    component
   }) {
     // don't include matching theme in possible shadowing paths
-    const themes = ogThemes.filter(t => t !== theme);
+    const themes = ogThemes.filter(({
+      themeName
+    }) => themeName !== theme);
 
     if (!this.cache[`${theme}-${component}`]) {
-      this.cache[`${theme}-${component}`] = [path.join(path.resolve(`.`), `src`, theme)].concat(Array.from(themes).reverse().map(aTheme => path.join(path.dirname(require.resolve(aTheme)), `src`, theme))).map(dir => path.join(dir, component)).find(possibleComponentPath => {
+      this.cache[`${theme}-${component}`] = [path.join(path.resolve(`.`), `src`, theme)].concat(Array.from(themes).reverse().map(({
+        themeDir
+      }) => path.join(themeDir, `src`, theme))).map(dir => path.join(dir, component)).find(possibleComponentPath => {
         debug(`possibleComponentPath`, possibleComponentPath);
         let dir;
 
@@ -108,5 +127,51 @@ module.exports = class GatsbyThemeComponentShadowingResolverPlugin {
     return this.cache[`${theme}-${component}`];
   }
 
-};
+  getMatchingThemesForPath(filepath) {
+    // find out which theme's src/components dir we're requiring from
+    const allMatchingThemes = this.themes.filter(({
+      themeName
+    }) => filepath.includes(path.join(themeName, `src`))); // The same theme can be included twice in the themes list causing multiple
+    // matches. This case should only be counted as a single match for that theme.
+
+    return _.uniq(allMatchingThemes.map(({
+      themeName
+    }) => themeName));
+  } // given a theme name, return all of the possible shadow locations
+
+
+  getBaseShadowDirsForThemes(theme) {
+    return Array.from(this.themes).reverse().map(({
+      themeName,
+      themeDir
+    }) => {
+      if (themeName === theme) {
+        return path.join(themeDir, `src`);
+      } else {
+        return path.join(themeDir, `src`, theme);
+      }
+    });
+  }
+
+  requestPathIsIssuerShadowPath({
+    requestPath,
+    issuerPath
+  }) {
+    // get the issuer's theme
+    const matchingThemes = this.getMatchingThemesForPath(requestPath);
+
+    if (matchingThemes.length !== 1) {
+      return false;
+    }
+
+    const [theme] = matchingThemes; // get the location of the component relative to src/
+
+    const [, component] = requestPath.split(path.join(theme, `src`)); // get list of potential shadow locations
+
+    const shadowFiles = this.getBaseShadowDirsForThemes(theme).map(dir => path.join(dir, component)); // if the issuer is requesting a path that is a potential shadow path of itself
+
+    return shadowFiles.includes(pathWithoutExtension(issuerPath));
+  }
+
+}, _temp);
 //# sourceMappingURL=index.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/internal-plugins/webpack-theme-component-shadowing/index.js.map b/node_modules/gatsby/dist/internal-plugins/webpack-theme-component-shadowing/index.js.map
index ddfac8d..d68cf1c 100644
--- a/node_modules/gatsby/dist/internal-plugins/webpack-theme-component-shadowing/index.js.map
+++ b/node_modules/gatsby/dist/internal-plugins/webpack-theme-component-shadowing/index.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/internal-plugins/webpack-theme-component-shadowing/index.js"],"names":["path","require","debug","fs","module","exports","GatsbyThemeComponentShadowingResolverPlugin","constructor","projectRoot","themes","apply","resolver","plugin","request","callback","matchingThemes","filter","name","includes","join","length","Error","theme","split","component","context","issuer","issuerExtension","extname","slice","endsWith","doResolve","builtComponentPath","resolveComponentPath","matchingTheme","ogThemes","t","cache","resolve","concat","Array","from","reverse","map","aTheme","dirname","dir","find","possibleComponentPath","readdirSync","e","exists","filepath","ext","filenameWithoutExtension","basename"],"mappings":"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","sourcesContent":["const path = require(`path`)\nconst debug = require(`debug`)(`gatsby:component-shadowing`)\nconst fs = require(`fs`)\n\nmodule.exports = class GatsbyThemeComponentShadowingResolverPlugin {\n  cache = {}\n\n  constructor({ projectRoot, themes }) {\n    debug(`themes list`, themes)\n    this.themes = themes\n    this.projectRoot = projectRoot\n  }\n\n  apply(resolver) {\n    resolver.plugin(`relative`, (request, callback) => {\n      // find out which theme's src/components dir we're requiring from\n      const matchingThemes = this.themes.filter(name =>\n        request.path.includes(path.join(name, `src`))\n      )\n      // 0 matching themes happens a lot fo rpaths we don't want to handle\n      // > 1 matching theme means we have a path like\n      //   `gatsby-theme-blog/src/components/gatsby-theme-something/src/components`\n      if (matchingThemes.length > 1) {\n        throw new Error(\n          `Gatsby can't differentiate between themes ${matchingThemes.join(\n            ` and `\n          )} for path ${request.path}`\n        )\n      }\n      if (matchingThemes.length !== 1) {\n        return callback()\n      }\n      // theme is the theme package from which we're requiring the relative component\n      const [theme] = matchingThemes\n      // get the location of the component relative to src/\n      const [, component] = request.path.split(path.join(theme, `src`))\n\n      /**\n       * if someone adds\n       * ```\n       * modules: [path.resolve(__dirname, 'src'), 'node_modules'],\n       * ```\n       * to the webpack config, `issuer` is `null`, so we skip this check.\n       * note that it's probably a bad idea in general to set `modules`\n       * like this in a theme, but we also shouldn't artificially break\n       * people that do.\n       */\n      if (request.context.issuer) {\n        const issuerExtension = path.extname(request.context.issuer)\n\n        if (\n          request.context.issuer\n            .slice(0, -issuerExtension.length)\n            .endsWith(component)\n        ) {\n          return resolver.doResolve(\n            `describedRelative`,\n            request,\n            null,\n            {},\n            callback\n          )\n        }\n      }\n      const builtComponentPath = this.resolveComponentPath({\n        matchingTheme: theme,\n        themes: this.themes,\n        component,\n        projectRoot: this.projectRoot,\n      })\n\n      return resolver.doResolve(\n        `describedRelative`,\n        { ...request, path: builtComponentPath || request.path },\n        null,\n        {},\n        callback\n      )\n    })\n  }\n\n  // check the cache, the user's project, and finally the theme files\n  resolveComponentPath({\n    matchingTheme: theme,\n    themes: ogThemes,\n    component,\n    projectRoot,\n  }) {\n    // don't include matching theme in possible shadowing paths\n    const themes = ogThemes.filter(t => t !== theme)\n    if (!this.cache[`${theme}-${component}`]) {\n      this.cache[`${theme}-${component}`] = [\n        path.join(path.resolve(`.`), `src`, theme),\n      ]\n        .concat(\n          Array.from(themes)\n            .reverse()\n            .map(aTheme =>\n              path.join(path.dirname(require.resolve(aTheme)), `src`, theme)\n            )\n        )\n        .map(dir => path.join(dir, component))\n        .find(possibleComponentPath => {\n          debug(`possibleComponentPath`, possibleComponentPath)\n          let dir\n          try {\n            // we use fs/path instead of require.resolve to work with\n            // TypeScript and alternate syntaxes\n            dir = fs.readdirSync(path.dirname(possibleComponentPath))\n          } catch (e) {\n            return false\n          }\n          const exists = dir\n            .map(filepath => {\n              const ext = path.extname(filepath)\n              const filenameWithoutExtension = path.basename(filepath, ext)\n              return filenameWithoutExtension\n            })\n            .includes(\n              path.basename(\n                possibleComponentPath,\n                path.extname(possibleComponentPath)\n              )\n            )\n          return exists\n        })\n    }\n\n    return this.cache[`${theme}-${component}`]\n  }\n}\n"],"file":"index.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/internal-plugins/webpack-theme-component-shadowing/index.js"],"names":["path","require","debug","fs","_","pathWithoutExtension","fullPath","parsed","parse","join","dir","name","module","exports","GatsbyThemeComponentShadowingResolverPlugin","constructor","projectRoot","themes","map","themeName","apply","resolver","plugin","request","callback","matchingThemes","getMatchingThemesForPath","length","Error","theme","component","split","context","issuer","requestPathIsIssuerShadowPath","requestPath","issuerPath","doResolve","builtComponentPath","resolveComponentPath","matchingTheme","ogThemes","filter","cache","resolve","concat","Array","from","reverse","themeDir","find","possibleComponentPath","readdirSync","dirname","e","exists","filepath","ext","extname","filenameWithoutExtension","basename","includes","allMatchingThemes","uniq","getBaseShadowDirsForThemes","shadowFiles"],"mappings":"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","sourcesContent":["const path = require(`path`)\nconst debug = require(`debug`)(`gatsby:component-shadowing`)\nconst fs = require(`fs`)\nconst _ = require(`lodash`)\n\nconst pathWithoutExtension = fullPath => {\n  const parsed = path.parse(fullPath)\n  return path.join(parsed.dir, parsed.name)\n}\n\nmodule.exports = class GatsbyThemeComponentShadowingResolverPlugin {\n  cache = {}\n\n  constructor({ projectRoot, themes }) {\n    debug(`themes list`, themes.map(({ themeName }) => themeName))\n    this.themes = themes\n    this.projectRoot = projectRoot\n  }\n\n  apply(resolver) {\n    resolver.plugin(`relative`, (request, callback) => {\n      const matchingThemes = this.getMatchingThemesForPath(request.path)\n\n      // 0 matching themes happens a lot for paths we don't want to handle\n      // > 1 matching theme means we have a path like\n      //   `gatsby-theme-blog/src/components/gatsby-theme-something/src/components`\n      if (matchingThemes.length > 1) {\n        throw new Error(\n          `Gatsby can't differentiate between themes ${matchingThemes.join(\n            ` and `\n          )} for path ${request.path}`\n        )\n      }\n\n      if (matchingThemes.length !== 1) {\n        return callback()\n      }\n\n      // theme is the theme package from which we're requiring the relative component\n      const [theme] = matchingThemes\n      // get the location of the component relative to src/\n      const [, component] = request.path.split(path.join(theme, `src`))\n\n      if (\n        /**\n         * if someone adds\n         * ```\n         * modules: [path.resolve(__dirname, 'src'), 'node_modules'],\n         * ```\n         * to the webpack config, `issuer` is `null`, so we skip this check.\n         * note that it's probably a bad idea in general to set `modules`\n         * like this in a theme, but we also shouldn't artificially break\n         * people that do.\n         */\n        request.context.issuer &&\n        /**\n         * An issuer is the file making the require request. It can\n         * be in a user's site or a theme. If the issuer is requesting\n         * a path in the shadow chain that it participates in, then we\n         * will let the request through as normal. Otherwise, we\n         * engage the shadowing algorithm.\n         */\n        this.requestPathIsIssuerShadowPath({\n          requestPath: request.path,\n          issuerPath: request.context.issuer,\n        })\n      ) {\n        return resolver.doResolve(\n          `describedRelative`,\n          request,\n          null,\n          {},\n          callback\n        )\n      }\n\n      // This is the shadowing algorithm.\n      const builtComponentPath = this.resolveComponentPath({\n        matchingTheme: theme,\n        themes: this.themes,\n        component,\n      })\n\n      return resolver.doResolve(\n        `describedRelative`,\n        { ...request, path: builtComponentPath || request.path },\n        null,\n        {},\n        callback\n      )\n    })\n  }\n\n  // check the cache, the user's project, and finally the theme files\n  resolveComponentPath({ matchingTheme: theme, themes: ogThemes, component }) {\n    // don't include matching theme in possible shadowing paths\n    const themes = ogThemes.filter(({ themeName }) => themeName !== theme)\n    if (!this.cache[`${theme}-${component}`]) {\n      this.cache[`${theme}-${component}`] = [\n        path.join(path.resolve(`.`), `src`, theme),\n      ]\n        .concat(\n          Array.from(themes)\n            .reverse()\n            .map(({ themeDir }) => path.join(themeDir, `src`, theme))\n        )\n        .map(dir => path.join(dir, component))\n        .find(possibleComponentPath => {\n          debug(`possibleComponentPath`, possibleComponentPath)\n          let dir\n          try {\n            // we use fs/path instead of require.resolve to work with\n            // TypeScript and alternate syntaxes\n            dir = fs.readdirSync(path.dirname(possibleComponentPath))\n          } catch (e) {\n            return false\n          }\n          const exists = dir\n            .map(filepath => {\n              const ext = path.extname(filepath)\n              const filenameWithoutExtension = path.basename(filepath, ext)\n              return filenameWithoutExtension\n            })\n            .includes(\n              path.basename(\n                possibleComponentPath,\n                path.extname(possibleComponentPath)\n              )\n            )\n          return exists\n        })\n    }\n\n    return this.cache[`${theme}-${component}`]\n  }\n\n  getMatchingThemesForPath(filepath) {\n    // find out which theme's src/components dir we're requiring from\n    const allMatchingThemes = this.themes.filter(({ themeName }) =>\n      filepath.includes(path.join(themeName, `src`))\n    )\n\n    // The same theme can be included twice in the themes list causing multiple\n    // matches. This case should only be counted as a single match for that theme.\n    return _.uniq(allMatchingThemes.map(({ themeName }) => themeName))\n  }\n\n  // given a theme name, return all of the possible shadow locations\n  getBaseShadowDirsForThemes(theme) {\n    return Array.from(this.themes)\n      .reverse()\n      .map(({ themeName, themeDir }) => {\n        if (themeName === theme) {\n          return path.join(themeDir, `src`)\n        } else {\n          return path.join(themeDir, `src`, theme)\n        }\n      })\n  }\n\n  requestPathIsIssuerShadowPath({ requestPath, issuerPath }) {\n    // get the issuer's theme\n    const matchingThemes = this.getMatchingThemesForPath(requestPath)\n    if (matchingThemes.length !== 1) {\n      return false\n    }\n    const [theme] = matchingThemes\n\n    // get the location of the component relative to src/\n    const [, component] = requestPath.split(path.join(theme, `src`))\n\n    // get list of potential shadow locations\n    const shadowFiles = this.getBaseShadowDirsForThemes(theme).map(dir =>\n      path.join(dir, component)\n    )\n\n    // if the issuer is requesting a path that is a potential shadow path of itself\n    return shadowFiles.includes(pathWithoutExtension(issuerPath))\n  }\n}\n"],"file":"index.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/joi-schemas/joi.js b/node_modules/gatsby/dist/joi-schemas/joi.js
index 19a6289..f060a7b 100644
--- a/node_modules/gatsby/dist/joi-schemas/joi.js
+++ b/node_modules/gatsby/dist/joi-schemas/joi.js
@@ -5,11 +5,18 @@ exports.nodeSchema = exports.pageSchema = exports.gatsbyConfigSchema = void 0;
 
 const Joi = require(`joi`);
 
+const stripTrailingSlash = chain => chain.replace(/(\w)\/+$/, `$1`);
+
 const gatsbyConfigSchema = Joi.object().keys({
   __experimentalThemes: Joi.array(),
   polyfill: Joi.boolean(),
-  siteMetadata: Joi.object(),
-  pathPrefix: Joi.string(),
+  siteMetadata: Joi.object({
+    siteUrl: stripTrailingSlash(Joi.string()).uri()
+  }).unknown(),
+  pathPrefix: Joi.string().uri({
+    allowRelative: true,
+    relativeOnly: true
+  }),
   mapping: Joi.object(),
   plugins: Joi.array(),
   proxy: Joi.object().keys({
diff --git a/node_modules/gatsby/dist/joi-schemas/joi.js.map b/node_modules/gatsby/dist/joi-schemas/joi.js.map
index 10f29a6..c1a2fdf 100644
--- a/node_modules/gatsby/dist/joi-schemas/joi.js.map
+++ b/node_modules/gatsby/dist/joi-schemas/joi.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/joi-schemas/joi.js"],"names":["Joi","require","gatsbyConfigSchema","object","keys","__experimentalThemes","array","polyfill","boolean","siteMetadata","pathPrefix","string","mapping","plugins","proxy","prefix","required","url","developMiddleware","func","pageSchema","path","matchPath","component","componentChunkName","context","pluginCreator___NODE","pluginCreatorId","unknown","nodeSchema","id","children","items","forbidden","parent","allow","fields","internal","contentDigest","mediaType","type","owner","fieldOwners","content","description","ignoreType"],"mappings":"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","sourcesContent":["const Joi = require(`joi`)\n\nexport const gatsbyConfigSchema = Joi.object().keys({\n  __experimentalThemes: Joi.array(),\n  polyfill: Joi.boolean(),\n  siteMetadata: Joi.object(),\n  pathPrefix: Joi.string(),\n  mapping: Joi.object(),\n  plugins: Joi.array(),\n  proxy: Joi.object().keys({\n    prefix: Joi.string().required(),\n    url: Joi.string().required(),\n  }),\n  developMiddleware: Joi.func(),\n})\n\nexport const pageSchema = Joi.object()\n  .keys({\n    path: Joi.string().required(),\n    matchPath: Joi.string(),\n    component: Joi.string().required(),\n    componentChunkName: Joi.string().required(),\n    context: Joi.object(),\n    pluginCreator___NODE: Joi.string(),\n    pluginCreatorId: Joi.string(),\n  })\n  .unknown()\n\nexport const nodeSchema = Joi.object()\n  .keys({\n    id: Joi.string().required(),\n    children: Joi.array().items(Joi.string(), Joi.object().forbidden()),\n    parent: Joi.string().allow(null),\n    fields: Joi.object(),\n    internal: Joi.object()\n      .keys({\n        contentDigest: Joi.string().required(),\n        mediaType: Joi.string(),\n        type: Joi.string().required(),\n        owner: Joi.string().required(),\n        fieldOwners: Joi.object(),\n        content: Joi.string().allow(``),\n        description: Joi.string(),\n        ignoreType: Joi.boolean(),\n      })\n      .unknown({\n        allow: false,\n      }), // Don't allow non-standard fields\n  })\n  .unknown()\n"],"file":"joi.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/joi-schemas/joi.js"],"names":["Joi","require","stripTrailingSlash","chain","replace","gatsbyConfigSchema","object","keys","__experimentalThemes","array","polyfill","boolean","siteMetadata","siteUrl","string","uri","unknown","pathPrefix","allowRelative","relativeOnly","mapping","plugins","proxy","prefix","required","url","developMiddleware","func","pageSchema","path","matchPath","component","componentChunkName","context","pluginCreator___NODE","pluginCreatorId","nodeSchema","id","children","items","forbidden","parent","allow","fields","internal","contentDigest","mediaType","type","owner","fieldOwners","content","description","ignoreType"],"mappings":"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","sourcesContent":["const Joi = require(`joi`)\n\nconst stripTrailingSlash = chain => chain.replace(/(\\w)\\/+$/, `$1`)\n\nexport const gatsbyConfigSchema = Joi.object().keys({\n  __experimentalThemes: Joi.array(),\n  polyfill: Joi.boolean(),\n  siteMetadata: Joi.object({\n    siteUrl: stripTrailingSlash(Joi.string()).uri(),\n  }).unknown(),\n  pathPrefix: Joi.string().uri({\n    allowRelative: true,\n    relativeOnly: true,\n  }),\n  mapping: Joi.object(),\n  plugins: Joi.array(),\n  proxy: Joi.object().keys({\n    prefix: Joi.string().required(),\n    url: Joi.string().required(),\n  }),\n  developMiddleware: Joi.func(),\n})\n\nexport const pageSchema = Joi.object()\n  .keys({\n    path: Joi.string().required(),\n    matchPath: Joi.string(),\n    component: Joi.string().required(),\n    componentChunkName: Joi.string().required(),\n    context: Joi.object(),\n    pluginCreator___NODE: Joi.string(),\n    pluginCreatorId: Joi.string(),\n  })\n  .unknown()\n\nexport const nodeSchema = Joi.object()\n  .keys({\n    id: Joi.string().required(),\n    children: Joi.array().items(Joi.string(), Joi.object().forbidden()),\n    parent: Joi.string().allow(null),\n    fields: Joi.object(),\n    internal: Joi.object()\n      .keys({\n        contentDigest: Joi.string().required(),\n        mediaType: Joi.string(),\n        type: Joi.string().required(),\n        owner: Joi.string().required(),\n        fieldOwners: Joi.object(),\n        content: Joi.string().allow(``),\n        description: Joi.string(),\n        ignoreType: Joi.boolean(),\n      })\n      .unknown({\n        allow: false,\n      }), // Don't allow non-standard fields\n  })\n  .unknown()\n"],"file":"joi.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/redux/actions.js b/node_modules/gatsby/dist/redux/actions.js
index 122c580..898fc74 100644
--- a/node_modules/gatsby/dist/redux/actions.js
+++ b/node_modules/gatsby/dist/redux/actions.js
@@ -1,20 +1,18 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _objectWithoutPropertiesLoose2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutPropertiesLoose"));
-
 const Joi = require(`joi`);
 
 const chalk = require(`chalk`);
 
 const _ = require(`lodash`);
 
-const _require = require(`redux`),
-      bindActionCreators = _require.bindActionCreators;
+const {
+  bindActionCreators
+} = require(`redux`);
 
-const _require2 = require(`common-tags`),
-      stripIndent = _require2.stripIndent;
+const {
+  stripIndent
+} = require(`common-tags`);
 
 const report = require(`gatsby-cli/lib/reporter`);
 
@@ -30,22 +28,26 @@ const kebabHash = require(`kebab-hash`);
 
 const slash = require(`slash`);
 
-const _require3 = require(`../db/nodes`),
-      hasNodeChanged = _require3.hasNodeChanged,
-      getNode = _require3.getNode;
+const {
+  hasNodeChanged,
+  getNode
+} = require(`../db/nodes`);
 
-const _require4 = require(`../db/node-tracking`),
-      trackInlineObjectsInRootNode = _require4.trackInlineObjectsInRootNode;
+const {
+  trackInlineObjectsInRootNode
+} = require(`../db/node-tracking`);
 
-const _require5 = require(`./index`),
-      store = _require5.store;
+const {
+  store
+} = require(`./index`);
 
 const fileExistsSync = require(`fs-exists-cached`).sync;
 
 const joiSchemas = require(`../joi-schemas/joi`);
 
-const _require6 = require(`../utils/js-chunk-names`),
-      generateComponentChunkName = _require6.generateComponentChunkName;
+const {
+  generateComponentChunkName
+} = require(`../utils/js-chunk-names`);
 
 const actions = {};
 
@@ -81,6 +83,7 @@ const pascalCase = _.flow(_.camelCase, _.upperFirst);
 
 const hasWarnedForPageComponentInvalidContext = new Set();
 const hasWarnedForPageComponentInvalidCasing = new Set();
+const pageComponentCache = {};
 const fileOkCache = {};
 /**
  * Create a page. See [the guide on creating and modifying pages](/docs/creating-and-modifying-pages/)
@@ -184,34 +187,44 @@ ${reservedFields.map(f => `  * "${f}"`).join(`\n`)}
       console.log(page);
       noPageOrComponent = true;
     } else if (page.component) {
-      // normalize component path
-      page.component = slash(page.component); // check if path uses correct casing - incorrect casing will
-      // cause issues in query compiler and inconsistencies when
-      // developing on Mac or Windows and trying to deploy from
-      // linux CI/CD pipeline
-
-      const trueComponentPath = slash(truePath(page.component));
-
-      if (trueComponentPath !== page.component) {
-        if (!hasWarnedForPageComponentInvalidCasing.has(page.component)) {
-          const markers = page.component.split(``).map((letter, index) => {
-            if (letter !== trueComponentPath[index]) {
-              return `^`;
-            }
-
-            return ` `;
-          }).join(``);
-          report.warn(stripIndent`
-          ${name} created a page with a component path that doesn't match the casing of the actual file. This may work locally, but will break on systems which are case-sensitive, e.g. most CI/CD pipelines.
-
-          page.component:     "${page.component}"
-          path in filesystem: "${trueComponentPath}"
-                               ${markers}
-        `);
-          hasWarnedForPageComponentInvalidCasing.add(page.component);
+      // check if we've processed this component path
+      // before, before running the expensive "truePath"
+      // operation
+      if (pageComponentCache[page.component]) {
+        page.component = pageComponentCache[page.component];
+      } else {
+        const originalPageComponent = page.component; // normalize component path
+
+        page.component = slash(page.component); // check if path uses correct casing - incorrect casing will
+        // cause issues in query compiler and inconsistencies when
+        // developing on Mac or Windows and trying to deploy from
+        // linux CI/CD pipeline
+
+        const trueComponentPath = slash(truePath(page.component));
+
+        if (trueComponentPath !== page.component) {
+          if (!hasWarnedForPageComponentInvalidCasing.has(page.component)) {
+            const markers = page.component.split(``).map((letter, index) => {
+              if (letter !== trueComponentPath[index]) {
+                return `^`;
+              }
+
+              return ` `;
+            }).join(``);
+            report.warn(stripIndent`
+            ${name} created a page with a component path that doesn't match the casing of the actual file. This may work locally, but will break on systems which are case-sensitive, e.g. most CI/CD pipelines.
+
+            page.component:     "${page.component}"
+            path in filesystem: "${trueComponentPath}"
+                                 ${markers}
+          `);
+            hasWarnedForPageComponentInvalidCasing.add(page.component);
+          }
+
+          page.component = trueComponentPath;
         }
 
-        page.component = trueComponentPath;
+        pageComponentCache[originalPageComponent] = page.component;
       }
     }
   }
@@ -300,12 +313,12 @@ ${reservedFields.map(f => `  * "${f}"`).join(`\n`)}
 
   const oldPage = store.getState().pages.get(internalPage.path);
   const contextModified = !!oldPage && !_.isEqual(oldPage.context, internalPage.context);
-  return Object.assign({}, actionOptions, {
+  return { ...actionOptions,
     type: `CREATE_PAGE`,
     contextModified,
     plugin,
     payload: internalPage
-  });
+  };
 };
 /**
  * Delete a node
@@ -317,10 +330,9 @@ ${reservedFields.map(f => `  * "${f}"`).join(`\n`)}
 
 
 actions.deleteNode = (options, plugin, args) => {
-  let node = _.get(options, `node`); // Check if using old method signature. Warn about incorrect usage but get
+  let id; // Check if using old method signature. Warn about incorrect usage but get
   // node from nodeID anyway.
 
-
   if (typeof options === `string`) {
     let msg = `Calling "deleteNode" with a nodeId is deprecated. Please pass an ` + `object containing a full node instead: deleteNode({ node }).`;
 
@@ -331,8 +343,14 @@ actions.deleteNode = (options, plugin, args) => {
     }
 
     report.warn(msg);
-    node = getNode(options);
-  }
+    id = options;
+  } else {
+    id = options && options.node && options.node.id;
+  } // Always get node from the store, as the node we get as an arg
+  // might already have been deleted.
+
+
+  const node = getNode(id);
 
   const createDeleteAction = node => {
     return {
@@ -409,9 +427,20 @@ const typeOwners = {};
  * node as the type is used in forming GraphQL types so users will query
  * for nodes based on the type choosen here. Nodes of a given type can
  * only be created by one plugin.
- * @param {string} node.internal.content An optional field. The raw content
- * of the node. Can be excluded if it'd require a lot of memory to load in
- * which case you must define a `loadNodeContent` function for this node.
+ * @param {string} node.internal.content An optional field. This is rarely
+ * used. It is used when a source plugin sources data it doesn't know how
+ * to transform e.g. a markdown string pulled from an API. The source plugin
+ * can defer the transformation to a specialized transformer plugin like
+ * gatsby-transformer-remark. This `content` field holds the raw content
+ * (so for the markdown case, the markdown string).
+ *
+ * Data that's already structured should be added to the top-level of the node
+ * object and _not_ added here. You should not `JSON.stringify` your node's
+ * data here.
+ *
+ * If the content is very large and can be lazy-loaded, e.g. a file on disk,
+ * you can define a `loadNodeContent` function for this node and the node
+ * content will be lazy loaded when it's needed.
  * @param {string} node.internal.contentDigest the digest for the content
  * of this node. Helps Gatsby avoid doing extra work on data that hasn't
  * changed.
@@ -506,7 +535,7 @@ actions.createNode = (node, plugin, actionOptions = {}) => {
     `);
   }
 
-  trackInlineObjectsInRootNode(node);
+  node = trackInlineObjectsInRootNode(node, true);
   const oldNode = getNode(node.id); // Ensure the plugin isn't creating a node type owned by another
   // plugin. Type "ownership" is first come first served.
 
@@ -549,35 +578,35 @@ actions.createNode = (node, plugin, actionOptions = {}) => {
   let updateNodeAction; // Check if the node has already been processed.
 
   if (oldNode && !hasNodeChanged(node.id, node.internal.contentDigest)) {
-    updateNodeAction = Object.assign({
+    updateNodeAction = {
       type: `TOUCH_NODE`,
-      plugin
-    }, actionOptions, {
+      plugin,
+      ...actionOptions,
       payload: node.id
-    });
+    };
   } else {
     // Remove any previously created descendant nodes as they're all due
     // to be recreated.
     if (oldNode) {
       const createDeleteAction = node => {
-        return Object.assign({
+        return {
           type: `DELETE_NODE`,
-          plugin
-        }, actionOptions, {
+          plugin,
+          ...actionOptions,
           payload: node
-        });
+        };
       };
 
       deleteActions = findChildrenRecursively(oldNode.children).map(getNode).map(createDeleteAction);
     }
 
-    updateNodeAction = Object.assign({
+    updateNodeAction = {
       type: `CREATE_NODE`,
       plugin,
-      oldNode
-    }, actionOptions, {
+      oldNode,
+      ...actionOptions,
       payload: node
-    });
+    };
   }
 
   if (deleteActions && deleteActions.length) {
@@ -696,12 +725,12 @@ actions.createNodeField = ({
 
   node.fields[name] = value;
   node.internal.fieldOwners[schemaFieldName] = plugin.name;
-  return Object.assign({
+  return {
     type: `ADD_FIELD_TO_NODE`,
-    plugin
-  }, actionOptions, {
+    plugin,
+    ...actionOptions,
     payload: node
-  });
+  };
 };
 /**
  * Creates a link between a parent and child node. This is used when you
@@ -1075,14 +1104,13 @@ const maybeAddPathPrefix = (path, pathPrefix) => {
  */
 
 
-actions.createRedirect = (_ref) => {
-  let fromPath = _ref.fromPath,
-      _ref$isPermanent = _ref.isPermanent,
-      isPermanent = _ref$isPermanent === void 0 ? false : _ref$isPermanent,
-      _ref$redirectInBrowse = _ref.redirectInBrowser,
-      redirectInBrowser = _ref$redirectInBrowse === void 0 ? false : _ref$redirectInBrowse,
-      toPath = _ref.toPath,
-      rest = (0, _objectWithoutPropertiesLoose2.default)(_ref, ["fromPath", "isPermanent", "redirectInBrowser", "toPath"]);
+actions.createRedirect = ({
+  fromPath,
+  isPermanent = false,
+  redirectInBrowser = false,
+  toPath,
+  ...rest
+}) => {
   let pathPrefix = ``;
 
   if (store.getState().program.prefixPaths) {
@@ -1091,12 +1119,13 @@ actions.createRedirect = (_ref) => {
 
   return {
     type: `CREATE_REDIRECT`,
-    payload: Object.assign({
+    payload: {
       fromPath: maybeAddPathPrefix(fromPath, pathPrefix),
       isPermanent,
       redirectInBrowser,
-      toPath: maybeAddPathPrefix(toPath, pathPrefix)
-    }, rest)
+      toPath: maybeAddPathPrefix(toPath, pathPrefix),
+      ...rest
+    }
   };
 };
 /**
@@ -1190,6 +1219,7 @@ actions.addThirdPartySchema = ({
  *       fields: {
  *         frontmatter: 'Frontmatter!'
  *       },
+ *       interfaces: ['Node'],
  *     }),
  *     schema.buildObjectType({
  *       name: 'Frontmatter',
@@ -1218,6 +1248,149 @@ actions.createTypes = (types, plugin, traceId) => {
     payload: types
   };
 };
+/**
+ *
+ * Report that a query has been extracted from a component. Used by
+ * query-compilier.js.
+ *
+ * @param {Object} $0
+ * @param {componentPath} $0.componentPath The path to the component that just had
+ * its query read.
+ * @param {query} $0.query The GraphQL query that was extracted from the component.
+ * @private
+ */
+
+
+actions.queryExtracted = ({
+  componentPath,
+  query
+}, plugin, traceId) => {
+  return {
+    type: `QUERY_EXTRACTED`,
+    plugin,
+    traceId,
+    payload: {
+      componentPath,
+      query
+    }
+  };
+};
+/**
+ *
+ * Report that the Relay Compilier found a graphql error when attempting to extract a query
+ *
+ * @param {Object} $0
+ * @param {componentPath} $0.componentPath The path to the component that just had
+ * its query read.
+ * @param {error} $0.error The GraphQL query that was extracted from the component.
+ * @private
+ */
+
+
+actions.queryExtractionGraphQLError = ({
+  componentPath,
+  error
+}, plugin, traceId) => {
+  return {
+    type: `QUERY_EXTRACTION_GRAPHQL_ERROR`,
+    plugin,
+    traceId,
+    payload: {
+      componentPath,
+      error
+    }
+  };
+};
+/**
+ *
+ * Report that babel was able to extract the graphql query.
+ * Indicates that the file is free of JS errors.
+ *
+ * @param {Object} $0
+ * @param {componentPath} $0.componentPath The path to the component that just had
+ * its query read.
+ * @private
+ */
+
+
+actions.queryExtractedBabelSuccess = ({
+  componentPath
+}, plugin, traceId) => {
+  return {
+    type: `QUERY_EXTRACTION_BABEL_SUCCESS`,
+    plugin,
+    traceId,
+    payload: {
+      componentPath
+    }
+  };
+};
+/**
+ *
+ * Report that the Relay Compilier found a babel error when attempting to extract a query
+ *
+ * @param {Object} $0
+ * @param {componentPath} $0.componentPath The path to the component that just had
+ * its query read.
+ * @param {error} $0.error The Babel error object
+ * @private
+ */
+
+
+actions.queryExtractionBabelError = ({
+  componentPath,
+  error
+}, plugin, traceId) => {
+  return {
+    type: `QUERY_EXTRACTION_BABEL_ERROR`,
+    plugin,
+    traceId,
+    payload: {
+      componentPath,
+      error
+    }
+  };
+};
+/**
+ * Set overall program status e.g. `BOOTSTRAPING` or `BOOTSTRAP_FINISHED`.
+ *
+ * @param {string} Program status
+ * @private
+ */
+
+
+actions.setProgramStatus = (status, plugin, traceId) => {
+  return {
+    type: `SET_PROGRAM_STATUS`,
+    plugin,
+    traceId,
+    payload: status
+  };
+};
+/**
+ * Broadcast that a page's query was run.
+ *
+ * @param {string} Path to the page component that changed.
+ * @private
+ */
+
+
+actions.pageQueryRun = ({
+  path,
+  componentPath,
+  isPage
+}, plugin, traceId) => {
+  return {
+    type: `PAGE_QUERY_RUN`,
+    plugin,
+    traceId,
+    payload: {
+      path,
+      componentPath,
+      isPage
+    }
+  };
+};
 /**
  * All action creators wrapped with a dispatch.
  */
diff --git a/node_modules/gatsby/dist/redux/actions.js.map b/node_modules/gatsby/dist/redux/actions.js.map
index 9628d46..c918aa8 100644
--- a/node_modules/gatsby/dist/redux/actions.js.map
+++ b/node_modules/gatsby/dist/redux/actions.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/redux/actions.js"],"names":["Joi","require","chalk","_","bindActionCreators","stripIndent","report","path","fs","truePath","url","kebabHash","slash","hasNodeChanged","getNode","trackInlineObjectsInRootNode","store","fileExistsSync","sync","joiSchemas","generateComponentChunkName","actions","findChildrenRecursively","children","concat","map","child","newChildren","isArray","length","deletePage","page","type","payload","pascalCase","flow","camelCase","upperFirst","hasWarnedForPageComponentInvalidContext","Set","hasWarnedForPageComponentInvalidCasing","fileOkCache","createPage","plugin","actionOptions","noPageOrComponent","name","message","process","env","NODE_ENV","console","log","bold","red","isObject","context","reservedFields","invalidFields","Object","keys","pick","singularMessage","pluralMessage","error","f","join","JSON","stringify","some","panic","has","component","warn","add","trueComponentPath","markers","split","letter","index","isAbsolute","jsonName","internalComponentName","internalPage","matchPath","componentChunkName","isCreatedByStatefulCreatePages","traceId","updatedAt","Date","now","includes","fileName","fileContent","readFileSync","notEmpty","includesDefaultExport","test","extname","relativePath","relative","getState","program","directory","panicOnBuild","oldPage","pages","get","contextModified","isEqual","deleteNode","options","args","node","msg","createDeleteAction","deleteAction","deleteDescendantsActions","deleteNodes","nodes","descendantNodes","flatten","n","deleteNodesAction","typeOwners","createNode","internal","array","parent","owner","result","validate","nodeSchema","fields","Error","oldNode","id","pluginName","parentSpan","setTag","deleteActions","updateNodeAction","contentDigest","touchNode","nodeId","createNodeField","value","fieldName","fieldValue","fieldOwners","schemaFieldName","fieldOwner","createParentChildLink","push","uniq","createPageDependency","connection","deleteComponentsDependencies","paths","replaceComponentQuery","query","componentPath","replaceStaticQuery","setWebpackConfig","config","replaceWebpackConfig","setBabelOptions","exit","setBabelPlugin","setBabelPreset","createJob","job","setJob","endJob","setPluginStatus","status","maybeAddPathPrefix","pathPrefix","parsed","parse","isRelativeProtocol","startsWith","protocol","createRedirect","fromPath","isPermanent","redirectInBrowser","toPath","rest","prefixPaths","addThirdPartySchema","schema","createTypes","types","exports","boundActionCreators","dispatch"],"mappings":"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","sourcesContent":["// @flow\nconst Joi = require(`joi`)\nconst chalk = require(`chalk`)\nconst _ = require(`lodash`)\nconst { bindActionCreators } = require(`redux`)\nconst { stripIndent } = require(`common-tags`)\nconst report = require(`gatsby-cli/lib/reporter`)\nconst path = require(`path`)\nconst fs = require(`fs`)\nconst truePath = require(`true-case-path`)\nconst url = require(`url`)\nconst kebabHash = require(`kebab-hash`)\nconst slash = require(`slash`)\nconst { hasNodeChanged, getNode } = require(`../db/nodes`)\nconst { trackInlineObjectsInRootNode } = require(`../db/node-tracking`)\nconst { store } = require(`./index`)\nconst fileExistsSync = require(`fs-exists-cached`).sync\nconst joiSchemas = require(`../joi-schemas/joi`)\nconst { generateComponentChunkName } = require(`../utils/js-chunk-names`)\n\nconst actions = {}\n\nconst findChildrenRecursively = (children = []) => {\n  children = children.concat(\n    ...children.map(child => {\n      const newChildren = getNode(child).children\n      if (_.isArray(newChildren) && newChildren.length > 0) {\n        return findChildrenRecursively(newChildren)\n      } else {\n        return []\n      }\n    })\n  )\n\n  return children\n}\n\ntype Job = {\n  id: string,\n}\ntype PageInput = {\n  path: string,\n  component: string,\n  context?: Object,\n}\n\ntype Page = {\n  path: string,\n  matchPath: ?string,\n  component: string,\n  context: Object,\n  internalComponentName: string,\n  jsonName: string,\n  componentChunkName: string,\n  updatedAt: number,\n}\n\ntype Plugin = {\n  name: string,\n}\n\ntype ActionOptions = {\n  traceId: ?string,\n  parentSpan: ?Object,\n  followsSpan: ?Object,\n}\n\n/**\n * Delete a page\n * @param {Object} page a page object\n * @param {string} page.path The path of the page\n * @param {string} page.component The absolute path to the page component\n * @example\n * deletePage(page)\n */\nactions.deletePage = (page: PageInput) => {\n  return {\n    type: `DELETE_PAGE`,\n    payload: page,\n  }\n}\n\nconst pascalCase = _.flow(\n  _.camelCase,\n  _.upperFirst\n)\nconst hasWarnedForPageComponentInvalidContext = new Set()\nconst hasWarnedForPageComponentInvalidCasing = new Set()\nconst fileOkCache = {}\n\n/**\n * Create a page. See [the guide on creating and modifying pages](/docs/creating-and-modifying-pages/)\n * for detailed documentation about creating pages.\n * @param {Object} page a page object\n * @param {string} page.path Any valid URL. Must start with a forward slash\n * @param {string} page.component The absolute path to the component for this page\n * @param {Object} page.context Context data for this page. Passed as props\n * to the component `this.props.pageContext` as well as to the graphql query\n * as graphql arguments.\n * @example\n * createPage({\n *   path: `/my-sweet-new-page/`,\n *   component: path.resolve(`./src/templates/my-sweet-new-page.js`),\n *   // The context is passed as props to the component as well\n *   // as into the component's GraphQL query.\n *   context: {\n *     id: `123456`,\n *   },\n * })\n */\nactions.createPage = (\n  page: PageInput,\n  plugin?: Plugin,\n  actionOptions?: ActionOptions\n) => {\n  let noPageOrComponent = false\n  let name = `The plugin \"${plugin.name}\"`\n  if (plugin.name === `default-site-plugin`) {\n    name = `Your site's \"gatsby-node.js\"`\n  }\n  if (!page.path) {\n    const message = `${name} must set the page path when creating a page`\n    // Don't log out when testing\n    if (process.env.NODE_ENV !== `test`) {\n      console.log(chalk.bold.red(message))\n      console.log(``)\n      console.log(page)\n    } else {\n      return message\n    }\n    noPageOrComponent = true\n  }\n\n  // Validate that the context object doesn't overlap with any core page fields\n  // as this will cause trouble when running graphql queries.\n  if (_.isObject(page.context)) {\n    const reservedFields = [\n      `path`,\n      `matchPath`,\n      `component`,\n      `componentChunkName`,\n      `pluginCreator___NODE`,\n      `pluginCreatorId`,\n    ]\n    const invalidFields = Object.keys(_.pick(page.context, reservedFields))\n\n    const singularMessage = `${name} used a reserved field name in the context object when creating a page:`\n    const pluralMessage = `${name} used reserved field names in the context object when creating a page:`\n    if (invalidFields.length > 0) {\n      const error = `${\n        invalidFields.length === 1 ? singularMessage : pluralMessage\n      }\n\n${invalidFields.map(f => `  * \"${f}\"`).join(`\\n`)}\n\n${JSON.stringify(page, null, 4)}\n\nData in \"context\" is passed to GraphQL as potential arguments when running the\npage query.\n\nWhen arguments for GraphQL are constructed, the context object is combined with\nthe page object so *both* page object and context data are available as\narguments. So you don't need to add the page \"path\" to the context as it's\nalready available in GraphQL. If a context field duplicates a field already\nused by the page object, this can break functionality within Gatsby so must be\navoided.\n\nPlease choose another name for the conflicting fields.\n\nThe following fields are used by the page object and should be avoided.\n\n${reservedFields.map(f => `  * \"${f}\"`).join(`\\n`)}\n\n            `\n      if (process.env.NODE_ENV === `test`) {\n        return error\n        // Only error if the context version is different than the page\n        // version.  People in v1 often thought that they needed to also pass\n        // the path to context for it to be available in GraphQL\n      } else if (invalidFields.some(f => page.context[f] !== page[f])) {\n        report.panic(error)\n      } else {\n        if (!hasWarnedForPageComponentInvalidContext.has(page.component)) {\n          report.warn(error)\n          hasWarnedForPageComponentInvalidContext.add(page.component)\n        }\n      }\n    }\n  }\n\n  // Don't check if the component exists during tests as we use a lot of fake\n  // component paths.\n  if (process.env.NODE_ENV !== `test`) {\n    if (!fileExistsSync(page.component)) {\n      const message = `${name} created a page with a component that doesn't exist. Missing component is ${\n        page.component\n      }`\n      console.log(``)\n      console.log(chalk.bold.red(message))\n      console.log(``)\n      console.log(page)\n      noPageOrComponent = true\n    } else if (page.component) {\n      // normalize component path\n      page.component = slash(page.component)\n      // check if path uses correct casing - incorrect casing will\n      // cause issues in query compiler and inconsistencies when\n      // developing on Mac or Windows and trying to deploy from\n      // linux CI/CD pipeline\n      const trueComponentPath = slash(truePath(page.component))\n      if (trueComponentPath !== page.component) {\n        if (!hasWarnedForPageComponentInvalidCasing.has(page.component)) {\n          const markers = page.component\n            .split(``)\n            .map((letter, index) => {\n              if (letter !== trueComponentPath[index]) {\n                return `^`\n              }\n              return ` `\n            })\n            .join(``)\n\n          report.warn(\n            stripIndent`\n          ${name} created a page with a component path that doesn't match the casing of the actual file. This may work locally, but will break on systems which are case-sensitive, e.g. most CI/CD pipelines.\n\n          page.component:     \"${page.component}\"\n          path in filesystem: \"${trueComponentPath}\"\n                               ${markers}\n        `\n          )\n          hasWarnedForPageComponentInvalidCasing.add(page.component)\n        }\n        page.component = trueComponentPath\n      }\n    }\n  }\n\n  if (!page.component || !path.isAbsolute(page.component)) {\n    const message = `${name} must set the absolute path to the page component when create creating a page`\n    // Don't log out when testing\n    if (process.env.NODE_ENV !== `test`) {\n      console.log(``)\n      console.log(chalk.bold.red(message))\n      console.log(``)\n      console.log(page)\n    } else {\n      return message\n    }\n    noPageOrComponent = true\n  }\n\n  if (noPageOrComponent) {\n    report.panic(\n      `See the documentation for createPage https://www.gatsbyjs.org/docs/actions/#createPage`\n    )\n  }\n\n  let jsonName\n  let internalComponentName\n  if (page.path === `/`) {\n    jsonName = `index`\n    internalComponentName = `ComponentIndex`\n  } else {\n    jsonName = `${kebabHash(page.path)}`\n    internalComponentName = `Component${pascalCase(page.path)}`\n  }\n\n  let internalPage: Page = {\n    jsonName,\n    internalComponentName,\n    path: page.path,\n    matchPath: page.matchPath,\n    component: page.component,\n    componentChunkName: generateComponentChunkName(page.component),\n    isCreatedByStatefulCreatePages:\n      actionOptions &&\n      actionOptions.traceId === `initial-createPagesStatefully`,\n    // Ensure the page has a context object\n    context: page.context || {},\n    updatedAt: Date.now(),\n  }\n\n  // If the path doesn't have an initial forward slash, add it.\n  if (internalPage.path[0] !== `/`) {\n    internalPage.path = `/${internalPage.path}`\n  }\n\n  // Validate that the page component imports React and exports something\n  // (hopefully a component).\n  //\n  // Only run validation once during builds.\n  if (\n    !internalPage.component.includes(`/.cache/`) &&\n    (process.env.NODE_ENV === `production` &&\n      !fileOkCache[internalPage.component])\n  ) {\n    const fileName = internalPage.component\n    const fileContent = fs.readFileSync(fileName, `utf-8`)\n    let notEmpty = true\n    let includesDefaultExport = true\n\n    if (fileContent === ``) {\n      notEmpty = false\n    }\n\n    if (\n      !fileContent.includes(`export default`) &&\n      !fileContent.includes(`module.exports`) &&\n      !fileContent.includes(`exports.default`) &&\n      // this check only applies to js and ts, not mdx\n      /\\.(jsx?|tsx?)/.test(path.extname(fileName))\n    ) {\n      includesDefaultExport = false\n    }\n    if (!notEmpty || !includesDefaultExport) {\n      const relativePath = path.relative(\n        store.getState().program.directory,\n        fileName\n      )\n\n      if (!notEmpty) {\n        report.panicOnBuild(\n          `You have an empty file in the \"src/pages\" directory at \"${relativePath}\". Please remove it or make it a valid component`\n        )\n      }\n\n      if (!includesDefaultExport) {\n        report.panicOnBuild(\n          `[${fileName}] The page component must export a React component for it to be valid`\n        )\n      }\n    }\n\n    fileOkCache[internalPage.component] = true\n  }\n\n  const oldPage: Page = store.getState().pages.get(internalPage.path)\n  const contextModified =\n    !!oldPage && !_.isEqual(oldPage.context, internalPage.context)\n\n  return {\n    ...actionOptions,\n    type: `CREATE_PAGE`,\n    contextModified,\n    plugin,\n    payload: internalPage,\n  }\n}\n\n/**\n * Delete a node\n * @param {object} $0\n * @param {object} $0.node the node object\n * @example\n * deleteNode({node: node})\n */\nactions.deleteNode = (options: any, plugin: Plugin, args: any) => {\n  let node = _.get(options, `node`)\n\n  // Check if using old method signature. Warn about incorrect usage but get\n  // node from nodeID anyway.\n  if (typeof options === `string`) {\n    let msg =\n      `Calling \"deleteNode\" with a nodeId is deprecated. Please pass an ` +\n      `object containing a full node instead: deleteNode({ node }).`\n    if (args && args.name) {\n      // `plugin` used to be the third argument\n      plugin = args\n      msg = msg + ` \"deleteNode\" was called by ${plugin.name}`\n    }\n    report.warn(msg)\n\n    node = getNode(options)\n  }\n\n  const createDeleteAction = node => {\n    return {\n      type: `DELETE_NODE`,\n      plugin,\n      payload: node,\n    }\n  }\n\n  const deleteAction = createDeleteAction(node)\n\n  // It's possible the file node was never created as sometimes tools will\n  // write and then immediately delete temporary files to the file system.\n  const deleteDescendantsActions =\n    node &&\n    findChildrenRecursively(node.children)\n      .map(getNode)\n      .map(createDeleteAction)\n\n  if (deleteDescendantsActions && deleteDescendantsActions.length) {\n    return [...deleteDescendantsActions, deleteAction]\n  } else {\n    return deleteAction\n  }\n}\n\n/**\n * Batch delete nodes\n * @param {Array} nodes an array of node ids\n * @example\n * deleteNodes([`node1`, `node2`])\n */\nactions.deleteNodes = (nodes: any[], plugin: Plugin) => {\n  let msg =\n    `The \"deleteNodes\" action is now deprecated and will be removed in ` +\n    `Gatsby v3. Please use \"deleteNode\" instead.`\n  if (plugin && plugin.name) {\n    msg = msg + ` \"deleteNodes\" was called by ${plugin.name}`\n  }\n  report.warn(msg)\n\n  // Also delete any nodes transformed from these.\n  const descendantNodes = _.flatten(\n    nodes.map(n => findChildrenRecursively(getNode(n).children))\n  )\n\n  const deleteNodesAction = {\n    type: `DELETE_NODES`,\n    plugin,\n    payload: [...nodes, ...descendantNodes],\n  }\n  return deleteNodesAction\n}\n\nconst typeOwners = {}\n/**\n * Create a new node.\n * @param {Object} node a node object\n * @param {string} node.id The node's ID. Must be globally unique.\n * @param {string} node.parent The ID of the parent's node. If the node is\n * derived from another node, set that node as the parent. Otherwise it can\n * just be `null`.\n * @param {Array} node.children An array of children node IDs. If you're\n * creating the children nodes while creating the parent node, add the\n * children node IDs here directly. If you're adding a child node to a\n * parent node created by a plugin, you can't mutate this value directly\n * to add your node id, instead use the action creator `createParentChildLink`.\n * @param {Object} node.internal node fields that aren't generally\n * interesting to consumers of node data but are very useful for plugin writers\n * and Gatsby core.\n * @param {string} node.internal.mediaType An optional field to indicate to\n * transformer plugins that your node has raw content they can transform.\n * Use either an official media type (we use mime-db as our source\n * (https://www.npmjs.com/package/mime-db) or a made-up one if your data\n * doesn't fit in any existing bucket. Transformer plugins use node media types\n * for deciding if they should transform a node into a new one. E.g.\n * markdown transformers look for media types of\n * `text/markdown`.\n * @param {string} node.internal.type An arbitrary globally unique type\n * choosen by the plugin creating the node. Should be descriptive of the\n * node as the type is used in forming GraphQL types so users will query\n * for nodes based on the type choosen here. Nodes of a given type can\n * only be created by one plugin.\n * @param {string} node.internal.content An optional field. The raw content\n * of the node. Can be excluded if it'd require a lot of memory to load in\n * which case you must define a `loadNodeContent` function for this node.\n * @param {string} node.internal.contentDigest the digest for the content\n * of this node. Helps Gatsby avoid doing extra work on data that hasn't\n * changed.\n * @param {string} node.internal.description An optional field. Human\n * readable description of what this node represent / its source. It will\n * be displayed when type conflicts are found, making it easier to find\n * and correct type conflicts.\n * @example\n * createNode({\n *   // Data for the node.\n *   field1: `a string`,\n *   field2: 10,\n *   field3: true,\n *   ...arbitraryOtherData,\n *\n *   // Required fields.\n *   id: `a-node-id`,\n *   parent: `the-id-of-the-parent-node`, // or null if it's a source node without a parent\n *   children: [],\n *   internal: {\n *     type: `CoolServiceMarkdownField`,\n *     contentDigest: crypto\n *       .createHash(`md5`)\n *       .update(JSON.stringify(fieldData))\n *       .digest(`hex`),\n *     mediaType: `text/markdown`, // optional\n *     content: JSON.stringify(fieldData), // optional\n *     description: `Cool Service: \"Title of entry\"`, // optional\n *   }\n * })\n */\nactions.createNode = (\n  node: any,\n  plugin?: Plugin,\n  actionOptions?: ActionOptions = {}\n) => {\n  if (!_.isObject(node)) {\n    return console.log(\n      chalk.bold.red(\n        `The node passed to the \"createNode\" action creator must be an object`\n      )\n    )\n  }\n\n  // Ensure the new node has an internals object.\n  if (!node.internal) {\n    node.internal = {}\n  }\n\n  // Ensure the new node has a children array.\n  if (!node.array && !_.isArray(node.children)) {\n    node.children = []\n  }\n\n  // Ensure the new node has a parent field\n  if (!node.parent) {\n    node.parent = null\n  }\n\n  // Tell user not to set the owner name themself.\n  if (node.internal.owner) {\n    report.error(JSON.stringify(node, null, 4))\n    report.panic(\n      chalk.bold.red(\n        `The node internal.owner field is set automatically by Gatsby and not by plugins`\n      )\n    )\n  }\n\n  // Add the plugin name to the internal object.\n  if (plugin) {\n    node.internal.owner = plugin.name\n  }\n\n  const result = Joi.validate(node, joiSchemas.nodeSchema)\n  if (result.error) {\n    console.log(chalk.bold.red(`The new node didn't pass validation`))\n    console.log(chalk.bold.red(result.error))\n    console.log(node)\n    return { type: `VALIDATION_ERROR`, error: true }\n  }\n\n  // Ensure node isn't directly setting fields.\n  if (node.fields) {\n    throw new Error(\n      stripIndent`\n      Plugins creating nodes can not set data on the reserved field \"fields\"\n      as this is reserved for plugins which wish to extend your nodes.\n\n      If your plugin didn't add \"fields\" you're probably seeing this\n      error because you're reusing an old node object.\n\n      Node:\n\n      ${JSON.stringify(node, null, 4)}\n\n      Plugin that created the node:\n\n      ${JSON.stringify(plugin, null, 4)}\n    `\n    )\n  }\n\n  trackInlineObjectsInRootNode(node)\n\n  const oldNode = getNode(node.id)\n\n  // Ensure the plugin isn't creating a node type owned by another\n  // plugin. Type \"ownership\" is first come first served.\n  if (plugin) {\n    let pluginName = plugin.name\n\n    if (!typeOwners[node.internal.type])\n      typeOwners[node.internal.type] = pluginName\n    else if (typeOwners[node.internal.type] !== pluginName)\n      throw new Error(stripIndent`\n        The plugin \"${pluginName}\" created a node of a type owned by another plugin.\n\n        The node type \"${node.internal.type}\" is owned by \"${\n        typeOwners[node.internal.type]\n      }\".\n\n        If you copy and pasted code from elsewhere, you'll need to pick a new type name\n        for your new node(s).\n\n        The node object passed to \"createNode\":\n\n        ${JSON.stringify(node, null, 4)}\n\n        The plugin creating the node:\n\n        ${JSON.stringify(plugin, null, 4)}\n      `)\n\n    // If the node has been created in the past, check that\n    // the current plugin is the same as the previous.\n    if (oldNode && oldNode.internal.owner !== pluginName) {\n      throw new Error(\n        stripIndent`\n        Nodes can only be updated by their owner. Node \"${node.id}\" is\n        owned by \"${oldNode.internal.owner}\" and another plugin \"${pluginName}\"\n        tried to update it.\n\n        `\n      )\n    }\n  }\n\n  if (actionOptions.parentSpan) {\n    actionOptions.parentSpan.setTag(`nodeId`, node.id)\n    actionOptions.parentSpan.setTag(`nodeType`, node.id)\n  }\n\n  let deleteActions\n  let updateNodeAction\n  // Check if the node has already been processed.\n  if (oldNode && !hasNodeChanged(node.id, node.internal.contentDigest)) {\n    updateNodeAction = {\n      type: `TOUCH_NODE`,\n      plugin,\n      ...actionOptions,\n      payload: node.id,\n    }\n  } else {\n    // Remove any previously created descendant nodes as they're all due\n    // to be recreated.\n    if (oldNode) {\n      const createDeleteAction = node => {\n        return {\n          type: `DELETE_NODE`,\n          plugin,\n          ...actionOptions,\n          payload: node,\n        }\n      }\n      deleteActions = findChildrenRecursively(oldNode.children)\n        .map(getNode)\n        .map(createDeleteAction)\n    }\n\n    updateNodeAction = {\n      type: `CREATE_NODE`,\n      plugin,\n      oldNode,\n      ...actionOptions,\n      payload: node,\n    }\n  }\n\n  if (deleteActions && deleteActions.length) {\n    return [...deleteActions, updateNodeAction]\n  } else {\n    return updateNodeAction\n  }\n}\n\n/**\n * \"Touch\" a node. Tells Gatsby a node still exists and shouldn't\n * be garbage collected. Primarily useful for source plugins fetching\n * nodes from a remote system that can return only nodes that have\n * updated. The source plugin then touches all the nodes that haven't\n * updated but still exist so Gatsby knows to keep them.\n * @param {Object} $0\n * @param {string} $0.nodeId The id of a node\n * @example\n * touchNode({ nodeId: `a-node-id` })\n */\nactions.touchNode = (options: any, plugin?: Plugin) => {\n  let nodeId = _.get(options, `nodeId`)\n\n  // Check if using old method signature. Warn about incorrect usage\n  if (typeof options === `string`) {\n    console.warn(\n      `Calling \"touchNode\" with a nodeId is deprecated. Please pass an object containing a nodeId instead: touchNode({ nodeId: 'a-node-id' })`\n    )\n\n    if (plugin && plugin.name) {\n      console.log(`\"touchNode\" was called by ${plugin.name}`)\n    }\n\n    nodeId = options\n  }\n\n  return {\n    type: `TOUCH_NODE`,\n    plugin,\n    payload: nodeId,\n  }\n}\n\ntype CreateNodeInput = {\n  node: Object,\n  fieldName?: string,\n  fieldValue?: string,\n  name?: string,\n  value: any,\n}\n/**\n * Extend another node. The new node field is placed under the `fields`\n * key on the extended node object.\n *\n * Once a plugin has claimed a field name the field name can't be used by\n * other plugins.  Also since nodes are immutable, you can't mutate the node\n * directly. So to extend another node, use this.\n * @param {Object} $0\n * @param {Object} $0.node the target node object\n * @param {string} $0.fieldName [deprecated] the name for the field\n * @param {string} $0.fieldValue [deprecated] the value for the field\n * @param {string} $0.name the name for the field\n * @param {string} $0.value the value for the field\n * @example\n * createNodeField({\n *   node,\n *   name: `happiness`,\n *   value: `is sweet graphql queries`\n * })\n *\n * // The field value is now accessible at node.fields.happiness\n */\nactions.createNodeField = (\n  { node, name, value, fieldName, fieldValue }: CreateNodeInput,\n  plugin: Plugin,\n  actionOptions?: ActionOptions\n) => {\n  if (fieldName) {\n    console.warn(\n      `Calling \"createNodeField\" with \"fieldName\" is deprecated. Use \"name\" instead`\n    )\n    if (!name) {\n      name = fieldName\n    }\n  }\n  if (fieldValue) {\n    console.warn(\n      `Calling \"createNodeField\" with \"fieldValue\" is deprecated. Use \"value\" instead`\n    )\n    if (!value) {\n      value = fieldValue\n    }\n  }\n  // Ensure required fields are set.\n  if (!node.internal.fieldOwners) {\n    node.internal.fieldOwners = {}\n  }\n  if (!node.fields) {\n    node.fields = {}\n  }\n\n  /**\n   * Normalized name of the field that will be used in schema\n   */\n  const schemaFieldName = _.includes(name, `___NODE`)\n    ? name.split(`___`)[0]\n    : name\n\n  // Check that this field isn't owned by another plugin.\n  const fieldOwner = node.internal.fieldOwners[schemaFieldName]\n  if (fieldOwner && fieldOwner !== plugin.name) {\n    throw new Error(\n      stripIndent`\n      A plugin tried to update a node field that it doesn't own:\n\n      Node id: ${node.id}\n      Plugin: ${plugin.name}\n      name: ${name}\n      value: ${value}\n      `\n    )\n  }\n\n  // Update node\n  node.fields[name] = value\n  node.internal.fieldOwners[schemaFieldName] = plugin.name\n\n  return {\n    type: `ADD_FIELD_TO_NODE`,\n    plugin,\n    ...actionOptions,\n    payload: node,\n  }\n}\n\n/**\n * Creates a link between a parent and child node. This is used when you\n * transform content from a node creating a new child node. You need to add\n * this new child node to the `children` array of the parent but since you\n * don't have direct access to the immutable parent node, use this action\n * instead.\n * @param {Object} $0\n * @param {Object} $0.parent the parent node object\n * @param {Object} $0.child the child node object\n * @example\n * createParentChildLink({ parent: parentNode, child: childNode })\n */\nactions.createParentChildLink = (\n  { parent, child }: { parent: any, child: any },\n  plugin?: Plugin\n) => {\n  // Update parent\n  parent.children.push(child.id)\n  parent.children = _.uniq(parent.children)\n\n  return {\n    type: `ADD_CHILD_NODE_TO_PARENT_NODE`,\n    plugin,\n    payload: parent,\n  }\n}\n\n/**\n * Create a dependency between a page and data. Probably for\n * internal use only.\n * @param {Object} $0\n * @param {string} $0.path the path to the page\n * @param {string} $0.nodeId A node ID\n * @param {string} $0.connection A connection type\n * @private\n */\nactions.createPageDependency = (\n  {\n    path,\n    nodeId,\n    connection,\n  }: { path: string, nodeId: string, connection: string },\n  plugin: string = ``\n) => {\n  return {\n    type: `CREATE_COMPONENT_DEPENDENCY`,\n    plugin,\n    payload: {\n      path,\n      nodeId,\n      connection,\n    },\n  }\n}\n\n/**\n * Delete dependencies between an array of pages and data. Probably for\n * internal use only. Used when deleting pages.\n * @param {Array} paths the paths to delete.\n * @private\n */\nactions.deleteComponentsDependencies = (paths: string[]) => {\n  return {\n    type: `DELETE_COMPONENTS_DEPENDENCIES`,\n    payload: {\n      paths,\n    },\n  }\n}\n\n/**\n * When the query watcher extracts a GraphQL query, it calls\n * this to store the query with its component.\n * @private\n */\nactions.replaceComponentQuery = ({\n  query,\n  componentPath,\n}: {\n  query: string,\n  componentPath: string,\n}) => {\n  return {\n    type: `REPLACE_COMPONENT_QUERY`,\n    payload: {\n      query,\n      componentPath,\n    },\n  }\n}\n\n/**\n * When the query watcher extracts a \"static\" GraphQL query from <StaticQuery>\n * components, it calls this to store the query with its component.\n * @private\n */\nactions.replaceStaticQuery = (args: any, plugin?: ?Plugin = null) => {\n  return {\n    type: `REPLACE_STATIC_QUERY`,\n    plugin,\n    payload: args,\n  }\n}\n\n/**\n * Merge additional configuration into the current webpack config. A few\n * configurations options will be ignored if set, in order to try prevent accidental breakage.\n * Specifically, any change to `entry`, `output`, `target`, or `resolveLoaders` will be ignored.\n *\n * For full control over the webpack config, use `replaceWebpackConfig()`.\n *\n * @param {Object} config partial webpack config, to be merged into the current one\n */\nactions.setWebpackConfig = (config: Object, plugin?: ?Plugin = null) => {\n  return {\n    type: `SET_WEBPACK_CONFIG`,\n    plugin,\n    payload: config,\n  }\n}\n\n/**\n * Completely replace the webpack config for the current stage. This can be\n * dangerous and break Gatsby if certain configuration options are changed.\n *\n * Generally only useful for cases where you need to handle config merging logic\n * yourself, in which case consider using `webpack-merge`.\n *\n * @param {Object} config complete webpack config\n */\nactions.replaceWebpackConfig = (config: Object, plugin?: ?Plugin = null) => {\n  return {\n    type: `REPLACE_WEBPACK_CONFIG`,\n    plugin,\n    payload: config,\n  }\n}\n\n/**\n * Set top-level Babel options. Plugins and presets will be ignored. Use\n * setBabelPlugin and setBabelPreset for this.\n * @param {Object} config An options object in the shape of a normal babelrc JavaScript object\n * @example\n * setBabelOptions({\n *   options: {\n *     sourceMaps: `inline`,\n *   }\n * })\n */\nactions.setBabelOptions = (options: Object, plugin?: ?Plugin = null) => {\n  // Validate\n  let name = `The plugin \"${plugin.name}\"`\n  if (plugin.name === `default-site-plugin`) {\n    name = `Your site's \"gatsby-node.js\"`\n  }\n  if (!_.isObject(options)) {\n    console.log(`${name} must pass an object to \"setBabelOptions\"`)\n    console.log(JSON.stringify(options, null, 4))\n    if (process.env.NODE_ENV !== `test`) {\n      process.exit(1)\n    }\n  }\n\n  if (!_.isObject(options.options)) {\n    console.log(`${name} must pass options to \"setBabelOptions\"`)\n    console.log(JSON.stringify(options, null, 4))\n    if (process.env.NODE_ENV !== `test`) {\n      process.exit(1)\n    }\n  }\n\n  return {\n    type: `SET_BABEL_OPTIONS`,\n    plugin,\n    payload: options,\n  }\n}\n\n/**\n * Add new plugins or merge options into existing Babel plugins.\n * @param {Object} config A config object describing the Babel plugin to be added.\n * @param {string} config.name The name of the Babel plugin\n * @param {Object} config.options Options to pass to the Babel plugin.\n * @example\n * setBabelPlugin({\n *   name:  `babel-plugin-emotion`,\n *   options: {\n *     sourceMap: true,\n *   },\n * })\n */\nactions.setBabelPlugin = (config: Object, plugin?: ?Plugin = null) => {\n  // Validate\n  let name = `The plugin \"${plugin.name}\"`\n  if (plugin.name === `default-site-plugin`) {\n    name = `Your site's \"gatsby-node.js\"`\n  }\n  if (!config.name) {\n    console.log(`${name} must set the name of the Babel plugin`)\n    console.log(JSON.stringify(config, null, 4))\n    if (process.env.NODE_ENV !== `test`) {\n      process.exit(1)\n    }\n  }\n  if (!config.options) {\n    config.options = {}\n  }\n  return {\n    type: `SET_BABEL_PLUGIN`,\n    plugin,\n    payload: config,\n  }\n}\n\n/**\n * Add new presets or merge options into existing Babel presets.\n * @param {Object} config A config object describing the Babel plugin to be added.\n * @param {string} config.name The name of the Babel preset.\n * @param {Object} config.options Options to pass to the Babel preset.\n * @example\n * setBabelPreset({\n *   name: `@babel/preset-react`,\n *   options: {\n *     pragma: `Glamor.createElement`,\n *   },\n * })\n */\nactions.setBabelPreset = (config: Object, plugin?: ?Plugin = null) => {\n  // Validate\n  let name = `The plugin \"${plugin.name}\"`\n  if (plugin.name === `default-site-plugin`) {\n    name = `Your site's \"gatsby-node.js\"`\n  }\n  if (!config.name) {\n    console.log(`${name} must set the name of the Babel preset`)\n    console.log(JSON.stringify(config, null, 4))\n    if (process.env.NODE_ENV !== `test`) {\n      process.exit(1)\n    }\n  }\n  if (!config.options) {\n    config.options = {}\n  }\n  return {\n    type: `SET_BABEL_PRESET`,\n    plugin,\n    payload: config,\n  }\n}\n\n/**\n * Create a \"job\". This is a long-running process that are generally\n * started as side-effects to GraphQL queries.\n * [`gatsby-plugin-sharp`](/packages/gatsby-plugin-sharp/) uses this for\n * example.\n *\n * Gatsby doesn't finish its bootstrap until all jobs are ended.\n * @param {Object} job A job object with at least an id set\n * @param {id} job.id The id of the job\n * @example\n * createJob({ id: `write file id: 123`, fileName: `something.jpeg` })\n */\nactions.createJob = (job: Job, plugin?: ?Plugin = null) => {\n  return {\n    type: `CREATE_JOB`,\n    plugin,\n    payload: job,\n  }\n}\n\n/**\n * Set (update) a \"job\". Sometimes on really long running jobs you want\n * to update the job as it continues.\n *\n * @param {Object} job A job object with at least an id set\n * @param {id} job.id The id of the job\n * @example\n * setJob({ id: `write file id: 123`, progress: 50 })\n */\nactions.setJob = (job: Job, plugin?: ?Plugin = null) => {\n  return {\n    type: `SET_JOB`,\n    plugin,\n    payload: job,\n  }\n}\n\n/**\n * End a \"job\".\n *\n * Gatsby doesn't finish its bootstrap until all jobs are ended.\n * @param {Object} job  A job object with at least an id set\n * @param {id} job.id The id of the job\n * @example\n * endJob({ id: `write file id: 123` })\n */\nactions.endJob = (job: Job, plugin?: ?Plugin = null) => {\n  return {\n    type: `END_JOB`,\n    plugin,\n    payload: job,\n  }\n}\n\n/**\n * Set plugin status. A plugin can use this to save status keys e.g. the last\n * it fetched something. These values are persisted between runs of Gatsby.\n *\n * @param {Object} status  An object with arbitrary values set\n * @example\n * setPluginStatus({ lastFetched: Date.now() })\n */\nactions.setPluginStatus = (\n  status: { [key: string]: mixed },\n  plugin: Plugin\n) => {\n  return {\n    type: `SET_PLUGIN_STATUS`,\n    plugin,\n    payload: status,\n  }\n}\n\n/**\n * Check if path is absolute and add pathPrefix in front if it's not\n */\nconst maybeAddPathPrefix = (path, pathPrefix) => {\n  const parsed = url.parse(path)\n  const isRelativeProtocol = path.startsWith(`//`)\n  return `${\n    parsed.protocol != null || isRelativeProtocol ? `` : pathPrefix\n  }${path}`\n}\n\n/**\n * Create a redirect from one page to another. Server redirects don't work out\n * of the box. You must have a plugin setup to integrate the redirect data with\n * your hosting technology e.g. the [Netlify\n * plugin](/packages/gatsby-plugin-netlify/), or the [Amazon S3\n * plugin](/packages/gatsby-plugin-s3/).\n *\n * @param {Object} redirect Redirect data\n * @param {string} redirect.fromPath Any valid URL. Must start with a forward slash\n * @param {boolean} redirect.isPermanent This is a permanent redirect; defaults to temporary\n * @param {string} redirect.toPath URL of a created page (see `createPage`)\n * @param {boolean} redirect.redirectInBrowser Redirects are generally for redirecting legacy URLs to their new configuration. If you can't update your UI for some reason, set `redirectInBrowser` to true and Gatsby will handle redirecting in the client as well.\n * @param {boolean} redirect.force (Plugin-specific) Will trigger the redirect even if the `fromPath` matches a piece of content. This is not part of the Gatsby API, but implemented by (some) plugins that configure hosting provider redirects\n * @param {number} redirect.statusCode (Plugin-specific) Manually set the HTTP status code. This allows you to create a rewrite (status code 200) or custom error page (status code 404). Note that this will override the `isPermanent` option which also sets the status code. This is not part of the Gatsby API, but implemented by (some) plugins that configure hosting provider redirects\n * @example\n * createRedirect({ fromPath: '/old-url', toPath: '/new-url', isPermanent: true })\n * createRedirect({ fromPath: '/url', toPath: '/zn-CH/url', Language: 'zn' })\n * createRedirect({ fromPath: '/not_so-pretty_url', toPath: '/pretty/url', statusCode: 200 })\n */\nactions.createRedirect = ({\n  fromPath,\n  isPermanent = false,\n  redirectInBrowser = false,\n  toPath,\n  ...rest\n}) => {\n  let pathPrefix = ``\n  if (store.getState().program.prefixPaths) {\n    pathPrefix = store.getState().config.pathPrefix\n  }\n\n  return {\n    type: `CREATE_REDIRECT`,\n    payload: {\n      fromPath: maybeAddPathPrefix(fromPath, pathPrefix),\n      isPermanent,\n      redirectInBrowser,\n      toPath: maybeAddPathPrefix(toPath, pathPrefix),\n      ...rest,\n    },\n  }\n}\n\n/**\n * Add a third-party schema to be merged into main schema. Schema has to be a\n * graphql-js GraphQLSchema object.\n *\n * This schema is going to be merged as-is. This can easily break the main\n * Gatsby schema, so it's user's responsibility to make sure it doesn't happen\n * (by eg namespacing the schema).\n *\n * @param {Object} $0\n * @param {GraphQLSchema} $0.schema GraphQL schema to add\n */\nactions.addThirdPartySchema = (\n  { schema }: { schema: GraphQLSchema },\n  plugin: Plugin,\n  traceId?: string\n) => {\n  return {\n    type: `ADD_THIRD_PARTY_SCHEMA`,\n    plugin,\n    traceId,\n    payload: schema,\n  }\n}\n\nimport type GatsbyGraphQLType from \"../schema/types/type-builders\"\n/**\n * Add type definitions to the GraphQL schema.\n *\n * @param {string | GraphQLOutputType | GatsbyGraphQLType | string[] | GraphQLOutputType[] | GatsbyGraphQLType[]} types Type definitions\n *\n * Type definitions can be provided either as\n * [`graphql-js` types](https://graphql.org/graphql-js/), in\n * [GraphQL schema definition language (SDL)](https://graphql.org/learn/)\n * or using Gatsby Type Builders available on the `schema` API argument.\n *\n * Things to note:\n * * needs to be called *before* schema generation. It is recommended to use\n *   `createTypes` in the `sourceNodes` API.\n * * type definitions targeting node types, i.e. `MarkdownRemark` and others\n *   added in `sourceNodes` or `onCreateNode` APIs, need to implement the\n *   `Node` interface. Interface fields will be added automatically, but it\n *   is mandatory to label those types with `implements Node`.\n * * by default, explicit type definitions from `createTypes` will be merged\n *   with inferred field types, and default field resolvers for `Date` (which\n *   adds formatting options) and `File` (which resolves the field value as\n *   a `relativePath` foreign-key field) are added. This behavior can be\n *   customised with `@infer` and `@dontInfer` directives, and their\n *   `noDefaultResolvers` argument.\n *\n * @example\n * exports.sourceNodes = ({ actions }) => {\n *   const { createTypes } = actions\n *   const typeDefs = `\n *     \"\"\"\n *     Markdown Node\n *     \"\"\"\n *     type MarkdownRemark implements Node {\n *       frontmatter: Frontmatter!\n *     }\n *\n *     \"\"\"\n *     Markdown Frontmatter\n *     \"\"\"\n *     type Frontmatter {\n *       title: String!\n *       author: AuthorJson!\n *       date: Date!\n *       published: Boolean!\n *       tags: [String!]!\n *     }\n *\n *     \"\"\"\n *     Author information\n *     \"\"\"\n *     # Does not include automatically inferred fields\n *     type AuthorJson implements Node @dontInfer(noFieldResolvers: true) {\n *       name: String!\n *       birthday: Date! # no default resolvers for Date formatting added\n *     }\n *   `\n *   createTypes(typeDefs)\n * }\n *\n * // using Gatsby Type Builder API\n * exports.sourceNodes = ({ actions, schema }) => {\n *   const { createTypes } = actions\n *   const typeDefs = [\n *     schema.buildObjectType({\n *       name: 'MarkdownRemark',\n *       fields: {\n *         frontmatter: 'Frontmatter!'\n *       },\n *     }),\n *     schema.buildObjectType({\n *       name: 'Frontmatter',\n *       fields: {\n *         title: {\n *           type: 'String!',\n *           resolve(parent) {\n *             return parent.title || '(Untitled)'\n *           }\n *         },\n *         author: 'AuthorJson!',\n *         date: 'Date!',\n *         published: 'Boolean!',\n *         tags: '[String!]!',\n *       }\n *     })\n *   ]\n *   createTypes(typeDefs)\n * }\n */\nactions.createTypes = (\n  types:\n    | string\n    | GraphQLOutputType\n    | GatsbyGraphQLType\n    | Array<string | GraphQLOutputType | GatsbyGraphQLType>,\n  plugin: Plugin,\n  traceId?: string\n) => {\n  return {\n    type: `CREATE_TYPES`,\n    plugin,\n    traceId,\n    payload: types,\n  }\n}\n\n/**\n * All action creators wrapped with a dispatch.\n */\nexports.actions = actions\n\n/**\n * All action creators wrapped with a dispatch. - *DEPRECATED*\n */\nexports.boundActionCreators = bindActionCreators(actions, store.dispatch)\n"],"file":"actions.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/redux/actions.js"],"names":["Joi","require","chalk","_","bindActionCreators","stripIndent","report","path","fs","truePath","url","kebabHash","slash","hasNodeChanged","getNode","trackInlineObjectsInRootNode","store","fileExistsSync","sync","joiSchemas","generateComponentChunkName","actions","findChildrenRecursively","children","concat","map","child","newChildren","isArray","length","deletePage","page","type","payload","pascalCase","flow","camelCase","upperFirst","hasWarnedForPageComponentInvalidContext","Set","hasWarnedForPageComponentInvalidCasing","pageComponentCache","fileOkCache","createPage","plugin","actionOptions","noPageOrComponent","name","message","process","env","NODE_ENV","console","log","bold","red","isObject","context","reservedFields","invalidFields","Object","keys","pick","singularMessage","pluralMessage","error","f","join","JSON","stringify","some","panic","has","component","warn","add","originalPageComponent","trueComponentPath","markers","split","letter","index","isAbsolute","jsonName","internalComponentName","internalPage","matchPath","componentChunkName","isCreatedByStatefulCreatePages","traceId","updatedAt","Date","now","includes","fileName","fileContent","readFileSync","notEmpty","includesDefaultExport","test","extname","relativePath","relative","getState","program","directory","panicOnBuild","oldPage","pages","get","contextModified","isEqual","deleteNode","options","args","id","msg","node","createDeleteAction","deleteAction","deleteDescendantsActions","deleteNodes","nodes","descendantNodes","flatten","n","deleteNodesAction","typeOwners","createNode","internal","array","parent","owner","result","validate","nodeSchema","fields","Error","oldNode","pluginName","parentSpan","setTag","deleteActions","updateNodeAction","contentDigest","touchNode","nodeId","createNodeField","value","fieldName","fieldValue","fieldOwners","schemaFieldName","fieldOwner","createParentChildLink","push","uniq","createPageDependency","connection","deleteComponentsDependencies","paths","replaceComponentQuery","query","componentPath","replaceStaticQuery","setWebpackConfig","config","replaceWebpackConfig","setBabelOptions","exit","setBabelPlugin","setBabelPreset","createJob","job","setJob","endJob","setPluginStatus","status","maybeAddPathPrefix","pathPrefix","parsed","parse","isRelativeProtocol","startsWith","protocol","createRedirect","fromPath","isPermanent","redirectInBrowser","toPath","rest","prefixPaths","addThirdPartySchema","schema","createTypes","types","queryExtracted","queryExtractionGraphQLError","queryExtractedBabelSuccess","queryExtractionBabelError","setProgramStatus","pageQueryRun","isPage","exports","boundActionCreators","dispatch"],"mappings":"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","sourcesContent":["// @flow\nconst Joi = require(`joi`)\nconst chalk = require(`chalk`)\nconst _ = require(`lodash`)\nconst { bindActionCreators } = require(`redux`)\nconst { stripIndent } = require(`common-tags`)\nconst report = require(`gatsby-cli/lib/reporter`)\nconst path = require(`path`)\nconst fs = require(`fs`)\nconst truePath = require(`true-case-path`)\nconst url = require(`url`)\nconst kebabHash = require(`kebab-hash`)\nconst slash = require(`slash`)\nconst { hasNodeChanged, getNode } = require(`../db/nodes`)\nconst { trackInlineObjectsInRootNode } = require(`../db/node-tracking`)\nconst { store } = require(`./index`)\nconst fileExistsSync = require(`fs-exists-cached`).sync\nconst joiSchemas = require(`../joi-schemas/joi`)\nconst { generateComponentChunkName } = require(`../utils/js-chunk-names`)\n\nconst actions = {}\n\nconst findChildrenRecursively = (children = []) => {\n  children = children.concat(\n    ...children.map(child => {\n      const newChildren = getNode(child).children\n      if (_.isArray(newChildren) && newChildren.length > 0) {\n        return findChildrenRecursively(newChildren)\n      } else {\n        return []\n      }\n    })\n  )\n\n  return children\n}\n\ntype Job = {\n  id: string,\n}\ntype PageInput = {\n  path: string,\n  component: string,\n  context?: Object,\n}\n\ntype Page = {\n  path: string,\n  matchPath: ?string,\n  component: string,\n  context: Object,\n  internalComponentName: string,\n  jsonName: string,\n  componentChunkName: string,\n  updatedAt: number,\n}\n\ntype Plugin = {\n  name: string,\n}\n\ntype ActionOptions = {\n  traceId: ?string,\n  parentSpan: ?Object,\n  followsSpan: ?Object,\n}\n\n/**\n * Delete a page\n * @param {Object} page a page object\n * @param {string} page.path The path of the page\n * @param {string} page.component The absolute path to the page component\n * @example\n * deletePage(page)\n */\nactions.deletePage = (page: PageInput) => {\n  return {\n    type: `DELETE_PAGE`,\n    payload: page,\n  }\n}\n\nconst pascalCase = _.flow(\n  _.camelCase,\n  _.upperFirst\n)\nconst hasWarnedForPageComponentInvalidContext = new Set()\nconst hasWarnedForPageComponentInvalidCasing = new Set()\nconst pageComponentCache = {}\nconst fileOkCache = {}\n\n/**\n * Create a page. See [the guide on creating and modifying pages](/docs/creating-and-modifying-pages/)\n * for detailed documentation about creating pages.\n * @param {Object} page a page object\n * @param {string} page.path Any valid URL. Must start with a forward slash\n * @param {string} page.component The absolute path to the component for this page\n * @param {Object} page.context Context data for this page. Passed as props\n * to the component `this.props.pageContext` as well as to the graphql query\n * as graphql arguments.\n * @example\n * createPage({\n *   path: `/my-sweet-new-page/`,\n *   component: path.resolve(`./src/templates/my-sweet-new-page.js`),\n *   // The context is passed as props to the component as well\n *   // as into the component's GraphQL query.\n *   context: {\n *     id: `123456`,\n *   },\n * })\n */\nactions.createPage = (\n  page: PageInput,\n  plugin?: Plugin,\n  actionOptions?: ActionOptions\n) => {\n  let noPageOrComponent = false\n  let name = `The plugin \"${plugin.name}\"`\n  if (plugin.name === `default-site-plugin`) {\n    name = `Your site's \"gatsby-node.js\"`\n  }\n  if (!page.path) {\n    const message = `${name} must set the page path when creating a page`\n    // Don't log out when testing\n    if (process.env.NODE_ENV !== `test`) {\n      console.log(chalk.bold.red(message))\n      console.log(``)\n      console.log(page)\n    } else {\n      return message\n    }\n    noPageOrComponent = true\n  }\n\n  // Validate that the context object doesn't overlap with any core page fields\n  // as this will cause trouble when running graphql queries.\n  if (_.isObject(page.context)) {\n    const reservedFields = [\n      `path`,\n      `matchPath`,\n      `component`,\n      `componentChunkName`,\n      `pluginCreator___NODE`,\n      `pluginCreatorId`,\n    ]\n    const invalidFields = Object.keys(_.pick(page.context, reservedFields))\n\n    const singularMessage = `${name} used a reserved field name in the context object when creating a page:`\n    const pluralMessage = `${name} used reserved field names in the context object when creating a page:`\n    if (invalidFields.length > 0) {\n      const error = `${\n        invalidFields.length === 1 ? singularMessage : pluralMessage\n      }\n\n${invalidFields.map(f => `  * \"${f}\"`).join(`\\n`)}\n\n${JSON.stringify(page, null, 4)}\n\nData in \"context\" is passed to GraphQL as potential arguments when running the\npage query.\n\nWhen arguments for GraphQL are constructed, the context object is combined with\nthe page object so *both* page object and context data are available as\narguments. So you don't need to add the page \"path\" to the context as it's\nalready available in GraphQL. If a context field duplicates a field already\nused by the page object, this can break functionality within Gatsby so must be\navoided.\n\nPlease choose another name for the conflicting fields.\n\nThe following fields are used by the page object and should be avoided.\n\n${reservedFields.map(f => `  * \"${f}\"`).join(`\\n`)}\n\n            `\n      if (process.env.NODE_ENV === `test`) {\n        return error\n        // Only error if the context version is different than the page\n        // version.  People in v1 often thought that they needed to also pass\n        // the path to context for it to be available in GraphQL\n      } else if (invalidFields.some(f => page.context[f] !== page[f])) {\n        report.panic(error)\n      } else {\n        if (!hasWarnedForPageComponentInvalidContext.has(page.component)) {\n          report.warn(error)\n          hasWarnedForPageComponentInvalidContext.add(page.component)\n        }\n      }\n    }\n  }\n\n  // Don't check if the component exists during tests as we use a lot of fake\n  // component paths.\n  if (process.env.NODE_ENV !== `test`) {\n    if (!fileExistsSync(page.component)) {\n      const message = `${name} created a page with a component that doesn't exist. Missing component is ${\n        page.component\n      }`\n      console.log(``)\n      console.log(chalk.bold.red(message))\n      console.log(``)\n      console.log(page)\n      noPageOrComponent = true\n    } else if (page.component) {\n      // check if we've processed this component path\n      // before, before running the expensive \"truePath\"\n      // operation\n      if (pageComponentCache[page.component]) {\n        page.component = pageComponentCache[page.component]\n      } else {\n        const originalPageComponent = page.component\n\n        // normalize component path\n        page.component = slash(page.component)\n        // check if path uses correct casing - incorrect casing will\n        // cause issues in query compiler and inconsistencies when\n        // developing on Mac or Windows and trying to deploy from\n        // linux CI/CD pipeline\n        const trueComponentPath = slash(truePath(page.component))\n        if (trueComponentPath !== page.component) {\n          if (!hasWarnedForPageComponentInvalidCasing.has(page.component)) {\n            const markers = page.component\n              .split(``)\n              .map((letter, index) => {\n                if (letter !== trueComponentPath[index]) {\n                  return `^`\n                }\n                return ` `\n              })\n              .join(``)\n\n            report.warn(\n              stripIndent`\n            ${name} created a page with a component path that doesn't match the casing of the actual file. This may work locally, but will break on systems which are case-sensitive, e.g. most CI/CD pipelines.\n\n            page.component:     \"${page.component}\"\n            path in filesystem: \"${trueComponentPath}\"\n                                 ${markers}\n          `\n            )\n            hasWarnedForPageComponentInvalidCasing.add(page.component)\n          }\n\n          page.component = trueComponentPath\n        }\n        pageComponentCache[originalPageComponent] = page.component\n      }\n    }\n  }\n\n  if (!page.component || !path.isAbsolute(page.component)) {\n    const message = `${name} must set the absolute path to the page component when create creating a page`\n    // Don't log out when testing\n    if (process.env.NODE_ENV !== `test`) {\n      console.log(``)\n      console.log(chalk.bold.red(message))\n      console.log(``)\n      console.log(page)\n    } else {\n      return message\n    }\n    noPageOrComponent = true\n  }\n\n  if (noPageOrComponent) {\n    report.panic(\n      `See the documentation for createPage https://www.gatsbyjs.org/docs/actions/#createPage`\n    )\n  }\n\n  let jsonName\n  let internalComponentName\n  if (page.path === `/`) {\n    jsonName = `index`\n    internalComponentName = `ComponentIndex`\n  } else {\n    jsonName = `${kebabHash(page.path)}`\n    internalComponentName = `Component${pascalCase(page.path)}`\n  }\n\n  let internalPage: Page = {\n    jsonName,\n    internalComponentName,\n    path: page.path,\n    matchPath: page.matchPath,\n    component: page.component,\n    componentChunkName: generateComponentChunkName(page.component),\n    isCreatedByStatefulCreatePages:\n      actionOptions &&\n      actionOptions.traceId === `initial-createPagesStatefully`,\n    // Ensure the page has a context object\n    context: page.context || {},\n    updatedAt: Date.now(),\n  }\n\n  // If the path doesn't have an initial forward slash, add it.\n  if (internalPage.path[0] !== `/`) {\n    internalPage.path = `/${internalPage.path}`\n  }\n\n  // Validate that the page component imports React and exports something\n  // (hopefully a component).\n  //\n  // Only run validation once during builds.\n  if (\n    !internalPage.component.includes(`/.cache/`) &&\n    (process.env.NODE_ENV === `production` &&\n      !fileOkCache[internalPage.component])\n  ) {\n    const fileName = internalPage.component\n    const fileContent = fs.readFileSync(fileName, `utf-8`)\n    let notEmpty = true\n    let includesDefaultExport = true\n\n    if (fileContent === ``) {\n      notEmpty = false\n    }\n\n    if (\n      !fileContent.includes(`export default`) &&\n      !fileContent.includes(`module.exports`) &&\n      !fileContent.includes(`exports.default`) &&\n      // this check only applies to js and ts, not mdx\n      /\\.(jsx?|tsx?)/.test(path.extname(fileName))\n    ) {\n      includesDefaultExport = false\n    }\n    if (!notEmpty || !includesDefaultExport) {\n      const relativePath = path.relative(\n        store.getState().program.directory,\n        fileName\n      )\n\n      if (!notEmpty) {\n        report.panicOnBuild(\n          `You have an empty file in the \"src/pages\" directory at \"${relativePath}\". Please remove it or make it a valid component`\n        )\n      }\n\n      if (!includesDefaultExport) {\n        report.panicOnBuild(\n          `[${fileName}] The page component must export a React component for it to be valid`\n        )\n      }\n    }\n\n    fileOkCache[internalPage.component] = true\n  }\n\n  const oldPage: Page = store.getState().pages.get(internalPage.path)\n  const contextModified =\n    !!oldPage && !_.isEqual(oldPage.context, internalPage.context)\n\n  return {\n    ...actionOptions,\n    type: `CREATE_PAGE`,\n    contextModified,\n    plugin,\n    payload: internalPage,\n  }\n}\n\n/**\n * Delete a node\n * @param {object} $0\n * @param {object} $0.node the node object\n * @example\n * deleteNode({node: node})\n */\nactions.deleteNode = (options: any, plugin: Plugin, args: any) => {\n  let id\n\n  // Check if using old method signature. Warn about incorrect usage but get\n  // node from nodeID anyway.\n  if (typeof options === `string`) {\n    let msg =\n      `Calling \"deleteNode\" with a nodeId is deprecated. Please pass an ` +\n      `object containing a full node instead: deleteNode({ node }).`\n    if (args && args.name) {\n      // `plugin` used to be the third argument\n      plugin = args\n      msg = msg + ` \"deleteNode\" was called by ${plugin.name}`\n    }\n    report.warn(msg)\n\n    id = options\n  } else {\n    id = options && options.node && options.node.id\n  }\n\n  // Always get node from the store, as the node we get as an arg\n  // might already have been deleted.\n  const node = getNode(id)\n\n  const createDeleteAction = node => {\n    return {\n      type: `DELETE_NODE`,\n      plugin,\n      payload: node,\n    }\n  }\n\n  const deleteAction = createDeleteAction(node)\n\n  // It's possible the file node was never created as sometimes tools will\n  // write and then immediately delete temporary files to the file system.\n  const deleteDescendantsActions =\n    node &&\n    findChildrenRecursively(node.children)\n      .map(getNode)\n      .map(createDeleteAction)\n\n  if (deleteDescendantsActions && deleteDescendantsActions.length) {\n    return [...deleteDescendantsActions, deleteAction]\n  } else {\n    return deleteAction\n  }\n}\n\n/**\n * Batch delete nodes\n * @param {Array} nodes an array of node ids\n * @example\n * deleteNodes([`node1`, `node2`])\n */\nactions.deleteNodes = (nodes: any[], plugin: Plugin) => {\n  let msg =\n    `The \"deleteNodes\" action is now deprecated and will be removed in ` +\n    `Gatsby v3. Please use \"deleteNode\" instead.`\n  if (plugin && plugin.name) {\n    msg = msg + ` \"deleteNodes\" was called by ${plugin.name}`\n  }\n  report.warn(msg)\n\n  // Also delete any nodes transformed from these.\n  const descendantNodes = _.flatten(\n    nodes.map(n => findChildrenRecursively(getNode(n).children))\n  )\n\n  const deleteNodesAction = {\n    type: `DELETE_NODES`,\n    plugin,\n    payload: [...nodes, ...descendantNodes],\n  }\n  return deleteNodesAction\n}\n\nconst typeOwners = {}\n/**\n * Create a new node.\n * @param {Object} node a node object\n * @param {string} node.id The node's ID. Must be globally unique.\n * @param {string} node.parent The ID of the parent's node. If the node is\n * derived from another node, set that node as the parent. Otherwise it can\n * just be `null`.\n * @param {Array} node.children An array of children node IDs. If you're\n * creating the children nodes while creating the parent node, add the\n * children node IDs here directly. If you're adding a child node to a\n * parent node created by a plugin, you can't mutate this value directly\n * to add your node id, instead use the action creator `createParentChildLink`.\n * @param {Object} node.internal node fields that aren't generally\n * interesting to consumers of node data but are very useful for plugin writers\n * and Gatsby core.\n * @param {string} node.internal.mediaType An optional field to indicate to\n * transformer plugins that your node has raw content they can transform.\n * Use either an official media type (we use mime-db as our source\n * (https://www.npmjs.com/package/mime-db) or a made-up one if your data\n * doesn't fit in any existing bucket. Transformer plugins use node media types\n * for deciding if they should transform a node into a new one. E.g.\n * markdown transformers look for media types of\n * `text/markdown`.\n * @param {string} node.internal.type An arbitrary globally unique type\n * choosen by the plugin creating the node. Should be descriptive of the\n * node as the type is used in forming GraphQL types so users will query\n * for nodes based on the type choosen here. Nodes of a given type can\n * only be created by one plugin.\n * @param {string} node.internal.content An optional field. This is rarely\n * used. It is used when a source plugin sources data it doesn't know how\n * to transform e.g. a markdown string pulled from an API. The source plugin\n * can defer the transformation to a specialized transformer plugin like\n * gatsby-transformer-remark. This `content` field holds the raw content\n * (so for the markdown case, the markdown string).\n *\n * Data that's already structured should be added to the top-level of the node\n * object and _not_ added here. You should not `JSON.stringify` your node's\n * data here.\n *\n * If the content is very large and can be lazy-loaded, e.g. a file on disk,\n * you can define a `loadNodeContent` function for this node and the node\n * content will be lazy loaded when it's needed.\n * @param {string} node.internal.contentDigest the digest for the content\n * of this node. Helps Gatsby avoid doing extra work on data that hasn't\n * changed.\n * @param {string} node.internal.description An optional field. Human\n * readable description of what this node represent / its source. It will\n * be displayed when type conflicts are found, making it easier to find\n * and correct type conflicts.\n * @example\n * createNode({\n *   // Data for the node.\n *   field1: `a string`,\n *   field2: 10,\n *   field3: true,\n *   ...arbitraryOtherData,\n *\n *   // Required fields.\n *   id: `a-node-id`,\n *   parent: `the-id-of-the-parent-node`, // or null if it's a source node without a parent\n *   children: [],\n *   internal: {\n *     type: `CoolServiceMarkdownField`,\n *     contentDigest: crypto\n *       .createHash(`md5`)\n *       .update(JSON.stringify(fieldData))\n *       .digest(`hex`),\n *     mediaType: `text/markdown`, // optional\n *     content: JSON.stringify(fieldData), // optional\n *     description: `Cool Service: \"Title of entry\"`, // optional\n *   }\n * })\n */\nactions.createNode = (\n  node: any,\n  plugin?: Plugin,\n  actionOptions?: ActionOptions = {}\n) => {\n  if (!_.isObject(node)) {\n    return console.log(\n      chalk.bold.red(\n        `The node passed to the \"createNode\" action creator must be an object`\n      )\n    )\n  }\n\n  // Ensure the new node has an internals object.\n  if (!node.internal) {\n    node.internal = {}\n  }\n\n  // Ensure the new node has a children array.\n  if (!node.array && !_.isArray(node.children)) {\n    node.children = []\n  }\n\n  // Ensure the new node has a parent field\n  if (!node.parent) {\n    node.parent = null\n  }\n\n  // Tell user not to set the owner name themself.\n  if (node.internal.owner) {\n    report.error(JSON.stringify(node, null, 4))\n    report.panic(\n      chalk.bold.red(\n        `The node internal.owner field is set automatically by Gatsby and not by plugins`\n      )\n    )\n  }\n\n  // Add the plugin name to the internal object.\n  if (plugin) {\n    node.internal.owner = plugin.name\n  }\n\n  const result = Joi.validate(node, joiSchemas.nodeSchema)\n  if (result.error) {\n    console.log(chalk.bold.red(`The new node didn't pass validation`))\n    console.log(chalk.bold.red(result.error))\n    console.log(node)\n    return { type: `VALIDATION_ERROR`, error: true }\n  }\n\n  // Ensure node isn't directly setting fields.\n  if (node.fields) {\n    throw new Error(\n      stripIndent`\n      Plugins creating nodes can not set data on the reserved field \"fields\"\n      as this is reserved for plugins which wish to extend your nodes.\n\n      If your plugin didn't add \"fields\" you're probably seeing this\n      error because you're reusing an old node object.\n\n      Node:\n\n      ${JSON.stringify(node, null, 4)}\n\n      Plugin that created the node:\n\n      ${JSON.stringify(plugin, null, 4)}\n    `\n    )\n  }\n\n  node = trackInlineObjectsInRootNode(node, true)\n\n  const oldNode = getNode(node.id)\n\n  // Ensure the plugin isn't creating a node type owned by another\n  // plugin. Type \"ownership\" is first come first served.\n  if (plugin) {\n    let pluginName = plugin.name\n\n    if (!typeOwners[node.internal.type])\n      typeOwners[node.internal.type] = pluginName\n    else if (typeOwners[node.internal.type] !== pluginName)\n      throw new Error(stripIndent`\n        The plugin \"${pluginName}\" created a node of a type owned by another plugin.\n\n        The node type \"${node.internal.type}\" is owned by \"${\n        typeOwners[node.internal.type]\n      }\".\n\n        If you copy and pasted code from elsewhere, you'll need to pick a new type name\n        for your new node(s).\n\n        The node object passed to \"createNode\":\n\n        ${JSON.stringify(node, null, 4)}\n\n        The plugin creating the node:\n\n        ${JSON.stringify(plugin, null, 4)}\n      `)\n\n    // If the node has been created in the past, check that\n    // the current plugin is the same as the previous.\n    if (oldNode && oldNode.internal.owner !== pluginName) {\n      throw new Error(\n        stripIndent`\n        Nodes can only be updated by their owner. Node \"${node.id}\" is\n        owned by \"${oldNode.internal.owner}\" and another plugin \"${pluginName}\"\n        tried to update it.\n\n        `\n      )\n    }\n  }\n\n  if (actionOptions.parentSpan) {\n    actionOptions.parentSpan.setTag(`nodeId`, node.id)\n    actionOptions.parentSpan.setTag(`nodeType`, node.id)\n  }\n\n  let deleteActions\n  let updateNodeAction\n  // Check if the node has already been processed.\n  if (oldNode && !hasNodeChanged(node.id, node.internal.contentDigest)) {\n    updateNodeAction = {\n      type: `TOUCH_NODE`,\n      plugin,\n      ...actionOptions,\n      payload: node.id,\n    }\n  } else {\n    // Remove any previously created descendant nodes as they're all due\n    // to be recreated.\n    if (oldNode) {\n      const createDeleteAction = node => {\n        return {\n          type: `DELETE_NODE`,\n          plugin,\n          ...actionOptions,\n          payload: node,\n        }\n      }\n      deleteActions = findChildrenRecursively(oldNode.children)\n        .map(getNode)\n        .map(createDeleteAction)\n    }\n\n    updateNodeAction = {\n      type: `CREATE_NODE`,\n      plugin,\n      oldNode,\n      ...actionOptions,\n      payload: node,\n    }\n  }\n\n  if (deleteActions && deleteActions.length) {\n    return [...deleteActions, updateNodeAction]\n  } else {\n    return updateNodeAction\n  }\n}\n\n/**\n * \"Touch\" a node. Tells Gatsby a node still exists and shouldn't\n * be garbage collected. Primarily useful for source plugins fetching\n * nodes from a remote system that can return only nodes that have\n * updated. The source plugin then touches all the nodes that haven't\n * updated but still exist so Gatsby knows to keep them.\n * @param {Object} $0\n * @param {string} $0.nodeId The id of a node\n * @example\n * touchNode({ nodeId: `a-node-id` })\n */\nactions.touchNode = (options: any, plugin?: Plugin) => {\n  let nodeId = _.get(options, `nodeId`)\n\n  // Check if using old method signature. Warn about incorrect usage\n  if (typeof options === `string`) {\n    console.warn(\n      `Calling \"touchNode\" with a nodeId is deprecated. Please pass an object containing a nodeId instead: touchNode({ nodeId: 'a-node-id' })`\n    )\n\n    if (plugin && plugin.name) {\n      console.log(`\"touchNode\" was called by ${plugin.name}`)\n    }\n\n    nodeId = options\n  }\n\n  return {\n    type: `TOUCH_NODE`,\n    plugin,\n    payload: nodeId,\n  }\n}\n\ntype CreateNodeInput = {\n  node: Object,\n  fieldName?: string,\n  fieldValue?: string,\n  name?: string,\n  value: any,\n}\n/**\n * Extend another node. The new node field is placed under the `fields`\n * key on the extended node object.\n *\n * Once a plugin has claimed a field name the field name can't be used by\n * other plugins.  Also since nodes are immutable, you can't mutate the node\n * directly. So to extend another node, use this.\n * @param {Object} $0\n * @param {Object} $0.node the target node object\n * @param {string} $0.fieldName [deprecated] the name for the field\n * @param {string} $0.fieldValue [deprecated] the value for the field\n * @param {string} $0.name the name for the field\n * @param {string} $0.value the value for the field\n * @example\n * createNodeField({\n *   node,\n *   name: `happiness`,\n *   value: `is sweet graphql queries`\n * })\n *\n * // The field value is now accessible at node.fields.happiness\n */\nactions.createNodeField = (\n  { node, name, value, fieldName, fieldValue }: CreateNodeInput,\n  plugin: Plugin,\n  actionOptions?: ActionOptions\n) => {\n  if (fieldName) {\n    console.warn(\n      `Calling \"createNodeField\" with \"fieldName\" is deprecated. Use \"name\" instead`\n    )\n    if (!name) {\n      name = fieldName\n    }\n  }\n  if (fieldValue) {\n    console.warn(\n      `Calling \"createNodeField\" with \"fieldValue\" is deprecated. Use \"value\" instead`\n    )\n    if (!value) {\n      value = fieldValue\n    }\n  }\n  // Ensure required fields are set.\n  if (!node.internal.fieldOwners) {\n    node.internal.fieldOwners = {}\n  }\n  if (!node.fields) {\n    node.fields = {}\n  }\n\n  /**\n   * Normalized name of the field that will be used in schema\n   */\n  const schemaFieldName = _.includes(name, `___NODE`)\n    ? name.split(`___`)[0]\n    : name\n\n  // Check that this field isn't owned by another plugin.\n  const fieldOwner = node.internal.fieldOwners[schemaFieldName]\n  if (fieldOwner && fieldOwner !== plugin.name) {\n    throw new Error(\n      stripIndent`\n      A plugin tried to update a node field that it doesn't own:\n\n      Node id: ${node.id}\n      Plugin: ${plugin.name}\n      name: ${name}\n      value: ${value}\n      `\n    )\n  }\n\n  // Update node\n  node.fields[name] = value\n  node.internal.fieldOwners[schemaFieldName] = plugin.name\n\n  return {\n    type: `ADD_FIELD_TO_NODE`,\n    plugin,\n    ...actionOptions,\n    payload: node,\n  }\n}\n\n/**\n * Creates a link between a parent and child node. This is used when you\n * transform content from a node creating a new child node. You need to add\n * this new child node to the `children` array of the parent but since you\n * don't have direct access to the immutable parent node, use this action\n * instead.\n * @param {Object} $0\n * @param {Object} $0.parent the parent node object\n * @param {Object} $0.child the child node object\n * @example\n * createParentChildLink({ parent: parentNode, child: childNode })\n */\nactions.createParentChildLink = (\n  { parent, child }: { parent: any, child: any },\n  plugin?: Plugin\n) => {\n  // Update parent\n  parent.children.push(child.id)\n  parent.children = _.uniq(parent.children)\n\n  return {\n    type: `ADD_CHILD_NODE_TO_PARENT_NODE`,\n    plugin,\n    payload: parent,\n  }\n}\n\n/**\n * Create a dependency between a page and data. Probably for\n * internal use only.\n * @param {Object} $0\n * @param {string} $0.path the path to the page\n * @param {string} $0.nodeId A node ID\n * @param {string} $0.connection A connection type\n * @private\n */\nactions.createPageDependency = (\n  {\n    path,\n    nodeId,\n    connection,\n  }: { path: string, nodeId: string, connection: string },\n  plugin: string = ``\n) => {\n  return {\n    type: `CREATE_COMPONENT_DEPENDENCY`,\n    plugin,\n    payload: {\n      path,\n      nodeId,\n      connection,\n    },\n  }\n}\n\n/**\n * Delete dependencies between an array of pages and data. Probably for\n * internal use only. Used when deleting pages.\n * @param {Array} paths the paths to delete.\n * @private\n */\nactions.deleteComponentsDependencies = (paths: string[]) => {\n  return {\n    type: `DELETE_COMPONENTS_DEPENDENCIES`,\n    payload: {\n      paths,\n    },\n  }\n}\n\n/**\n * When the query watcher extracts a GraphQL query, it calls\n * this to store the query with its component.\n * @private\n */\nactions.replaceComponentQuery = ({\n  query,\n  componentPath,\n}: {\n  query: string,\n  componentPath: string,\n}) => {\n  return {\n    type: `REPLACE_COMPONENT_QUERY`,\n    payload: {\n      query,\n      componentPath,\n    },\n  }\n}\n\n/**\n * When the query watcher extracts a \"static\" GraphQL query from <StaticQuery>\n * components, it calls this to store the query with its component.\n * @private\n */\nactions.replaceStaticQuery = (args: any, plugin?: ?Plugin = null) => {\n  return {\n    type: `REPLACE_STATIC_QUERY`,\n    plugin,\n    payload: args,\n  }\n}\n\n/**\n * Merge additional configuration into the current webpack config. A few\n * configurations options will be ignored if set, in order to try prevent accidental breakage.\n * Specifically, any change to `entry`, `output`, `target`, or `resolveLoaders` will be ignored.\n *\n * For full control over the webpack config, use `replaceWebpackConfig()`.\n *\n * @param {Object} config partial webpack config, to be merged into the current one\n */\nactions.setWebpackConfig = (config: Object, plugin?: ?Plugin = null) => {\n  return {\n    type: `SET_WEBPACK_CONFIG`,\n    plugin,\n    payload: config,\n  }\n}\n\n/**\n * Completely replace the webpack config for the current stage. This can be\n * dangerous and break Gatsby if certain configuration options are changed.\n *\n * Generally only useful for cases where you need to handle config merging logic\n * yourself, in which case consider using `webpack-merge`.\n *\n * @param {Object} config complete webpack config\n */\nactions.replaceWebpackConfig = (config: Object, plugin?: ?Plugin = null) => {\n  return {\n    type: `REPLACE_WEBPACK_CONFIG`,\n    plugin,\n    payload: config,\n  }\n}\n\n/**\n * Set top-level Babel options. Plugins and presets will be ignored. Use\n * setBabelPlugin and setBabelPreset for this.\n * @param {Object} config An options object in the shape of a normal babelrc JavaScript object\n * @example\n * setBabelOptions({\n *   options: {\n *     sourceMaps: `inline`,\n *   }\n * })\n */\nactions.setBabelOptions = (options: Object, plugin?: ?Plugin = null) => {\n  // Validate\n  let name = `The plugin \"${plugin.name}\"`\n  if (plugin.name === `default-site-plugin`) {\n    name = `Your site's \"gatsby-node.js\"`\n  }\n  if (!_.isObject(options)) {\n    console.log(`${name} must pass an object to \"setBabelOptions\"`)\n    console.log(JSON.stringify(options, null, 4))\n    if (process.env.NODE_ENV !== `test`) {\n      process.exit(1)\n    }\n  }\n\n  if (!_.isObject(options.options)) {\n    console.log(`${name} must pass options to \"setBabelOptions\"`)\n    console.log(JSON.stringify(options, null, 4))\n    if (process.env.NODE_ENV !== `test`) {\n      process.exit(1)\n    }\n  }\n\n  return {\n    type: `SET_BABEL_OPTIONS`,\n    plugin,\n    payload: options,\n  }\n}\n\n/**\n * Add new plugins or merge options into existing Babel plugins.\n * @param {Object} config A config object describing the Babel plugin to be added.\n * @param {string} config.name The name of the Babel plugin\n * @param {Object} config.options Options to pass to the Babel plugin.\n * @example\n * setBabelPlugin({\n *   name:  `babel-plugin-emotion`,\n *   options: {\n *     sourceMap: true,\n *   },\n * })\n */\nactions.setBabelPlugin = (config: Object, plugin?: ?Plugin = null) => {\n  // Validate\n  let name = `The plugin \"${plugin.name}\"`\n  if (plugin.name === `default-site-plugin`) {\n    name = `Your site's \"gatsby-node.js\"`\n  }\n  if (!config.name) {\n    console.log(`${name} must set the name of the Babel plugin`)\n    console.log(JSON.stringify(config, null, 4))\n    if (process.env.NODE_ENV !== `test`) {\n      process.exit(1)\n    }\n  }\n  if (!config.options) {\n    config.options = {}\n  }\n  return {\n    type: `SET_BABEL_PLUGIN`,\n    plugin,\n    payload: config,\n  }\n}\n\n/**\n * Add new presets or merge options into existing Babel presets.\n * @param {Object} config A config object describing the Babel plugin to be added.\n * @param {string} config.name The name of the Babel preset.\n * @param {Object} config.options Options to pass to the Babel preset.\n * @example\n * setBabelPreset({\n *   name: `@babel/preset-react`,\n *   options: {\n *     pragma: `Glamor.createElement`,\n *   },\n * })\n */\nactions.setBabelPreset = (config: Object, plugin?: ?Plugin = null) => {\n  // Validate\n  let name = `The plugin \"${plugin.name}\"`\n  if (plugin.name === `default-site-plugin`) {\n    name = `Your site's \"gatsby-node.js\"`\n  }\n  if (!config.name) {\n    console.log(`${name} must set the name of the Babel preset`)\n    console.log(JSON.stringify(config, null, 4))\n    if (process.env.NODE_ENV !== `test`) {\n      process.exit(1)\n    }\n  }\n  if (!config.options) {\n    config.options = {}\n  }\n  return {\n    type: `SET_BABEL_PRESET`,\n    plugin,\n    payload: config,\n  }\n}\n\n/**\n * Create a \"job\". This is a long-running process that are generally\n * started as side-effects to GraphQL queries.\n * [`gatsby-plugin-sharp`](/packages/gatsby-plugin-sharp/) uses this for\n * example.\n *\n * Gatsby doesn't finish its bootstrap until all jobs are ended.\n * @param {Object} job A job object with at least an id set\n * @param {id} job.id The id of the job\n * @example\n * createJob({ id: `write file id: 123`, fileName: `something.jpeg` })\n */\nactions.createJob = (job: Job, plugin?: ?Plugin = null) => {\n  return {\n    type: `CREATE_JOB`,\n    plugin,\n    payload: job,\n  }\n}\n\n/**\n * Set (update) a \"job\". Sometimes on really long running jobs you want\n * to update the job as it continues.\n *\n * @param {Object} job A job object with at least an id set\n * @param {id} job.id The id of the job\n * @example\n * setJob({ id: `write file id: 123`, progress: 50 })\n */\nactions.setJob = (job: Job, plugin?: ?Plugin = null) => {\n  return {\n    type: `SET_JOB`,\n    plugin,\n    payload: job,\n  }\n}\n\n/**\n * End a \"job\".\n *\n * Gatsby doesn't finish its bootstrap until all jobs are ended.\n * @param {Object} job  A job object with at least an id set\n * @param {id} job.id The id of the job\n * @example\n * endJob({ id: `write file id: 123` })\n */\nactions.endJob = (job: Job, plugin?: ?Plugin = null) => {\n  return {\n    type: `END_JOB`,\n    plugin,\n    payload: job,\n  }\n}\n\n/**\n * Set plugin status. A plugin can use this to save status keys e.g. the last\n * it fetched something. These values are persisted between runs of Gatsby.\n *\n * @param {Object} status  An object with arbitrary values set\n * @example\n * setPluginStatus({ lastFetched: Date.now() })\n */\nactions.setPluginStatus = (\n  status: { [key: string]: mixed },\n  plugin: Plugin\n) => {\n  return {\n    type: `SET_PLUGIN_STATUS`,\n    plugin,\n    payload: status,\n  }\n}\n\n/**\n * Check if path is absolute and add pathPrefix in front if it's not\n */\nconst maybeAddPathPrefix = (path, pathPrefix) => {\n  const parsed = url.parse(path)\n  const isRelativeProtocol = path.startsWith(`//`)\n  return `${\n    parsed.protocol != null || isRelativeProtocol ? `` : pathPrefix\n  }${path}`\n}\n\n/**\n * Create a redirect from one page to another. Server redirects don't work out\n * of the box. You must have a plugin setup to integrate the redirect data with\n * your hosting technology e.g. the [Netlify\n * plugin](/packages/gatsby-plugin-netlify/), or the [Amazon S3\n * plugin](/packages/gatsby-plugin-s3/).\n *\n * @param {Object} redirect Redirect data\n * @param {string} redirect.fromPath Any valid URL. Must start with a forward slash\n * @param {boolean} redirect.isPermanent This is a permanent redirect; defaults to temporary\n * @param {string} redirect.toPath URL of a created page (see `createPage`)\n * @param {boolean} redirect.redirectInBrowser Redirects are generally for redirecting legacy URLs to their new configuration. If you can't update your UI for some reason, set `redirectInBrowser` to true and Gatsby will handle redirecting in the client as well.\n * @param {boolean} redirect.force (Plugin-specific) Will trigger the redirect even if the `fromPath` matches a piece of content. This is not part of the Gatsby API, but implemented by (some) plugins that configure hosting provider redirects\n * @param {number} redirect.statusCode (Plugin-specific) Manually set the HTTP status code. This allows you to create a rewrite (status code 200) or custom error page (status code 404). Note that this will override the `isPermanent` option which also sets the status code. This is not part of the Gatsby API, but implemented by (some) plugins that configure hosting provider redirects\n * @example\n * createRedirect({ fromPath: '/old-url', toPath: '/new-url', isPermanent: true })\n * createRedirect({ fromPath: '/url', toPath: '/zn-CH/url', Language: 'zn' })\n * createRedirect({ fromPath: '/not_so-pretty_url', toPath: '/pretty/url', statusCode: 200 })\n */\nactions.createRedirect = ({\n  fromPath,\n  isPermanent = false,\n  redirectInBrowser = false,\n  toPath,\n  ...rest\n}) => {\n  let pathPrefix = ``\n  if (store.getState().program.prefixPaths) {\n    pathPrefix = store.getState().config.pathPrefix\n  }\n\n  return {\n    type: `CREATE_REDIRECT`,\n    payload: {\n      fromPath: maybeAddPathPrefix(fromPath, pathPrefix),\n      isPermanent,\n      redirectInBrowser,\n      toPath: maybeAddPathPrefix(toPath, pathPrefix),\n      ...rest,\n    },\n  }\n}\n\n/**\n * Add a third-party schema to be merged into main schema. Schema has to be a\n * graphql-js GraphQLSchema object.\n *\n * This schema is going to be merged as-is. This can easily break the main\n * Gatsby schema, so it's user's responsibility to make sure it doesn't happen\n * (by eg namespacing the schema).\n *\n * @param {Object} $0\n * @param {GraphQLSchema} $0.schema GraphQL schema to add\n */\nactions.addThirdPartySchema = (\n  { schema }: { schema: GraphQLSchema },\n  plugin: Plugin,\n  traceId?: string\n) => {\n  return {\n    type: `ADD_THIRD_PARTY_SCHEMA`,\n    plugin,\n    traceId,\n    payload: schema,\n  }\n}\n\nimport type GatsbyGraphQLType from \"../schema/types/type-builders\"\n/**\n * Add type definitions to the GraphQL schema.\n *\n * @param {string | GraphQLOutputType | GatsbyGraphQLType | string[] | GraphQLOutputType[] | GatsbyGraphQLType[]} types Type definitions\n *\n * Type definitions can be provided either as\n * [`graphql-js` types](https://graphql.org/graphql-js/), in\n * [GraphQL schema definition language (SDL)](https://graphql.org/learn/)\n * or using Gatsby Type Builders available on the `schema` API argument.\n *\n * Things to note:\n * * needs to be called *before* schema generation. It is recommended to use\n *   `createTypes` in the `sourceNodes` API.\n * * type definitions targeting node types, i.e. `MarkdownRemark` and others\n *   added in `sourceNodes` or `onCreateNode` APIs, need to implement the\n *   `Node` interface. Interface fields will be added automatically, but it\n *   is mandatory to label those types with `implements Node`.\n * * by default, explicit type definitions from `createTypes` will be merged\n *   with inferred field types, and default field resolvers for `Date` (which\n *   adds formatting options) and `File` (which resolves the field value as\n *   a `relativePath` foreign-key field) are added. This behavior can be\n *   customised with `@infer` and `@dontInfer` directives, and their\n *   `noDefaultResolvers` argument.\n *\n * @example\n * exports.sourceNodes = ({ actions }) => {\n *   const { createTypes } = actions\n *   const typeDefs = `\n *     \"\"\"\n *     Markdown Node\n *     \"\"\"\n *     type MarkdownRemark implements Node {\n *       frontmatter: Frontmatter!\n *     }\n *\n *     \"\"\"\n *     Markdown Frontmatter\n *     \"\"\"\n *     type Frontmatter {\n *       title: String!\n *       author: AuthorJson!\n *       date: Date!\n *       published: Boolean!\n *       tags: [String!]!\n *     }\n *\n *     \"\"\"\n *     Author information\n *     \"\"\"\n *     # Does not include automatically inferred fields\n *     type AuthorJson implements Node @dontInfer(noFieldResolvers: true) {\n *       name: String!\n *       birthday: Date! # no default resolvers for Date formatting added\n *     }\n *   `\n *   createTypes(typeDefs)\n * }\n *\n * // using Gatsby Type Builder API\n * exports.sourceNodes = ({ actions, schema }) => {\n *   const { createTypes } = actions\n *   const typeDefs = [\n *     schema.buildObjectType({\n *       name: 'MarkdownRemark',\n *       fields: {\n *         frontmatter: 'Frontmatter!'\n *       },\n *       interfaces: ['Node'],\n *     }),\n *     schema.buildObjectType({\n *       name: 'Frontmatter',\n *       fields: {\n *         title: {\n *           type: 'String!',\n *           resolve(parent) {\n *             return parent.title || '(Untitled)'\n *           }\n *         },\n *         author: 'AuthorJson!',\n *         date: 'Date!',\n *         published: 'Boolean!',\n *         tags: '[String!]!',\n *       }\n *     })\n *   ]\n *   createTypes(typeDefs)\n * }\n */\nactions.createTypes = (\n  types:\n    | string\n    | GraphQLOutputType\n    | GatsbyGraphQLType\n    | Array<string | GraphQLOutputType | GatsbyGraphQLType>,\n  plugin: Plugin,\n  traceId?: string\n) => {\n  return {\n    type: `CREATE_TYPES`,\n    plugin,\n    traceId,\n    payload: types,\n  }\n}\n\n/**\n *\n * Report that a query has been extracted from a component. Used by\n * query-compilier.js.\n *\n * @param {Object} $0\n * @param {componentPath} $0.componentPath The path to the component that just had\n * its query read.\n * @param {query} $0.query The GraphQL query that was extracted from the component.\n * @private\n */\nactions.queryExtracted = (\n  { componentPath, query },\n  plugin: Plugin,\n  traceId?: string\n) => {\n  return {\n    type: `QUERY_EXTRACTED`,\n    plugin,\n    traceId,\n    payload: { componentPath, query },\n  }\n}\n\n/**\n *\n * Report that the Relay Compilier found a graphql error when attempting to extract a query\n *\n * @param {Object} $0\n * @param {componentPath} $0.componentPath The path to the component that just had\n * its query read.\n * @param {error} $0.error The GraphQL query that was extracted from the component.\n * @private\n */\nactions.queryExtractionGraphQLError = (\n  { componentPath, error },\n  plugin: Plugin,\n  traceId?: string\n) => {\n  return {\n    type: `QUERY_EXTRACTION_GRAPHQL_ERROR`,\n    plugin,\n    traceId,\n    payload: { componentPath, error },\n  }\n}\n\n/**\n *\n * Report that babel was able to extract the graphql query.\n * Indicates that the file is free of JS errors.\n *\n * @param {Object} $0\n * @param {componentPath} $0.componentPath The path to the component that just had\n * its query read.\n * @private\n */\nactions.queryExtractedBabelSuccess = (\n  { componentPath },\n  plugin: Plugin,\n  traceId?: string\n) => {\n  return {\n    type: `QUERY_EXTRACTION_BABEL_SUCCESS`,\n    plugin,\n    traceId,\n    payload: { componentPath },\n  }\n}\n\n/**\n *\n * Report that the Relay Compilier found a babel error when attempting to extract a query\n *\n * @param {Object} $0\n * @param {componentPath} $0.componentPath The path to the component that just had\n * its query read.\n * @param {error} $0.error The Babel error object\n * @private\n */\nactions.queryExtractionBabelError = (\n  { componentPath, error },\n  plugin: Plugin,\n  traceId?: string\n) => {\n  return {\n    type: `QUERY_EXTRACTION_BABEL_ERROR`,\n    plugin,\n    traceId,\n    payload: { componentPath, error },\n  }\n}\n\n/**\n * Set overall program status e.g. `BOOTSTRAPING` or `BOOTSTRAP_FINISHED`.\n *\n * @param {string} Program status\n * @private\n */\nactions.setProgramStatus = (status, plugin: Plugin, traceId?: string) => {\n  return {\n    type: `SET_PROGRAM_STATUS`,\n    plugin,\n    traceId,\n    payload: status,\n  }\n}\n\n/**\n * Broadcast that a page's query was run.\n *\n * @param {string} Path to the page component that changed.\n * @private\n */\nactions.pageQueryRun = (\n  { path, componentPath, isPage },\n  plugin: Plugin,\n  traceId?: string\n) => {\n  return {\n    type: `PAGE_QUERY_RUN`,\n    plugin,\n    traceId,\n    payload: { path, componentPath, isPage },\n  }\n}\n\n/**\n * All action creators wrapped with a dispatch.\n */\nexports.actions = actions\n\n/**\n * All action creators wrapped with a dispatch. - *DEPRECATED*\n */\nexports.boundActionCreators = bindActionCreators(actions, store.dispatch)\n"],"file":"actions.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/redux/actions/add-page-dependency.js b/node_modules/gatsby/dist/redux/actions/add-page-dependency.js
index 9502d86..040e2dc 100644
--- a/node_modules/gatsby/dist/redux/actions/add-page-dependency.js
+++ b/node_modules/gatsby/dist/redux/actions/add-page-dependency.js
@@ -2,11 +2,13 @@
 
 const _ = require(`lodash`);
 
-const _require = require(`../`),
-      store = _require.store;
+const {
+  store
+} = require(`../`);
 
-const _require2 = require(`../actions.js`),
-      actions = _require2.actions;
+const {
+  actions
+} = require(`../actions.js`);
 
 function createPageDependency({
   path,
diff --git a/node_modules/gatsby/dist/redux/actions/add-page-dependency.js.map b/node_modules/gatsby/dist/redux/actions/add-page-dependency.js.map
index ab3677a..31df8ff 100644
--- a/node_modules/gatsby/dist/redux/actions/add-page-dependency.js.map
+++ b/node_modules/gatsby/dist/redux/actions/add-page-dependency.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/redux/actions/add-page-dependency.js"],"names":["_","require","store","actions","createPageDependency","path","nodeId","connection","state","getState","nodeDependencyExists","connectionDependencyExists","includes","componentDataDependencies","nodes","connections","action","dispatch","module","exports"],"mappings":";;AAAA,MAAMA,CAAC,GAAGC,OAAO,CAAE,QAAF,CAAjB;;iBAEkBA,OAAO,CAAE,KAAF,C;MAAjBC,K,YAAAA,K;;kBACYD,OAAO,CAAE,eAAF,C;MAAnBE,O,aAAAA,O;;AAER,SAASC,oBAAT,CAA8B;AAAEC,EAAAA,IAAF;AAAQC,EAAAA,MAAR;AAAgBC,EAAAA;AAAhB,CAA9B,EAA4D;AAC1D,QAAMC,KAAK,GAAGN,KAAK,CAACO,QAAN,EAAd,CAD0D,CAG1D;AACA;;AACA,MAAIC,oBAAoB,GAAG,KAA3B;AACA,MAAIC,0BAA0B,GAAG,KAAjC;;AACA,MAAI,CAACL,MAAL,EAAa;AACXI,IAAAA,oBAAoB,GAAG,IAAvB;AACD;;AACD,MACEJ,MAAM,IACNN,CAAC,CAACY,QAAF,CAAWJ,KAAK,CAACK,yBAAN,CAAgCC,KAAhC,CAAsCR,MAAtC,CAAX,EAA0DD,IAA1D,CAFF,EAGE;AACAK,IAAAA,oBAAoB,GAAG,IAAvB;AACD;;AACD,MAAI,CAACH,UAAL,EAAiB;AACfI,IAAAA,0BAA0B,GAAG,IAA7B;AACD;;AACD,MACEJ,UAAU,IACVP,CAAC,CAACY,QAAF,CAAWJ,KAAK,CAACK,yBAAN,CAAgCE,WAA3C,EAAwDR,UAAxD,CAFF,EAGE;AACAI,IAAAA,0BAA0B,GAAG,IAA7B;AACD;;AACD,MAAID,oBAAoB,IAAIC,0BAA5B,EAAwD;AACtD;AACD,GA3ByD,CA6B1D;;;AACA,QAAMK,MAAM,GAAGb,OAAO,CAACC,oBAAR,CAA6B;AAAEC,IAAAA,IAAF;AAAQC,IAAAA,MAAR;AAAgBC,IAAAA;AAAhB,GAA7B,CAAf;AACAL,EAAAA,KAAK,CAACe,QAAN,CAAeD,MAAf;AACD;;AAEDE,MAAM,CAACC,OAAP,GAAiBf,oBAAjB","sourcesContent":["const _ = require(`lodash`)\n\nconst { store } = require(`../`)\nconst { actions } = require(`../actions.js`)\n\nfunction createPageDependency({ path, nodeId, connection }) {\n  const state = store.getState()\n\n  // Check that the dependencies aren't already recorded so we\n  // can avoid creating lots of very noisy actions.\n  let nodeDependencyExists = false\n  let connectionDependencyExists = false\n  if (!nodeId) {\n    nodeDependencyExists = true\n  }\n  if (\n    nodeId &&\n    _.includes(state.componentDataDependencies.nodes[nodeId], path)\n  ) {\n    nodeDependencyExists = true\n  }\n  if (!connection) {\n    connectionDependencyExists = true\n  }\n  if (\n    connection &&\n    _.includes(state.componentDataDependencies.connections, connection)\n  ) {\n    connectionDependencyExists = true\n  }\n  if (nodeDependencyExists && connectionDependencyExists) {\n    return\n  }\n\n  // It's new, let's dispatch it\n  const action = actions.createPageDependency({ path, nodeId, connection })\n  store.dispatch(action)\n}\n\nmodule.exports = createPageDependency\n"],"file":"add-page-dependency.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/redux/actions/add-page-dependency.js"],"names":["_","require","store","actions","createPageDependency","path","nodeId","connection","state","getState","nodeDependencyExists","connectionDependencyExists","includes","componentDataDependencies","nodes","connections","action","dispatch","module","exports"],"mappings":";;AAAA,MAAMA,CAAC,GAAGC,OAAO,CAAE,QAAF,CAAjB;;AAEA,MAAM;AAAEC,EAAAA;AAAF,IAAYD,OAAO,CAAE,KAAF,CAAzB;;AACA,MAAM;AAAEE,EAAAA;AAAF,IAAcF,OAAO,CAAE,eAAF,CAA3B;;AAEA,SAASG,oBAAT,CAA8B;AAAEC,EAAAA,IAAF;AAAQC,EAAAA,MAAR;AAAgBC,EAAAA;AAAhB,CAA9B,EAA4D;AAC1D,QAAMC,KAAK,GAAGN,KAAK,CAACO,QAAN,EAAd,CAD0D,CAG1D;AACA;;AACA,MAAIC,oBAAoB,GAAG,KAA3B;AACA,MAAIC,0BAA0B,GAAG,KAAjC;;AACA,MAAI,CAACL,MAAL,EAAa;AACXI,IAAAA,oBAAoB,GAAG,IAAvB;AACD;;AACD,MACEJ,MAAM,IACNN,CAAC,CAACY,QAAF,CAAWJ,KAAK,CAACK,yBAAN,CAAgCC,KAAhC,CAAsCR,MAAtC,CAAX,EAA0DD,IAA1D,CAFF,EAGE;AACAK,IAAAA,oBAAoB,GAAG,IAAvB;AACD;;AACD,MAAI,CAACH,UAAL,EAAiB;AACfI,IAAAA,0BAA0B,GAAG,IAA7B;AACD;;AACD,MACEJ,UAAU,IACVP,CAAC,CAACY,QAAF,CAAWJ,KAAK,CAACK,yBAAN,CAAgCE,WAA3C,EAAwDR,UAAxD,CAFF,EAGE;AACAI,IAAAA,0BAA0B,GAAG,IAA7B;AACD;;AACD,MAAID,oBAAoB,IAAIC,0BAA5B,EAAwD;AACtD;AACD,GA3ByD,CA6B1D;;;AACA,QAAMK,MAAM,GAAGb,OAAO,CAACC,oBAAR,CAA6B;AAAEC,IAAAA,IAAF;AAAQC,IAAAA,MAAR;AAAgBC,IAAAA;AAAhB,GAA7B,CAAf;AACAL,EAAAA,KAAK,CAACe,QAAN,CAAeD,MAAf;AACD;;AAEDE,MAAM,CAACC,OAAP,GAAiBf,oBAAjB","sourcesContent":["const _ = require(`lodash`)\n\nconst { store } = require(`../`)\nconst { actions } = require(`../actions.js`)\n\nfunction createPageDependency({ path, nodeId, connection }) {\n  const state = store.getState()\n\n  // Check that the dependencies aren't already recorded so we\n  // can avoid creating lots of very noisy actions.\n  let nodeDependencyExists = false\n  let connectionDependencyExists = false\n  if (!nodeId) {\n    nodeDependencyExists = true\n  }\n  if (\n    nodeId &&\n    _.includes(state.componentDataDependencies.nodes[nodeId], path)\n  ) {\n    nodeDependencyExists = true\n  }\n  if (!connection) {\n    connectionDependencyExists = true\n  }\n  if (\n    connection &&\n    _.includes(state.componentDataDependencies.connections, connection)\n  ) {\n    connectionDependencyExists = true\n  }\n  if (nodeDependencyExists && connectionDependencyExists) {\n    return\n  }\n\n  // It's new, let's dispatch it\n  const action = actions.createPageDependency({ path, nodeId, connection })\n  store.dispatch(action)\n}\n\nmodule.exports = createPageDependency\n"],"file":"add-page-dependency.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/redux/index.js b/node_modules/gatsby/dist/redux/index.js
index f48a9fe..1762abf 100644
--- a/node_modules/gatsby/dist/redux/index.js
+++ b/node_modules/gatsby/dist/redux/index.js
@@ -4,101 +4,64 @@ const Redux = require(`redux`);
 
 const _ = require(`lodash`);
 
-const fs = require(`fs-extra`);
-
-const mitt = require(`mitt`);
-
-const stringify = require(`json-stringify-safe`); // Create event emitter for actions
+const mitt = require(`mitt`); // Create event emitter for actions
 
 
 const emitter = mitt(); // Reducers
 
 const reducers = require(`./reducers`);
 
-const objectToMap = obj => {
-  let map = new Map();
-  Object.keys(obj).forEach(key => {
-    map.set(key, obj[key]);
-  });
-  return map;
-};
-
-const mapToObject = map => {
-  const obj = {};
-
-  for (var _iterator = map, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
-    var _ref;
-
-    if (_isArray) {
-      if (_i >= _iterator.length) break;
-      _ref = _iterator[_i++];
-    } else {
-      _i = _iterator.next();
-      if (_i.done) break;
-      _ref = _i.value;
-    }
-
-    let _ref2 = _ref,
-        key = _ref2[0],
-        value = _ref2[1];
-    obj[key] = value;
-  }
-
-  return obj;
-}; // Read from cache the old node data.
+const {
+  writeToCache,
+  readFromCache
+} = require(`./persist`); // Read old node data from cache.
 
 
-let initialState = {};
+const readState = () => {
+  try {
+    const state = readFromCache();
 
-try {
-  const file = fs.readFileSync(`${process.cwd()}/.cache/redux-state.json`); // Apparently the file mocking in node-tracking-test.js
-  // can override the file reading replacing the mocked string with
-  // an already parsed object.
+    if (state.nodes) {
+      // re-create nodesByType
+      state.nodesByType = new Map();
+      state.nodes.forEach(node => {
+        const {
+          type
+        } = node.internal;
 
-  if (Buffer.isBuffer(file) || typeof file === `string`) {
-    initialState = JSON.parse(file);
-  }
+        if (!state.nodesByType.has(type)) {
+          state.nodesByType.set(type, new Map());
+        }
 
-  if (initialState.staticQueryComponents) {
-    initialState.staticQueryComponents = objectToMap(initialState.staticQueryComponents);
-  }
+        state.nodesByType.get(type).set(node.id, node);
+      });
+    }
 
-  if (initialState.components) {
-    initialState.components = objectToMap(initialState.components);
+    return state;
+  } catch (e) {// ignore errors.
   }
 
-  if (initialState.nodes) {
-    initialState.nodes = objectToMap(initialState.nodes);
-    initialState.nodesByType = new Map();
-    initialState.nodes.forEach(node => {
-      const type = node.internal.type;
-
-      if (!initialState.nodesByType.has(type)) {
-        initialState.nodesByType.set(type, new Map());
-      }
-
-      initialState.nodesByType.get(type).set(node.id, node);
-    });
-  }
-} catch (e) {// ignore errors.
-}
+  return {};
+};
 
-const store = Redux.createStore(Redux.combineReducers(Object.assign({}, reducers)), initialState, Redux.applyMiddleware(function multi({
+exports.readState = readState;
+const store = Redux.createStore(Redux.combineReducers({ ...reducers
+}), readState(), Redux.applyMiddleware(function multi({
   dispatch
 }) {
   return next => action => Array.isArray(action) ? action.filter(Boolean).map(dispatch) : next(action);
 })); // Persist state.
 
 function saveState() {
+  if (process.env.DANGEROUSLY_DISABLE_OOM) {
+    return Promise.resolve();
+  }
+
   const state = store.getState();
 
   const pickedState = _.pick(state, [`nodes`, `status`, `componentDataDependencies`, `jsonDataPaths`, `components`, `staticQueryComponents`]);
 
-  pickedState.staticQueryComponents = mapToObject(pickedState.staticQueryComponents);
-  pickedState.components = mapToObject(pickedState.components);
-  pickedState.nodes = pickedState.nodes ? mapToObject(pickedState.nodes) : [];
-  const stringified = stringify(pickedState, null, 2);
-  return fs.writeFile(`${process.cwd()}/.cache/redux-state.json`, stringified);
+  return writeToCache(pickedState);
 }
 
 exports.saveState = saveState;
diff --git a/node_modules/gatsby/dist/redux/index.js.map b/node_modules/gatsby/dist/redux/index.js.map
index bce8138..edb2792 100644
--- a/node_modules/gatsby/dist/redux/index.js.map
+++ b/node_modules/gatsby/dist/redux/index.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/redux/index.js"],"names":["Redux","require","_","fs","mitt","stringify","emitter","reducers","objectToMap","obj","map","Map","Object","keys","forEach","key","set","mapToObject","value","initialState","file","readFileSync","process","cwd","Buffer","isBuffer","JSON","parse","staticQueryComponents","components","nodes","nodesByType","node","type","internal","has","get","id","e","store","createStore","combineReducers","applyMiddleware","multi","dispatch","next","action","Array","isArray","filter","Boolean","saveState","state","getState","pickedState","pick","stringified","writeFile","exports","subscribe","lastAction","emit"],"mappings":"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","sourcesContent":["const Redux = require(`redux`)\nconst _ = require(`lodash`)\nconst fs = require(`fs-extra`)\nconst mitt = require(`mitt`)\nconst stringify = require(`json-stringify-safe`)\n\n// Create event emitter for actions\nconst emitter = mitt()\n\n// Reducers\nconst reducers = require(`./reducers`)\n\nconst objectToMap = obj => {\n  let map = new Map()\n  Object.keys(obj).forEach(key => {\n    map.set(key, obj[key])\n  })\n  return map\n}\n\nconst mapToObject = map => {\n  const obj = {}\n  for (let [key, value] of map) {\n    obj[key] = value\n  }\n  return obj\n}\n\n// Read from cache the old node data.\nlet initialState = {}\ntry {\n  const file = fs.readFileSync(`${process.cwd()}/.cache/redux-state.json`)\n  // Apparently the file mocking in node-tracking-test.js\n  // can override the file reading replacing the mocked string with\n  // an already parsed object.\n  if (Buffer.isBuffer(file) || typeof file === `string`) {\n    initialState = JSON.parse(file)\n  }\n  if (initialState.staticQueryComponents) {\n    initialState.staticQueryComponents = objectToMap(\n      initialState.staticQueryComponents\n    )\n  }\n  if (initialState.components) {\n    initialState.components = objectToMap(initialState.components)\n  }\n  if (initialState.nodes) {\n    initialState.nodes = objectToMap(initialState.nodes)\n\n    initialState.nodesByType = new Map()\n    initialState.nodes.forEach(node => {\n      const { type } = node.internal\n      if (!initialState.nodesByType.has(type)) {\n        initialState.nodesByType.set(type, new Map())\n      }\n      initialState.nodesByType.get(type).set(node.id, node)\n    })\n  }\n} catch (e) {\n  // ignore errors.\n}\n\nconst store = Redux.createStore(\n  Redux.combineReducers({ ...reducers }),\n  initialState,\n  Redux.applyMiddleware(function multi({ dispatch }) {\n    return next => action =>\n      Array.isArray(action)\n        ? action.filter(Boolean).map(dispatch)\n        : next(action)\n  })\n)\n\n// Persist state.\nfunction saveState() {\n  const state = store.getState()\n  const pickedState = _.pick(state, [\n    `nodes`,\n    `status`,\n    `componentDataDependencies`,\n    `jsonDataPaths`,\n    `components`,\n    `staticQueryComponents`,\n  ])\n\n  pickedState.staticQueryComponents = mapToObject(\n    pickedState.staticQueryComponents\n  )\n  pickedState.components = mapToObject(pickedState.components)\n  pickedState.nodes = pickedState.nodes ? mapToObject(pickedState.nodes) : []\n  const stringified = stringify(pickedState, null, 2)\n  return fs.writeFile(`${process.cwd()}/.cache/redux-state.json`, stringified)\n}\n\nexports.saveState = saveState\n\nstore.subscribe(() => {\n  const lastAction = store.getState().lastAction\n  emitter.emit(lastAction.type, lastAction)\n})\n\n/** Event emitter */\nexports.emitter = emitter\n\n/** Redux store */\nexports.store = store\n"],"file":"index.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/redux/index.js"],"names":["Redux","require","_","mitt","emitter","reducers","writeToCache","readFromCache","readState","state","nodes","nodesByType","Map","forEach","node","type","internal","has","set","get","id","e","exports","store","createStore","combineReducers","applyMiddleware","multi","dispatch","next","action","Array","isArray","filter","Boolean","map","saveState","process","env","DANGEROUSLY_DISABLE_OOM","Promise","resolve","getState","pickedState","pick","subscribe","lastAction","emit"],"mappings":";;AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAE,OAAF,CAArB;;AACA,MAAMC,CAAC,GAAGD,OAAO,CAAE,QAAF,CAAjB;;AAEA,MAAME,IAAI,GAAGF,OAAO,CAAE,MAAF,CAApB,C,CAEA;;;AACA,MAAMG,OAAO,GAAGD,IAAI,EAApB,C,CAEA;;AACA,MAAME,QAAQ,GAAGJ,OAAO,CAAE,YAAF,CAAxB;;AACA,MAAM;AAAEK,EAAAA,YAAF;AAAgBC,EAAAA;AAAhB,IAAkCN,OAAO,CAAE,WAAF,CAA/C,C,CAEA;;;AACA,MAAMO,SAAS,GAAG,MAAM;AACtB,MAAI;AACF,UAAMC,KAAK,GAAGF,aAAa,EAA3B;;AACA,QAAIE,KAAK,CAACC,KAAV,EAAiB;AACf;AACAD,MAAAA,KAAK,CAACE,WAAN,GAAoB,IAAIC,GAAJ,EAApB;AACAH,MAAAA,KAAK,CAACC,KAAN,CAAYG,OAAZ,CAAoBC,IAAI,IAAI;AAC1B,cAAM;AAAEC,UAAAA;AAAF,YAAWD,IAAI,CAACE,QAAtB;;AACA,YAAI,CAACP,KAAK,CAACE,WAAN,CAAkBM,GAAlB,CAAsBF,IAAtB,CAAL,EAAkC;AAChCN,UAAAA,KAAK,CAACE,WAAN,CAAkBO,GAAlB,CAAsBH,IAAtB,EAA4B,IAAIH,GAAJ,EAA5B;AACD;;AACDH,QAAAA,KAAK,CAACE,WAAN,CAAkBQ,GAAlB,CAAsBJ,IAAtB,EAA4BG,GAA5B,CAAgCJ,IAAI,CAACM,EAArC,EAAyCN,IAAzC;AACD,OAND;AAOD;;AACD,WAAOL,KAAP;AACD,GAdD,CAcE,OAAOY,CAAP,EAAU,CACV;AACD;;AACD,SAAO,EAAP;AACD,CAnBD;;AAqBAC,OAAO,CAACd,SAAR,GAAoBA,SAApB;AAEA,MAAMe,KAAK,GAAGvB,KAAK,CAACwB,WAAN,CACZxB,KAAK,CAACyB,eAAN,CAAsB,EAAE,GAAGpB;AAAL,CAAtB,CADY,EAEZG,SAAS,EAFG,EAGZR,KAAK,CAAC0B,eAAN,CAAsB,SAASC,KAAT,CAAe;AAAEC,EAAAA;AAAF,CAAf,EAA6B;AACjD,SAAOC,IAAI,IAAIC,MAAM,IACnBC,KAAK,CAACC,OAAN,CAAcF,MAAd,IACIA,MAAM,CAACG,MAAP,CAAcC,OAAd,EAAuBC,GAAvB,CAA2BP,QAA3B,CADJ,GAEIC,IAAI,CAACC,MAAD,CAHV;AAID,CALD,CAHY,CAAd,C,CAWA;;AACA,SAASM,SAAT,GAAqB;AACnB,MAAIC,OAAO,CAACC,GAAR,CAAYC,uBAAhB,EAAyC;AACvC,WAAOC,OAAO,CAACC,OAAR,EAAP;AACD;;AAED,QAAMhC,KAAK,GAAGc,KAAK,CAACmB,QAAN,EAAd;;AACA,QAAMC,WAAW,GAAGzC,CAAC,CAAC0C,IAAF,CAAOnC,KAAP,EAAc,CAC/B,OAD+B,EAE/B,QAF+B,EAG/B,2BAH+B,EAI/B,eAJ+B,EAK/B,YAL+B,EAM/B,uBAN+B,CAAd,CAApB;;AASA,SAAOH,YAAY,CAACqC,WAAD,CAAnB;AACD;;AAEDrB,OAAO,CAACc,SAAR,GAAoBA,SAApB;AAEAb,KAAK,CAACsB,SAAN,CAAgB,MAAM;AACpB,QAAMC,UAAU,GAAGvB,KAAK,CAACmB,QAAN,GAAiBI,UAApC;AACA1C,EAAAA,OAAO,CAAC2C,IAAR,CAAaD,UAAU,CAAC/B,IAAxB,EAA8B+B,UAA9B;AACD,CAHD;AAKA;;AACAxB,OAAO,CAAClB,OAAR,GAAkBA,OAAlB;AAEA;;AACAkB,OAAO,CAACC,KAAR,GAAgBA,KAAhB","sourcesContent":["const Redux = require(`redux`)\nconst _ = require(`lodash`)\n\nconst mitt = require(`mitt`)\n\n// Create event emitter for actions\nconst emitter = mitt()\n\n// Reducers\nconst reducers = require(`./reducers`)\nconst { writeToCache, readFromCache } = require(`./persist`)\n\n// Read old node data from cache.\nconst readState = () => {\n  try {\n    const state = readFromCache()\n    if (state.nodes) {\n      // re-create nodesByType\n      state.nodesByType = new Map()\n      state.nodes.forEach(node => {\n        const { type } = node.internal\n        if (!state.nodesByType.has(type)) {\n          state.nodesByType.set(type, new Map())\n        }\n        state.nodesByType.get(type).set(node.id, node)\n      })\n    }\n    return state\n  } catch (e) {\n    // ignore errors.\n  }\n  return {}\n}\n\nexports.readState = readState\n\nconst store = Redux.createStore(\n  Redux.combineReducers({ ...reducers }),\n  readState(),\n  Redux.applyMiddleware(function multi({ dispatch }) {\n    return next => action =>\n      Array.isArray(action)\n        ? action.filter(Boolean).map(dispatch)\n        : next(action)\n  })\n)\n\n// Persist state.\nfunction saveState() {\n  if (process.env.DANGEROUSLY_DISABLE_OOM) {\n    return Promise.resolve()\n  }\n\n  const state = store.getState()\n  const pickedState = _.pick(state, [\n    `nodes`,\n    `status`,\n    `componentDataDependencies`,\n    `jsonDataPaths`,\n    `components`,\n    `staticQueryComponents`,\n  ])\n\n  return writeToCache(pickedState)\n}\n\nexports.saveState = saveState\n\nstore.subscribe(() => {\n  const lastAction = store.getState().lastAction\n  emitter.emit(lastAction.type, lastAction)\n})\n\n/** Event emitter */\nexports.emitter = emitter\n\n/** Redux store */\nexports.store = store\n"],"file":"index.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/redux/nodes.js b/node_modules/gatsby/dist/redux/nodes.js
index b418732..d2b792b 100644
--- a/node_modules/gatsby/dist/redux/nodes.js
+++ b/node_modules/gatsby/dist/redux/nodes.js
@@ -1,7 +1,8 @@
 "use strict";
 
-const _require = require(`./index`),
-      store = _require.store;
+const {
+  store
+} = require(`./index`);
 /**
  * Get all nodes from redux store.
  *
diff --git a/node_modules/gatsby/dist/redux/nodes.js.map b/node_modules/gatsby/dist/redux/nodes.js.map
index 51c98f7..64dbf53 100644
--- a/node_modules/gatsby/dist/redux/nodes.js.map
+++ b/node_modules/gatsby/dist/redux/nodes.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/redux/nodes.js"],"names":["require","store","getNodes","nodes","getState","Array","from","values","exports","getNode","id","get","getNodesByType","type","nodesByType","getTypes","keys","hasNodeChanged","digest","node","internal","contentDigest","getNodeAndSavePathDependency","path","createPageDependency","nodeId"],"mappings":";;iBAEkBA,OAAO,CAAE,SAAF,C;MAAjBC,K,YAAAA,K;AAER;;;;;;;AAKA,MAAMC,QAAQ,GAAG,MAAM;AACrB,QAAMC,KAAK,GAAGF,KAAK,CAACG,QAAN,GAAiBD,KAA/B;;AACA,MAAIA,KAAJ,EAAW;AACT,WAAOE,KAAK,CAACC,IAAN,CAAWH,KAAK,CAACI,MAAN,EAAX,CAAP;AACD,GAFD,MAEO;AACL,WAAO,EAAP;AACD;AACF,CAPD;;AASAC,OAAO,CAACN,QAAR,GAAmBA,QAAnB;AAEA;;;;;;AAKA,MAAMO,OAAO,GAAGC,EAAE,IAAIT,KAAK,CAACG,QAAN,GAAiBD,KAAjB,CAAuBQ,GAAvB,CAA2BD,EAA3B,CAAtB;;AAEAF,OAAO,CAACC,OAAR,GAAkBA,OAAlB;AAEA;;;;;;;AAMA,MAAMG,cAAc,GAAGC,IAAI,IAAI;AAC7B,QAAMV,KAAK,GAAGF,KAAK,CAACG,QAAN,GAAiBU,WAAjB,CAA6BH,GAA7B,CAAiCE,IAAjC,CAAd;;AACA,MAAIV,KAAJ,EAAW;AACT,WAAOE,KAAK,CAACC,IAAN,CAAWH,KAAK,CAACI,MAAN,EAAX,CAAP;AACD,GAFD,MAEO;AACL,WAAO,EAAP;AACD;AACF,CAPD;;AASAC,OAAO,CAACI,cAAR,GAAyBA,cAAzB;AAEA;;;;;;AAKA,MAAMG,QAAQ,GAAG,MAAMV,KAAK,CAACC,IAAN,CAAWL,KAAK,CAACG,QAAN,GAAiBU,WAAjB,CAA6BE,IAA7B,EAAX,CAAvB;;AAEAR,OAAO,CAACO,QAAR,GAAmBA,QAAnB;AAEA;;;;;;;;AAOAP,OAAO,CAACS,cAAR,GAAyB,CAACP,EAAD,EAAKQ,MAAL,KAAgB;AACvC,QAAMC,IAAI,GAAGlB,KAAK,CAACG,QAAN,GAAiBD,KAAjB,CAAuBQ,GAAvB,CAA2BD,EAA3B,CAAb;;AACA,MAAI,CAACS,IAAL,EAAW;AACT,WAAO,IAAP;AACD,GAFD,MAEO;AACL,WAAOA,IAAI,CAACC,QAAL,CAAcC,aAAd,KAAgCH,MAAvC;AACD;AACF,CAPD;AASA;;;;;;;;;AAOAV,OAAO,CAACc,4BAAR,GAAuC,CAACZ,EAAD,EAAKa,IAAL,KAAc;AACnD,QAAMC,oBAAoB,GAAGxB,OAAO,CAAE,+BAAF,CAApC;;AACA,QAAMmB,IAAI,GAAGV,OAAO,CAACC,EAAD,CAApB;AACAc,EAAAA,oBAAoB,CAAC;AAAED,IAAAA,IAAF;AAAQE,IAAAA,MAAM,EAAEf;AAAhB,GAAD,CAApB;AACA,SAAOS,IAAP;AACD,CALD","sourcesContent":["/* @flow */\n\nconst { store } = require(`./index`)\n\n/**\n * Get all nodes from redux store.\n *\n * @returns {Array}\n */\nconst getNodes = () => {\n  const nodes = store.getState().nodes\n  if (nodes) {\n    return Array.from(nodes.values())\n  } else {\n    return []\n  }\n}\n\nexports.getNodes = getNodes\n\n/** Get node by id from store.\n *\n * @param {string} id\n * @returns {Object}\n */\nconst getNode = id => store.getState().nodes.get(id)\n\nexports.getNode = getNode\n\n/**\n * Get all nodes of type from redux store.\n *\n * @param {string} type\n * @returns {Array}\n */\nconst getNodesByType = type => {\n  const nodes = store.getState().nodesByType.get(type)\n  if (nodes) {\n    return Array.from(nodes.values())\n  } else {\n    return []\n  }\n}\n\nexports.getNodesByType = getNodesByType\n\n/**\n * Get all type names from redux store.\n *\n * @returns {Array}\n */\nconst getTypes = () => Array.from(store.getState().nodesByType.keys())\n\nexports.getTypes = getTypes\n\n/**\n * Determine if node has changed.\n *\n * @param {string} id\n * @param {string} digest\n * @returns {boolean}\n */\nexports.hasNodeChanged = (id, digest) => {\n  const node = store.getState().nodes.get(id)\n  if (!node) {\n    return true\n  } else {\n    return node.internal.contentDigest !== digest\n  }\n}\n\n/**\n * Get node and save path dependency.\n *\n * @param {string} id\n * @param {string} path\n * @returns {Object} node\n */\nexports.getNodeAndSavePathDependency = (id, path) => {\n  const createPageDependency = require(`./actions/add-page-dependency`)\n  const node = getNode(id)\n  createPageDependency({ path, nodeId: id })\n  return node\n}\n"],"file":"nodes.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/redux/nodes.js"],"names":["store","require","getNodes","nodes","getState","Array","from","values","exports","getNode","id","get","getNodesByType","type","nodesByType","getTypes","keys","hasNodeChanged","digest","node","internal","contentDigest","getNodeAndSavePathDependency","path","createPageDependency","nodeId"],"mappings":";;AAEA,MAAM;AAAEA,EAAAA;AAAF,IAAYC,OAAO,CAAE,SAAF,CAAzB;AAEA;;;;;;;AAKA,MAAMC,QAAQ,GAAG,MAAM;AACrB,QAAMC,KAAK,GAAGH,KAAK,CAACI,QAAN,GAAiBD,KAA/B;;AACA,MAAIA,KAAJ,EAAW;AACT,WAAOE,KAAK,CAACC,IAAN,CAAWH,KAAK,CAACI,MAAN,EAAX,CAAP;AACD,GAFD,MAEO;AACL,WAAO,EAAP;AACD;AACF,CAPD;;AASAC,OAAO,CAACN,QAAR,GAAmBA,QAAnB;AAEA;;;;;;AAKA,MAAMO,OAAO,GAAGC,EAAE,IAAIV,KAAK,CAACI,QAAN,GAAiBD,KAAjB,CAAuBQ,GAAvB,CAA2BD,EAA3B,CAAtB;;AAEAF,OAAO,CAACC,OAAR,GAAkBA,OAAlB;AAEA;;;;;;;AAMA,MAAMG,cAAc,GAAGC,IAAI,IAAI;AAC7B,QAAMV,KAAK,GAAGH,KAAK,CAACI,QAAN,GAAiBU,WAAjB,CAA6BH,GAA7B,CAAiCE,IAAjC,CAAd;;AACA,MAAIV,KAAJ,EAAW;AACT,WAAOE,KAAK,CAACC,IAAN,CAAWH,KAAK,CAACI,MAAN,EAAX,CAAP;AACD,GAFD,MAEO;AACL,WAAO,EAAP;AACD;AACF,CAPD;;AASAC,OAAO,CAACI,cAAR,GAAyBA,cAAzB;AAEA;;;;;;AAKA,MAAMG,QAAQ,GAAG,MAAMV,KAAK,CAACC,IAAN,CAAWN,KAAK,CAACI,QAAN,GAAiBU,WAAjB,CAA6BE,IAA7B,EAAX,CAAvB;;AAEAR,OAAO,CAACO,QAAR,GAAmBA,QAAnB;AAEA;;;;;;;;AAOAP,OAAO,CAACS,cAAR,GAAyB,CAACP,EAAD,EAAKQ,MAAL,KAAgB;AACvC,QAAMC,IAAI,GAAGnB,KAAK,CAACI,QAAN,GAAiBD,KAAjB,CAAuBQ,GAAvB,CAA2BD,EAA3B,CAAb;;AACA,MAAI,CAACS,IAAL,EAAW;AACT,WAAO,IAAP;AACD,GAFD,MAEO;AACL,WAAOA,IAAI,CAACC,QAAL,CAAcC,aAAd,KAAgCH,MAAvC;AACD;AACF,CAPD;AASA;;;;;;;;;AAOAV,OAAO,CAACc,4BAAR,GAAuC,CAACZ,EAAD,EAAKa,IAAL,KAAc;AACnD,QAAMC,oBAAoB,GAAGvB,OAAO,CAAE,+BAAF,CAApC;;AACA,QAAMkB,IAAI,GAAGV,OAAO,CAACC,EAAD,CAApB;AACAc,EAAAA,oBAAoB,CAAC;AAAED,IAAAA,IAAF;AAAQE,IAAAA,MAAM,EAAEf;AAAhB,GAAD,CAApB;AACA,SAAOS,IAAP;AACD,CALD","sourcesContent":["/* @flow */\n\nconst { store } = require(`./index`)\n\n/**\n * Get all nodes from redux store.\n *\n * @returns {Array}\n */\nconst getNodes = () => {\n  const nodes = store.getState().nodes\n  if (nodes) {\n    return Array.from(nodes.values())\n  } else {\n    return []\n  }\n}\n\nexports.getNodes = getNodes\n\n/** Get node by id from store.\n *\n * @param {string} id\n * @returns {Object}\n */\nconst getNode = id => store.getState().nodes.get(id)\n\nexports.getNode = getNode\n\n/**\n * Get all nodes of type from redux store.\n *\n * @param {string} type\n * @returns {Array}\n */\nconst getNodesByType = type => {\n  const nodes = store.getState().nodesByType.get(type)\n  if (nodes) {\n    return Array.from(nodes.values())\n  } else {\n    return []\n  }\n}\n\nexports.getNodesByType = getNodesByType\n\n/**\n * Get all type names from redux store.\n *\n * @returns {Array}\n */\nconst getTypes = () => Array.from(store.getState().nodesByType.keys())\n\nexports.getTypes = getTypes\n\n/**\n * Determine if node has changed.\n *\n * @param {string} id\n * @param {string} digest\n * @returns {boolean}\n */\nexports.hasNodeChanged = (id, digest) => {\n  const node = store.getState().nodes.get(id)\n  if (!node) {\n    return true\n  } else {\n    return node.internal.contentDigest !== digest\n  }\n}\n\n/**\n * Get node and save path dependency.\n *\n * @param {string} id\n * @param {string} path\n * @returns {Object} node\n */\nexports.getNodeAndSavePathDependency = (id, path) => {\n  const createPageDependency = require(`./actions/add-page-dependency`)\n  const node = getNode(id)\n  createPageDependency({ path, nodeId: id })\n  return node\n}\n"],"file":"nodes.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/redux/plugin-runner.js b/node_modules/gatsby/dist/redux/plugin-runner.js
index 6945ca2..c806517 100644
--- a/node_modules/gatsby/dist/redux/plugin-runner.js
+++ b/node_modules/gatsby/dist/redux/plugin-runner.js
@@ -1,11 +1,13 @@
 "use strict";
 
 // Invoke plugins for certain actions.
-const _require = require(`./index`),
-      emitter = _require.emitter;
+const {
+  emitter
+} = require(`./index`);
 
-const _require2 = require(`../db/nodes`),
-      getNode = _require2.getNode;
+const {
+  getNode
+} = require(`../db/nodes`);
 
 const apiRunnerNode = require(`../utils/api-runner-node`);
 
diff --git a/node_modules/gatsby/dist/redux/plugin-runner.js.map b/node_modules/gatsby/dist/redux/plugin-runner.js.map
index dfb03d8..9df6a45 100644
--- a/node_modules/gatsby/dist/redux/plugin-runner.js.map
+++ b/node_modules/gatsby/dist/redux/plugin-runner.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/redux/plugin-runner.js"],"names":["require","emitter","getNode","apiRunnerNode","on","action","node","payload","id","traceTags","nodeId","nodeType","internal","type","traceId","parentSpan","page","plugin","name"],"mappings":";;AAAA;iBAEoBA,OAAO,CAAE,SAAF,C;MAAnBC,O,YAAAA,O;;kBACYD,OAAO,CAAE,aAAF,C;MAAnBE,O,aAAAA,O;;AACR,MAAMC,aAAa,GAAGH,OAAO,CAAE,0BAAF,CAA7B;;AAEAC,OAAO,CAACG,EAAR,CAAY,aAAZ,EAA0BC,MAAM,IAAI;AAClC,QAAMC,IAAI,GAAGJ,OAAO,CAACG,MAAM,CAACE,OAAP,CAAeC,EAAhB,CAApB;AACA,QAAMC,SAAS,GAAG;AAAEC,IAAAA,MAAM,EAAEJ,IAAI,CAACE,EAAf;AAAmBG,IAAAA,QAAQ,EAAEL,IAAI,CAACM,QAAL,CAAcC;AAA3C,GAAlB;AACAV,EAAAA,aAAa,CAAE,cAAF,EAAiB;AAC5BG,IAAAA,IAD4B;AAE5BQ,IAAAA,OAAO,EAAET,MAAM,CAACS,OAFY;AAG5BC,IAAAA,UAAU,EAAEV,MAAM,CAACU,UAHS;AAI5BN,IAAAA;AAJ4B,GAAjB,CAAb;AAMD,CATD;AAWAR,OAAO,CAACG,EAAR,CAAY,aAAZ,EAA0BC,MAAM,IAAI;AAClC,QAAMW,IAAI,GAAGX,MAAM,CAACE,OAApB;AACAJ,EAAAA,aAAa,CACV,cADU,EAEX;AAAEa,IAAAA,IAAF;AAAQF,IAAAA,OAAO,EAAET,MAAM,CAACS,OAAxB;AAAiCC,IAAAA,UAAU,EAAEV,MAAM,CAACU;AAApD,GAFW,EAGXV,MAAM,CAACY,MAAP,CAAcC,IAHH,CAAb;AAKD,CAPD","sourcesContent":["// Invoke plugins for certain actions.\n\nconst { emitter } = require(`./index`)\nconst { getNode } = require(`../db/nodes`)\nconst apiRunnerNode = require(`../utils/api-runner-node`)\n\nemitter.on(`CREATE_NODE`, action => {\n  const node = getNode(action.payload.id)\n  const traceTags = { nodeId: node.id, nodeType: node.internal.type }\n  apiRunnerNode(`onCreateNode`, {\n    node,\n    traceId: action.traceId,\n    parentSpan: action.parentSpan,\n    traceTags,\n  })\n})\n\nemitter.on(`CREATE_PAGE`, action => {\n  const page = action.payload\n  apiRunnerNode(\n    `onCreatePage`,\n    { page, traceId: action.traceId, parentSpan: action.parentSpan },\n    action.plugin.name\n  )\n})\n"],"file":"plugin-runner.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/redux/plugin-runner.js"],"names":["emitter","require","getNode","apiRunnerNode","on","action","node","payload","id","traceTags","nodeId","nodeType","internal","type","traceId","parentSpan","page","plugin","name"],"mappings":";;AAAA;AAEA,MAAM;AAAEA,EAAAA;AAAF,IAAcC,OAAO,CAAE,SAAF,CAA3B;;AACA,MAAM;AAAEC,EAAAA;AAAF,IAAcD,OAAO,CAAE,aAAF,CAA3B;;AACA,MAAME,aAAa,GAAGF,OAAO,CAAE,0BAAF,CAA7B;;AAEAD,OAAO,CAACI,EAAR,CAAY,aAAZ,EAA0BC,MAAM,IAAI;AAClC,QAAMC,IAAI,GAAGJ,OAAO,CAACG,MAAM,CAACE,OAAP,CAAeC,EAAhB,CAApB;AACA,QAAMC,SAAS,GAAG;AAAEC,IAAAA,MAAM,EAAEJ,IAAI,CAACE,EAAf;AAAmBG,IAAAA,QAAQ,EAAEL,IAAI,CAACM,QAAL,CAAcC;AAA3C,GAAlB;AACAV,EAAAA,aAAa,CAAE,cAAF,EAAiB;AAC5BG,IAAAA,IAD4B;AAE5BQ,IAAAA,OAAO,EAAET,MAAM,CAACS,OAFY;AAG5BC,IAAAA,UAAU,EAAEV,MAAM,CAACU,UAHS;AAI5BN,IAAAA;AAJ4B,GAAjB,CAAb;AAMD,CATD;AAWAT,OAAO,CAACI,EAAR,CAAY,aAAZ,EAA0BC,MAAM,IAAI;AAClC,QAAMW,IAAI,GAAGX,MAAM,CAACE,OAApB;AACAJ,EAAAA,aAAa,CACV,cADU,EAEX;AAAEa,IAAAA,IAAF;AAAQF,IAAAA,OAAO,EAAET,MAAM,CAACS,OAAxB;AAAiCC,IAAAA,UAAU,EAAEV,MAAM,CAACU;AAApD,GAFW,EAGXV,MAAM,CAACY,MAAP,CAAcC,IAHH,CAAb;AAKD,CAPD","sourcesContent":["// Invoke plugins for certain actions.\n\nconst { emitter } = require(`./index`)\nconst { getNode } = require(`../db/nodes`)\nconst apiRunnerNode = require(`../utils/api-runner-node`)\n\nemitter.on(`CREATE_NODE`, action => {\n  const node = getNode(action.payload.id)\n  const traceTags = { nodeId: node.id, nodeType: node.internal.type }\n  apiRunnerNode(`onCreateNode`, {\n    node,\n    traceId: action.traceId,\n    parentSpan: action.parentSpan,\n    traceTags,\n  })\n})\n\nemitter.on(`CREATE_PAGE`, action => {\n  const page = action.payload\n  apiRunnerNode(\n    `onCreatePage`,\n    { page, traceId: action.traceId, parentSpan: action.parentSpan },\n    action.plugin.name\n  )\n})\n"],"file":"plugin-runner.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/redux/prepare-nodes.js b/node_modules/gatsby/dist/redux/prepare-nodes.js
index 12873e8..0377212 100644
--- a/node_modules/gatsby/dist/redux/prepare-nodes.js
+++ b/node_modules/gatsby/dist/redux/prepare-nodes.js
@@ -2,15 +2,18 @@
 
 const _ = require(`lodash`);
 
-const _require = require(`../db/node-tracking`),
-      trackInlineObjectsInRootNode = _require.trackInlineObjectsInRootNode;
+const {
+  trackInlineObjectsInRootNode
+} = require(`../db/node-tracking`);
 
-const _require2 = require(`../redux`),
-      store = _require2.store;
+const {
+  store
+} = require(`../redux`);
 
-const _require3 = require(`graphql`),
-      getNullableType = _require3.getNullableType,
-      getNamedType = _require3.getNamedType;
+const {
+  getNullableType,
+  getNamedType
+} = require(`graphql`);
 
 const withResolverContext = require(`../schema/context`);
 
@@ -20,10 +23,11 @@ const enhancedNodePromiseCache = new Map();
 const enhancedNodeCacheId = ({
   node,
   args
-}) => node && node.internal && node.internal.contentDigest ? JSON.stringify(Object.assign({
+}) => node && node.internal && node.internal.contentDigest ? JSON.stringify({
   nodeid: node.id,
-  digest: node.internal.contentDigest
-}, args)) : null; /////////////////////////////////////////////////////////////////////
+  digest: node.internal.contentDigest,
+  ...args
+}) : null; /////////////////////////////////////////////////////////////////////
 // Resolve nodes
 /////////////////////////////////////////////////////////////////////
 
@@ -32,9 +36,9 @@ function awaitSiftField(fields, node, k) {
   const field = fields[k];
 
   if (field.resolve) {
-    const _store$getState = store.getState(),
-          schema = _store$getState.schema;
-
+    const {
+      schema
+    } = store.getState();
     return field.resolve(node, {}, withResolverContext({}, schema), {
       fieldName: k,
       schema,
@@ -67,23 +71,25 @@ function resolveRecursive(node, siftFieldsObj, gqFields) {
 
     return v;
   }).then(v => [k, v]))).then(resolvedFields => {
-    const myNode = Object.assign({}, node);
+    const myNode = { ...node
+    };
     resolvedFields.forEach(([k, v]) => myNode[k] = v);
     return myNode;
   });
 }
 
 function resolveNodes(nodes, typeName, firstOnly, fieldsToSift, gqlFields) {
-  const _store$getState2 = store.getState(),
-        resolvedNodesCache = _store$getState2.resolvedNodesCache;
-
-  const nodesCacheKey = JSON.stringify(Object.assign({
+  const {
+    resolvedNodesCache
+  } = store.getState();
+  const nodesCacheKey = JSON.stringify({
     // typeName + count being the same is a pretty good
     // indication that the nodes are the same.
     typeName,
     firstOnly,
-    nodesLength: nodes.length
-  }, fieldsToSift));
+    nodesLength: nodes.length,
+    ...fieldsToSift
+  });
 
   if (resolvedNodesCache.has(nodesCacheKey)) {
     return Promise.resolve(resolvedNodesCache.get(nodesCacheKey));
diff --git a/node_modules/gatsby/dist/redux/prepare-nodes.js.map b/node_modules/gatsby/dist/redux/prepare-nodes.js.map
index d5231e7..cb83cba 100644
--- a/node_modules/gatsby/dist/redux/prepare-nodes.js.map
+++ b/node_modules/gatsby/dist/redux/prepare-nodes.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/redux/prepare-nodes.js"],"names":["_","require","trackInlineObjectsInRootNode","store","getNullableType","getNamedType","withResolverContext","enhancedNodeCache","Map","enhancedNodePromiseCache","enhancedNodeCacheId","node","args","internal","contentDigest","JSON","stringify","nodeid","id","digest","awaitSiftField","fields","k","field","resolve","getState","schema","fieldName","returnType","type","undefined","resolveRecursive","siftFieldsObj","gqFields","Promise","all","keys","map","then","v","innerSift","innerGqConfig","innerType","innerListType","isObject","isFunction","getFields","isArray","item","resolvedFields","myNode","forEach","resolveNodes","nodes","typeName","firstOnly","fieldsToSift","gqlFields","resolvedNodesCache","nodesCacheKey","nodesLength","length","has","get","cacheKey","enhancedNodeGenerationPromise","resolvedNode","set","resolvedNodes","dispatch","payload","key","module","exports"],"mappings":"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","sourcesContent":["const _ = require(`lodash`)\nconst { trackInlineObjectsInRootNode } = require(`../db/node-tracking`)\nconst { store } = require(`../redux`)\nconst { getNullableType, getNamedType } = require(`graphql`)\nconst withResolverContext = require(`../schema/context`)\n\nconst enhancedNodeCache = new Map()\nconst enhancedNodePromiseCache = new Map()\nconst enhancedNodeCacheId = ({ node, args }) =>\n  node && node.internal && node.internal.contentDigest\n    ? JSON.stringify({\n        nodeid: node.id,\n        digest: node.internal.contentDigest,\n        ...args,\n      })\n    : null\n\n/////////////////////////////////////////////////////////////////////\n// Resolve nodes\n/////////////////////////////////////////////////////////////////////\n\nfunction awaitSiftField(fields, node, k) {\n  const field = fields[k]\n  if (field.resolve) {\n    const { schema } = store.getState()\n    return field.resolve(node, {}, withResolverContext({}, schema), {\n      fieldName: k,\n      schema,\n      returnType: field.type,\n    })\n  } else if (node[k] !== undefined) {\n    return node[k]\n  }\n\n  return undefined\n}\n\n// Resolves every field used in the node.\nfunction resolveRecursive(node, siftFieldsObj, gqFields) {\n  return Promise.all(\n    _.keys(siftFieldsObj).map(k =>\n      Promise.resolve(awaitSiftField(gqFields, node, k))\n        .then(v => {\n          const innerSift = siftFieldsObj[k]\n          const innerGqConfig = gqFields[k]\n\n          const innerType = getNullableType(innerGqConfig.type)\n          const innerListType = getNamedType(innerType)\n          if (_.isObject(innerSift) && v != null && innerType) {\n            if (_.isFunction(innerType.getFields)) {\n              // this is single object\n              return resolveRecursive(v, innerSift, innerType.getFields())\n            } else if (_.isArray(v) && _.isFunction(innerListType.getFields)) {\n              // this is array\n              return Promise.all(\n                v.map(item =>\n                  resolveRecursive(item, innerSift, innerListType.getFields())\n                )\n              )\n            }\n          }\n\n          return v\n        })\n        .then(v => [k, v])\n    )\n  ).then(resolvedFields => {\n    const myNode = {\n      ...node,\n    }\n    resolvedFields.forEach(([k, v]) => (myNode[k] = v))\n    return myNode\n  })\n}\n\nfunction resolveNodes(nodes, typeName, firstOnly, fieldsToSift, gqlFields) {\n  const { resolvedNodesCache } = store.getState()\n  const nodesCacheKey = JSON.stringify({\n    // typeName + count being the same is a pretty good\n    // indication that the nodes are the same.\n    typeName,\n    firstOnly,\n    nodesLength: nodes.length,\n    ...fieldsToSift,\n  })\n  if (resolvedNodesCache.has(nodesCacheKey)) {\n    return Promise.resolve(resolvedNodesCache.get(nodesCacheKey))\n  } else {\n    return Promise.all(\n      nodes.map(node => {\n        const cacheKey = enhancedNodeCacheId({\n          node,\n          args: fieldsToSift,\n        })\n        if (cacheKey && enhancedNodeCache.has(cacheKey)) {\n          return Promise.resolve(enhancedNodeCache.get(cacheKey))\n        } else if (cacheKey && enhancedNodePromiseCache.has(cacheKey)) {\n          return enhancedNodePromiseCache.get(cacheKey)\n        }\n\n        const enhancedNodeGenerationPromise = new Promise(resolve => {\n          resolveRecursive(node, fieldsToSift, gqlFields).then(resolvedNode => {\n            trackInlineObjectsInRootNode(resolvedNode)\n            if (cacheKey) {\n              enhancedNodeCache.set(cacheKey, resolvedNode)\n            }\n            resolve(resolvedNode)\n          })\n        })\n        enhancedNodePromiseCache.set(cacheKey, enhancedNodeGenerationPromise)\n        return enhancedNodeGenerationPromise\n      })\n    ).then(resolvedNodes => {\n      store.dispatch({\n        type: `SET_RESOLVED_NODES`,\n        payload: {\n          key: nodesCacheKey,\n          nodes: resolvedNodes,\n        },\n      })\n      return resolvedNodes\n    })\n  }\n}\n\nmodule.exports = {\n  resolveNodes,\n  resolveRecursive,\n}\n"],"file":"prepare-nodes.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/redux/prepare-nodes.js"],"names":["_","require","trackInlineObjectsInRootNode","store","getNullableType","getNamedType","withResolverContext","enhancedNodeCache","Map","enhancedNodePromiseCache","enhancedNodeCacheId","node","args","internal","contentDigest","JSON","stringify","nodeid","id","digest","awaitSiftField","fields","k","field","resolve","schema","getState","fieldName","returnType","type","undefined","resolveRecursive","siftFieldsObj","gqFields","Promise","all","keys","map","then","v","innerSift","innerGqConfig","innerType","innerListType","isObject","isFunction","getFields","isArray","item","resolvedFields","myNode","forEach","resolveNodes","nodes","typeName","firstOnly","fieldsToSift","gqlFields","resolvedNodesCache","nodesCacheKey","nodesLength","length","has","get","cacheKey","enhancedNodeGenerationPromise","resolvedNode","set","resolvedNodes","dispatch","payload","key","module","exports"],"mappings":"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","sourcesContent":["const _ = require(`lodash`)\nconst { trackInlineObjectsInRootNode } = require(`../db/node-tracking`)\nconst { store } = require(`../redux`)\nconst { getNullableType, getNamedType } = require(`graphql`)\nconst withResolverContext = require(`../schema/context`)\n\nconst enhancedNodeCache = new Map()\nconst enhancedNodePromiseCache = new Map()\nconst enhancedNodeCacheId = ({ node, args }) =>\n  node && node.internal && node.internal.contentDigest\n    ? JSON.stringify({\n        nodeid: node.id,\n        digest: node.internal.contentDigest,\n        ...args,\n      })\n    : null\n\n/////////////////////////////////////////////////////////////////////\n// Resolve nodes\n/////////////////////////////////////////////////////////////////////\n\nfunction awaitSiftField(fields, node, k) {\n  const field = fields[k]\n  if (field.resolve) {\n    const { schema } = store.getState()\n    return field.resolve(node, {}, withResolverContext({}, schema), {\n      fieldName: k,\n      schema,\n      returnType: field.type,\n    })\n  } else if (node[k] !== undefined) {\n    return node[k]\n  }\n\n  return undefined\n}\n\n// Resolves every field used in the node.\nfunction resolveRecursive(node, siftFieldsObj, gqFields) {\n  return Promise.all(\n    _.keys(siftFieldsObj).map(k =>\n      Promise.resolve(awaitSiftField(gqFields, node, k))\n        .then(v => {\n          const innerSift = siftFieldsObj[k]\n          const innerGqConfig = gqFields[k]\n\n          const innerType = getNullableType(innerGqConfig.type)\n          const innerListType = getNamedType(innerType)\n          if (_.isObject(innerSift) && v != null && innerType) {\n            if (_.isFunction(innerType.getFields)) {\n              // this is single object\n              return resolveRecursive(v, innerSift, innerType.getFields())\n            } else if (_.isArray(v) && _.isFunction(innerListType.getFields)) {\n              // this is array\n              return Promise.all(\n                v.map(item =>\n                  resolveRecursive(item, innerSift, innerListType.getFields())\n                )\n              )\n            }\n          }\n\n          return v\n        })\n        .then(v => [k, v])\n    )\n  ).then(resolvedFields => {\n    const myNode = {\n      ...node,\n    }\n    resolvedFields.forEach(([k, v]) => (myNode[k] = v))\n    return myNode\n  })\n}\n\nfunction resolveNodes(nodes, typeName, firstOnly, fieldsToSift, gqlFields) {\n  const { resolvedNodesCache } = store.getState()\n  const nodesCacheKey = JSON.stringify({\n    // typeName + count being the same is a pretty good\n    // indication that the nodes are the same.\n    typeName,\n    firstOnly,\n    nodesLength: nodes.length,\n    ...fieldsToSift,\n  })\n  if (resolvedNodesCache.has(nodesCacheKey)) {\n    return Promise.resolve(resolvedNodesCache.get(nodesCacheKey))\n  } else {\n    return Promise.all(\n      nodes.map(node => {\n        const cacheKey = enhancedNodeCacheId({\n          node,\n          args: fieldsToSift,\n        })\n        if (cacheKey && enhancedNodeCache.has(cacheKey)) {\n          return Promise.resolve(enhancedNodeCache.get(cacheKey))\n        } else if (cacheKey && enhancedNodePromiseCache.has(cacheKey)) {\n          return enhancedNodePromiseCache.get(cacheKey)\n        }\n\n        const enhancedNodeGenerationPromise = new Promise(resolve => {\n          resolveRecursive(node, fieldsToSift, gqlFields).then(resolvedNode => {\n            trackInlineObjectsInRootNode(resolvedNode)\n            if (cacheKey) {\n              enhancedNodeCache.set(cacheKey, resolvedNode)\n            }\n            resolve(resolvedNode)\n          })\n        })\n        enhancedNodePromiseCache.set(cacheKey, enhancedNodeGenerationPromise)\n        return enhancedNodeGenerationPromise\n      })\n    ).then(resolvedNodes => {\n      store.dispatch({\n        type: `SET_RESOLVED_NODES`,\n        payload: {\n          key: nodesCacheKey,\n          nodes: resolvedNodes,\n        },\n      })\n      return resolvedNodes\n    })\n  }\n}\n\nmodule.exports = {\n  resolveNodes,\n  resolveRecursive,\n}\n"],"file":"prepare-nodes.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/redux/reducers/babelrc.js b/node_modules/gatsby/dist/redux/reducers/babelrc.js
index 3ec29a2..b4b0a77 100644
--- a/node_modules/gatsby/dist/redux/reducers/babelrc.js
+++ b/node_modules/gatsby/dist/redux/reducers/babelrc.js
@@ -94,7 +94,9 @@ module.exports = (state = {
             return;
           }
 
-          state.stages[stage].options = Object.assign({}, state.stages[stage].options, action.payload.options);
+          state.stages[stage].options = { ...state.stages[stage].options,
+            ...action.payload.options
+          };
         });
         return state;
       }
diff --git a/node_modules/gatsby/dist/redux/reducers/babelrc.js.map b/node_modules/gatsby/dist/redux/reducers/babelrc.js.map
index 195393f..3743bcd 100644
--- a/node_modules/gatsby/dist/redux/reducers/babelrc.js.map
+++ b/node_modules/gatsby/dist/redux/reducers/babelrc.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/redux/reducers/babelrc.js"],"names":["_","require","module","exports","state","stages","develop","plugins","presets","options","cacheDirectory","sourceType","action","type","Object","keys","forEach","stage","payload","index","findIndex","p","name","plugin","merge"],"mappings":"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","sourcesContent":["const _ = require(`lodash`)\n\nmodule.exports = (\n  state = {\n    stages: {\n      develop: {\n        plugins: [],\n        presets: [],\n        options: {\n          cacheDirectory: true,\n          sourceType: `unambiguous`,\n        },\n      },\n      \"develop-html\": {\n        plugins: [],\n        presets: [],\n        options: {\n          cacheDirectory: true,\n          sourceType: `unambiguous`,\n        },\n      },\n      \"build-html\": {\n        plugins: [],\n        presets: [],\n        options: {\n          cacheDirectory: true,\n          sourceType: `unambiguous`,\n        },\n      },\n      \"build-javascript\": {\n        plugins: [],\n        presets: [],\n        options: {\n          cacheDirectory: true,\n          sourceType: `unambiguous`,\n        },\n      },\n    },\n  },\n  action\n) => {\n  switch (action.type) {\n    case `SET_BABEL_PLUGIN`: {\n      Object.keys(state.stages).forEach(stage => {\n        if (action.payload.stage && action.payload.stage !== stage) {\n          return\n        }\n\n        const index = _.findIndex(\n          state.stages[stage].plugins,\n          p => p.name === action.payload.name\n        )\n        // If the plugin already exists, merge the options.\n        // Otherwise, add it to the end.\n        if (index !== -1) {\n          const plugin = state.stages[stage].plugins[index]\n          state.stages[stage].plugins[index] = {\n            name: plugin.name,\n            options: _.merge(plugin.options, action.payload.options),\n          }\n        } else {\n          state.stages[stage].plugins = [\n            ...state.stages[stage].plugins,\n            action.payload,\n          ]\n        }\n      })\n\n      return state\n    }\n    case `SET_BABEL_PRESET`: {\n      Object.keys(state.stages).forEach(stage => {\n        if (action.payload.stage && action.payload.stage !== stage) {\n          return\n        }\n\n        const index = _.findIndex(\n          state.stages[stage].presets,\n          p => p.name === action.payload.name\n        )\n        // If the plugin already exists, merge the options.\n        // Otherwise, add it to the end.\n        if (index !== -1) {\n          const plugin = state.stages[stage].presets[index]\n          state.stages[stage].presets[index] = {\n            name: plugin.name,\n            options: _.merge(plugin.options, action.payload.options),\n          }\n        } else {\n          state.stages[stage].presets = [\n            ...state.stages[stage].presets,\n            action.payload,\n          ]\n        }\n      })\n      return state\n    }\n    case `SET_BABEL_OPTIONS`: {\n      Object.keys(state.stages).forEach(stage => {\n        if (action.payload.stage && action.payload.stage !== stage) {\n          return\n        }\n\n        state.stages[stage].options = {\n          ...state.stages[stage].options,\n          ...action.payload.options,\n        }\n      })\n      return state\n    }\n  }\n\n  return state\n}\n"],"file":"babelrc.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/redux/reducers/babelrc.js"],"names":["_","require","module","exports","state","stages","develop","plugins","presets","options","cacheDirectory","sourceType","action","type","Object","keys","forEach","stage","payload","index","findIndex","p","name","plugin","merge"],"mappings":"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","sourcesContent":["const _ = require(`lodash`)\n\nmodule.exports = (\n  state = {\n    stages: {\n      develop: {\n        plugins: [],\n        presets: [],\n        options: {\n          cacheDirectory: true,\n          sourceType: `unambiguous`,\n        },\n      },\n      \"develop-html\": {\n        plugins: [],\n        presets: [],\n        options: {\n          cacheDirectory: true,\n          sourceType: `unambiguous`,\n        },\n      },\n      \"build-html\": {\n        plugins: [],\n        presets: [],\n        options: {\n          cacheDirectory: true,\n          sourceType: `unambiguous`,\n        },\n      },\n      \"build-javascript\": {\n        plugins: [],\n        presets: [],\n        options: {\n          cacheDirectory: true,\n          sourceType: `unambiguous`,\n        },\n      },\n    },\n  },\n  action\n) => {\n  switch (action.type) {\n    case `SET_BABEL_PLUGIN`: {\n      Object.keys(state.stages).forEach(stage => {\n        if (action.payload.stage && action.payload.stage !== stage) {\n          return\n        }\n\n        const index = _.findIndex(\n          state.stages[stage].plugins,\n          p => p.name === action.payload.name\n        )\n        // If the plugin already exists, merge the options.\n        // Otherwise, add it to the end.\n        if (index !== -1) {\n          const plugin = state.stages[stage].plugins[index]\n          state.stages[stage].plugins[index] = {\n            name: plugin.name,\n            options: _.merge(plugin.options, action.payload.options),\n          }\n        } else {\n          state.stages[stage].plugins = [\n            ...state.stages[stage].plugins,\n            action.payload,\n          ]\n        }\n      })\n\n      return state\n    }\n    case `SET_BABEL_PRESET`: {\n      Object.keys(state.stages).forEach(stage => {\n        if (action.payload.stage && action.payload.stage !== stage) {\n          return\n        }\n\n        const index = _.findIndex(\n          state.stages[stage].presets,\n          p => p.name === action.payload.name\n        )\n        // If the plugin already exists, merge the options.\n        // Otherwise, add it to the end.\n        if (index !== -1) {\n          const plugin = state.stages[stage].presets[index]\n          state.stages[stage].presets[index] = {\n            name: plugin.name,\n            options: _.merge(plugin.options, action.payload.options),\n          }\n        } else {\n          state.stages[stage].presets = [\n            ...state.stages[stage].presets,\n            action.payload,\n          ]\n        }\n      })\n      return state\n    }\n    case `SET_BABEL_OPTIONS`: {\n      Object.keys(state.stages).forEach(stage => {\n        if (action.payload.stage && action.payload.stage !== stage) {\n          return\n        }\n\n        state.stages[stage].options = {\n          ...state.stages[stage].options,\n          ...action.payload.options,\n        }\n      })\n      return state\n    }\n  }\n\n  return state\n}\n"],"file":"babelrc.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/redux/reducers/components.js b/node_modules/gatsby/dist/redux/reducers/components.js
index 7f73e40..7199a22 100644
--- a/node_modules/gatsby/dist/redux/reducers/components.js
+++ b/node_modules/gatsby/dist/redux/reducers/components.js
@@ -1,33 +1,150 @@
 "use strict";
 
-const _ = require(`lodash`);
-
 const normalize = require(`normalize-path`);
 
+const {
+  interpret
+} = require(`xstate`);
+
+const componentMachine = require(`../machines/page-component`);
+
+const services = new Map();
+let programStatus = `BOOTSTRAPPING`;
+
 module.exports = (state = new Map(), action) => {
   switch (action.type) {
     case `DELETE_CACHE`:
       return new Map();
 
-    case `CREATE_PAGE`:
-      action.payload.componentPath = normalize(action.payload.component);
-      state.set(action.payload.componentPath, _.merge({
-        query: ``
-      }, state.get(action.payload.componentPath), {
-        componentPath: action.payload.componentPath
-      }));
+    case `SET_PROGRAM_STATUS`:
+      programStatus = action.payload;
+
+      if (programStatus === `BOOTSTRAP_QUERY_RUNNING_FINISHED`) {
+        services.forEach(s => s.send(`BOOTSTRAP_FINISHED`));
+      }
+
       return state;
 
+    case `CREATE_PAGE`:
+      {
+        action.payload.componentPath = normalize(action.payload.component); // Create XState service.
+
+        let service;
+
+        if (!services.has(action.payload.componentPath)) {
+          var _state$get;
+
+          const machine = componentMachine.withContext({
+            componentPath: action.payload.componentPath,
+            query: ((_state$get = state.get(action.payload.componentPath)) === null || _state$get === void 0 ? void 0 : _state$get.query) || ``,
+            pages: [action.payload.path],
+            isInBootstrap: programStatus === `BOOTSTRAPPING`
+          });
+          service = interpret(machine).start(); // .onTransition(nextState => {
+          // console.log(
+          // `component machine value`,
+          // _.pick(nextState, [`value`, `context`, `event`])
+          // )
+          // })
+          // .start()
+
+          services.set(action.payload.componentPath, service);
+        } else {
+          service = services.get(action.payload.componentPath);
+
+          if (!service.state.context.pages.includes(action.payload.path)) {
+            service.send({
+              type: `NEW_PAGE_CREATED`,
+              path: action.payload.path
+            });
+          }
+        }
+
+        state.set(action.payload.componentPath, Object.assign({
+          query: ``
+        }, service.state.context));
+        return state;
+      }
+
+    case `QUERY_EXTRACTED`:
+      {
+        action.payload.componentPath = normalize(action.payload.componentPath);
+        const service = services.get(action.payload.componentPath);
+
+        if (service.state.value === `queryExtractionBabelError`) {
+          // Do nothing until the babel error is fixed.
+          return state;
+        } // Check if the query has changed or not.
+
+
+        if (service.state.context.query === action.payload.query) {
+          service.send(`QUERY_DID_NOT_CHANGE`);
+        } else {
+          service.send({
+            type: `QUERY_CHANGED`,
+            query: action.payload.query
+          });
+        }
+
+        state.set(action.payload.componentPath, { ...service.state.context
+        });
+        return state;
+      }
+
+    case `QUERY_EXTRACTION_BABEL_SUCCESS`:
+    case `QUERY_EXTRACTION_BABEL_ERROR`:
+    case `QUERY_EXTRACTION_GRAPHQL_ERROR`:
+      {
+        let servicesToSendEventTo;
+
+        if (typeof action.payload.componentPath !== `string` && action.type === `QUERY_EXTRACTION_GRAPHQL_ERROR`) {
+          // if this is globabl query extraction error, send it to all page component services
+          servicesToSendEventTo = services;
+        } else {
+          action.payload.componentPath = normalize(action.payload.componentPath);
+          servicesToSendEventTo = [services.get(action.payload.componentPath)].filter(Boolean);
+        }
+
+        servicesToSendEventTo.forEach(service => service.send({
+          type: action.type,
+          ...action.payload
+        }));
+        return state;
+      }
+
+    case `PAGE_QUERY_RUN`:
+      {
+        if (action.payload.isPage) {
+          action.payload.componentPath = normalize(action.payload.componentPath);
+          const service = services.get(action.payload.componentPath); // TODO we want to keep track of whether there's any outstanding queries still
+          // running as this will mark queries as complete immediately even though
+          // a page component could have thousands of pages will processing.
+          // This can be done once we start modeling Pages as well.
+
+          service.send({
+            type: `QUERIES_COMPLETE`
+          });
+        }
+
+        return state;
+      }
+
     case `REMOVE_TEMPLATE_COMPONENT`:
-      state.delete(normalize(action.payload.componentPath));
-      return state;
+      {
+        action.payload.componentPath = normalize(action.payload.componentPath);
+        state.delete(action.payload.componentPath);
+        return state;
+      }
 
-    case `REPLACE_COMPONENT_QUERY`:
-      action.payload.componentPath = normalize(action.payload.componentPath);
-      state.set(action.payload.componentPath, Object.assign({}, state.get(action.payload.componentPath), {
-        query: action.payload.query
-      }));
-      return state;
+    case `DELETE_PAGE`:
+      {
+        const service = services.get(normalize(action.payload.component));
+        service.send({
+          type: `DELETE_PAGE`,
+          page: action.payload
+        });
+        return state;
+      }
   }
 
   return state;
diff --git a/node_modules/gatsby/dist/redux/reducers/components.js.map b/node_modules/gatsby/dist/redux/reducers/components.js.map
index fd2c044..9bf8203 100644
--- a/node_modules/gatsby/dist/redux/reducers/components.js.map
+++ b/node_modules/gatsby/dist/redux/reducers/components.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/redux/reducers/components.js"],"names":["_","require","normalize","module","exports","state","Map","action","type","payload","componentPath","component","set","merge","query","get","delete"],"mappings":";;AAAA,MAAMA,CAAC,GAAGC,OAAO,CAAE,QAAF,CAAjB;;AACA,MAAMC,SAAS,GAAGD,OAAO,CAAE,gBAAF,CAAzB;;AAEAE,MAAM,CAACC,OAAP,GAAiB,CAACC,KAAK,GAAG,IAAIC,GAAJ,EAAT,EAAoBC,MAApB,KAA+B;AAC9C,UAAQA,MAAM,CAACC,IAAf;AACE,SAAM,cAAN;AACE,aAAO,IAAIF,GAAJ,EAAP;;AACF,SAAM,aAAN;AACEC,MAAAA,MAAM,CAACE,OAAP,CAAeC,aAAf,GAA+BR,SAAS,CAACK,MAAM,CAACE,OAAP,CAAeE,SAAhB,CAAxC;AACAN,MAAAA,KAAK,CAACO,GAAN,CACEL,MAAM,CAACE,OAAP,CAAeC,aADjB,EAEEV,CAAC,CAACa,KAAF,CAAQ;AAAEC,QAAAA,KAAK,EAAG;AAAV,OAAR,EAAuBT,KAAK,CAACU,GAAN,CAAUR,MAAM,CAACE,OAAP,CAAeC,aAAzB,CAAvB,EAAgE;AAC9DA,QAAAA,aAAa,EAAEH,MAAM,CAACE,OAAP,CAAeC;AADgC,OAAhE,CAFF;AAMA,aAAOL,KAAP;;AACF,SAAM,2BAAN;AACEA,MAAAA,KAAK,CAACW,MAAN,CAAad,SAAS,CAACK,MAAM,CAACE,OAAP,CAAeC,aAAhB,CAAtB;AACA,aAAOL,KAAP;;AACF,SAAM,yBAAN;AACEE,MAAAA,MAAM,CAACE,OAAP,CAAeC,aAAf,GAA+BR,SAAS,CAACK,MAAM,CAACE,OAAP,CAAeC,aAAhB,CAAxC;AACAL,MAAAA,KAAK,CAACO,GAAN,CAAUL,MAAM,CAACE,OAAP,CAAeC,aAAzB,oBACKL,KAAK,CAACU,GAAN,CAAUR,MAAM,CAACE,OAAP,CAAeC,aAAzB,CADL;AAEEI,QAAAA,KAAK,EAAEP,MAAM,CAACE,OAAP,CAAeK;AAFxB;AAIA,aAAOT,KAAP;AArBJ;;AAwBA,SAAOA,KAAP;AACD,CA1BD","sourcesContent":["const _ = require(`lodash`)\nconst normalize = require(`normalize-path`)\n\nmodule.exports = (state = new Map(), action) => {\n  switch (action.type) {\n    case `DELETE_CACHE`:\n      return new Map()\n    case `CREATE_PAGE`:\n      action.payload.componentPath = normalize(action.payload.component)\n      state.set(\n        action.payload.componentPath,\n        _.merge({ query: `` }, state.get(action.payload.componentPath), {\n          componentPath: action.payload.componentPath,\n        })\n      )\n      return state\n    case `REMOVE_TEMPLATE_COMPONENT`:\n      state.delete(normalize(action.payload.componentPath))\n      return state\n    case `REPLACE_COMPONENT_QUERY`:\n      action.payload.componentPath = normalize(action.payload.componentPath)\n      state.set(action.payload.componentPath, {\n        ...state.get(action.payload.componentPath),\n        query: action.payload.query,\n      })\n      return state\n  }\n\n  return state\n}\n"],"file":"components.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/redux/reducers/components.js"],"names":["normalize","require","interpret","componentMachine","services","Map","programStatus","module","exports","state","action","type","payload","forEach","s","send","componentPath","component","service","has","machine","withContext","query","get","pages","path","isInBootstrap","start","set","context","includes","Object","assign","value","servicesToSendEventTo","filter","Boolean","isPage","delete","page"],"mappings":";;AAAA,MAAMA,SAAS,GAAGC,OAAO,CAAE,gBAAF,CAAzB;;AACA,MAAM;AAAEC,EAAAA;AAAF,IAAgBD,OAAO,CAAE,QAAF,CAA7B;;AAEA,MAAME,gBAAgB,GAAGF,OAAO,CAAE,4BAAF,CAAhC;;AAEA,MAAMG,QAAQ,GAAG,IAAIC,GAAJ,EAAjB;AACA,IAAIC,aAAa,GAAI,eAArB;;AAEAC,MAAM,CAACC,OAAP,GAAiB,CAACC,KAAK,GAAG,IAAIJ,GAAJ,EAAT,EAAoBK,MAApB,KAA+B;AAC9C,UAAQA,MAAM,CAACC,IAAf;AACE,SAAM,cAAN;AACE,aAAO,IAAIN,GAAJ,EAAP;;AACF,SAAM,oBAAN;AACEC,MAAAA,aAAa,GAAGI,MAAM,CAACE,OAAvB;;AACA,UAAIN,aAAa,KAAM,kCAAvB,EAA0D;AACxDF,QAAAA,QAAQ,CAACS,OAAT,CAAiBC,CAAC,IAAIA,CAAC,CAACC,IAAF,CAAQ,oBAAR,CAAtB;AACD;;AACD,aAAON,KAAP;;AACF,SAAM,aAAN;AAAoB;AAClBC,QAAAA,MAAM,CAACE,OAAP,CAAeI,aAAf,GAA+BhB,SAAS,CAACU,MAAM,CAACE,OAAP,CAAeK,SAAhB,CAAxC,CADkB,CAElB;;AACA,YAAIC,OAAJ;;AACA,YAAI,CAACd,QAAQ,CAACe,GAAT,CAAaT,MAAM,CAACE,OAAP,CAAeI,aAA5B,CAAL,EAAiD;AAAA;;AAC/C,gBAAMI,OAAO,GAAGjB,gBAAgB,CAACkB,WAAjB,CAA6B;AAC3CL,YAAAA,aAAa,EAAEN,MAAM,CAACE,OAAP,CAAeI,aADa;AAE3CM,YAAAA,KAAK,EAAE,eAAAb,KAAK,CAACc,GAAN,CAAUb,MAAM,CAACE,OAAP,CAAeI,aAAzB,2DAAyCM,KAAzC,KAAmD,EAFf;AAG3CE,YAAAA,KAAK,EAAE,CAACd,MAAM,CAACE,OAAP,CAAea,IAAhB,CAHoC;AAI3CC,YAAAA,aAAa,EAAEpB,aAAa,KAAM;AAJS,WAA7B,CAAhB;AAMAY,UAAAA,OAAO,GAAGhB,SAAS,CAACkB,OAAD,CAAT,CAAmBO,KAAnB,EAAV,CAP+C,CAQ/C;AACA;AACA;AACA;AACA;AACA;AACA;;AACAvB,UAAAA,QAAQ,CAACwB,GAAT,CAAalB,MAAM,CAACE,OAAP,CAAeI,aAA5B,EAA2CE,OAA3C;AACD,SAhBD,MAgBO;AACLA,UAAAA,OAAO,GAAGd,QAAQ,CAACmB,GAAT,CAAab,MAAM,CAACE,OAAP,CAAeI,aAA5B,CAAV;;AACA,cAAI,CAACE,OAAO,CAACT,KAAR,CAAcoB,OAAd,CAAsBL,KAAtB,CAA4BM,QAA5B,CAAqCpB,MAAM,CAACE,OAAP,CAAea,IAApD,CAAL,EAAgE;AAC9DP,YAAAA,OAAO,CAACH,IAAR,CAAa;AAAEJ,cAAAA,IAAI,EAAG,kBAAT;AAA4Bc,cAAAA,IAAI,EAAEf,MAAM,CAACE,OAAP,CAAea;AAAjD,aAAb;AACD;AACF;;AAEDhB,QAAAA,KAAK,CAACmB,GAAN,CACElB,MAAM,CAACE,OAAP,CAAeI,aADjB,EAEEe,MAAM,CAACC,MAAP,CACE;AACEV,UAAAA,KAAK,EAAG;AADV,SADF,EAIEJ,OAAO,CAACT,KAAR,CAAcoB,OAJhB,CAFF;AASA,eAAOpB,KAAP;AACD;;AACD,SAAM,iBAAN;AAAwB;AACtBC,QAAAA,MAAM,CAACE,OAAP,CAAeI,aAAf,GAA+BhB,SAAS,CAACU,MAAM,CAACE,OAAP,CAAeI,aAAhB,CAAxC;AACA,cAAME,OAAO,GAAGd,QAAQ,CAACmB,GAAT,CAAab,MAAM,CAACE,OAAP,CAAeI,aAA5B,CAAhB;;AAEA,YAAIE,OAAO,CAACT,KAAR,CAAcwB,KAAd,KAAyB,2BAA7B,EAAyD;AACvD;AACA,iBAAOxB,KAAP;AACD,SAPqB,CAStB;;;AACA,YAAIS,OAAO,CAACT,KAAR,CAAcoB,OAAd,CAAsBP,KAAtB,KAAgCZ,MAAM,CAACE,OAAP,CAAeU,KAAnD,EAA0D;AACxDJ,UAAAA,OAAO,CAACH,IAAR,CAAc,sBAAd;AACD,SAFD,MAEO;AACLG,UAAAA,OAAO,CAACH,IAAR,CAAa;AACXJ,YAAAA,IAAI,EAAG,eADI;AAEXW,YAAAA,KAAK,EAAEZ,MAAM,CAACE,OAAP,CAAeU;AAFX,WAAb;AAID;;AAEDb,QAAAA,KAAK,CAACmB,GAAN,CAAUlB,MAAM,CAACE,OAAP,CAAeI,aAAzB,EAAwC,EACtC,GAAGE,OAAO,CAACT,KAAR,CAAcoB;AADqB,SAAxC;AAGA,eAAOpB,KAAP;AACD;;AACD,SAAM,gCAAN;AACA,SAAM,8BAAN;AACA,SAAM,gCAAN;AAAuC;AACrC,YAAIyB,qBAAJ;;AACA,YACE,OAAOxB,MAAM,CAACE,OAAP,CAAeI,aAAtB,KAAyC,QAAzC,IACAN,MAAM,CAACC,IAAP,KAAiB,gCAFnB,EAGE;AACA;AACAuB,UAAAA,qBAAqB,GAAG9B,QAAxB;AACD,SAND,MAMO;AACLM,UAAAA,MAAM,CAACE,OAAP,CAAeI,aAAf,GAA+BhB,SAAS,CAACU,MAAM,CAACE,OAAP,CAAeI,aAAhB,CAAxC;AACAkB,UAAAA,qBAAqB,GAAG,CACtB9B,QAAQ,CAACmB,GAAT,CAAab,MAAM,CAACE,OAAP,CAAeI,aAA5B,CADsB,EAEtBmB,MAFsB,CAEfC,OAFe,CAAxB;AAGD;;AAEDF,QAAAA,qBAAqB,CAACrB,OAAtB,CAA8BK,OAAO,IACnCA,OAAO,CAACH,IAAR,CAAa;AACXJ,UAAAA,IAAI,EAAED,MAAM,CAACC,IADF;AAEX,aAAGD,MAAM,CAACE;AAFC,SAAb,CADF;AAOA,eAAOH,KAAP;AACD;;AACD,SAAM,gBAAN;AAAuB;AACrB,YAAIC,MAAM,CAACE,OAAP,CAAeyB,MAAnB,EAA2B;AACzB3B,UAAAA,MAAM,CAACE,OAAP,CAAeI,aAAf,GAA+BhB,SAAS,CAACU,MAAM,CAACE,OAAP,CAAeI,aAAhB,CAAxC;AACA,gBAAME,OAAO,GAAGd,QAAQ,CAACmB,GAAT,CAAab,MAAM,CAACE,OAAP,CAAeI,aAA5B,CAAhB,CAFyB,CAGzB;AACA;AACA;AACA;;AACAE,UAAAA,OAAO,CAACH,IAAR,CAAa;AACXJ,YAAAA,IAAI,EAAG;AADI,WAAb;AAGD;;AACD,eAAOF,KAAP;AACD;;AACD,SAAM,2BAAN;AAAkC;AAChCC,QAAAA,MAAM,CAACE,OAAP,CAAeI,aAAf,GAA+BhB,SAAS,CAACU,MAAM,CAACE,OAAP,CAAeI,aAAhB,CAAxC;AACAP,QAAAA,KAAK,CAAC6B,MAAN,CAAa5B,MAAM,CAACE,OAAP,CAAeI,aAA5B;AACA,eAAOP,KAAP;AACD;;AACD,SAAM,aAAN;AAAoB;AAClB,cAAMS,OAAO,GAAGd,QAAQ,CAACmB,GAAT,CAAavB,SAAS,CAACU,MAAM,CAACE,OAAP,CAAeK,SAAhB,CAAtB,CAAhB;AACAC,QAAAA,OAAO,CAACH,IAAR,CAAa;AACXJ,UAAAA,IAAI,EAAG,aADI;AAEX4B,UAAAA,IAAI,EAAE7B,MAAM,CAACE;AAFF,SAAb;AAIA,eAAOH,KAAP;AACD;AA3HH;;AA8HA,SAAOA,KAAP;AACD,CAhID","sourcesContent":["const normalize = require(`normalize-path`)\nconst { interpret } = require(`xstate`)\n\nconst componentMachine = require(`../machines/page-component`)\n\nconst services = new Map()\nlet programStatus = `BOOTSTRAPPING`\n\nmodule.exports = (state = new Map(), action) => {\n  switch (action.type) {\n    case `DELETE_CACHE`:\n      return new Map()\n    case `SET_PROGRAM_STATUS`:\n      programStatus = action.payload\n      if (programStatus === `BOOTSTRAP_QUERY_RUNNING_FINISHED`) {\n        services.forEach(s => s.send(`BOOTSTRAP_FINISHED`))\n      }\n      return state\n    case `CREATE_PAGE`: {\n      action.payload.componentPath = normalize(action.payload.component)\n      // Create XState service.\n      let service\n      if (!services.has(action.payload.componentPath)) {\n        const machine = componentMachine.withContext({\n          componentPath: action.payload.componentPath,\n          query: state.get(action.payload.componentPath)?.query || ``,\n          pages: [action.payload.path],\n          isInBootstrap: programStatus === `BOOTSTRAPPING`,\n        })\n        service = interpret(machine).start()\n        // .onTransition(nextState => {\n        // console.log(\n        // `component machine value`,\n        // _.pick(nextState, [`value`, `context`, `event`])\n        // )\n        // })\n        // .start()\n        services.set(action.payload.componentPath, service)\n      } else {\n        service = services.get(action.payload.componentPath)\n        if (!service.state.context.pages.includes(action.payload.path)) {\n          service.send({ type: `NEW_PAGE_CREATED`, path: action.payload.path })\n        }\n      }\n\n      state.set(\n        action.payload.componentPath,\n        Object.assign(\n          {\n            query: ``,\n          },\n          service.state.context\n        )\n      )\n      return state\n    }\n    case `QUERY_EXTRACTED`: {\n      action.payload.componentPath = normalize(action.payload.componentPath)\n      const service = services.get(action.payload.componentPath)\n\n      if (service.state.value === `queryExtractionBabelError`) {\n        // Do nothing until the babel error is fixed.\n        return state\n      }\n\n      // Check if the query has changed or not.\n      if (service.state.context.query === action.payload.query) {\n        service.send(`QUERY_DID_NOT_CHANGE`)\n      } else {\n        service.send({\n          type: `QUERY_CHANGED`,\n          query: action.payload.query,\n        })\n      }\n\n      state.set(action.payload.componentPath, {\n        ...service.state.context,\n      })\n      return state\n    }\n    case `QUERY_EXTRACTION_BABEL_SUCCESS`:\n    case `QUERY_EXTRACTION_BABEL_ERROR`:\n    case `QUERY_EXTRACTION_GRAPHQL_ERROR`: {\n      let servicesToSendEventTo\n      if (\n        typeof action.payload.componentPath !== `string` &&\n        action.type === `QUERY_EXTRACTION_GRAPHQL_ERROR`\n      ) {\n        // if this is globabl query extraction error, send it to all page component services\n        servicesToSendEventTo = services\n      } else {\n        action.payload.componentPath = normalize(action.payload.componentPath)\n        servicesToSendEventTo = [\n          services.get(action.payload.componentPath),\n        ].filter(Boolean)\n      }\n\n      servicesToSendEventTo.forEach(service =>\n        service.send({\n          type: action.type,\n          ...action.payload,\n        })\n      )\n\n      return state\n    }\n    case `PAGE_QUERY_RUN`: {\n      if (action.payload.isPage) {\n        action.payload.componentPath = normalize(action.payload.componentPath)\n        const service = services.get(action.payload.componentPath)\n        // TODO we want to keep track of whether there's any outstanding queries still\n        // running as this will mark queries as complete immediately even though\n        // a page component could have thousands of pages will processing.\n        // This can be done once we start modeling Pages as well.\n        service.send({\n          type: `QUERIES_COMPLETE`,\n        })\n      }\n      return state\n    }\n    case `REMOVE_TEMPLATE_COMPONENT`: {\n      action.payload.componentPath = normalize(action.payload.componentPath)\n      state.delete(action.payload.componentPath)\n      return state\n    }\n    case `DELETE_PAGE`: {\n      const service = services.get(normalize(action.payload.component))\n      service.send({\n        type: `DELETE_PAGE`,\n        page: action.payload,\n      })\n      return state\n    }\n  }\n\n  return state\n}\n"],"file":"components.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/redux/reducers/config.js b/node_modules/gatsby/dist/redux/reducers/config.js
index b31f728..a5b3df3 100644
--- a/node_modules/gatsby/dist/redux/reducers/config.js
+++ b/node_modules/gatsby/dist/redux/reducers/config.js
@@ -6,8 +6,9 @@ const chalk = require(`chalk`);
 
 const _ = require(`lodash`);
 
-const _require = require(`../../joi-schemas/joi`),
-      gatsbyConfigSchema = _require.gatsbyConfigSchema;
+const {
+  gatsbyConfigSchema
+} = require(`../../joi-schemas/joi`);
 
 module.exports = (state = {}, action) => {
   switch (action.type) {
@@ -52,7 +53,8 @@ module.exports = (state = {}, action) => {
           action = _.set(action, [`payload`, `polyfill`], true);
         }
 
-        return Object.assign({}, action.payload);
+        return { ...action.payload
+        };
       }
 
     default:
diff --git a/node_modules/gatsby/dist/redux/reducers/config.js.map b/node_modules/gatsby/dist/redux/reducers/config.js.map
index 97d41fc..eafe3c4 100644
--- a/node_modules/gatsby/dist/redux/reducers/config.js.map
+++ b/node_modules/gatsby/dist/redux/reducers/config.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/redux/reducers/config.js"],"names":["Joi","require","chalk","_","gatsbyConfigSchema","module","exports","state","action","type","result","validate","payload","error","console","log","blue","bgYellow","bold","red","linkPrefix","Error","pathPrefix","startsWith","endsWith","slice","has","set"],"mappings":";;AAAA,MAAMA,GAAG,GAAGC,OAAO,CAAE,KAAF,CAAnB;;AACA,MAAMC,KAAK,GAAGD,OAAO,CAAE,OAAF,CAArB;;AACA,MAAME,CAAC,GAAGF,OAAO,CAAE,QAAF,CAAjB;;iBAE+BA,OAAO,CAAE,uBAAF,C;MAA9BG,kB,YAAAA,kB;;AAERC,MAAM,CAACC,OAAP,GAAiB,CAACC,KAAK,GAAG,EAAT,EAAaC,MAAb,KAAwB;AACvC,UAAQA,MAAM,CAACC,IAAf;AACE,SAAM,iBAAN;AAAwB;AACtB;AACA,cAAMC,MAAM,GAAGV,GAAG,CAACW,QAAJ,CAAaH,MAAM,CAACI,OAApB,EAA6BR,kBAA7B,CAAf,CAFsB,CAGtB;AACA;AACA;;AACA,YAAIM,MAAM,CAACG,KAAX,EAAkB;AAChBC,UAAAA,OAAO,CAACC,GAAR,CACEb,KAAK,CAACc,IAAN,CAAWC,QAAX,CAAqB,+CAArB,CADF;AAGAH,UAAAA,OAAO,CAACC,GAAR,CAAYb,KAAK,CAACgB,IAAN,CAAWC,GAAX,CAAeT,MAAM,CAACG,KAAtB,CAAZ;;AACA,cAAIL,MAAM,CAACI,OAAP,CAAeQ,UAAnB,EAA+B;AAC7BN,YAAAA,OAAO,CAACC,GAAR,CAAa,gDAAb;AACD;;AACD,gBAAM,IAAIM,KAAJ,CAAW,+CAAX,CAAN;AACD,SAfqB,CAiBtB;AACA;;;AACA,YAAIb,MAAM,CAACI,OAAP,IAAkBJ,MAAM,CAACI,OAAP,CAAeU,UAArC,EAAiD;AAC/C,cAAI,CAACnB,CAAC,CAACoB,UAAF,CAAaf,MAAM,CAACI,OAAP,CAAeU,UAA5B,EAAyC,GAAzC,CAAL,EAAmD;AACjDd,YAAAA,MAAM,CAACI,OAAP,CAAeU,UAAf,GAA6B,IAAGd,MAAM,CAACI,OAAP,CAAeU,UAAW,EAA1D;AACD;;AACD,cAAInB,CAAC,CAACqB,QAAF,CAAWhB,MAAM,CAACI,OAAP,CAAeU,UAA1B,EAAuC,GAAvC,CAAJ,EAAgD;AAC9Cd,YAAAA,MAAM,CAACI,OAAP,CAAeU,UAAf,GAA4Bd,MAAM,CAACI,OAAP,CAAeU,UAAf,CAA0BG,KAA1B,CAAgC,CAAhC,EAAmC,CAAC,CAApC,CAA5B;AACD;AACF,SA1BqB,CA4BtB;AACA;;;AACA,YAAI,CAACtB,CAAC,CAACuB,GAAF,CAAMlB,MAAN,EAAc,CAAE,SAAF,EAAa,YAAb,CAAd,CAAL,EAA+C;AAC7CA,UAAAA,MAAM,GAAGL,CAAC,CAACwB,GAAF,CAAMnB,MAAN,EAAc,CAAE,SAAF,EAAa,YAAb,CAAd,EAA0C,EAA1C,CAAT;AACD,SAhCqB,CAkCtB;;;AACA,YAAI,CAACL,CAAC,CAACuB,GAAF,CAAMlB,MAAN,EAAc,CAAE,SAAF,EAAa,UAAb,CAAd,CAAL,EAA6C;AAC3CA,UAAAA,MAAM,GAAGL,CAAC,CAACwB,GAAF,CAAMnB,MAAN,EAAc,CAAE,SAAF,EAAa,UAAb,CAAd,EAAuC,IAAvC,CAAT;AACD;;AAED,iCACKA,MAAM,CAACI,OADZ;AAGD;;AACD;AACE,aAAOL,KAAP;AA7CJ;AA+CD,CAhDD","sourcesContent":["const Joi = require(`joi`)\nconst chalk = require(`chalk`)\nconst _ = require(`lodash`)\n\nconst { gatsbyConfigSchema } = require(`../../joi-schemas/joi`)\n\nmodule.exports = (state = {}, action) => {\n  switch (action.type) {\n    case `SET_SITE_CONFIG`: {\n      // Validate the config.\n      const result = Joi.validate(action.payload, gatsbyConfigSchema)\n      // TODO use Redux for capturing errors from different\n      // parts of Gatsby so a) can capture richer errors and b) be\n      // more flexible how to display them.\n      if (result.error) {\n        console.log(\n          chalk.blue.bgYellow(`The site's gatsby-config.js failed validation`)\n        )\n        console.log(chalk.bold.red(result.error))\n        if (action.payload.linkPrefix) {\n          console.log(`\"linkPrefix\" should be changed to \"pathPrefix\"`)\n        }\n        throw new Error(`The site's gatsby-config.js failed validation`)\n      }\n\n      // Ensure that the pathPrefix (if set) starts with a forward slash\n      // and doesn't end with a slash.\n      if (action.payload && action.payload.pathPrefix) {\n        if (!_.startsWith(action.payload.pathPrefix, `/`)) {\n          action.payload.pathPrefix = `/${action.payload.pathPrefix}`\n        }\n        if (_.endsWith(action.payload.pathPrefix, `/`)) {\n          action.payload.pathPrefix = action.payload.pathPrefix.slice(0, -1)\n        }\n      }\n\n      // If pathPrefix isn't set, set it to an empty string\n      // to avoid it showing up as undefined elsewhere.\n      if (!_.has(action, [`payload`, `pathPrefix`])) {\n        action = _.set(action, [`payload`, `pathPrefix`], ``)\n      }\n\n      // Default polyfill to true.\n      if (!_.has(action, [`payload`, `polyfill`])) {\n        action = _.set(action, [`payload`, `polyfill`], true)\n      }\n\n      return {\n        ...action.payload,\n      }\n    }\n    default:\n      return state\n  }\n}\n"],"file":"config.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/redux/reducers/config.js"],"names":["Joi","require","chalk","_","gatsbyConfigSchema","module","exports","state","action","type","result","validate","payload","error","console","log","blue","bgYellow","bold","red","linkPrefix","Error","pathPrefix","startsWith","endsWith","slice","has","set"],"mappings":";;AAAA,MAAMA,GAAG,GAAGC,OAAO,CAAE,KAAF,CAAnB;;AACA,MAAMC,KAAK,GAAGD,OAAO,CAAE,OAAF,CAArB;;AACA,MAAME,CAAC,GAAGF,OAAO,CAAE,QAAF,CAAjB;;AAEA,MAAM;AAAEG,EAAAA;AAAF,IAAyBH,OAAO,CAAE,uBAAF,CAAtC;;AAEAI,MAAM,CAACC,OAAP,GAAiB,CAACC,KAAK,GAAG,EAAT,EAAaC,MAAb,KAAwB;AACvC,UAAQA,MAAM,CAACC,IAAf;AACE,SAAM,iBAAN;AAAwB;AACtB;AACA,cAAMC,MAAM,GAAGV,GAAG,CAACW,QAAJ,CAAaH,MAAM,CAACI,OAApB,EAA6BR,kBAA7B,CAAf,CAFsB,CAGtB;AACA;AACA;;AACA,YAAIM,MAAM,CAACG,KAAX,EAAkB;AAChBC,UAAAA,OAAO,CAACC,GAAR,CACEb,KAAK,CAACc,IAAN,CAAWC,QAAX,CAAqB,+CAArB,CADF;AAGAH,UAAAA,OAAO,CAACC,GAAR,CAAYb,KAAK,CAACgB,IAAN,CAAWC,GAAX,CAAeT,MAAM,CAACG,KAAtB,CAAZ;;AACA,cAAIL,MAAM,CAACI,OAAP,CAAeQ,UAAnB,EAA+B;AAC7BN,YAAAA,OAAO,CAACC,GAAR,CAAa,gDAAb;AACD;;AACD,gBAAM,IAAIM,KAAJ,CAAW,+CAAX,CAAN;AACD,SAfqB,CAiBtB;AACA;;;AACA,YAAIb,MAAM,CAACI,OAAP,IAAkBJ,MAAM,CAACI,OAAP,CAAeU,UAArC,EAAiD;AAC/C,cAAI,CAACnB,CAAC,CAACoB,UAAF,CAAaf,MAAM,CAACI,OAAP,CAAeU,UAA5B,EAAyC,GAAzC,CAAL,EAAmD;AACjDd,YAAAA,MAAM,CAACI,OAAP,CAAeU,UAAf,GAA6B,IAAGd,MAAM,CAACI,OAAP,CAAeU,UAAW,EAA1D;AACD;;AACD,cAAInB,CAAC,CAACqB,QAAF,CAAWhB,MAAM,CAACI,OAAP,CAAeU,UAA1B,EAAuC,GAAvC,CAAJ,EAAgD;AAC9Cd,YAAAA,MAAM,CAACI,OAAP,CAAeU,UAAf,GAA4Bd,MAAM,CAACI,OAAP,CAAeU,UAAf,CAA0BG,KAA1B,CAAgC,CAAhC,EAAmC,CAAC,CAApC,CAA5B;AACD;AACF,SA1BqB,CA4BtB;AACA;;;AACA,YAAI,CAACtB,CAAC,CAACuB,GAAF,CAAMlB,MAAN,EAAc,CAAE,SAAF,EAAa,YAAb,CAAd,CAAL,EAA+C;AAC7CA,UAAAA,MAAM,GAAGL,CAAC,CAACwB,GAAF,CAAMnB,MAAN,EAAc,CAAE,SAAF,EAAa,YAAb,CAAd,EAA0C,EAA1C,CAAT;AACD,SAhCqB,CAkCtB;;;AACA,YAAI,CAACL,CAAC,CAACuB,GAAF,CAAMlB,MAAN,EAAc,CAAE,SAAF,EAAa,UAAb,CAAd,CAAL,EAA6C;AAC3CA,UAAAA,MAAM,GAAGL,CAAC,CAACwB,GAAF,CAAMnB,MAAN,EAAc,CAAE,SAAF,EAAa,UAAb,CAAd,EAAuC,IAAvC,CAAT;AACD;;AAED,eAAO,EACL,GAAGA,MAAM,CAACI;AADL,SAAP;AAGD;;AACD;AACE,aAAOL,KAAP;AA7CJ;AA+CD,CAhDD","sourcesContent":["const Joi = require(`joi`)\nconst chalk = require(`chalk`)\nconst _ = require(`lodash`)\n\nconst { gatsbyConfigSchema } = require(`../../joi-schemas/joi`)\n\nmodule.exports = (state = {}, action) => {\n  switch (action.type) {\n    case `SET_SITE_CONFIG`: {\n      // Validate the config.\n      const result = Joi.validate(action.payload, gatsbyConfigSchema)\n      // TODO use Redux for capturing errors from different\n      // parts of Gatsby so a) can capture richer errors and b) be\n      // more flexible how to display them.\n      if (result.error) {\n        console.log(\n          chalk.blue.bgYellow(`The site's gatsby-config.js failed validation`)\n        )\n        console.log(chalk.bold.red(result.error))\n        if (action.payload.linkPrefix) {\n          console.log(`\"linkPrefix\" should be changed to \"pathPrefix\"`)\n        }\n        throw new Error(`The site's gatsby-config.js failed validation`)\n      }\n\n      // Ensure that the pathPrefix (if set) starts with a forward slash\n      // and doesn't end with a slash.\n      if (action.payload && action.payload.pathPrefix) {\n        if (!_.startsWith(action.payload.pathPrefix, `/`)) {\n          action.payload.pathPrefix = `/${action.payload.pathPrefix}`\n        }\n        if (_.endsWith(action.payload.pathPrefix, `/`)) {\n          action.payload.pathPrefix = action.payload.pathPrefix.slice(0, -1)\n        }\n      }\n\n      // If pathPrefix isn't set, set it to an empty string\n      // to avoid it showing up as undefined elsewhere.\n      if (!_.has(action, [`payload`, `pathPrefix`])) {\n        action = _.set(action, [`payload`, `pathPrefix`], ``)\n      }\n\n      // Default polyfill to true.\n      if (!_.has(action, [`payload`, `polyfill`])) {\n        action = _.set(action, [`payload`, `polyfill`], true)\n      }\n\n      return {\n        ...action.payload,\n      }\n    }\n    default:\n      return state\n  }\n}\n"],"file":"config.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/redux/reducers/index.js b/node_modules/gatsby/dist/redux/reducers/index.js
index 4a68a06..4ba6812 100644
--- a/node_modules/gatsby/dist/redux/reducers/index.js
+++ b/node_modules/gatsby/dist/redux/reducers/index.js
@@ -32,9 +32,7 @@ module.exports = {
   resolvedNodesCache: require(`./resolved-nodes`),
   nodesTouched: require(`./nodes-touched`),
   lastAction: require(`./last-action`),
-  plugins: require(`./plugins`),
   flattenedPlugins: require(`./flattened-plugins`),
-  apiToPlugins: require(`./api-to-plugins`),
   config: require(`./config`),
   pages: require(`./pages`),
   schema: require(`./schema`),
diff --git a/node_modules/gatsby/dist/redux/reducers/index.js.map b/node_modules/gatsby/dist/redux/reducers/index.js.map
index 9b8dc99..24e63ef 100644
--- a/node_modules/gatsby/dist/redux/reducers/index.js.map
+++ b/node_modules/gatsby/dist/redux/reducers/index.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/redux/reducers/index.js"],"names":["reduxNodes","require","lokiNodes","reducer","backend","process","env","GATSBY_DB_NODES","getNodesReducer","nodesReducer","Error","module","exports","program","nodes","nodesByType","resolvedNodesCache","nodesTouched","lastAction","plugins","flattenedPlugins","apiToPlugins","config","pages","schema","status","componentDataDependencies","components","staticQueryComponents","jobs","webpack","redirects","babelrc","jsonDataPaths","schemaCustomization","themes"],"mappings":";;AAAA,MAAMA,UAAU,GAAGC,OAAO,CAAE,SAAF,CAA1B;;AACA,MAAMC,SAAS,GAAGD,OAAO,CAAE,qBAAF,CAAP,CAA+BE,OAAjD;;AAEA,MAAMC,OAAO,GAAGC,OAAO,CAACC,GAAR,CAAYC,eAAZ,IAAgC,OAAhD;;AAEA,SAASC,eAAT,GAA2B;AACzB,MAAIC,YAAJ;;AACA,UAAQL,OAAR;AACE,SAAM,OAAN;AACEK,MAAAA,YAAY,GAAGT,UAAf;AACA;;AACF,SAAM,MAAN;AACES,MAAAA,YAAY,GAAGP,SAAf;AACA;;AACF;AACE,YAAM,IAAIQ,KAAJ,CACH,iEADG,CAAN;AARJ;;AAYA,SAAOD,YAAP;AACD;;AAEDE,MAAM,CAACC,OAAP,GAAiB;AACfC,EAAAA,OAAO,EAAEZ,OAAO,CAAE,WAAF,CADD;AAEfa,EAAAA,KAAK,EAAEN,eAAe,EAFP;AAGfO,EAAAA,WAAW,EAAEd,OAAO,CAAE,iBAAF,CAHL;AAIfe,EAAAA,kBAAkB,EAAEf,OAAO,CAAE,kBAAF,CAJZ;AAKfgB,EAAAA,YAAY,EAAEhB,OAAO,CAAE,iBAAF,CALN;AAMfiB,EAAAA,UAAU,EAAEjB,OAAO,CAAE,eAAF,CANJ;AAOfkB,EAAAA,OAAO,EAAElB,OAAO,CAAE,WAAF,CAPD;AAQfmB,EAAAA,gBAAgB,EAAEnB,OAAO,CAAE,qBAAF,CARV;AASfoB,EAAAA,YAAY,EAAEpB,OAAO,CAAE,kBAAF,CATN;AAUfqB,EAAAA,MAAM,EAAErB,OAAO,CAAE,UAAF,CAVA;AAWfsB,EAAAA,KAAK,EAAEtB,OAAO,CAAE,SAAF,CAXC;AAYfuB,EAAAA,MAAM,EAAEvB,OAAO,CAAE,UAAF,CAZA;AAafwB,EAAAA,MAAM,EAAExB,OAAO,CAAE,UAAF,CAbA;AAcfyB,EAAAA,yBAAyB,EAAEzB,OAAO,CAAE,+BAAF,CAdnB;AAef0B,EAAAA,UAAU,EAAE1B,OAAO,CAAE,cAAF,CAfJ;AAgBf2B,EAAAA,qBAAqB,EAAE3B,OAAO,CAAE,2BAAF,CAhBf;AAiBf4B,EAAAA,IAAI,EAAE5B,OAAO,CAAE,QAAF,CAjBE;AAkBf6B,EAAAA,OAAO,EAAE7B,OAAO,CAAE,WAAF,CAlBD;AAmBf8B,EAAAA,SAAS,EAAE9B,OAAO,CAAE,aAAF,CAnBH;AAoBf+B,EAAAA,OAAO,EAAE/B,OAAO,CAAE,WAAF,CApBD;AAqBfgC,EAAAA,aAAa,EAAEhC,OAAO,CAAE,mBAAF,CArBP;AAsBfiC,EAAAA,mBAAmB,EAAEjC,OAAO,CAAE,wBAAF,CAtBb;AAuBfkC,EAAAA,MAAM,EAAElC,OAAO,CAAE,UAAF;AAvBA,CAAjB","sourcesContent":["const reduxNodes = require(`./nodes`)\nconst lokiNodes = require(`../../db/loki/nodes`).reducer\n\nconst backend = process.env.GATSBY_DB_NODES || `redux`\n\nfunction getNodesReducer() {\n  let nodesReducer\n  switch (backend) {\n    case `redux`:\n      nodesReducer = reduxNodes\n      break\n    case `loki`:\n      nodesReducer = lokiNodes\n      break\n    default:\n      throw new Error(\n        `Unsupported DB nodes backend (value of env var GATSBY_DB_NODES)`\n      )\n  }\n  return nodesReducer\n}\n\nmodule.exports = {\n  program: require(`./program`),\n  nodes: getNodesReducer(),\n  nodesByType: require(`./nodes-by-type`),\n  resolvedNodesCache: require(`./resolved-nodes`),\n  nodesTouched: require(`./nodes-touched`),\n  lastAction: require(`./last-action`),\n  plugins: require(`./plugins`),\n  flattenedPlugins: require(`./flattened-plugins`),\n  apiToPlugins: require(`./api-to-plugins`),\n  config: require(`./config`),\n  pages: require(`./pages`),\n  schema: require(`./schema`),\n  status: require(`./status`),\n  componentDataDependencies: require(`./component-data-dependencies`),\n  components: require(`./components`),\n  staticQueryComponents: require(`./static-query-components`),\n  jobs: require(`./jobs`),\n  webpack: require(`./webpack`),\n  redirects: require(`./redirects`),\n  babelrc: require(`./babelrc`),\n  jsonDataPaths: require(`./json-data-paths`),\n  schemaCustomization: require(`./schema-customization`),\n  themes: require(`./themes`),\n}\n"],"file":"index.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/redux/reducers/index.js"],"names":["reduxNodes","require","lokiNodes","reducer","backend","process","env","GATSBY_DB_NODES","getNodesReducer","nodesReducer","Error","module","exports","program","nodes","nodesByType","resolvedNodesCache","nodesTouched","lastAction","flattenedPlugins","config","pages","schema","status","componentDataDependencies","components","staticQueryComponents","jobs","webpack","redirects","babelrc","jsonDataPaths","schemaCustomization","themes"],"mappings":";;AAAA,MAAMA,UAAU,GAAGC,OAAO,CAAE,SAAF,CAA1B;;AACA,MAAMC,SAAS,GAAGD,OAAO,CAAE,qBAAF,CAAP,CAA+BE,OAAjD;;AAEA,MAAMC,OAAO,GAAGC,OAAO,CAACC,GAAR,CAAYC,eAAZ,IAAgC,OAAhD;;AAEA,SAASC,eAAT,GAA2B;AACzB,MAAIC,YAAJ;;AACA,UAAQL,OAAR;AACE,SAAM,OAAN;AACEK,MAAAA,YAAY,GAAGT,UAAf;AACA;;AACF,SAAM,MAAN;AACES,MAAAA,YAAY,GAAGP,SAAf;AACA;;AACF;AACE,YAAM,IAAIQ,KAAJ,CACH,iEADG,CAAN;AARJ;;AAYA,SAAOD,YAAP;AACD;;AAEDE,MAAM,CAACC,OAAP,GAAiB;AACfC,EAAAA,OAAO,EAAEZ,OAAO,CAAE,WAAF,CADD;AAEfa,EAAAA,KAAK,EAAEN,eAAe,EAFP;AAGfO,EAAAA,WAAW,EAAEd,OAAO,CAAE,iBAAF,CAHL;AAIfe,EAAAA,kBAAkB,EAAEf,OAAO,CAAE,kBAAF,CAJZ;AAKfgB,EAAAA,YAAY,EAAEhB,OAAO,CAAE,iBAAF,CALN;AAMfiB,EAAAA,UAAU,EAAEjB,OAAO,CAAE,eAAF,CANJ;AAOfkB,EAAAA,gBAAgB,EAAElB,OAAO,CAAE,qBAAF,CAPV;AAQfmB,EAAAA,MAAM,EAAEnB,OAAO,CAAE,UAAF,CARA;AASfoB,EAAAA,KAAK,EAAEpB,OAAO,CAAE,SAAF,CATC;AAUfqB,EAAAA,MAAM,EAAErB,OAAO,CAAE,UAAF,CAVA;AAWfsB,EAAAA,MAAM,EAAEtB,OAAO,CAAE,UAAF,CAXA;AAYfuB,EAAAA,yBAAyB,EAAEvB,OAAO,CAAE,+BAAF,CAZnB;AAafwB,EAAAA,UAAU,EAAExB,OAAO,CAAE,cAAF,CAbJ;AAcfyB,EAAAA,qBAAqB,EAAEzB,OAAO,CAAE,2BAAF,CAdf;AAef0B,EAAAA,IAAI,EAAE1B,OAAO,CAAE,QAAF,CAfE;AAgBf2B,EAAAA,OAAO,EAAE3B,OAAO,CAAE,WAAF,CAhBD;AAiBf4B,EAAAA,SAAS,EAAE5B,OAAO,CAAE,aAAF,CAjBH;AAkBf6B,EAAAA,OAAO,EAAE7B,OAAO,CAAE,WAAF,CAlBD;AAmBf8B,EAAAA,aAAa,EAAE9B,OAAO,CAAE,mBAAF,CAnBP;AAoBf+B,EAAAA,mBAAmB,EAAE/B,OAAO,CAAE,wBAAF,CApBb;AAqBfgC,EAAAA,MAAM,EAAEhC,OAAO,CAAE,UAAF;AArBA,CAAjB","sourcesContent":["const reduxNodes = require(`./nodes`)\nconst lokiNodes = require(`../../db/loki/nodes`).reducer\n\nconst backend = process.env.GATSBY_DB_NODES || `redux`\n\nfunction getNodesReducer() {\n  let nodesReducer\n  switch (backend) {\n    case `redux`:\n      nodesReducer = reduxNodes\n      break\n    case `loki`:\n      nodesReducer = lokiNodes\n      break\n    default:\n      throw new Error(\n        `Unsupported DB nodes backend (value of env var GATSBY_DB_NODES)`\n      )\n  }\n  return nodesReducer\n}\n\nmodule.exports = {\n  program: require(`./program`),\n  nodes: getNodesReducer(),\n  nodesByType: require(`./nodes-by-type`),\n  resolvedNodesCache: require(`./resolved-nodes`),\n  nodesTouched: require(`./nodes-touched`),\n  lastAction: require(`./last-action`),\n  flattenedPlugins: require(`./flattened-plugins`),\n  config: require(`./config`),\n  pages: require(`./pages`),\n  schema: require(`./schema`),\n  status: require(`./status`),\n  componentDataDependencies: require(`./component-data-dependencies`),\n  components: require(`./components`),\n  staticQueryComponents: require(`./static-query-components`),\n  jobs: require(`./jobs`),\n  webpack: require(`./webpack`),\n  redirects: require(`./redirects`),\n  babelrc: require(`./babelrc`),\n  jsonDataPaths: require(`./json-data-paths`),\n  schemaCustomization: require(`./schema-customization`),\n  themes: require(`./themes`),\n}\n"],"file":"index.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/redux/reducers/jobs.js b/node_modules/gatsby/dist/redux/reducers/jobs.js
index dcb81bc..0a883be 100644
--- a/node_modules/gatsby/dist/redux/reducers/jobs.js
+++ b/node_modules/gatsby/dist/redux/reducers/jobs.js
@@ -2,8 +2,9 @@
 
 const _ = require(`lodash`);
 
-const _require = require(`common-tags`),
-      oneLine = _require.oneLine;
+const {
+  oneLine
+} = require(`common-tags`);
 
 const moment = require(`moment`);
 
@@ -21,10 +22,10 @@ module.exports = (state = {
 
         const index = _.findIndex(state.active, j => j.id === action.payload.id);
 
-        const mergedJob = _.merge(state.active[index], Object.assign({}, action.payload, {
+        const mergedJob = _.merge(state.active[index], { ...action.payload,
           createdAt: Date.now(),
           plugin: action.plugin
-        }));
+        });
 
         if (index !== -1) {
           return {
@@ -34,10 +35,10 @@ module.exports = (state = {
         } else {
           return {
             done: state.done,
-            active: state.active.concat([Object.assign({}, action.payload, {
+            active: state.active.concat([{ ...action.payload,
               createdAt: Date.now(),
               plugin: action.plugin
-            })])
+            }])
           };
         }
       }
@@ -59,10 +60,10 @@ module.exports = (state = {
         }
 
         return {
-          done: state.done.concat([Object.assign({}, job, {
+          done: state.done.concat([{ ...job,
             completedAt,
             runTime: moment(completedAt).diff(moment(job.createdAt))
-          })]),
+          }]),
           active: state.active.filter(j => j.id !== action.payload.id)
         };
       }
diff --git a/node_modules/gatsby/dist/redux/reducers/jobs.js.map b/node_modules/gatsby/dist/redux/reducers/jobs.js.map
index 461baec..b52325f 100644
--- a/node_modules/gatsby/dist/redux/reducers/jobs.js.map
+++ b/node_modules/gatsby/dist/redux/reducers/jobs.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/redux/reducers/jobs.js"],"names":["_","require","oneLine","moment","module","exports","state","active","done","action","type","payload","id","Error","index","findIndex","j","mergedJob","merge","createdAt","Date","now","plugin","slice","concat","completedAt","job","find","get","runTime","diff","filter"],"mappings":"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","sourcesContent":["const _ = require(`lodash`)\nconst { oneLine } = require(`common-tags`)\nconst moment = require(`moment`)\n\nmodule.exports = (state = { active: [], done: [] }, action) => {\n  switch (action.type) {\n    case `CREATE_JOB`:\n    case `SET_JOB`: {\n      if (!action.payload.id) {\n        throw new Error(`An ID must be provided when creating or setting job`)\n      }\n      const index = _.findIndex(state.active, j => j.id === action.payload.id)\n      const mergedJob = _.merge(state.active[index], {\n        ...action.payload,\n        createdAt: Date.now(),\n        plugin: action.plugin,\n      })\n      if (index !== -1) {\n        return {\n          done: state.done,\n          active: [\n            ...state.active\n              .slice(0, index)\n              .concat([mergedJob])\n              .concat(state.active.slice(index + 1)),\n          ],\n        }\n      } else {\n        return {\n          done: state.done,\n          active: state.active.concat([\n            {\n              ...action.payload,\n              createdAt: Date.now(),\n              plugin: action.plugin,\n            },\n          ]),\n        }\n      }\n    }\n    case `END_JOB`: {\n      if (!action.payload.id) {\n        throw new Error(`An ID must be provided when ending a job`)\n      }\n      const completedAt = Date.now()\n      const job = state.active.find(j => j.id === action.payload.id)\n      if (!job) {\n        throw new Error(oneLine`\n          The plugin \"${_.get(action, `plugin.name`, `anonymous`)}\"\n          tried to end a job with the id \"${action.payload.id}\"\n          that either hasn't yet been created or has already been ended`)\n      }\n\n      return {\n        done: state.done.concat([\n          {\n            ...job,\n            completedAt,\n            runTime: moment(completedAt).diff(moment(job.createdAt)),\n          },\n        ]),\n        active: state.active.filter(j => j.id !== action.payload.id),\n      }\n    }\n  }\n\n  return state\n}\n"],"file":"jobs.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/redux/reducers/jobs.js"],"names":["_","require","oneLine","moment","module","exports","state","active","done","action","type","payload","id","Error","index","findIndex","j","mergedJob","merge","createdAt","Date","now","plugin","slice","concat","completedAt","job","find","get","runTime","diff","filter"],"mappings":";;AAAA,MAAMA,CAAC,GAAGC,OAAO,CAAE,QAAF,CAAjB;;AACA,MAAM;AAAEC,EAAAA;AAAF,IAAcD,OAAO,CAAE,aAAF,CAA3B;;AACA,MAAME,MAAM,GAAGF,OAAO,CAAE,QAAF,CAAtB;;AAEAG,MAAM,CAACC,OAAP,GAAiB,CAACC,KAAK,GAAG;AAAEC,EAAAA,MAAM,EAAE,EAAV;AAAcC,EAAAA,IAAI,EAAE;AAApB,CAAT,EAAmCC,MAAnC,KAA8C;AAC7D,UAAQA,MAAM,CAACC,IAAf;AACE,SAAM,YAAN;AACA,SAAM,SAAN;AAAgB;AACd,YAAI,CAACD,MAAM,CAACE,OAAP,CAAeC,EAApB,EAAwB;AACtB,gBAAM,IAAIC,KAAJ,CAAW,qDAAX,CAAN;AACD;;AACD,cAAMC,KAAK,GAAGd,CAAC,CAACe,SAAF,CAAYT,KAAK,CAACC,MAAlB,EAA0BS,CAAC,IAAIA,CAAC,CAACJ,EAAF,KAASH,MAAM,CAACE,OAAP,CAAeC,EAAvD,CAAd;;AACA,cAAMK,SAAS,GAAGjB,CAAC,CAACkB,KAAF,CAAQZ,KAAK,CAACC,MAAN,CAAaO,KAAb,CAAR,EAA6B,EAC7C,GAAGL,MAAM,CAACE,OADmC;AAE7CQ,UAAAA,SAAS,EAAEC,IAAI,CAACC,GAAL,EAFkC;AAG7CC,UAAAA,MAAM,EAAEb,MAAM,CAACa;AAH8B,SAA7B,CAAlB;;AAKA,YAAIR,KAAK,KAAK,CAAC,CAAf,EAAkB;AAChB,iBAAO;AACLN,YAAAA,IAAI,EAAEF,KAAK,CAACE,IADP;AAELD,YAAAA,MAAM,EAAE,CACN,GAAGD,KAAK,CAACC,MAAN,CACAgB,KADA,CACM,CADN,EACST,KADT,EAEAU,MAFA,CAEO,CAACP,SAAD,CAFP,EAGAO,MAHA,CAGOlB,KAAK,CAACC,MAAN,CAAagB,KAAb,CAAmBT,KAAK,GAAG,CAA3B,CAHP,CADG;AAFH,WAAP;AASD,SAVD,MAUO;AACL,iBAAO;AACLN,YAAAA,IAAI,EAAEF,KAAK,CAACE,IADP;AAELD,YAAAA,MAAM,EAAED,KAAK,CAACC,MAAN,CAAaiB,MAAb,CAAoB,CAC1B,EACE,GAAGf,MAAM,CAACE,OADZ;AAEEQ,cAAAA,SAAS,EAAEC,IAAI,CAACC,GAAL,EAFb;AAGEC,cAAAA,MAAM,EAAEb,MAAM,CAACa;AAHjB,aAD0B,CAApB;AAFH,WAAP;AAUD;AACF;;AACD,SAAM,SAAN;AAAgB;AACd,YAAI,CAACb,MAAM,CAACE,OAAP,CAAeC,EAApB,EAAwB;AACtB,gBAAM,IAAIC,KAAJ,CAAW,0CAAX,CAAN;AACD;;AACD,cAAMY,WAAW,GAAGL,IAAI,CAACC,GAAL,EAApB;AACA,cAAMK,GAAG,GAAGpB,KAAK,CAACC,MAAN,CAAaoB,IAAb,CAAkBX,CAAC,IAAIA,CAAC,CAACJ,EAAF,KAASH,MAAM,CAACE,OAAP,CAAeC,EAA/C,CAAZ;;AACA,YAAI,CAACc,GAAL,EAAU;AACR,gBAAM,IAAIb,KAAJ,CAAUX,OAAQ;wBACRF,CAAC,CAAC4B,GAAF,CAAMnB,MAAN,EAAe,aAAf,EAA8B,WAA9B,CAA0C;4CACtBA,MAAM,CAACE,OAAP,CAAeC,EAAG;wEAFhD,CAAN;AAID;;AAED,eAAO;AACLJ,UAAAA,IAAI,EAAEF,KAAK,CAACE,IAAN,CAAWgB,MAAX,CAAkB,CACtB,EACE,GAAGE,GADL;AAEED,YAAAA,WAFF;AAGEI,YAAAA,OAAO,EAAE1B,MAAM,CAACsB,WAAD,CAAN,CAAoBK,IAApB,CAAyB3B,MAAM,CAACuB,GAAG,CAACP,SAAL,CAA/B;AAHX,WADsB,CAAlB,CADD;AAQLZ,UAAAA,MAAM,EAAED,KAAK,CAACC,MAAN,CAAawB,MAAb,CAAoBf,CAAC,IAAIA,CAAC,CAACJ,EAAF,KAASH,MAAM,CAACE,OAAP,CAAeC,EAAjD;AARH,SAAP;AAUD;AA1DH;;AA6DA,SAAON,KAAP;AACD,CA/DD","sourcesContent":["const _ = require(`lodash`)\nconst { oneLine } = require(`common-tags`)\nconst moment = require(`moment`)\n\nmodule.exports = (state = { active: [], done: [] }, action) => {\n  switch (action.type) {\n    case `CREATE_JOB`:\n    case `SET_JOB`: {\n      if (!action.payload.id) {\n        throw new Error(`An ID must be provided when creating or setting job`)\n      }\n      const index = _.findIndex(state.active, j => j.id === action.payload.id)\n      const mergedJob = _.merge(state.active[index], {\n        ...action.payload,\n        createdAt: Date.now(),\n        plugin: action.plugin,\n      })\n      if (index !== -1) {\n        return {\n          done: state.done,\n          active: [\n            ...state.active\n              .slice(0, index)\n              .concat([mergedJob])\n              .concat(state.active.slice(index + 1)),\n          ],\n        }\n      } else {\n        return {\n          done: state.done,\n          active: state.active.concat([\n            {\n              ...action.payload,\n              createdAt: Date.now(),\n              plugin: action.plugin,\n            },\n          ]),\n        }\n      }\n    }\n    case `END_JOB`: {\n      if (!action.payload.id) {\n        throw new Error(`An ID must be provided when ending a job`)\n      }\n      const completedAt = Date.now()\n      const job = state.active.find(j => j.id === action.payload.id)\n      if (!job) {\n        throw new Error(oneLine`\n          The plugin \"${_.get(action, `plugin.name`, `anonymous`)}\"\n          tried to end a job with the id \"${action.payload.id}\"\n          that either hasn't yet been created or has already been ended`)\n      }\n\n      return {\n        done: state.done.concat([\n          {\n            ...job,\n            completedAt,\n            runTime: moment(completedAt).diff(moment(job.createdAt)),\n          },\n        ]),\n        active: state.active.filter(j => j.id !== action.payload.id),\n      }\n    }\n  }\n\n  return state\n}\n"],"file":"jobs.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/redux/reducers/nodes-by-type.js b/node_modules/gatsby/dist/redux/reducers/nodes-by-type.js
index 5ba886c..79eded6 100644
--- a/node_modules/gatsby/dist/redux/reducers/nodes-by-type.js
+++ b/node_modules/gatsby/dist/redux/reducers/nodes-by-type.js
@@ -1,7 +1,9 @@
 "use strict";
 
 const getNodesOfType = (node, state) => {
-  const type = node.internal.type;
+  const {
+    type
+  } = node.internal;
 
   if (!state.has(type)) {
     state.set(type, new Map());
@@ -35,6 +37,7 @@ module.exports = (state = new Map(), action) => {
     case `DELETE_NODE`:
       {
         const node = action.payload;
+        if (!node) return state;
         const nodesOfType = getNodesOfType(node, state);
         nodesOfType.delete(node.id);
 
diff --git a/node_modules/gatsby/dist/redux/reducers/nodes-by-type.js.map b/node_modules/gatsby/dist/redux/reducers/nodes-by-type.js.map
index cf7da65..830d682 100644
--- a/node_modules/gatsby/dist/redux/reducers/nodes-by-type.js.map
+++ b/node_modules/gatsby/dist/redux/reducers/nodes-by-type.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/redux/reducers/nodes-by-type.js"],"names":["getNodesOfType","node","state","type","internal","has","set","Map","get","module","exports","action","payload","nodesOfType","id","delete","size","ids","forEach","Array","from","some","nodes"],"mappings":";;AAAA,MAAMA,cAAc,GAAG,CAACC,IAAD,EAAOC,KAAP,KAAiB;AAAA,QAC9BC,IAD8B,GACrBF,IAAI,CAACG,QADgB,CAC9BD,IAD8B;;AAEtC,MAAI,CAACD,KAAK,CAACG,GAAN,CAAUF,IAAV,CAAL,EAAsB;AACpBD,IAAAA,KAAK,CAACI,GAAN,CAAUH,IAAV,EAAgB,IAAII,GAAJ,EAAhB;AACD;;AACD,SAAOL,KAAK,CAACM,GAAN,CAAUL,IAAV,CAAP;AACD,CAND;;AAQAM,MAAM,CAACC,OAAP,GAAiB,CAACR,KAAK,GAAG,IAAIK,GAAJ,EAAT,EAAoBI,MAApB,KAA+B;AAC9C,UAAQA,MAAM,CAACR,IAAf;AACE,SAAM,cAAN;AACE,aAAO,IAAII,GAAJ,EAAP;;AAEF,SAAM,aAAN;AAAoB;AAClB,cAAMN,IAAI,GAAGU,MAAM,CAACC,OAApB;AACA,cAAMC,WAAW,GAAGb,cAAc,CAACC,IAAD,EAAOC,KAAP,CAAlC;AACAW,QAAAA,WAAW,CAACP,GAAZ,CAAgBL,IAAI,CAACa,EAArB,EAAyBb,IAAzB;AACA,eAAOC,KAAP;AACD;;AAED,SAAM,mBAAN;AACA,SAAM,+BAAN;AAAsC;AACpC,cAAMD,IAAI,GAAGU,MAAM,CAACC,OAApB;AACA,cAAMC,WAAW,GAAGb,cAAc,CAACC,IAAD,EAAOC,KAAP,CAAlC;AACAW,QAAAA,WAAW,CAACP,GAAZ,CAAgBL,IAAI,CAACa,EAArB,EAAyBb,IAAzB;AACA,eAAOC,KAAP;AACD;;AAED,SAAM,aAAN;AAAoB;AAClB,cAAMD,IAAI,GAAGU,MAAM,CAACC,OAApB;AACA,cAAMC,WAAW,GAAGb,cAAc,CAACC,IAAD,EAAOC,KAAP,CAAlC;AACAW,QAAAA,WAAW,CAACE,MAAZ,CAAmBd,IAAI,CAACa,EAAxB;;AACA,YAAI,CAACD,WAAW,CAACG,IAAjB,EAAuB;AACrBd,UAAAA,KAAK,CAACa,MAAN,CAAad,IAAI,CAACG,QAAL,CAAcD,IAA3B;AACD;;AACD,eAAOD,KAAP;AACD;AAED;;AACA,SAAM,cAAN;AAAqB;AACnB,cAAMe,GAAG,GAAGN,MAAM,CAACC,OAAnB;AACAK,QAAAA,GAAG,CAACC,OAAJ,CAAYJ,EAAE,IAAI;AAChBK,UAAAA,KAAK,CAACC,IAAN,CAAWlB,KAAX,EAAkBmB,IAAlB,CAAuB,CAAC,CAAClB,IAAD,EAAOmB,KAAP,CAAD,KAAmB;AACxC,gBAAIA,KAAK,CAACjB,GAAN,CAAUS,EAAV,CAAJ,EAAmB;AACjBQ,cAAAA,KAAK,CAACP,MAAN,CAAaD,EAAb;;AACA,kBAAI,CAACQ,KAAK,CAACN,IAAX,EAAiB;AACfd,gBAAAA,KAAK,CAACa,MAAN,CAAaZ,IAAb;AACD;;AACD,qBAAO,IAAP;AACD;;AACD,mBAAO,KAAP;AACD,WATD;AAUD,SAXD;AAYA,eAAOD,KAAP;AACD;;AAED;AACE,aAAOA,KAAP;AAhDJ;AAkDD,CAnDD","sourcesContent":["const getNodesOfType = (node, state) => {\n  const { type } = node.internal\n  if (!state.has(type)) {\n    state.set(type, new Map())\n  }\n  return state.get(type)\n}\n\nmodule.exports = (state = new Map(), action) => {\n  switch (action.type) {\n    case `DELETE_CACHE`:\n      return new Map()\n\n    case `CREATE_NODE`: {\n      const node = action.payload\n      const nodesOfType = getNodesOfType(node, state)\n      nodesOfType.set(node.id, node)\n      return state\n    }\n\n    case `ADD_FIELD_TO_NODE`:\n    case `ADD_CHILD_NODE_TO_PARENT_NODE`: {\n      const node = action.payload\n      const nodesOfType = getNodesOfType(node, state)\n      nodesOfType.set(node.id, node)\n      return state\n    }\n\n    case `DELETE_NODE`: {\n      const node = action.payload\n      const nodesOfType = getNodesOfType(node, state)\n      nodesOfType.delete(node.id)\n      if (!nodesOfType.size) {\n        state.delete(node.internal.type)\n      }\n      return state\n    }\n\n    // Deprecated, will be removed in Gatsby v3.\n    case `DELETE_NODES`: {\n      const ids = action.payload\n      ids.forEach(id => {\n        Array.from(state).some(([type, nodes]) => {\n          if (nodes.has(id)) {\n            nodes.delete(id)\n            if (!nodes.size) {\n              state.delete(type)\n            }\n            return true\n          }\n          return false\n        })\n      })\n      return state\n    }\n\n    default:\n      return state\n  }\n}\n"],"file":"nodes-by-type.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/redux/reducers/nodes-by-type.js"],"names":["getNodesOfType","node","state","type","internal","has","set","Map","get","module","exports","action","payload","nodesOfType","id","delete","size","ids","forEach","Array","from","some","nodes"],"mappings":";;AAAA,MAAMA,cAAc,GAAG,CAACC,IAAD,EAAOC,KAAP,KAAiB;AACtC,QAAM;AAAEC,IAAAA;AAAF,MAAWF,IAAI,CAACG,QAAtB;;AACA,MAAI,CAACF,KAAK,CAACG,GAAN,CAAUF,IAAV,CAAL,EAAsB;AACpBD,IAAAA,KAAK,CAACI,GAAN,CAAUH,IAAV,EAAgB,IAAII,GAAJ,EAAhB;AACD;;AACD,SAAOL,KAAK,CAACM,GAAN,CAAUL,IAAV,CAAP;AACD,CAND;;AAQAM,MAAM,CAACC,OAAP,GAAiB,CAACR,KAAK,GAAG,IAAIK,GAAJ,EAAT,EAAoBI,MAApB,KAA+B;AAC9C,UAAQA,MAAM,CAACR,IAAf;AACE,SAAM,cAAN;AACE,aAAO,IAAII,GAAJ,EAAP;;AAEF,SAAM,aAAN;AAAoB;AAClB,cAAMN,IAAI,GAAGU,MAAM,CAACC,OAApB;AACA,cAAMC,WAAW,GAAGb,cAAc,CAACC,IAAD,EAAOC,KAAP,CAAlC;AACAW,QAAAA,WAAW,CAACP,GAAZ,CAAgBL,IAAI,CAACa,EAArB,EAAyBb,IAAzB;AACA,eAAOC,KAAP;AACD;;AAED,SAAM,mBAAN;AACA,SAAM,+BAAN;AAAsC;AACpC,cAAMD,IAAI,GAAGU,MAAM,CAACC,OAApB;AACA,cAAMC,WAAW,GAAGb,cAAc,CAACC,IAAD,EAAOC,KAAP,CAAlC;AACAW,QAAAA,WAAW,CAACP,GAAZ,CAAgBL,IAAI,CAACa,EAArB,EAAyBb,IAAzB;AACA,eAAOC,KAAP;AACD;;AAED,SAAM,aAAN;AAAoB;AAClB,cAAMD,IAAI,GAAGU,MAAM,CAACC,OAApB;AACA,YAAI,CAACX,IAAL,EAAW,OAAOC,KAAP;AACX,cAAMW,WAAW,GAAGb,cAAc,CAACC,IAAD,EAAOC,KAAP,CAAlC;AACAW,QAAAA,WAAW,CAACE,MAAZ,CAAmBd,IAAI,CAACa,EAAxB;;AACA,YAAI,CAACD,WAAW,CAACG,IAAjB,EAAuB;AACrBd,UAAAA,KAAK,CAACa,MAAN,CAAad,IAAI,CAACG,QAAL,CAAcD,IAA3B;AACD;;AACD,eAAOD,KAAP;AACD;AAED;;AACA,SAAM,cAAN;AAAqB;AACnB,cAAMe,GAAG,GAAGN,MAAM,CAACC,OAAnB;AACAK,QAAAA,GAAG,CAACC,OAAJ,CAAYJ,EAAE,IAAI;AAChBK,UAAAA,KAAK,CAACC,IAAN,CAAWlB,KAAX,EAAkBmB,IAAlB,CAAuB,CAAC,CAAClB,IAAD,EAAOmB,KAAP,CAAD,KAAmB;AACxC,gBAAIA,KAAK,CAACjB,GAAN,CAAUS,EAAV,CAAJ,EAAmB;AACjBQ,cAAAA,KAAK,CAACP,MAAN,CAAaD,EAAb;;AACA,kBAAI,CAACQ,KAAK,CAACN,IAAX,EAAiB;AACfd,gBAAAA,KAAK,CAACa,MAAN,CAAaZ,IAAb;AACD;;AACD,qBAAO,IAAP;AACD;;AACD,mBAAO,KAAP;AACD,WATD;AAUD,SAXD;AAYA,eAAOD,KAAP;AACD;;AAED;AACE,aAAOA,KAAP;AAjDJ;AAmDD,CApDD","sourcesContent":["const getNodesOfType = (node, state) => {\n  const { type } = node.internal\n  if (!state.has(type)) {\n    state.set(type, new Map())\n  }\n  return state.get(type)\n}\n\nmodule.exports = (state = new Map(), action) => {\n  switch (action.type) {\n    case `DELETE_CACHE`:\n      return new Map()\n\n    case `CREATE_NODE`: {\n      const node = action.payload\n      const nodesOfType = getNodesOfType(node, state)\n      nodesOfType.set(node.id, node)\n      return state\n    }\n\n    case `ADD_FIELD_TO_NODE`:\n    case `ADD_CHILD_NODE_TO_PARENT_NODE`: {\n      const node = action.payload\n      const nodesOfType = getNodesOfType(node, state)\n      nodesOfType.set(node.id, node)\n      return state\n    }\n\n    case `DELETE_NODE`: {\n      const node = action.payload\n      if (!node) return state\n      const nodesOfType = getNodesOfType(node, state)\n      nodesOfType.delete(node.id)\n      if (!nodesOfType.size) {\n        state.delete(node.internal.type)\n      }\n      return state\n    }\n\n    // Deprecated, will be removed in Gatsby v3.\n    case `DELETE_NODES`: {\n      const ids = action.payload\n      ids.forEach(id => {\n        Array.from(state).some(([type, nodes]) => {\n          if (nodes.has(id)) {\n            nodes.delete(id)\n            if (!nodes.size) {\n              state.delete(type)\n            }\n            return true\n          }\n          return false\n        })\n      })\n      return state\n    }\n\n    default:\n      return state\n  }\n}\n"],"file":"nodes-by-type.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/redux/reducers/nodes.js b/node_modules/gatsby/dist/redux/reducers/nodes.js
index 8a57561..ceb9baa 100644
--- a/node_modules/gatsby/dist/redux/reducers/nodes.js
+++ b/node_modules/gatsby/dist/redux/reducers/nodes.js
@@ -18,7 +18,10 @@ module.exports = (state = new Map(), action) => {
 
     case `DELETE_NODE`:
       {
-        state.delete(action.payload.id);
+        if (action.payload) {
+          state.delete(action.payload.id);
+        }
+
         return state;
       }
 
diff --git a/node_modules/gatsby/dist/redux/reducers/nodes.js.map b/node_modules/gatsby/dist/redux/reducers/nodes.js.map
index 0aefb98..81cdd2b 100644
--- a/node_modules/gatsby/dist/redux/reducers/nodes.js.map
+++ b/node_modules/gatsby/dist/redux/reducers/nodes.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/redux/reducers/nodes.js"],"names":["module","exports","state","Map","action","type","set","payload","id","delete","forEach"],"mappings":";;AAAAA,MAAM,CAACC,OAAP,GAAiB,CAACC,KAAK,GAAG,IAAIC,GAAJ,EAAT,EAAoBC,MAApB,KAA+B;AAC9C,UAAQA,MAAM,CAACC,IAAf;AACE,SAAM,cAAN;AACE,aAAO,IAAIF,GAAJ,EAAP;;AACF,SAAM,aAAN;AAAoB;AAClBD,QAAAA,KAAK,CAACI,GAAN,CAAUF,MAAM,CAACG,OAAP,CAAeC,EAAzB,EAA6BJ,MAAM,CAACG,OAApC;AACA,eAAOL,KAAP;AACD;;AAED,SAAM,mBAAN;AACA,SAAM,+BAAN;AACEA,MAAAA,KAAK,CAACI,GAAN,CAAUF,MAAM,CAACG,OAAP,CAAeC,EAAzB,EAA6BJ,MAAM,CAACG,OAApC;AACA,aAAOL,KAAP;;AAEF,SAAM,aAAN;AAAoB;AAClBA,QAAAA,KAAK,CAACO,MAAN,CAAaL,MAAM,CAACG,OAAP,CAAeC,EAA5B;AACA,eAAON,KAAP;AACD;;AAED,SAAM,cAAN;AAAqB;AACnBE,QAAAA,MAAM,CAACG,OAAP,CAAeG,OAAf,CAAuBF,EAAE,IAAIN,KAAK,CAACO,MAAN,CAAaD,EAAb,CAA7B;AACA,eAAON,KAAP;AACD;;AAED;AACE,aAAOA,KAAP;AAxBJ;AA0BD,CA3BD","sourcesContent":["module.exports = (state = new Map(), action) => {\n  switch (action.type) {\n    case `DELETE_CACHE`:\n      return new Map()\n    case `CREATE_NODE`: {\n      state.set(action.payload.id, action.payload)\n      return state\n    }\n\n    case `ADD_FIELD_TO_NODE`:\n    case `ADD_CHILD_NODE_TO_PARENT_NODE`:\n      state.set(action.payload.id, action.payload)\n      return state\n\n    case `DELETE_NODE`: {\n      state.delete(action.payload.id)\n      return state\n    }\n\n    case `DELETE_NODES`: {\n      action.payload.forEach(id => state.delete(id))\n      return state\n    }\n\n    default:\n      return state\n  }\n}\n"],"file":"nodes.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/redux/reducers/nodes.js"],"names":["module","exports","state","Map","action","type","set","payload","id","delete","forEach"],"mappings":";;AAAAA,MAAM,CAACC,OAAP,GAAiB,CAACC,KAAK,GAAG,IAAIC,GAAJ,EAAT,EAAoBC,MAApB,KAA+B;AAC9C,UAAQA,MAAM,CAACC,IAAf;AACE,SAAM,cAAN;AACE,aAAO,IAAIF,GAAJ,EAAP;;AACF,SAAM,aAAN;AAAoB;AAClBD,QAAAA,KAAK,CAACI,GAAN,CAAUF,MAAM,CAACG,OAAP,CAAeC,EAAzB,EAA6BJ,MAAM,CAACG,OAApC;AACA,eAAOL,KAAP;AACD;;AAED,SAAM,mBAAN;AACA,SAAM,+BAAN;AACEA,MAAAA,KAAK,CAACI,GAAN,CAAUF,MAAM,CAACG,OAAP,CAAeC,EAAzB,EAA6BJ,MAAM,CAACG,OAApC;AACA,aAAOL,KAAP;;AAEF,SAAM,aAAN;AAAoB;AAClB,YAAIE,MAAM,CAACG,OAAX,EAAoB;AAClBL,UAAAA,KAAK,CAACO,MAAN,CAAaL,MAAM,CAACG,OAAP,CAAeC,EAA5B;AACD;;AACD,eAAON,KAAP;AACD;;AAED,SAAM,cAAN;AAAqB;AACnBE,QAAAA,MAAM,CAACG,OAAP,CAAeG,OAAf,CAAuBF,EAAE,IAAIN,KAAK,CAACO,MAAN,CAAaD,EAAb,CAA7B;AACA,eAAON,KAAP;AACD;;AAED;AACE,aAAOA,KAAP;AA1BJ;AA4BD,CA7BD","sourcesContent":["module.exports = (state = new Map(), action) => {\n  switch (action.type) {\n    case `DELETE_CACHE`:\n      return new Map()\n    case `CREATE_NODE`: {\n      state.set(action.payload.id, action.payload)\n      return state\n    }\n\n    case `ADD_FIELD_TO_NODE`:\n    case `ADD_CHILD_NODE_TO_PARENT_NODE`:\n      state.set(action.payload.id, action.payload)\n      return state\n\n    case `DELETE_NODE`: {\n      if (action.payload) {\n        state.delete(action.payload.id)\n      }\n      return state\n    }\n\n    case `DELETE_NODES`: {\n      action.payload.forEach(id => state.delete(id))\n      return state\n    }\n\n    default:\n      return state\n  }\n}\n"],"file":"nodes.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/redux/reducers/program.js b/node_modules/gatsby/dist/redux/reducers/program.js
index 80eec5a..fd6ce56 100644
--- a/node_modules/gatsby/dist/redux/reducers/program.js
+++ b/node_modules/gatsby/dist/redux/reducers/program.js
@@ -1,16 +1,23 @@
 "use strict";
 
 module.exports = (state = {
-  directory: `/`
+  directory: `/`,
+  state: `BOOTSTRAPPING`
 }, action) => {
   switch (action.type) {
     case `SET_PROGRAM`:
-      return Object.assign({}, action.payload);
+      return { ...action.payload
+      };
 
     case `SET_PROGRAM_EXTENSIONS`:
-      return Object.assign({}, state, {
+      return { ...state,
         extensions: action.payload
-      });
+      };
+
+    case `SET_PROGRAM_STATUS`:
+      return { ...state,
+        status: `BOOTSTRAP_FINISHED`
+      };
 
     default:
       return state;
diff --git a/node_modules/gatsby/dist/redux/reducers/program.js.map b/node_modules/gatsby/dist/redux/reducers/program.js.map
index b649554..179c9fc 100644
--- a/node_modules/gatsby/dist/redux/reducers/program.js.map
+++ b/node_modules/gatsby/dist/redux/reducers/program.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/redux/reducers/program.js"],"names":["module","exports","state","directory","action","type","payload","extensions"],"mappings":";;AAAAA,MAAM,CAACC,OAAP,GAAiB,CAACC,KAAK,GAAG;AAAEC,EAAAA,SAAS,EAAG;AAAd,CAAT,EAA6BC,MAA7B,KAAwC;AACvD,UAAQA,MAAM,CAACC,IAAf;AACE,SAAM,aAAN;AACE,+BACKD,MAAM,CAACE,OADZ;;AAIF,SAAM,wBAAN;AACE,+BACKJ,KADL;AAEEK,QAAAA,UAAU,EAAEH,MAAM,CAACE;AAFrB;;AAKF;AACE,aAAOJ,KAAP;AAbJ;AAeD,CAhBD","sourcesContent":["module.exports = (state = { directory: `/` }, action) => {\n  switch (action.type) {\n    case `SET_PROGRAM`:\n      return {\n        ...action.payload,\n      }\n\n    case `SET_PROGRAM_EXTENSIONS`:\n      return {\n        ...state,\n        extensions: action.payload,\n      }\n\n    default:\n      return state\n  }\n}\n"],"file":"program.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/redux/reducers/program.js"],"names":["module","exports","state","directory","action","type","payload","extensions","status"],"mappings":";;AAAAA,MAAM,CAACC,OAAP,GAAiB,CACfC,KAAK,GAAG;AAAEC,EAAAA,SAAS,EAAG,GAAd;AAAkBD,EAAAA,KAAK,EAAG;AAA1B,CADO,EAEfE,MAFe,KAGZ;AACH,UAAQA,MAAM,CAACC,IAAf;AACE,SAAM,aAAN;AACE,aAAO,EACL,GAAGD,MAAM,CAACE;AADL,OAAP;;AAIF,SAAM,wBAAN;AACE,aAAO,EACL,GAAGJ,KADE;AAELK,QAAAA,UAAU,EAAEH,MAAM,CAACE;AAFd,OAAP;;AAKF,SAAM,oBAAN;AACE,aAAO,EACL,GAAGJ,KADE;AAELM,QAAAA,MAAM,EAAG;AAFJ,OAAP;;AAKF;AACE,aAAON,KAAP;AAnBJ;AAqBD,CAzBD","sourcesContent":["module.exports = (\n  state = { directory: `/`, state: `BOOTSTRAPPING` },\n  action\n) => {\n  switch (action.type) {\n    case `SET_PROGRAM`:\n      return {\n        ...action.payload,\n      }\n\n    case `SET_PROGRAM_EXTENSIONS`:\n      return {\n        ...state,\n        extensions: action.payload,\n      }\n\n    case `SET_PROGRAM_STATUS`:\n      return {\n        ...state,\n        status: `BOOTSTRAP_FINISHED`,\n      }\n\n    default:\n      return state\n  }\n}\n"],"file":"program.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/redux/reducers/resolved-nodes.js b/node_modules/gatsby/dist/redux/reducers/resolved-nodes.js
index cbafa25..58a8dc5 100644
--- a/node_modules/gatsby/dist/redux/reducers/resolved-nodes.js
+++ b/node_modules/gatsby/dist/redux/reducers/resolved-nodes.js
@@ -10,9 +10,10 @@ module.exports = (state = new Map(), action) => {
 
     case `SET_RESOLVED_NODES`:
       {
-        const _action$payload = action.payload,
-              key = _action$payload.key,
-              nodes = _action$payload.nodes;
+        const {
+          key,
+          nodes
+        } = action.payload;
         state.set(key, nodes);
         return state;
       }
diff --git a/node_modules/gatsby/dist/redux/reducers/resolved-nodes.js.map b/node_modules/gatsby/dist/redux/reducers/resolved-nodes.js.map
index 4aed735..72e9512 100644
--- a/node_modules/gatsby/dist/redux/reducers/resolved-nodes.js.map
+++ b/node_modules/gatsby/dist/redux/reducers/resolved-nodes.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/redux/reducers/resolved-nodes.js"],"names":["module","exports","state","Map","action","type","payload","key","nodes","set"],"mappings":";;AAAAA,MAAM,CAACC,OAAP,GAAiB,CAACC,KAAK,GAAG,IAAIC,GAAJ,EAAT,EAAoBC,MAApB,KAA+B;AAC9C,UAAQA,MAAM,CAACC,IAAf;AACE,SAAM,cAAN;AACA,SAAM,aAAN;AACA,SAAM,aAAN;AACA,SAAM,cAAN;AACE,aAAO,IAAIF,GAAJ,EAAP;;AAEF,SAAM,oBAAN;AAA2B;AAAA,gCACFC,MAAM,CAACE,OADL;AAAA,cACjBC,GADiB,mBACjBA,GADiB;AAAA,cACZC,KADY,mBACZA,KADY;AAEzBN,QAAAA,KAAK,CAACO,GAAN,CAAUF,GAAV,EAAeC,KAAf;AACA,eAAON,KAAP;AACD;;AAED;AACE,aAAOA,KAAP;AAdJ;AAgBD,CAjBD","sourcesContent":["module.exports = (state = new Map(), action) => {\n  switch (action.type) {\n    case `DELETE_CACHE`:\n    case `CREATE_NODE`:\n    case `DELETE_NODE`:\n    case `DELETE_NODES`:\n      return new Map()\n\n    case `SET_RESOLVED_NODES`: {\n      const { key, nodes } = action.payload\n      state.set(key, nodes)\n      return state\n    }\n\n    default:\n      return state\n  }\n}\n"],"file":"resolved-nodes.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/redux/reducers/resolved-nodes.js"],"names":["module","exports","state","Map","action","type","key","nodes","payload","set"],"mappings":";;AAAAA,MAAM,CAACC,OAAP,GAAiB,CAACC,KAAK,GAAG,IAAIC,GAAJ,EAAT,EAAoBC,MAApB,KAA+B;AAC9C,UAAQA,MAAM,CAACC,IAAf;AACE,SAAM,cAAN;AACA,SAAM,aAAN;AACA,SAAM,aAAN;AACA,SAAM,cAAN;AACE,aAAO,IAAIF,GAAJ,EAAP;;AAEF,SAAM,oBAAN;AAA2B;AACzB,cAAM;AAAEG,UAAAA,GAAF;AAAOC,UAAAA;AAAP,YAAiBH,MAAM,CAACI,OAA9B;AACAN,QAAAA,KAAK,CAACO,GAAN,CAAUH,GAAV,EAAeC,KAAf;AACA,eAAOL,KAAP;AACD;;AAED;AACE,aAAOA,KAAP;AAdJ;AAgBD,CAjBD","sourcesContent":["module.exports = (state = new Map(), action) => {\n  switch (action.type) {\n    case `DELETE_CACHE`:\n    case `CREATE_NODE`:\n    case `DELETE_NODE`:\n    case `DELETE_NODES`:\n      return new Map()\n\n    case `SET_RESOLVED_NODES`: {\n      const { key, nodes } = action.payload\n      state.set(key, nodes)\n      return state\n    }\n\n    default:\n      return state\n  }\n}\n"],"file":"resolved-nodes.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/redux/reducers/schema-customization.js b/node_modules/gatsby/dist/redux/reducers/schema-customization.js
index ba1c707..0b0c1cf 100644
--- a/node_modules/gatsby/dist/redux/reducers/schema-customization.js
+++ b/node_modules/gatsby/dist/redux/reducers/schema-customization.js
@@ -9,28 +9,36 @@ module.exports = (state = {
 }, action) => {
   switch (action.type) {
     case `ADD_THIRD_PARTY_SCHEMA`:
-      return Object.assign({}, state, {
+      return { ...state,
         thirdPartySchemas: [...state.thirdPartySchemas, action.payload]
-      });
+      };
 
     case `SET_SCHEMA_COMPOSER`:
-      return Object.assign({}, state, {
+      return { ...state,
         composer: action.payload
-      });
+      };
 
     case `CREATE_TYPES`:
       {
         let types;
 
         if (_.isArray(action.payload)) {
-          types = [...state.types, ...action.payload];
+          types = [...state.types, ...action.payload.map(typeOrTypeDef => {
+            return {
+              typeOrTypeDef,
+              plugin: action.plugin
+            };
+          })];
         } else {
-          types = [...state.types, action.payload];
+          types = [...state.types, {
+            typeOrTypeDef: action.payload,
+            plugin: action.plugin
+          }];
         }
 
-        return Object.assign({}, state, {
+        return { ...state,
           types
-        });
+        };
       }
 
     case `DELETE_CACHE`:
diff --git a/node_modules/gatsby/dist/redux/reducers/schema-customization.js.map b/node_modules/gatsby/dist/redux/reducers/schema-customization.js.map
index 3582d42..67ebd3a 100644
--- a/node_modules/gatsby/dist/redux/reducers/schema-customization.js.map
+++ b/node_modules/gatsby/dist/redux/reducers/schema-customization.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/redux/reducers/schema-customization.js"],"names":["_","require","module","exports","state","composer","thirdPartySchemas","types","action","type","payload","isArray"],"mappings":";;AAAA,MAAMA,CAAC,GAAGC,OAAO,CAAE,QAAF,CAAjB;;AACAC,MAAM,CAACC,OAAP,GAAiB,CACfC,KAAK,GAAG;AACNC,EAAAA,QAAQ,EAAE,IADJ;AAENC,EAAAA,iBAAiB,EAAE,EAFb;AAGNC,EAAAA,KAAK,EAAE;AAHD,CADO,EAMfC,MANe,KAOZ;AACH,UAAQA,MAAM,CAACC,IAAf;AACE,SAAM,wBAAN;AACE,+BACKL,KADL;AAEEE,QAAAA,iBAAiB,EAAE,CAAC,GAAGF,KAAK,CAACE,iBAAV,EAA6BE,MAAM,CAACE,OAApC;AAFrB;;AAIF,SAAM,qBAAN;AACE,+BACKN,KADL;AAEEC,QAAAA,QAAQ,EAAEG,MAAM,CAACE;AAFnB;;AAIF,SAAM,cAAN;AAAqB;AACnB,YAAIH,KAAJ;;AACA,YAAIP,CAAC,CAACW,OAAF,CAAUH,MAAM,CAACE,OAAjB,CAAJ,EAA+B;AAC7BH,UAAAA,KAAK,GAAG,CAAC,GAAGH,KAAK,CAACG,KAAV,EAAiB,GAAGC,MAAM,CAACE,OAA3B,CAAR;AACD,SAFD,MAEO;AACLH,UAAAA,KAAK,GAAG,CAAC,GAAGH,KAAK,CAACG,KAAV,EAAiBC,MAAM,CAACE,OAAxB,CAAR;AACD;;AACD,iCACKN,KADL;AAEEG,UAAAA;AAFF;AAID;;AACD,SAAM,cAAN;AACE,aAAO;AACLF,QAAAA,QAAQ,EAAE,IADL;AAELC,QAAAA,iBAAiB,EAAE,EAFd;AAGLC,QAAAA,KAAK,EAAE;AAHF,OAAP;;AAKF;AACE,aAAOH,KAAP;AA9BJ;AAgCD,CAxCD","sourcesContent":["const _ = require(`lodash`)\nmodule.exports = (\n  state = {\n    composer: null,\n    thirdPartySchemas: [],\n    types: [],\n  },\n  action\n) => {\n  switch (action.type) {\n    case `ADD_THIRD_PARTY_SCHEMA`:\n      return {\n        ...state,\n        thirdPartySchemas: [...state.thirdPartySchemas, action.payload],\n      }\n    case `SET_SCHEMA_COMPOSER`:\n      return {\n        ...state,\n        composer: action.payload,\n      }\n    case `CREATE_TYPES`: {\n      let types\n      if (_.isArray(action.payload)) {\n        types = [...state.types, ...action.payload]\n      } else {\n        types = [...state.types, action.payload]\n      }\n      return {\n        ...state,\n        types,\n      }\n    }\n    case `DELETE_CACHE`:\n      return {\n        composer: null,\n        thirdPartySchemas: [],\n        types: [],\n      }\n    default:\n      return state\n  }\n}\n"],"file":"schema-customization.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/redux/reducers/schema-customization.js"],"names":["_","require","module","exports","state","composer","thirdPartySchemas","types","action","type","payload","isArray","map","typeOrTypeDef","plugin"],"mappings":";;AAAA,MAAMA,CAAC,GAAGC,OAAO,CAAE,QAAF,CAAjB;;AACAC,MAAM,CAACC,OAAP,GAAiB,CACfC,KAAK,GAAG;AACNC,EAAAA,QAAQ,EAAE,IADJ;AAENC,EAAAA,iBAAiB,EAAE,EAFb;AAGNC,EAAAA,KAAK,EAAE;AAHD,CADO,EAMfC,MANe,KAOZ;AACH,UAAQA,MAAM,CAACC,IAAf;AACE,SAAM,wBAAN;AACE,aAAO,EACL,GAAGL,KADE;AAELE,QAAAA,iBAAiB,EAAE,CAAC,GAAGF,KAAK,CAACE,iBAAV,EAA6BE,MAAM,CAACE,OAApC;AAFd,OAAP;;AAIF,SAAM,qBAAN;AACE,aAAO,EACL,GAAGN,KADE;AAELC,QAAAA,QAAQ,EAAEG,MAAM,CAACE;AAFZ,OAAP;;AAIF,SAAM,cAAN;AAAqB;AACnB,YAAIH,KAAJ;;AACA,YAAIP,CAAC,CAACW,OAAF,CAAUH,MAAM,CAACE,OAAjB,CAAJ,EAA+B;AAC7BH,UAAAA,KAAK,GAAG,CACN,GAAGH,KAAK,CAACG,KADH,EAEN,GAAGC,MAAM,CAACE,OAAP,CAAeE,GAAf,CAAmBC,aAAa,IAAI;AACrC,mBAAO;AACLA,cAAAA,aADK;AAELC,cAAAA,MAAM,EAAEN,MAAM,CAACM;AAFV,aAAP;AAID,WALE,CAFG,CAAR;AASD,SAVD,MAUO;AACLP,UAAAA,KAAK,GAAG,CACN,GAAGH,KAAK,CAACG,KADH,EAEN;AAAEM,YAAAA,aAAa,EAAEL,MAAM,CAACE,OAAxB;AAAiCI,YAAAA,MAAM,EAAEN,MAAM,CAACM;AAAhD,WAFM,CAAR;AAID;;AACD,eAAO,EACL,GAAGV,KADE;AAELG,UAAAA;AAFK,SAAP;AAID;;AACD,SAAM,cAAN;AACE,aAAO;AACLF,QAAAA,QAAQ,EAAE,IADL;AAELC,QAAAA,iBAAiB,EAAE,EAFd;AAGLC,QAAAA,KAAK,EAAE;AAHF,OAAP;;AAKF;AACE,aAAOH,KAAP;AAzCJ;AA2CD,CAnDD","sourcesContent":["const _ = require(`lodash`)\nmodule.exports = (\n  state = {\n    composer: null,\n    thirdPartySchemas: [],\n    types: [],\n  },\n  action\n) => {\n  switch (action.type) {\n    case `ADD_THIRD_PARTY_SCHEMA`:\n      return {\n        ...state,\n        thirdPartySchemas: [...state.thirdPartySchemas, action.payload],\n      }\n    case `SET_SCHEMA_COMPOSER`:\n      return {\n        ...state,\n        composer: action.payload,\n      }\n    case `CREATE_TYPES`: {\n      let types\n      if (_.isArray(action.payload)) {\n        types = [\n          ...state.types,\n          ...action.payload.map(typeOrTypeDef => {\n            return {\n              typeOrTypeDef,\n              plugin: action.plugin,\n            }\n          }),\n        ]\n      } else {\n        types = [\n          ...state.types,\n          { typeOrTypeDef: action.payload, plugin: action.plugin },\n        ]\n      }\n      return {\n        ...state,\n        types,\n      }\n    }\n    case `DELETE_CACHE`:\n      return {\n        composer: null,\n        thirdPartySchemas: [],\n        types: [],\n      }\n    default:\n      return state\n  }\n}\n"],"file":"schema-customization.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/redux/reducers/status.js b/node_modules/gatsby/dist/redux/reducers/status.js
index 983c358..bd69cbf 100644
--- a/node_modules/gatsby/dist/redux/reducers/status.js
+++ b/node_modules/gatsby/dist/redux/reducers/status.js
@@ -12,9 +12,9 @@ module.exports = (state = {
       };
 
     case `UPDATE_PLUGINS_HASH`:
-      return Object.assign({}, state, {
+      return { ...state,
         PLUGINS_HASH: action.payload
-      });
+      };
 
     case `SET_PLUGIN_STATUS`:
       if (!action.plugin && !action.plugin.name) {
@@ -25,11 +25,11 @@ module.exports = (state = {
         throw new Error(`You must pass an object into setPluginStatus. What was passed in was ${JSON.stringify(action.payload, null, 4)}`);
       }
 
-      return Object.assign({}, state, {
-        plugins: Object.assign({}, state.plugins, {
+      return { ...state,
+        plugins: { ...state.plugins,
           [action.plugin.name]: _.merge({}, state.plugins[action.plugin.name], action.payload)
-        })
-      });
+        }
+      };
 
     default:
       return state;
diff --git a/node_modules/gatsby/dist/redux/reducers/status.js.map b/node_modules/gatsby/dist/redux/reducers/status.js.map
index 7008edb..98a197e 100644
--- a/node_modules/gatsby/dist/redux/reducers/status.js.map
+++ b/node_modules/gatsby/dist/redux/reducers/status.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/redux/reducers/status.js"],"names":["_","require","module","exports","state","plugins","action","type","PLUGINS_HASH","payload","plugin","name","Error","isObject","JSON","stringify","merge"],"mappings":";;AAAA,MAAMA,CAAC,GAAGC,OAAO,CAAE,QAAF,CAAjB;;AAEAC,MAAM,CAACC,OAAP,GAAiB,CAACC,KAAK,GAAG;AAAEC,EAAAA,OAAO,EAAE;AAAX,CAAT,EAA0BC,MAA1B,KAAqC;AACpD,UAAQA,MAAM,CAACC,IAAf;AACE,SAAM,cAAN;AACE,aAAO;AAAEF,QAAAA,OAAO,EAAE;AAAX,OAAP;;AACF,SAAM,qBAAN;AACE,+BACKD,KADL;AAEEI,QAAAA,YAAY,EAAEF,MAAM,CAACG;AAFvB;;AAIF,SAAM,mBAAN;AACE,UAAI,CAACH,MAAM,CAACI,MAAR,IAAkB,CAACJ,MAAM,CAACI,MAAP,CAAcC,IAArC,EAA2C;AACzC,cAAM,IAAIC,KAAJ,CAAW,8CAAX,CAAN;AACD;;AACD,UAAI,CAACZ,CAAC,CAACa,QAAF,CAAWP,MAAM,CAACG,OAAlB,CAAL,EAAiC;AAC/B,cAAM,IAAIG,KAAJ,CACH,wEAAuEE,IAAI,CAACC,SAAL,CACtET,MAAM,CAACG,OAD+D,EAEtE,IAFsE,EAGtE,CAHsE,CAItE,EALE,CAAN;AAOD;;AACD,+BACKL,KADL;AAEEC,QAAAA,OAAO,oBACFD,KAAK,CAACC,OADJ;AAEL,WAACC,MAAM,CAACI,MAAP,CAAcC,IAAf,GAAsBX,CAAC,CAACgB,KAAF,CACpB,EADoB,EAEpBZ,KAAK,CAACC,OAAN,CAAcC,MAAM,CAACI,MAAP,CAAcC,IAA5B,CAFoB,EAGpBL,MAAM,CAACG,OAHa;AAFjB;AAFT;;AAWF;AACE,aAAOL,KAAP;AAjCJ;AAmCD,CApCD","sourcesContent":["const _ = require(`lodash`)\n\nmodule.exports = (state = { plugins: {} }, action) => {\n  switch (action.type) {\n    case `DELETE_CACHE`:\n      return { plugins: {} }\n    case `UPDATE_PLUGINS_HASH`:\n      return {\n        ...state,\n        PLUGINS_HASH: action.payload,\n      }\n    case `SET_PLUGIN_STATUS`:\n      if (!action.plugin && !action.plugin.name) {\n        throw new Error(`You can't set plugin status without a plugin`)\n      }\n      if (!_.isObject(action.payload)) {\n        throw new Error(\n          `You must pass an object into setPluginStatus. What was passed in was ${JSON.stringify(\n            action.payload,\n            null,\n            4\n          )}`\n        )\n      }\n      return {\n        ...state,\n        plugins: {\n          ...state.plugins,\n          [action.plugin.name]: _.merge(\n            {},\n            state.plugins[action.plugin.name],\n            action.payload\n          ),\n        },\n      }\n    default:\n      return state\n  }\n}\n"],"file":"status.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/redux/reducers/status.js"],"names":["_","require","module","exports","state","plugins","action","type","PLUGINS_HASH","payload","plugin","name","Error","isObject","JSON","stringify","merge"],"mappings":";;AAAA,MAAMA,CAAC,GAAGC,OAAO,CAAE,QAAF,CAAjB;;AAEAC,MAAM,CAACC,OAAP,GAAiB,CAACC,KAAK,GAAG;AAAEC,EAAAA,OAAO,EAAE;AAAX,CAAT,EAA0BC,MAA1B,KAAqC;AACpD,UAAQA,MAAM,CAACC,IAAf;AACE,SAAM,cAAN;AACE,aAAO;AAAEF,QAAAA,OAAO,EAAE;AAAX,OAAP;;AACF,SAAM,qBAAN;AACE,aAAO,EACL,GAAGD,KADE;AAELI,QAAAA,YAAY,EAAEF,MAAM,CAACG;AAFhB,OAAP;;AAIF,SAAM,mBAAN;AACE,UAAI,CAACH,MAAM,CAACI,MAAR,IAAkB,CAACJ,MAAM,CAACI,MAAP,CAAcC,IAArC,EAA2C;AACzC,cAAM,IAAIC,KAAJ,CAAW,8CAAX,CAAN;AACD;;AACD,UAAI,CAACZ,CAAC,CAACa,QAAF,CAAWP,MAAM,CAACG,OAAlB,CAAL,EAAiC;AAC/B,cAAM,IAAIG,KAAJ,CACH,wEAAuEE,IAAI,CAACC,SAAL,CACtET,MAAM,CAACG,OAD+D,EAEtE,IAFsE,EAGtE,CAHsE,CAItE,EALE,CAAN;AAOD;;AACD,aAAO,EACL,GAAGL,KADE;AAELC,QAAAA,OAAO,EAAE,EACP,GAAGD,KAAK,CAACC,OADF;AAEP,WAACC,MAAM,CAACI,MAAP,CAAcC,IAAf,GAAsBX,CAAC,CAACgB,KAAF,CACpB,EADoB,EAEpBZ,KAAK,CAACC,OAAN,CAAcC,MAAM,CAACI,MAAP,CAAcC,IAA5B,CAFoB,EAGpBL,MAAM,CAACG,OAHa;AAFf;AAFJ,OAAP;;AAWF;AACE,aAAOL,KAAP;AAjCJ;AAmCD,CApCD","sourcesContent":["const _ = require(`lodash`)\n\nmodule.exports = (state = { plugins: {} }, action) => {\n  switch (action.type) {\n    case `DELETE_CACHE`:\n      return { plugins: {} }\n    case `UPDATE_PLUGINS_HASH`:\n      return {\n        ...state,\n        PLUGINS_HASH: action.payload,\n      }\n    case `SET_PLUGIN_STATUS`:\n      if (!action.plugin && !action.plugin.name) {\n        throw new Error(`You can't set plugin status without a plugin`)\n      }\n      if (!_.isObject(action.payload)) {\n        throw new Error(\n          `You must pass an object into setPluginStatus. What was passed in was ${JSON.stringify(\n            action.payload,\n            null,\n            4\n          )}`\n        )\n      }\n      return {\n        ...state,\n        plugins: {\n          ...state.plugins,\n          [action.plugin.name]: _.merge(\n            {},\n            state.plugins[action.plugin.name],\n            action.payload\n          ),\n        },\n      }\n    default:\n      return state\n  }\n}\n"],"file":"status.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/redux/reducers/themes.js b/node_modules/gatsby/dist/redux/reducers/themes.js
index 16900a4..9c00c56 100644
--- a/node_modules/gatsby/dist/redux/reducers/themes.js
+++ b/node_modules/gatsby/dist/redux/reducers/themes.js
@@ -3,9 +3,9 @@
 module.exports = (state = {}, action) => {
   switch (action.type) {
     case `SET_RESOLVED_THEMES`:
-      return Object.assign({}, state, {
+      return { ...state,
         themes: action.payload
-      });
+      };
 
     default:
       return state;
diff --git a/node_modules/gatsby/dist/redux/reducers/themes.js.map b/node_modules/gatsby/dist/redux/reducers/themes.js.map
index 35d8216..bc72838 100644
--- a/node_modules/gatsby/dist/redux/reducers/themes.js.map
+++ b/node_modules/gatsby/dist/redux/reducers/themes.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/redux/reducers/themes.js"],"names":["module","exports","state","action","type","themes","payload"],"mappings":";;AAAAA,MAAM,CAACC,OAAP,GAAiB,CAACC,KAAK,GAAG,EAAT,EAAaC,MAAb,KAAwB;AACvC,UAAQA,MAAM,CAACC,IAAf;AACE,SAAM,qBAAN;AACE,+BACKF,KADL;AAEEG,QAAAA,MAAM,EAAEF,MAAM,CAACG;AAFjB;;AAKF;AACE,aAAOJ,KAAP;AARJ;AAUD,CAXD","sourcesContent":["module.exports = (state = {}, action) => {\n  switch (action.type) {\n    case `SET_RESOLVED_THEMES`:\n      return {\n        ...state,\n        themes: action.payload,\n      }\n\n    default:\n      return state\n  }\n}\n"],"file":"themes.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/redux/reducers/themes.js"],"names":["module","exports","state","action","type","themes","payload"],"mappings":";;AAAAA,MAAM,CAACC,OAAP,GAAiB,CAACC,KAAK,GAAG,EAAT,EAAaC,MAAb,KAAwB;AACvC,UAAQA,MAAM,CAACC,IAAf;AACE,SAAM,qBAAN;AACE,aAAO,EACL,GAAGF,KADE;AAELG,QAAAA,MAAM,EAAEF,MAAM,CAACG;AAFV,OAAP;;AAKF;AACE,aAAOJ,KAAP;AARJ;AAUD,CAXD","sourcesContent":["module.exports = (state = {}, action) => {\n  switch (action.type) {\n    case `SET_RESOLVED_THEMES`:\n      return {\n        ...state,\n        themes: action.payload,\n      }\n\n    default:\n      return state\n  }\n}\n"],"file":"themes.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/redux/reducers/webpack.js b/node_modules/gatsby/dist/redux/reducers/webpack.js
index 9eba397..8397d4e 100644
--- a/node_modules/gatsby/dist/redux/reducers/webpack.js
+++ b/node_modules/gatsby/dist/redux/reducers/webpack.js
@@ -15,7 +15,8 @@ module.exports = (state = {}, action) => {
       }
 
     case `REPLACE_WEBPACK_CONFIG`:
-      return Object.assign({}, action.payload);
+      return { ...action.payload
+      };
 
     default:
       return state;
diff --git a/node_modules/gatsby/dist/redux/reducers/webpack.js.map b/node_modules/gatsby/dist/redux/reducers/webpack.js.map
index e49036c..f1165c9 100644
--- a/node_modules/gatsby/dist/redux/reducers/webpack.js.map
+++ b/node_modules/gatsby/dist/redux/reducers/webpack.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/redux/reducers/webpack.js"],"names":["merge","require","module","exports","state","action","type","nextConfig","payload","entry","output","target","resolveLoaders"],"mappings":";;AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAE,eAAF,CAArB;;AAEAC,MAAM,CAACC,OAAP,GAAiB,CAACC,KAAK,GAAG,EAAT,EAAaC,MAAb,KAAwB;AACvC,UAAQA,MAAM,CAACC,IAAf;AACE,SAAM,oBAAN;AAA2B;AACzB,YAAIC,UAAU,GAAGF,MAAM,CAACG,OAAxB;AACA,eAAOD,UAAU,CAACE,KAAlB;AACA,eAAOF,UAAU,CAACG,MAAlB;AACA,eAAOH,UAAU,CAACI,MAAlB;AACA,eAAOJ,UAAU,CAACK,cAAlB;AAEA,eAAOZ,KAAK,CAACI,KAAD,EAAQG,UAAR,CAAZ;AACD;;AACD,SAAM,wBAAN;AACE,+BAAYF,MAAM,CAACG,OAAnB;;AAEF;AACE,aAAOJ,KAAP;AAdJ;AAgBD,CAjBD","sourcesContent":["const merge = require(`webpack-merge`)\n\nmodule.exports = (state = {}, action) => {\n  switch (action.type) {\n    case `SET_WEBPACK_CONFIG`: {\n      let nextConfig = action.payload\n      delete nextConfig.entry\n      delete nextConfig.output\n      delete nextConfig.target\n      delete nextConfig.resolveLoaders\n\n      return merge(state, nextConfig)\n    }\n    case `REPLACE_WEBPACK_CONFIG`:\n      return { ...action.payload }\n\n    default:\n      return state\n  }\n}\n"],"file":"webpack.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/redux/reducers/webpack.js"],"names":["merge","require","module","exports","state","action","type","nextConfig","payload","entry","output","target","resolveLoaders"],"mappings":";;AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAE,eAAF,CAArB;;AAEAC,MAAM,CAACC,OAAP,GAAiB,CAACC,KAAK,GAAG,EAAT,EAAaC,MAAb,KAAwB;AACvC,UAAQA,MAAM,CAACC,IAAf;AACE,SAAM,oBAAN;AAA2B;AACzB,YAAIC,UAAU,GAAGF,MAAM,CAACG,OAAxB;AACA,eAAOD,UAAU,CAACE,KAAlB;AACA,eAAOF,UAAU,CAACG,MAAlB;AACA,eAAOH,UAAU,CAACI,MAAlB;AACA,eAAOJ,UAAU,CAACK,cAAlB;AAEA,eAAOZ,KAAK,CAACI,KAAD,EAAQG,UAAR,CAAZ;AACD;;AACD,SAAM,wBAAN;AACE,aAAO,EAAE,GAAGF,MAAM,CAACG;AAAZ,OAAP;;AAEF;AACE,aAAOJ,KAAP;AAdJ;AAgBD,CAjBD","sourcesContent":["const merge = require(`webpack-merge`)\n\nmodule.exports = (state = {}, action) => {\n  switch (action.type) {\n    case `SET_WEBPACK_CONFIG`: {\n      let nextConfig = action.payload\n      delete nextConfig.entry\n      delete nextConfig.output\n      delete nextConfig.target\n      delete nextConfig.resolveLoaders\n\n      return merge(state, nextConfig)\n    }\n    case `REPLACE_WEBPACK_CONFIG`:\n      return { ...action.payload }\n\n    default:\n      return state\n  }\n}\n"],"file":"webpack.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/redux/run-sift.js b/node_modules/gatsby/dist/redux/run-sift.js
index c7ae080..6daab23 100644
--- a/node_modules/gatsby/dist/redux/run-sift.js
+++ b/node_modules/gatsby/dist/redux/run-sift.js
@@ -6,9 +6,10 @@ const _ = require(`lodash`);
 
 const prepareRegex = require(`../utils/prepare-regex`);
 
-const _require = require(`./prepare-nodes`),
-      resolveNodes = _require.resolveNodes,
-      resolveRecursive = _require.resolveRecursive; /////////////////////////////////////////////////////////////////////
+const {
+  resolveNodes,
+  resolveRecursive
+} = require(`./prepare-nodes`); /////////////////////////////////////////////////////////////////////
 // Parse filter
 /////////////////////////////////////////////////////////////////////
 
@@ -135,25 +136,26 @@ function handleMany(siftArgs, nodes, sort) {
 
 
 module.exports = args => {
-  const _require2 = require(`../db/nodes`),
-        getNode = _require2.getNode,
-        getNodesByType = _require2.getNodesByType;
+  const {
+    getNode,
+    getNodesByType
+  } = require(`../db/nodes`);
 
-  const queryArgs = args.queryArgs,
-        gqlType = args.gqlType,
-        _args$firstOnly = args.firstOnly,
-        firstOnly = _args$firstOnly === void 0 ? false : _args$firstOnly; // If nodes weren't provided, then load them from the DB
+  const {
+    queryArgs,
+    gqlType,
+    firstOnly = false
+  } = args; // If nodes weren't provided, then load them from the DB
 
   const nodes = args.nodes || getNodesByType(gqlType.name);
-
-  const _parseFilter = parseFilter(queryArgs.filter),
-        siftArgs = _parseFilter.siftArgs,
-        fieldsToSift = _parseFilter.fieldsToSift; // FIXME: fieldsToSift must include `sort.fields` as well as the
+  const {
+    siftArgs,
+    fieldsToSift
+  } = parseFilter(queryArgs.filter); // FIXME: fieldsToSift must include `sort.fields` as well as the
   // `field` arg on `group` and `distinct`
   // If the the query for single node only has a filter for an "id"
   // using "eq" operator, then we'll just grab that ID and return it.
 
-
   if (isEqId(firstOnly, fieldsToSift, siftArgs)) {
     const node = getNode(siftArgs[0].id[`$eq`]);
 
diff --git a/node_modules/gatsby/dist/redux/run-sift.js.map b/node_modules/gatsby/dist/redux/run-sift.js.map
index 464003f..5be7866 100644
--- a/node_modules/gatsby/dist/redux/run-sift.js.map
+++ b/node_modules/gatsby/dist/redux/run-sift.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/redux/run-sift.js"],"names":["sift","require","_","prepareRegex","resolveNodes","resolveRecursive","siftifyArgs","object","newObject","each","v","k","isPlainObject","Minimatch","mm","makeRe","extractFieldsToSift","filter","Object","keys","reduce","acc","key","value","parseFilter","siftArgs","fieldsToSift","push","isEqId","firstOnly","length","id","handleFirst","nodes","index","isEmpty","indexOf","$and","handleMany","sort","result","sortFields","fields","map","field","get","sortOrder","order","toLowerCase","orderBy","module","exports","args","getNode","getNodesByType","queryArgs","gqlType","name","node","internal","type","getFields","then","resolvedNodes"],"mappings":"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","sourcesContent":["// @flow\nconst sift = require(`sift`)\nconst _ = require(`lodash`)\nconst prepareRegex = require(`../utils/prepare-regex`)\nconst { resolveNodes, resolveRecursive } = require(`./prepare-nodes`)\n\n/////////////////////////////////////////////////////////////////////\n// Parse filter\n/////////////////////////////////////////////////////////////////////\n\nfunction siftifyArgs(object) {\n  const newObject = {}\n  _.each(object, (v, k) => {\n    if (_.isPlainObject(v)) {\n      if (k === `elemMatch`) {\n        k = `$elemMatch`\n      }\n      newObject[k] = siftifyArgs(v)\n    } else {\n      // Compile regex first.\n      if (k === `regex`) {\n        newObject[`$regex`] = prepareRegex(v)\n      } else if (k === `glob`) {\n        const Minimatch = require(`minimatch`).Minimatch\n        const mm = new Minimatch(v)\n        newObject[`$regex`] = mm.makeRe()\n      } else {\n        newObject[`$${k}`] = v\n      }\n    }\n  })\n  return newObject\n}\n\n// Build an object that excludes the innermost leafs,\n// this avoids including { eq: x } when resolving fields.\nconst extractFieldsToSift = filter =>\n  Object.keys(filter).reduce((acc, key) => {\n    let value = filter[key]\n    let k = Object.keys(value)[0]\n    let v = value[k]\n    if (_.isPlainObject(value) && _.isPlainObject(v)) {\n      acc[key] =\n        k === `elemMatch` ? extractFieldsToSift(v) : extractFieldsToSift(value)\n    } else {\n      acc[key] = true\n    }\n    return acc\n  }, {})\n\n/**\n * Parse filter and returns an object with two fields:\n * - siftArgs: the filter in a format that sift understands\n * - fieldsToSift: filter with operate leaves (e.g { eq: 3 })\n *   removed. Used later to resolve all filter fields\n */\nfunction parseFilter(filter) {\n  const siftArgs = []\n  let fieldsToSift = {}\n  if (filter) {\n    _.each(filter, (v, k) => {\n      siftArgs.push(\n        siftifyArgs({\n          [k]: v,\n        })\n      )\n    })\n    fieldsToSift = extractFieldsToSift(filter)\n  }\n  return { siftArgs, fieldsToSift }\n}\n\n/////////////////////////////////////////////////////////////////////\n// Run Sift\n/////////////////////////////////////////////////////////////////////\n\nfunction isEqId(firstOnly, fieldsToSift, siftArgs) {\n  return (\n    firstOnly &&\n    Object.keys(fieldsToSift).length === 1 &&\n    Object.keys(fieldsToSift)[0] === `id` &&\n    Object.keys(siftArgs[0].id).length === 1 &&\n    Object.keys(siftArgs[0].id)[0] === `$eq`\n  )\n}\n\nfunction handleFirst(siftArgs, nodes) {\n  const index = _.isEmpty(siftArgs)\n    ? 0\n    : sift.indexOf(\n        {\n          $and: siftArgs,\n        },\n        nodes\n      )\n\n  if (index !== -1) {\n    return [nodes[index]]\n  } else {\n    return []\n  }\n}\n\nfunction handleMany(siftArgs, nodes, sort) {\n  let result = _.isEmpty(siftArgs)\n    ? nodes\n    : sift(\n        {\n          $and: siftArgs,\n        },\n        nodes\n      )\n\n  if (!result || !result.length) return null\n\n  // Sort results.\n  if (sort) {\n    // create functions that return the item to compare on\n    // uses _.get so nested fields can be retrieved\n    const sortFields = sort.fields.map(field => v => _.get(v, field))\n    const sortOrder = sort.order.map(order => order.toLowerCase())\n\n    result = _.orderBy(result, sortFields, sortOrder)\n  }\n  return result\n}\n\n/**\n * Filters a list of nodes using mongodb-like syntax.\n *\n * @param args raw graphql query filter as an object\n * @param nodes The nodes array to run sift over (Optional\n *   will load itself if not present)\n * @param type gqlType. Created in build-node-types\n * @param firstOnly true if you want to return only the first result\n *   found. This will return a collection of size 1. Not a single\n *   element\n * @returns Collection of results. Collection will be limited to size\n *   if `firstOnly` is true\n */\nmodule.exports = (args: Object) => {\n  const { getNode, getNodesByType } = require(`../db/nodes`)\n\n  const { queryArgs, gqlType, firstOnly = false } = args\n\n  // If nodes weren't provided, then load them from the DB\n  const nodes = args.nodes || getNodesByType(gqlType.name)\n\n  const { siftArgs, fieldsToSift } = parseFilter(queryArgs.filter)\n  // FIXME: fieldsToSift must include `sort.fields` as well as the\n  // `field` arg on `group` and `distinct`\n\n  // If the the query for single node only has a filter for an \"id\"\n  // using \"eq\" operator, then we'll just grab that ID and return it.\n  if (isEqId(firstOnly, fieldsToSift, siftArgs)) {\n    const node = getNode(siftArgs[0].id[`$eq`])\n\n    if (!node || (node.internal && node.internal.type !== gqlType.name)) {\n      return []\n    }\n\n    return resolveRecursive(node, fieldsToSift, gqlType.getFields()).then(\n      node => (node ? [node] : [])\n    )\n  }\n\n  return resolveNodes(\n    nodes,\n    gqlType.name,\n    firstOnly,\n    fieldsToSift,\n    gqlType.getFields()\n  ).then(resolvedNodes => {\n    if (firstOnly) {\n      return handleFirst(siftArgs, resolvedNodes)\n    } else {\n      return handleMany(siftArgs, resolvedNodes, queryArgs.sort)\n    }\n  })\n}\n"],"file":"run-sift.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/redux/run-sift.js"],"names":["sift","require","_","prepareRegex","resolveNodes","resolveRecursive","siftifyArgs","object","newObject","each","v","k","isPlainObject","Minimatch","mm","makeRe","extractFieldsToSift","filter","Object","keys","reduce","acc","key","value","parseFilter","siftArgs","fieldsToSift","push","isEqId","firstOnly","length","id","handleFirst","nodes","index","isEmpty","indexOf","$and","handleMany","sort","result","sortFields","fields","map","field","get","sortOrder","order","toLowerCase","orderBy","module","exports","args","getNode","getNodesByType","queryArgs","gqlType","name","node","internal","type","getFields","then","resolvedNodes"],"mappings":"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","sourcesContent":["// @flow\nconst sift = require(`sift`)\nconst _ = require(`lodash`)\nconst prepareRegex = require(`../utils/prepare-regex`)\nconst { resolveNodes, resolveRecursive } = require(`./prepare-nodes`)\n\n/////////////////////////////////////////////////////////////////////\n// Parse filter\n/////////////////////////////////////////////////////////////////////\n\nfunction siftifyArgs(object) {\n  const newObject = {}\n  _.each(object, (v, k) => {\n    if (_.isPlainObject(v)) {\n      if (k === `elemMatch`) {\n        k = `$elemMatch`\n      }\n      newObject[k] = siftifyArgs(v)\n    } else {\n      // Compile regex first.\n      if (k === `regex`) {\n        newObject[`$regex`] = prepareRegex(v)\n      } else if (k === `glob`) {\n        const Minimatch = require(`minimatch`).Minimatch\n        const mm = new Minimatch(v)\n        newObject[`$regex`] = mm.makeRe()\n      } else {\n        newObject[`$${k}`] = v\n      }\n    }\n  })\n  return newObject\n}\n\n// Build an object that excludes the innermost leafs,\n// this avoids including { eq: x } when resolving fields.\nconst extractFieldsToSift = filter =>\n  Object.keys(filter).reduce((acc, key) => {\n    let value = filter[key]\n    let k = Object.keys(value)[0]\n    let v = value[k]\n    if (_.isPlainObject(value) && _.isPlainObject(v)) {\n      acc[key] =\n        k === `elemMatch` ? extractFieldsToSift(v) : extractFieldsToSift(value)\n    } else {\n      acc[key] = true\n    }\n    return acc\n  }, {})\n\n/**\n * Parse filter and returns an object with two fields:\n * - siftArgs: the filter in a format that sift understands\n * - fieldsToSift: filter with operate leaves (e.g { eq: 3 })\n *   removed. Used later to resolve all filter fields\n */\nfunction parseFilter(filter) {\n  const siftArgs = []\n  let fieldsToSift = {}\n  if (filter) {\n    _.each(filter, (v, k) => {\n      siftArgs.push(\n        siftifyArgs({\n          [k]: v,\n        })\n      )\n    })\n    fieldsToSift = extractFieldsToSift(filter)\n  }\n  return { siftArgs, fieldsToSift }\n}\n\n/////////////////////////////////////////////////////////////////////\n// Run Sift\n/////////////////////////////////////////////////////////////////////\n\nfunction isEqId(firstOnly, fieldsToSift, siftArgs) {\n  return (\n    firstOnly &&\n    Object.keys(fieldsToSift).length === 1 &&\n    Object.keys(fieldsToSift)[0] === `id` &&\n    Object.keys(siftArgs[0].id).length === 1 &&\n    Object.keys(siftArgs[0].id)[0] === `$eq`\n  )\n}\n\nfunction handleFirst(siftArgs, nodes) {\n  const index = _.isEmpty(siftArgs)\n    ? 0\n    : sift.indexOf(\n        {\n          $and: siftArgs,\n        },\n        nodes\n      )\n\n  if (index !== -1) {\n    return [nodes[index]]\n  } else {\n    return []\n  }\n}\n\nfunction handleMany(siftArgs, nodes, sort) {\n  let result = _.isEmpty(siftArgs)\n    ? nodes\n    : sift(\n        {\n          $and: siftArgs,\n        },\n        nodes\n      )\n\n  if (!result || !result.length) return null\n\n  // Sort results.\n  if (sort) {\n    // create functions that return the item to compare on\n    // uses _.get so nested fields can be retrieved\n    const sortFields = sort.fields.map(field => v => _.get(v, field))\n    const sortOrder = sort.order.map(order => order.toLowerCase())\n\n    result = _.orderBy(result, sortFields, sortOrder)\n  }\n  return result\n}\n\n/**\n * Filters a list of nodes using mongodb-like syntax.\n *\n * @param args raw graphql query filter as an object\n * @param nodes The nodes array to run sift over (Optional\n *   will load itself if not present)\n * @param type gqlType. Created in build-node-types\n * @param firstOnly true if you want to return only the first result\n *   found. This will return a collection of size 1. Not a single\n *   element\n * @returns Collection of results. Collection will be limited to size\n *   if `firstOnly` is true\n */\nmodule.exports = (args: Object) => {\n  const { getNode, getNodesByType } = require(`../db/nodes`)\n\n  const { queryArgs, gqlType, firstOnly = false } = args\n\n  // If nodes weren't provided, then load them from the DB\n  const nodes = args.nodes || getNodesByType(gqlType.name)\n\n  const { siftArgs, fieldsToSift } = parseFilter(queryArgs.filter)\n  // FIXME: fieldsToSift must include `sort.fields` as well as the\n  // `field` arg on `group` and `distinct`\n\n  // If the the query for single node only has a filter for an \"id\"\n  // using \"eq\" operator, then we'll just grab that ID and return it.\n  if (isEqId(firstOnly, fieldsToSift, siftArgs)) {\n    const node = getNode(siftArgs[0].id[`$eq`])\n\n    if (!node || (node.internal && node.internal.type !== gqlType.name)) {\n      return []\n    }\n\n    return resolveRecursive(node, fieldsToSift, gqlType.getFields()).then(\n      node => (node ? [node] : [])\n    )\n  }\n\n  return resolveNodes(\n    nodes,\n    gqlType.name,\n    firstOnly,\n    fieldsToSift,\n    gqlType.getFields()\n  ).then(resolvedNodes => {\n    if (firstOnly) {\n      return handleFirst(siftArgs, resolvedNodes)\n    } else {\n      return handleMany(siftArgs, resolvedNodes, queryArgs.sort)\n    }\n  })\n}\n"],"file":"run-sift.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/schema/context.js b/node_modules/gatsby/dist/schema/context.js
index 2d34de1..324de30 100644
--- a/node_modules/gatsby/dist/schema/context.js
+++ b/node_modules/gatsby/dist/schema/context.js
@@ -1,21 +1,22 @@
 "use strict";
 
-const _require = require(`./node-model`),
-      LocalNodeModel = _require.LocalNodeModel;
+const {
+  LocalNodeModel
+} = require(`./node-model`);
 
 const withResolverContext = (context, schema) => {
   const nodeStore = require(`../db/nodes`);
 
   const createPageDependency = require(`../redux/actions/add-page-dependency`);
 
-  return Object.assign({}, context, {
+  return { ...context,
     nodeModel: new LocalNodeModel({
       nodeStore,
       schema,
       createPageDependency,
       path: context.path
     })
-  });
+  };
 };
 
 module.exports = withResolverContext;
diff --git a/node_modules/gatsby/dist/schema/context.js.map b/node_modules/gatsby/dist/schema/context.js.map
index 1fb3a69..7c96431 100644
--- a/node_modules/gatsby/dist/schema/context.js.map
+++ b/node_modules/gatsby/dist/schema/context.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/schema/context.js"],"names":["require","LocalNodeModel","withResolverContext","context","schema","nodeStore","createPageDependency","nodeModel","path","module","exports"],"mappings":";;iBAA2BA,OAAO,CAAE,cAAF,C;MAA1BC,c,YAAAA,c;;AAER,MAAMC,mBAAmB,GAAG,CAACC,OAAD,EAAUC,MAAV,KAAqB;AAC/C,QAAMC,SAAS,GAAGL,OAAO,CAAE,aAAF,CAAzB;;AACA,QAAMM,oBAAoB,GAAGN,OAAO,CAAE,sCAAF,CAApC;;AAEA,2BACKG,OADL;AAEEI,IAAAA,SAAS,EAAE,IAAIN,cAAJ,CAAmB;AAC5BI,MAAAA,SAD4B;AAE5BD,MAAAA,MAF4B;AAG5BE,MAAAA,oBAH4B;AAI5BE,MAAAA,IAAI,EAAEL,OAAO,CAACK;AAJc,KAAnB;AAFb;AASD,CAbD;;AAeAC,MAAM,CAACC,OAAP,GAAiBR,mBAAjB","sourcesContent":["const { LocalNodeModel } = require(`./node-model`)\n\nconst withResolverContext = (context, schema) => {\n  const nodeStore = require(`../db/nodes`)\n  const createPageDependency = require(`../redux/actions/add-page-dependency`)\n\n  return {\n    ...context,\n    nodeModel: new LocalNodeModel({\n      nodeStore,\n      schema,\n      createPageDependency,\n      path: context.path,\n    }),\n  }\n}\n\nmodule.exports = withResolverContext\n"],"file":"context.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/schema/context.js"],"names":["LocalNodeModel","require","withResolverContext","context","schema","nodeStore","createPageDependency","nodeModel","path","module","exports"],"mappings":";;AAAA,MAAM;AAAEA,EAAAA;AAAF,IAAqBC,OAAO,CAAE,cAAF,CAAlC;;AAEA,MAAMC,mBAAmB,GAAG,CAACC,OAAD,EAAUC,MAAV,KAAqB;AAC/C,QAAMC,SAAS,GAAGJ,OAAO,CAAE,aAAF,CAAzB;;AACA,QAAMK,oBAAoB,GAAGL,OAAO,CAAE,sCAAF,CAApC;;AAEA,SAAO,EACL,GAAGE,OADE;AAELI,IAAAA,SAAS,EAAE,IAAIP,cAAJ,CAAmB;AAC5BK,MAAAA,SAD4B;AAE5BD,MAAAA,MAF4B;AAG5BE,MAAAA,oBAH4B;AAI5BE,MAAAA,IAAI,EAAEL,OAAO,CAACK;AAJc,KAAnB;AAFN,GAAP;AASD,CAbD;;AAeAC,MAAM,CAACC,OAAP,GAAiBR,mBAAjB","sourcesContent":["const { LocalNodeModel } = require(`./node-model`)\n\nconst withResolverContext = (context, schema) => {\n  const nodeStore = require(`../db/nodes`)\n  const createPageDependency = require(`../redux/actions/add-page-dependency`)\n\n  return {\n    ...context,\n    nodeModel: new LocalNodeModel({\n      nodeStore,\n      schema,\n      createPageDependency,\n      path: context.path,\n    }),\n  }\n}\n\nmodule.exports = withResolverContext\n"],"file":"context.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/schema/index.js b/node_modules/gatsby/dist/schema/index.js
index deb73c3..e627266 100644
--- a/node_modules/gatsby/dist/schema/index.js
+++ b/node_modules/gatsby/dist/schema/index.js
@@ -1,108 +1,97 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const tracer = require(`opentracing`).globalTracer();
 
-const _require = require(`../redux`),
-      store = _require.store;
+const {
+  store
+} = require(`../redux`);
 
 const nodeStore = require(`../db/nodes`);
 
-const _require2 = require(`./schema-composer`),
-      createSchemaComposer = _require2.createSchemaComposer;
-
-const _require3 = require(`./schema`),
-      buildSchema = _require3.buildSchema,
-      rebuildSchemaWithSitePage = _require3.rebuildSchemaWithSitePage;
-
-const _require4 = require(`./infer/type-conflict-reporter`),
-      TypeConflictReporter = _require4.TypeConflictReporter;
-
-module.exports.build =
-/*#__PURE__*/
-function () {
-  var _ref = (0, _asyncToGenerator2.default)(function* ({
-    parentSpan
-  }) {
-    const spanArgs = parentSpan ? {
-      childOf: parentSpan
-    } : {};
-    const span = tracer.startSpan(`build schema`, spanArgs);
-
-    let _store$getState = store.getState(),
-        _store$getState$schem = _store$getState.schemaCustomization,
-        thirdPartySchemas = _store$getState$schem.thirdPartySchemas,
-        types = _store$getState$schem.types,
-        typeMapping = _store$getState.config.mapping;
-
-    const typeConflictReporter = new TypeConflictReporter();
-    const schemaComposer = createSchemaComposer();
-    const schema = yield buildSchema({
-      schemaComposer,
-      nodeStore,
-      types,
+const {
+  createSchemaComposer
+} = require(`./schema-composer`);
+
+const {
+  buildSchema,
+  rebuildSchemaWithSitePage
+} = require(`./schema`);
+
+const {
+  TypeConflictReporter
+} = require(`./infer/type-conflict-reporter`);
+
+module.exports.build = async ({
+  parentSpan
+}) => {
+  const spanArgs = parentSpan ? {
+    childOf: parentSpan
+  } : {};
+  const span = tracer.startSpan(`build schema`, spanArgs);
+  let {
+    schemaCustomization: {
       thirdPartySchemas,
-      typeMapping,
-      typeConflictReporter,
-      parentSpan
-    });
-    typeConflictReporter.printConflicts();
-    store.dispatch({
-      type: `SET_SCHEMA_COMPOSER`,
-      payload: schemaComposer
-    });
-    store.dispatch({
-      type: `SET_SCHEMA`,
-      payload: schema
-    });
-    span.finish();
+      types
+    },
+    config: {
+      mapping: typeMapping
+    }
+  } = store.getState();
+  const typeConflictReporter = new TypeConflictReporter();
+  const schemaComposer = createSchemaComposer();
+  const schema = await buildSchema({
+    schemaComposer,
+    nodeStore,
+    types,
+    thirdPartySchemas,
+    typeMapping,
+    typeConflictReporter,
+    parentSpan
   });
-
-  return function (_x) {
-    return _ref.apply(this, arguments);
-  };
-}();
-
-module.exports.rebuildWithSitePage =
-/*#__PURE__*/
-function () {
-  var _ref2 = (0, _asyncToGenerator2.default)(function* ({
+  typeConflictReporter.printConflicts();
+  store.dispatch({
+    type: `SET_SCHEMA_COMPOSER`,
+    payload: schemaComposer
+  });
+  store.dispatch({
+    type: `SET_SCHEMA`,
+    payload: schema
+  });
+  span.finish();
+};
+
+module.exports.rebuildWithSitePage = async ({
+  parentSpan
+}) => {
+  const spanArgs = parentSpan ? {
+    childOf: parentSpan
+  } : {};
+  const span = tracer.startSpan(`rebuild schema with SitePage context`, spanArgs);
+  let {
+    schemaCustomization: {
+      composer: schemaComposer
+    },
+    config: {
+      mapping: typeMapping
+    }
+  } = store.getState();
+  const typeConflictReporter = new TypeConflictReporter();
+  const schema = await rebuildSchemaWithSitePage({
+    schemaComposer,
+    nodeStore,
+    typeMapping,
+    typeConflictReporter,
     parentSpan
-  }) {
-    const spanArgs = parentSpan ? {
-      childOf: parentSpan
-    } : {};
-    const span = tracer.startSpan(`rebuild schema with SitePage context`, spanArgs);
-
-    let _store$getState2 = store.getState(),
-        schemaComposer = _store$getState2.schemaCustomization.composer,
-        typeMapping = _store$getState2.config.mapping;
-
-    const typeConflictReporter = new TypeConflictReporter();
-    const schema = yield rebuildSchemaWithSitePage({
-      schemaComposer,
-      nodeStore,
-      typeMapping,
-      typeConflictReporter,
-      parentSpan
-    });
-    typeConflictReporter.printConflicts();
-    store.dispatch({
-      type: `SET_SCHEMA_COMPOSER`,
-      payload: schemaComposer
-    });
-    store.dispatch({
-      type: `SET_SCHEMA`,
-      payload: schema
-    });
-    span.finish();
   });
-
-  return function (_x2) {
-    return _ref2.apply(this, arguments);
-  };
-}();
+  typeConflictReporter.printConflicts();
+  store.dispatch({
+    type: `SET_SCHEMA_COMPOSER`,
+    payload: schemaComposer
+  });
+  store.dispatch({
+    type: `SET_SCHEMA`,
+    payload: schema
+  });
+  span.finish();
+};
 //# sourceMappingURL=index.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/schema/index.js.map b/node_modules/gatsby/dist/schema/index.js.map
index 6e7290b..cc5420e 100644
--- a/node_modules/gatsby/dist/schema/index.js.map
+++ b/node_modules/gatsby/dist/schema/index.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/schema/index.js"],"names":["tracer","require","globalTracer","store","nodeStore","createSchemaComposer","buildSchema","rebuildSchemaWithSitePage","TypeConflictReporter","module","exports","build","parentSpan","spanArgs","childOf","span","startSpan","getState","schemaCustomization","thirdPartySchemas","types","typeMapping","config","mapping","typeConflictReporter","schemaComposer","schema","printConflicts","dispatch","type","payload","finish","rebuildWithSitePage","composer"],"mappings":"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","sourcesContent":["/* @flow */\n\nconst tracer = require(`opentracing`).globalTracer()\nconst { store } = require(`../redux`)\nconst nodeStore = require(`../db/nodes`)\nconst { createSchemaComposer } = require(`./schema-composer`)\nconst { buildSchema, rebuildSchemaWithSitePage } = require(`./schema`)\nconst { TypeConflictReporter } = require(`./infer/type-conflict-reporter`)\n\nmodule.exports.build = async ({ parentSpan }) => {\n  const spanArgs = parentSpan ? { childOf: parentSpan } : {}\n  const span = tracer.startSpan(`build schema`, spanArgs)\n\n  let {\n    schemaCustomization: { thirdPartySchemas, types },\n    config: { mapping: typeMapping },\n  } = store.getState()\n\n  const typeConflictReporter = new TypeConflictReporter()\n\n  const schemaComposer = createSchemaComposer()\n  const schema = await buildSchema({\n    schemaComposer,\n    nodeStore,\n    types,\n    thirdPartySchemas,\n    typeMapping,\n    typeConflictReporter,\n    parentSpan,\n  })\n\n  typeConflictReporter.printConflicts()\n\n  store.dispatch({\n    type: `SET_SCHEMA_COMPOSER`,\n    payload: schemaComposer,\n  })\n  store.dispatch({\n    type: `SET_SCHEMA`,\n    payload: schema,\n  })\n\n  span.finish()\n}\n\nmodule.exports.rebuildWithSitePage = async ({ parentSpan }) => {\n  const spanArgs = parentSpan ? { childOf: parentSpan } : {}\n  const span = tracer.startSpan(\n    `rebuild schema with SitePage context`,\n    spanArgs\n  )\n  let {\n    schemaCustomization: { composer: schemaComposer },\n    config: { mapping: typeMapping },\n  } = store.getState()\n\n  const typeConflictReporter = new TypeConflictReporter()\n\n  const schema = await rebuildSchemaWithSitePage({\n    schemaComposer,\n    nodeStore,\n    typeMapping,\n    typeConflictReporter,\n    parentSpan,\n  })\n\n  typeConflictReporter.printConflicts()\n\n  store.dispatch({\n    type: `SET_SCHEMA_COMPOSER`,\n    payload: schemaComposer,\n  })\n  store.dispatch({\n    type: `SET_SCHEMA`,\n    payload: schema,\n  })\n\n  span.finish()\n}\n"],"file":"index.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/schema/index.js"],"names":["tracer","require","globalTracer","store","nodeStore","createSchemaComposer","buildSchema","rebuildSchemaWithSitePage","TypeConflictReporter","module","exports","build","parentSpan","spanArgs","childOf","span","startSpan","schemaCustomization","thirdPartySchemas","types","config","mapping","typeMapping","getState","typeConflictReporter","schemaComposer","schema","printConflicts","dispatch","type","payload","finish","rebuildWithSitePage","composer"],"mappings":"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","sourcesContent":["/* @flow */\n\nconst tracer = require(`opentracing`).globalTracer()\nconst { store } = require(`../redux`)\nconst nodeStore = require(`../db/nodes`)\nconst { createSchemaComposer } = require(`./schema-composer`)\nconst { buildSchema, rebuildSchemaWithSitePage } = require(`./schema`)\nconst { TypeConflictReporter } = require(`./infer/type-conflict-reporter`)\n\nmodule.exports.build = async ({ parentSpan }) => {\n  const spanArgs = parentSpan ? { childOf: parentSpan } : {}\n  const span = tracer.startSpan(`build schema`, spanArgs)\n\n  let {\n    schemaCustomization: { thirdPartySchemas, types },\n    config: { mapping: typeMapping },\n  } = store.getState()\n\n  const typeConflictReporter = new TypeConflictReporter()\n\n  const schemaComposer = createSchemaComposer()\n  const schema = await buildSchema({\n    schemaComposer,\n    nodeStore,\n    types,\n    thirdPartySchemas,\n    typeMapping,\n    typeConflictReporter,\n    parentSpan,\n  })\n\n  typeConflictReporter.printConflicts()\n\n  store.dispatch({\n    type: `SET_SCHEMA_COMPOSER`,\n    payload: schemaComposer,\n  })\n  store.dispatch({\n    type: `SET_SCHEMA`,\n    payload: schema,\n  })\n\n  span.finish()\n}\n\nmodule.exports.rebuildWithSitePage = async ({ parentSpan }) => {\n  const spanArgs = parentSpan ? { childOf: parentSpan } : {}\n  const span = tracer.startSpan(\n    `rebuild schema with SitePage context`,\n    spanArgs\n  )\n  let {\n    schemaCustomization: { composer: schemaComposer },\n    config: { mapping: typeMapping },\n  } = store.getState()\n\n  const typeConflictReporter = new TypeConflictReporter()\n\n  const schema = await rebuildSchemaWithSitePage({\n    schemaComposer,\n    nodeStore,\n    typeMapping,\n    typeConflictReporter,\n    parentSpan,\n  })\n\n  typeConflictReporter.printConflicts()\n\n  store.dispatch({\n    type: `SET_SCHEMA_COMPOSER`,\n    payload: schemaComposer,\n  })\n  store.dispatch({\n    type: `SET_SCHEMA`,\n    payload: schema,\n  })\n\n  span.finish()\n}\n"],"file":"index.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/schema/infer/add-inferred-fields.js b/node_modules/gatsby/dist/schema/infer/add-inferred-fields.js
index f3d512f..a4e654b 100644
--- a/node_modules/gatsby/dist/schema/infer/add-inferred-fields.js
+++ b/node_modules/gatsby/dist/schema/infer/add-inferred-fields.js
@@ -2,29 +2,34 @@
 
 const _ = require(`lodash`);
 
-const _require = require(`graphql`),
-      defaultFieldResolver = _require.defaultFieldResolver,
-      getNamedType = _require.getNamedType,
-      GraphQLObjectType = _require.GraphQLObjectType,
-      GraphQLList = _require.GraphQLList;
+const {
+  defaultFieldResolver,
+  getNamedType,
+  GraphQLObjectType,
+  GraphQLList
+} = require(`graphql`);
 
-const _require2 = require(`graphql-compose`),
-      ObjectTypeComposer = _require2.ObjectTypeComposer;
+const {
+  ObjectTypeComposer
+} = require(`graphql-compose`);
 
 const invariant = require(`invariant`);
 
 const report = require(`gatsby-cli/lib/reporter`);
 
-const _require3 = require(`./is-file`),
-      isFile = _require3.isFile;
+const {
+  isFile
+} = require(`./is-file`);
 
-const _require4 = require(`../resolvers`),
-      link = _require4.link,
-      fileByPath = _require4.fileByPath;
+const {
+  link,
+  fileByPath
+} = require(`../resolvers`);
 
-const _require5 = require(`../types/date`),
-      isDate = _require5.isDate,
-      dateResolver = _require5.dateResolver;
+const {
+  isDate,
+  dateResolver
+} = require(`../types/date`);
 
 const is32BitInteger = require(`./is-32-bit-integer`);
 
@@ -88,7 +93,7 @@ const addInferredFieldsImpl = ({
     if (possibleFields.length > 1) {
       const field = resolveMultipleFields(possibleFields);
       const possibleFieldsNames = possibleFields.map(field => `\`${field.unsanitizedKey}\``).join(`, `);
-      report.warn(`Multiple node fields resolve to the same GraphQL field \`${field.key}\` - [${possibleFieldsNames}]. Gatsby will use \`${field.unsanitizedKey}\`.`);
+      report.warn(`Multiple node fields resolve to the same GraphQL field \`${prefix}.${field.key}\` - [${possibleFieldsNames}]. Gatsby will use \`${field.unsanitizedKey}\`.`);
       fieldConfig = field.fieldConfig;
     } else {
       fieldConfig = possibleFields[0].fieldConfig;
@@ -108,19 +113,23 @@ const addInferredFieldsImpl = ({
       let namedFieldType = fieldType;
 
       while (namedFieldType.ofType) {
-        namedFieldType = namedFieldType.ofType;
-
         if (namedFieldType instanceof GraphQLList) {
           lists++;
         }
+
+        namedFieldType = namedFieldType.ofType;
       }
 
-      if (arrays === lists) {
-        if (namedFieldType instanceof GraphQLObjectType && typeof namedInferredType !== `string` && namedFieldType.name === namedInferredType.getTypeName()) {
+      const namedInferredTypeName = typeof namedInferredType === `string` ? namedInferredType : namedInferredType.getTypeName();
+
+      if (arrays === lists && namedFieldType.name === namedInferredTypeName) {
+        if (namedFieldType instanceof GraphQLObjectType && namedInferredType instanceof ObjectTypeComposer) {
           const fieldTypeComposer = typeComposer.getFieldTC(key);
           const inferredFields = namedInferredType.getFields();
           fieldTypeComposer.addFields(inferredFields);
-        } else if (addDefaultResolvers && namedFieldType.name === namedInferredType) {
+        }
+
+        if (addDefaultResolvers) {
           let field = typeComposer.getField(key);
 
           if (!field.type) {
@@ -206,17 +215,17 @@ const getFieldConfig = ({
 
   if (key !== unsanitizedKey) {
     const resolver = fieldConfig.resolve || defaultFieldResolver;
-    fieldConfig = Object.assign({}, fieldConfig, {
-      resolve: (source, args, context, info) => resolver(source, args, context, Object.assign({}, info, {
+    fieldConfig = { ...fieldConfig,
+      resolve: (source, args, context, info) => resolver(source, args, context, { ...info,
         fieldName: unsanitizedKey
-      }))
-    });
+      })
+    };
   }
 
   while (arrays > 0) {
-    fieldConfig = Object.assign({}, fieldConfig, {
+    fieldConfig = { ...fieldConfig,
       type: [fieldConfig.type]
-    });
+    };
     arrays--;
   }
 
@@ -252,10 +261,7 @@ const getFieldConfigFromMapping = ({
   typeMapping,
   selector
 }) => {
-  const _typeMapping$selector = typeMapping[selector].split(`.`),
-        type = _typeMapping$selector[0],
-        path = _typeMapping$selector.slice(1);
-
+  const [type, ...path] = typeMapping[selector].split(`.`);
   return {
     type,
     resolve: link({
@@ -402,8 +408,9 @@ const getSimpleFieldConfig = ({
 };
 
 const createTypeName = selector => {
-  const key = selector.split(`.`).map(_.upperFirst).join(``);
-  return key;
+  const keys = selector.split(`.`);
+  const suffix = keys.slice(1).map(_.upperFirst).join(``);
+  return `${keys[0]}${suffix}`;
 };
 
 const NON_ALPHA_NUMERIC_EXPR = new RegExp(`[^a-zA-Z0-9_]`, `g`);
diff --git a/node_modules/gatsby/dist/schema/infer/add-inferred-fields.js.map b/node_modules/gatsby/dist/schema/infer/add-inferred-fields.js.map
index 70d62d1..94b4617 100644
--- a/node_modules/gatsby/dist/schema/infer/add-inferred-fields.js.map
+++ b/node_modules/gatsby/dist/schema/infer/add-inferred-fields.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/schema/infer/add-inferred-fields.js"],"names":["_","require","defaultFieldResolver","getNamedType","GraphQLObjectType","GraphQLList","ObjectTypeComposer","invariant","report","isFile","link","fileByPath","isDate","dateResolver","is32BitInteger","addInferredFields","schemaComposer","typeComposer","exampleValue","nodeStore","inferConfig","typeMapping","parentSpan","addInferredFieldsImpl","exampleObject","prefix","getTypeName","addNewFields","infer","addDefaultResolvers","module","exports","fields","Object","keys","forEach","unsanitizedKey","push","getFieldConfig","fieldsByKey","groupBy","field","key","possibleFields","fieldConfig","length","resolveMultipleFields","possibleFieldsNames","map","join","warn","arrays","namedInferredType","type","Array","isArray","hasField","fieldType","getFieldType","lists","namedFieldType","ofType","name","fieldTypeComposer","getFieldTC","inferredFields","getFields","addFields","getField","isEmpty","args","resolve","setField","add","createFieldName","selector","value","hasMapping","getFieldConfigFromMapping","includes","getFieldConfigFromFieldNameConvention","split","getSimpleFieldConfig","resolver","source","context","info","fieldName","nodeField","find","canonicalField","sortBy","mapping","path","by","foreignKey","replace","getNodeBy","getNodes","node","get","getNode","linkedNodes","linkedTypes","uniq","filter","Boolean","internal","typeName","sort","getOrCreateUTC","utc","types","getOrCreateOTC","setTypes","setResolveType","has","Date","String","originalFieldTypeComposer","clone","createTemp","createTypeName","Error","upperFirst","NON_ALPHA_NUMERIC_EXPR","RegExp","replaced","match","char","index"],"mappings":"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","sourcesContent":["const _ = require(`lodash`)\nconst {\n  defaultFieldResolver,\n  getNamedType,\n  GraphQLObjectType,\n  GraphQLList,\n} = require(`graphql`)\nconst { ObjectTypeComposer } = require(`graphql-compose`)\nconst invariant = require(`invariant`)\nconst report = require(`gatsby-cli/lib/reporter`)\n\nconst { isFile } = require(`./is-file`)\nconst { link, fileByPath } = require(`../resolvers`)\nconst { isDate, dateResolver } = require(`../types/date`)\nconst is32BitInteger = require(`./is-32-bit-integer`)\n\nconst addInferredFields = ({\n  schemaComposer,\n  typeComposer,\n  exampleValue,\n  nodeStore,\n  inferConfig,\n  typeMapping,\n  parentSpan,\n}) => {\n  addInferredFieldsImpl({\n    schemaComposer,\n    typeComposer,\n    nodeStore,\n    exampleObject: exampleValue,\n    prefix: typeComposer.getTypeName(),\n    typeMapping,\n    addNewFields: inferConfig ? inferConfig.infer : true,\n    addDefaultResolvers: inferConfig ? inferConfig.addDefaultResolvers : true,\n  })\n}\n\nmodule.exports = {\n  addInferredFields,\n}\n\nconst addInferredFieldsImpl = ({\n  schemaComposer,\n  typeComposer,\n  nodeStore,\n  exampleObject,\n  typeMapping,\n  prefix,\n  addNewFields,\n  addDefaultResolvers,\n}) => {\n  const fields = []\n  Object.keys(exampleObject).forEach(unsanitizedKey => {\n    const exampleValue = exampleObject[unsanitizedKey]\n    fields.push(\n      getFieldConfig({\n        schemaComposer,\n        typeComposer,\n        nodeStore,\n        prefix,\n        exampleValue,\n        unsanitizedKey,\n        typeMapping,\n        addNewFields,\n        addDefaultResolvers,\n      })\n    )\n  })\n\n  const fieldsByKey = _.groupBy(fields, field => field.key)\n\n  Object.keys(fieldsByKey).forEach(key => {\n    const possibleFields = fieldsByKey[key]\n    let fieldConfig\n    if (possibleFields.length > 1) {\n      const field = resolveMultipleFields(possibleFields)\n      const possibleFieldsNames = possibleFields\n        .map(field => `\\`${field.unsanitizedKey}\\``)\n        .join(`, `)\n      report.warn(\n        `Multiple node fields resolve to the same GraphQL field \\`${\n          field.key\n        }\\` - [${possibleFieldsNames}]. Gatsby will use \\`${\n          field.unsanitizedKey\n        }\\`.`\n      )\n      fieldConfig = field.fieldConfig\n    } else {\n      fieldConfig = possibleFields[0].fieldConfig\n    }\n\n    let arrays = 0\n    let namedInferredType = fieldConfig.type\n    while (Array.isArray(namedInferredType)) {\n      namedInferredType = namedInferredType[0]\n      arrays++\n    }\n\n    if (typeComposer.hasField(key)) {\n      const fieldType = typeComposer.getFieldType(key)\n\n      let lists = 0\n      let namedFieldType = fieldType\n      while (namedFieldType.ofType) {\n        namedFieldType = namedFieldType.ofType\n        if (namedFieldType instanceof GraphQLList) {\n          lists++\n        }\n      }\n\n      if (arrays === lists) {\n        if (\n          namedFieldType instanceof GraphQLObjectType &&\n          typeof namedInferredType !== `string` &&\n          namedFieldType.name === namedInferredType.getTypeName()\n        ) {\n          const fieldTypeComposer = typeComposer.getFieldTC(key)\n          const inferredFields = namedInferredType.getFields()\n          fieldTypeComposer.addFields(inferredFields)\n        } else if (\n          addDefaultResolvers &&\n          namedFieldType.name === namedInferredType\n        ) {\n          let field = typeComposer.getField(key)\n          if (!field.type) {\n            field = {\n              type: field,\n            }\n          }\n          if (_.isEmpty(field.args) && fieldConfig.args) {\n            field.args = fieldConfig.args\n          }\n          if (!field.resolve && fieldConfig.resolve) {\n            field.resolve = fieldConfig.resolve\n          }\n          typeComposer.setField(key, field)\n        }\n      }\n    } else if (addNewFields) {\n      if (namedInferredType instanceof ObjectTypeComposer) {\n        schemaComposer.add(namedInferredType)\n      }\n      typeComposer.setField(key, fieldConfig)\n    }\n  })\n\n  return typeComposer\n}\n\nconst getFieldConfig = ({\n  schemaComposer,\n  typeComposer,\n  nodeStore,\n  prefix,\n  exampleValue,\n  unsanitizedKey,\n  typeMapping,\n  addNewFields,\n  addDefaultResolvers,\n}) => {\n  let key = createFieldName(unsanitizedKey)\n  const selector = `${prefix}.${key}`\n\n  let arrays = 0\n  let value = exampleValue\n  while (Array.isArray(value)) {\n    value = value[0]\n    arrays++\n  }\n\n  let fieldConfig\n  if (hasMapping(typeMapping, selector)) {\n    // TODO: Use `prefix` instead of `selector` in hasMapping and getFromMapping?\n    // i.e. does the config contain sanitized field names?\n    fieldConfig = getFieldConfigFromMapping({ typeMapping, selector })\n  } else if (key.includes(`___NODE`)) {\n    fieldConfig = getFieldConfigFromFieldNameConvention({\n      schemaComposer,\n      nodeStore,\n      value: exampleValue,\n      key: unsanitizedKey,\n    })\n    key = key.split(`___NODE`)[0]\n  } else {\n    fieldConfig = getSimpleFieldConfig({\n      schemaComposer,\n      typeComposer,\n      nodeStore,\n      key,\n      value,\n      selector,\n      typeMapping,\n      addNewFields,\n      addDefaultResolvers,\n    })\n  }\n\n  // Proxy resolver to unsanitized fieldName in case it contained invalid characters\n  if (key !== unsanitizedKey) {\n    const resolver = fieldConfig.resolve || defaultFieldResolver\n    fieldConfig = {\n      ...fieldConfig,\n      resolve: (source, args, context, info) =>\n        resolver(source, args, context, {\n          ...info,\n          fieldName: unsanitizedKey,\n        }),\n    }\n  }\n\n  while (arrays > 0) {\n    fieldConfig = { ...fieldConfig, type: [fieldConfig.type] }\n    arrays--\n  }\n\n  return {\n    key,\n    unsanitizedKey,\n    fieldConfig,\n  }\n}\n\nconst resolveMultipleFields = possibleFields => {\n  const nodeField = possibleFields.find(field =>\n    field.unsanitizedKey.includes(`___NODE`)\n  )\n  if (nodeField) {\n    return nodeField\n  }\n\n  const canonicalField = possibleFields.find(\n    field => field.unsanitizedKey === field.key\n  )\n  if (canonicalField) {\n    return canonicalField\n  }\n\n  return _.sortBy(possibleFields, field => field.unsanitizedKey)[0]\n}\n\n// XXX(freiksenet): removing this as it's a breaking change\n// Deeper nested levels should be inferred as JSON.\n// const MAX_DEPTH = 5\n\nconst hasMapping = (mapping, selector) =>\n  mapping && Object.keys(mapping).includes(selector)\n\nconst getFieldConfigFromMapping = ({ typeMapping, selector }) => {\n  const [type, ...path] = typeMapping[selector].split(`.`)\n  return { type, resolve: link({ by: path.join(`.`) || `id` }) }\n}\n\n// probably should be in example value\nconst getFieldConfigFromFieldNameConvention = ({\n  schemaComposer,\n  nodeStore,\n  value,\n  key,\n}) => {\n  const path = key.split(`___NODE___`)[1]\n  // Allow linking by nested fields, e.g. `author___NODE___contact___email`\n  const foreignKey = path && path.replace(/___/g, `.`)\n\n  const getNodeBy = value =>\n    foreignKey\n      ? nodeStore.getNodes().find(node => _.get(node, foreignKey) === value)\n      : nodeStore.getNode(value)\n\n  const linkedNodes = Array.isArray(value)\n    ? value.map(getNodeBy)\n    : [getNodeBy(value)]\n\n  const linkedTypes = _.uniq(\n    linkedNodes.filter(Boolean).map(node => node.internal.type)\n  )\n\n  invariant(\n    linkedTypes.length,\n    `Encountered an error trying to infer a GraphQL type for: \\`${key}\\`. ` +\n      `There is no corresponding node with the \\`id\\` field matching: \"${value}\".`\n  )\n\n  let type\n  // If the field value is an array that links to more than one type,\n  // create a GraphQLUnionType. Note that we don't support the case where\n  // scalar fields link to different types. Similarly, an array of objects\n  // with foreign-key fields will produce union types if those foreign-key\n  // fields are arrays, but not if they are scalars. See the tests for an example.\n  // FIXME: The naming of union types is a breaking change. In current master,\n  // the type name includes the key, which is (i) potentially not unique, and\n  // (ii) hinders reusing types.\n  if (linkedTypes.length > 1) {\n    const typeName = linkedTypes.sort().join(``) + `Union`\n    type = schemaComposer.getOrCreateUTC(typeName, utc => {\n      const types = linkedTypes.map(typeName =>\n        schemaComposer.getOrCreateOTC(typeName)\n      )\n      utc.setTypes(types)\n      utc.setResolveType(node => node.internal.type)\n    })\n  } else {\n    type = linkedTypes[0]\n  }\n\n  return { type, resolve: link({ by: foreignKey || `id` }) }\n}\n\nconst getSimpleFieldConfig = ({\n  schemaComposer,\n  typeComposer,\n  nodeStore,\n  key,\n  value,\n  selector,\n  typeMapping,\n  addNewFields,\n  addDefaultResolvers,\n}) => {\n  switch (typeof value) {\n    case `boolean`:\n      return { type: `Boolean` }\n    case `number`:\n      return { type: is32BitInteger(value) ? `Int` : `Float` }\n    case `string`:\n      if (isDate(value)) {\n        return dateResolver\n      }\n      // FIXME: The weird thing is that we are trying to infer a File,\n      // but cannot assume that a source plugin for File nodes is actually present.\n      if (schemaComposer.has(`File`) && isFile(nodeStore, selector, value)) {\n        // NOTE: For arrays of files, where not every path references\n        // a File node in the db, it is semi-random if the field is\n        // inferred as File or String, since the exampleValue only has\n        // the first entry (which could point to an existing file or not).\n        return { type: `File`, resolve: fileByPath }\n      }\n      return { type: `String` }\n    case `object`:\n      if (value instanceof Date) {\n        return dateResolver\n      }\n      if (value instanceof String) {\n        return { type: `String` }\n      }\n      if (value /* && depth < MAX_DEPTH*/) {\n        // We only create a temporary TypeComposer on nested fields\n        // (either a clone of an existing field type, or a temporary new one),\n        // because we don't yet know if this type should end up in the schema.\n        // It might be for a possibleField that will be disregarded later,\n        // so we cannot mutate the original.\n        let fieldTypeComposer\n        if (\n          typeComposer.hasField(key) &&\n          getNamedType(typeComposer.getFieldType(key)) instanceof\n            GraphQLObjectType\n        ) {\n          const originalFieldTypeComposer = typeComposer.getFieldTC(key)\n          fieldTypeComposer = originalFieldTypeComposer.clone(\n            originalFieldTypeComposer.getTypeName()\n          )\n        } else {\n          fieldTypeComposer = ObjectTypeComposer.createTemp(\n            createTypeName(selector),\n            schemaComposer\n          )\n        }\n\n        return {\n          type: addInferredFieldsImpl({\n            schemaComposer,\n            typeComposer: fieldTypeComposer,\n            nodeStore,\n            exampleObject: value,\n            typeMapping,\n            prefix: selector,\n            addNewFields,\n            addDefaultResolvers,\n          }),\n        }\n      }\n  }\n  throw new Error(`Can't determine type for \"${value}\" in \\`${selector}\\`.`)\n}\n\nconst createTypeName = selector => {\n  const key = selector\n    .split(`.`)\n    .map(_.upperFirst)\n    .join(``)\n\n  return key\n}\n\nconst NON_ALPHA_NUMERIC_EXPR = new RegExp(`[^a-zA-Z0-9_]`, `g`)\n\n/**\n * GraphQL field names must be a string and cannot contain anything other than\n * alphanumeric characters and `_`. They also can't start with `__` which is\n * reserved for internal fields (`___foo` doesn't work either).\n */\nconst createFieldName = key => {\n  // Check if the key is really a string otherwise GraphQL will throw.\n  invariant(\n    typeof key === `string`,\n    `GraphQL field name (key) is not a string: \\`${key}\\`.`\n  )\n\n  const replaced = key.replace(NON_ALPHA_NUMERIC_EXPR, `_`)\n\n  // key is invalid; normalize with leading underscore and rest with x\n  if (replaced.match(/^__/)) {\n    return replaced.replace(/_/g, (char, index) => (index === 0 ? `_` : `x`))\n  }\n\n  // key is invalid (starts with numeric); normalize with leading underscore\n  if (replaced.match(/^[0-9]/)) {\n    return `_` + replaced\n  }\n\n  return replaced\n}\n"],"file":"add-inferred-fields.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/schema/infer/add-inferred-fields.js"],"names":["_","require","defaultFieldResolver","getNamedType","GraphQLObjectType","GraphQLList","ObjectTypeComposer","invariant","report","isFile","link","fileByPath","isDate","dateResolver","is32BitInteger","addInferredFields","schemaComposer","typeComposer","exampleValue","nodeStore","inferConfig","typeMapping","parentSpan","addInferredFieldsImpl","exampleObject","prefix","getTypeName","addNewFields","infer","addDefaultResolvers","module","exports","fields","Object","keys","forEach","unsanitizedKey","push","getFieldConfig","fieldsByKey","groupBy","field","key","possibleFields","fieldConfig","length","resolveMultipleFields","possibleFieldsNames","map","join","warn","arrays","namedInferredType","type","Array","isArray","hasField","fieldType","getFieldType","lists","namedFieldType","ofType","namedInferredTypeName","name","fieldTypeComposer","getFieldTC","inferredFields","getFields","addFields","getField","isEmpty","args","resolve","setField","add","createFieldName","selector","value","hasMapping","getFieldConfigFromMapping","includes","getFieldConfigFromFieldNameConvention","split","getSimpleFieldConfig","resolver","source","context","info","fieldName","nodeField","find","canonicalField","sortBy","mapping","path","by","foreignKey","replace","getNodeBy","getNodes","node","get","getNode","linkedNodes","linkedTypes","uniq","filter","Boolean","internal","typeName","sort","getOrCreateUTC","utc","types","getOrCreateOTC","setTypes","setResolveType","has","Date","String","originalFieldTypeComposer","clone","createTemp","createTypeName","Error","suffix","slice","upperFirst","NON_ALPHA_NUMERIC_EXPR","RegExp","replaced","match","char","index"],"mappings":"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","sourcesContent":["const _ = require(`lodash`)\nconst {\n  defaultFieldResolver,\n  getNamedType,\n  GraphQLObjectType,\n  GraphQLList,\n} = require(`graphql`)\nconst { ObjectTypeComposer } = require(`graphql-compose`)\nconst invariant = require(`invariant`)\nconst report = require(`gatsby-cli/lib/reporter`)\n\nconst { isFile } = require(`./is-file`)\nconst { link, fileByPath } = require(`../resolvers`)\nconst { isDate, dateResolver } = require(`../types/date`)\nconst is32BitInteger = require(`./is-32-bit-integer`)\n\nconst addInferredFields = ({\n  schemaComposer,\n  typeComposer,\n  exampleValue,\n  nodeStore,\n  inferConfig,\n  typeMapping,\n  parentSpan,\n}) => {\n  addInferredFieldsImpl({\n    schemaComposer,\n    typeComposer,\n    nodeStore,\n    exampleObject: exampleValue,\n    prefix: typeComposer.getTypeName(),\n    typeMapping,\n    addNewFields: inferConfig ? inferConfig.infer : true,\n    addDefaultResolvers: inferConfig ? inferConfig.addDefaultResolvers : true,\n  })\n}\n\nmodule.exports = {\n  addInferredFields,\n}\n\nconst addInferredFieldsImpl = ({\n  schemaComposer,\n  typeComposer,\n  nodeStore,\n  exampleObject,\n  typeMapping,\n  prefix,\n  addNewFields,\n  addDefaultResolvers,\n}) => {\n  const fields = []\n  Object.keys(exampleObject).forEach(unsanitizedKey => {\n    const exampleValue = exampleObject[unsanitizedKey]\n    fields.push(\n      getFieldConfig({\n        schemaComposer,\n        typeComposer,\n        nodeStore,\n        prefix,\n        exampleValue,\n        unsanitizedKey,\n        typeMapping,\n        addNewFields,\n        addDefaultResolvers,\n      })\n    )\n  })\n\n  const fieldsByKey = _.groupBy(fields, field => field.key)\n\n  Object.keys(fieldsByKey).forEach(key => {\n    const possibleFields = fieldsByKey[key]\n    let fieldConfig\n    if (possibleFields.length > 1) {\n      const field = resolveMultipleFields(possibleFields)\n      const possibleFieldsNames = possibleFields\n        .map(field => `\\`${field.unsanitizedKey}\\``)\n        .join(`, `)\n      report.warn(\n        `Multiple node fields resolve to the same GraphQL field \\`${prefix}.${\n          field.key\n        }\\` - [${possibleFieldsNames}]. Gatsby will use \\`${\n          field.unsanitizedKey\n        }\\`.`\n      )\n      fieldConfig = field.fieldConfig\n    } else {\n      fieldConfig = possibleFields[0].fieldConfig\n    }\n\n    let arrays = 0\n    let namedInferredType = fieldConfig.type\n    while (Array.isArray(namedInferredType)) {\n      namedInferredType = namedInferredType[0]\n      arrays++\n    }\n\n    if (typeComposer.hasField(key)) {\n      const fieldType = typeComposer.getFieldType(key)\n\n      let lists = 0\n      let namedFieldType = fieldType\n      while (namedFieldType.ofType) {\n        if (namedFieldType instanceof GraphQLList) {\n          lists++\n        }\n        namedFieldType = namedFieldType.ofType\n      }\n\n      const namedInferredTypeName =\n        typeof namedInferredType === `string`\n          ? namedInferredType\n          : namedInferredType.getTypeName()\n\n      if (arrays === lists && namedFieldType.name === namedInferredTypeName) {\n        if (\n          namedFieldType instanceof GraphQLObjectType &&\n          namedInferredType instanceof ObjectTypeComposer\n        ) {\n          const fieldTypeComposer = typeComposer.getFieldTC(key)\n          const inferredFields = namedInferredType.getFields()\n          fieldTypeComposer.addFields(inferredFields)\n        }\n        if (addDefaultResolvers) {\n          let field = typeComposer.getField(key)\n          if (!field.type) {\n            field = {\n              type: field,\n            }\n          }\n          if (_.isEmpty(field.args) && fieldConfig.args) {\n            field.args = fieldConfig.args\n          }\n          if (!field.resolve && fieldConfig.resolve) {\n            field.resolve = fieldConfig.resolve\n          }\n          typeComposer.setField(key, field)\n        }\n      }\n    } else if (addNewFields) {\n      if (namedInferredType instanceof ObjectTypeComposer) {\n        schemaComposer.add(namedInferredType)\n      }\n      typeComposer.setField(key, fieldConfig)\n    }\n  })\n\n  return typeComposer\n}\n\nconst getFieldConfig = ({\n  schemaComposer,\n  typeComposer,\n  nodeStore,\n  prefix,\n  exampleValue,\n  unsanitizedKey,\n  typeMapping,\n  addNewFields,\n  addDefaultResolvers,\n}) => {\n  let key = createFieldName(unsanitizedKey)\n  const selector = `${prefix}.${key}`\n\n  let arrays = 0\n  let value = exampleValue\n  while (Array.isArray(value)) {\n    value = value[0]\n    arrays++\n  }\n\n  let fieldConfig\n  if (hasMapping(typeMapping, selector)) {\n    // TODO: Use `prefix` instead of `selector` in hasMapping and getFromMapping?\n    // i.e. does the config contain sanitized field names?\n    fieldConfig = getFieldConfigFromMapping({ typeMapping, selector })\n  } else if (key.includes(`___NODE`)) {\n    fieldConfig = getFieldConfigFromFieldNameConvention({\n      schemaComposer,\n      nodeStore,\n      value: exampleValue,\n      key: unsanitizedKey,\n    })\n    key = key.split(`___NODE`)[0]\n  } else {\n    fieldConfig = getSimpleFieldConfig({\n      schemaComposer,\n      typeComposer,\n      nodeStore,\n      key,\n      value,\n      selector,\n      typeMapping,\n      addNewFields,\n      addDefaultResolvers,\n    })\n  }\n\n  // Proxy resolver to unsanitized fieldName in case it contained invalid characters\n  if (key !== unsanitizedKey) {\n    const resolver = fieldConfig.resolve || defaultFieldResolver\n    fieldConfig = {\n      ...fieldConfig,\n      resolve: (source, args, context, info) =>\n        resolver(source, args, context, {\n          ...info,\n          fieldName: unsanitizedKey,\n        }),\n    }\n  }\n\n  while (arrays > 0) {\n    fieldConfig = { ...fieldConfig, type: [fieldConfig.type] }\n    arrays--\n  }\n\n  return {\n    key,\n    unsanitizedKey,\n    fieldConfig,\n  }\n}\n\nconst resolveMultipleFields = possibleFields => {\n  const nodeField = possibleFields.find(field =>\n    field.unsanitizedKey.includes(`___NODE`)\n  )\n  if (nodeField) {\n    return nodeField\n  }\n\n  const canonicalField = possibleFields.find(\n    field => field.unsanitizedKey === field.key\n  )\n  if (canonicalField) {\n    return canonicalField\n  }\n\n  return _.sortBy(possibleFields, field => field.unsanitizedKey)[0]\n}\n\n// XXX(freiksenet): removing this as it's a breaking change\n// Deeper nested levels should be inferred as JSON.\n// const MAX_DEPTH = 5\n\nconst hasMapping = (mapping, selector) =>\n  mapping && Object.keys(mapping).includes(selector)\n\nconst getFieldConfigFromMapping = ({ typeMapping, selector }) => {\n  const [type, ...path] = typeMapping[selector].split(`.`)\n  return { type, resolve: link({ by: path.join(`.`) || `id` }) }\n}\n\n// probably should be in example value\nconst getFieldConfigFromFieldNameConvention = ({\n  schemaComposer,\n  nodeStore,\n  value,\n  key,\n}) => {\n  const path = key.split(`___NODE___`)[1]\n  // Allow linking by nested fields, e.g. `author___NODE___contact___email`\n  const foreignKey = path && path.replace(/___/g, `.`)\n\n  const getNodeBy = value =>\n    foreignKey\n      ? nodeStore.getNodes().find(node => _.get(node, foreignKey) === value)\n      : nodeStore.getNode(value)\n\n  const linkedNodes = Array.isArray(value)\n    ? value.map(getNodeBy)\n    : [getNodeBy(value)]\n\n  const linkedTypes = _.uniq(\n    linkedNodes.filter(Boolean).map(node => node.internal.type)\n  )\n\n  invariant(\n    linkedTypes.length,\n    `Encountered an error trying to infer a GraphQL type for: \\`${key}\\`. ` +\n      `There is no corresponding node with the \\`id\\` field matching: \"${value}\".`\n  )\n\n  let type\n  // If the field value is an array that links to more than one type,\n  // create a GraphQLUnionType. Note that we don't support the case where\n  // scalar fields link to different types. Similarly, an array of objects\n  // with foreign-key fields will produce union types if those foreign-key\n  // fields are arrays, but not if they are scalars. See the tests for an example.\n  // FIXME: The naming of union types is a breaking change. In current master,\n  // the type name includes the key, which is (i) potentially not unique, and\n  // (ii) hinders reusing types.\n  if (linkedTypes.length > 1) {\n    const typeName = linkedTypes.sort().join(``) + `Union`\n    type = schemaComposer.getOrCreateUTC(typeName, utc => {\n      const types = linkedTypes.map(typeName =>\n        schemaComposer.getOrCreateOTC(typeName)\n      )\n      utc.setTypes(types)\n      utc.setResolveType(node => node.internal.type)\n    })\n  } else {\n    type = linkedTypes[0]\n  }\n\n  return { type, resolve: link({ by: foreignKey || `id` }) }\n}\n\nconst getSimpleFieldConfig = ({\n  schemaComposer,\n  typeComposer,\n  nodeStore,\n  key,\n  value,\n  selector,\n  typeMapping,\n  addNewFields,\n  addDefaultResolvers,\n}) => {\n  switch (typeof value) {\n    case `boolean`:\n      return { type: `Boolean` }\n    case `number`:\n      return { type: is32BitInteger(value) ? `Int` : `Float` }\n    case `string`:\n      if (isDate(value)) {\n        return dateResolver\n      }\n      // FIXME: The weird thing is that we are trying to infer a File,\n      // but cannot assume that a source plugin for File nodes is actually present.\n      if (schemaComposer.has(`File`) && isFile(nodeStore, selector, value)) {\n        // NOTE: For arrays of files, where not every path references\n        // a File node in the db, it is semi-random if the field is\n        // inferred as File or String, since the exampleValue only has\n        // the first entry (which could point to an existing file or not).\n        return { type: `File`, resolve: fileByPath }\n      }\n      return { type: `String` }\n    case `object`:\n      if (value instanceof Date) {\n        return dateResolver\n      }\n      if (value instanceof String) {\n        return { type: `String` }\n      }\n      if (value /* && depth < MAX_DEPTH*/) {\n        // We only create a temporary TypeComposer on nested fields\n        // (either a clone of an existing field type, or a temporary new one),\n        // because we don't yet know if this type should end up in the schema.\n        // It might be for a possibleField that will be disregarded later,\n        // so we cannot mutate the original.\n        let fieldTypeComposer\n        if (\n          typeComposer.hasField(key) &&\n          getNamedType(typeComposer.getFieldType(key)) instanceof\n            GraphQLObjectType\n        ) {\n          const originalFieldTypeComposer = typeComposer.getFieldTC(key)\n          fieldTypeComposer = originalFieldTypeComposer.clone(\n            originalFieldTypeComposer.getTypeName()\n          )\n        } else {\n          fieldTypeComposer = ObjectTypeComposer.createTemp(\n            createTypeName(selector),\n            schemaComposer\n          )\n        }\n\n        return {\n          type: addInferredFieldsImpl({\n            schemaComposer,\n            typeComposer: fieldTypeComposer,\n            nodeStore,\n            exampleObject: value,\n            typeMapping,\n            prefix: selector,\n            addNewFields,\n            addDefaultResolvers,\n          }),\n        }\n      }\n  }\n  throw new Error(`Can't determine type for \"${value}\" in \\`${selector}\\`.`)\n}\n\nconst createTypeName = selector => {\n  const keys = selector.split(`.`)\n  const suffix = keys\n    .slice(1)\n    .map(_.upperFirst)\n    .join(``)\n  return `${keys[0]}${suffix}`\n}\n\nconst NON_ALPHA_NUMERIC_EXPR = new RegExp(`[^a-zA-Z0-9_]`, `g`)\n\n/**\n * GraphQL field names must be a string and cannot contain anything other than\n * alphanumeric characters and `_`. They also can't start with `__` which is\n * reserved for internal fields (`___foo` doesn't work either).\n */\nconst createFieldName = key => {\n  // Check if the key is really a string otherwise GraphQL will throw.\n  invariant(\n    typeof key === `string`,\n    `GraphQL field name (key) is not a string: \\`${key}\\`.`\n  )\n\n  const replaced = key.replace(NON_ALPHA_NUMERIC_EXPR, `_`)\n\n  // key is invalid; normalize with leading underscore and rest with x\n  if (replaced.match(/^__/)) {\n    return replaced.replace(/_/g, (char, index) => (index === 0 ? `_` : `x`))\n  }\n\n  // key is invalid (starts with numeric); normalize with leading underscore\n  if (replaced.match(/^[0-9]/)) {\n    return `_` + replaced\n  }\n\n  return replaced\n}\n"],"file":"add-inferred-fields.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/schema/infer/example-value.js b/node_modules/gatsby/dist/schema/infer/example-value.js
index 5c84ba1..c881f82 100644
--- a/node_modules/gatsby/dist/schema/infer/example-value.js
+++ b/node_modules/gatsby/dist/schema/infer/example-value.js
@@ -4,8 +4,9 @@ const _ = require(`lodash`);
 
 const is32BitInteger = require(`./is-32-bit-integer`);
 
-const _require = require(`../types/date`),
-      isDate = _require.isDate;
+const {
+  looksLikeADate
+} = require(`../types/date`);
 
 const getExampleValue = ({
   nodes,
@@ -27,11 +28,12 @@ module.exports = {
 };
 
 const getExampleObject = ({
-  nodes,
+  nodes: rawNodes,
   prefix,
   typeConflictReporter,
   ignoreFields = []
 }) => {
+  const nodes = rawNodes.filter(node => node != null);
   const allKeys = nodes.reduce((acc, node) => Object.keys(node).forEach(key => key && !ignoreFields.includes(key) && acc.add(key)) || acc, new Set());
   const exampleValue = Array.from(allKeys).reduce((acc, key) => {
     const entries = nodes.map(node => {
@@ -49,13 +51,14 @@ const getExampleObject = ({
 
     if (!entriesByType.length) return acc; // TODO: This whole thing could be prettier!
 
-    let _entriesByType$ = entriesByType[0],
-        value = _entriesByType$.value,
-        type = _entriesByType$.type;
+    let {
+      value,
+      type
+    } = entriesByType[0];
     let arrayWrappers = 0;
 
     while (Array.isArray(value)) {
-      value = value[0];
+      value = value.find(v => v != null);
       arrayWrappers++;
     }
 
@@ -82,11 +85,13 @@ const getExampleObject = ({
 
     if (_.isObject(value) && !_.isArray(value) && !_.isDate(value) && !_.isRegExp(value)) {
       const objects = entries.reduce((acc, entry) => {
-        let value = entry.value;
+        let {
+          value
+        } = entry;
         let arrays = arrayWrappers - 1;
 
         while (arrays > 0) {
-          value = value[0];
+          value = value.find(v => v != null);
           arrays--;
         }
 
@@ -157,7 +162,7 @@ const getType = value => {
       return `number`;
 
     case `string`:
-      return isDate(value) ? `date` : `string`;
+      return looksLikeADate(value) ? `date` : `string`;
 
     case `boolean`:
       return `boolean`;
diff --git a/node_modules/gatsby/dist/schema/infer/example-value.js.map b/node_modules/gatsby/dist/schema/infer/example-value.js.map
index d1bfa95..010b5bd 100644
--- a/node_modules/gatsby/dist/schema/infer/example-value.js.map
+++ b/node_modules/gatsby/dist/schema/infer/example-value.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/schema/infer/example-value.js"],"names":["_","require","is32BitInteger","isDate","getExampleValue","nodes","typeName","typeConflictReporter","ignoreFields","exampleValue","getExampleObject","prefix","module","exports","allKeys","reduce","acc","node","Object","keys","forEach","key","includes","add","Set","Array","from","entries","map","value","type","getType","parent","filter","Boolean","selector","entriesByType","uniqBy","entry","length","arrayWrappers","isArray","isMixOfDatesAndStrings","allNonEmptyStringsAreDates","every","values","flatMap","addConflict","exampleFieldValue","isObject","isRegExp","objects","arrays","concat","exampleObject","findFloat","types","startsWith","slice","split","t","replace","size","has","result","find","numbers","some","number","Date","String","uniqueValues","uniq","v","join"],"mappings":"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","sourcesContent":["const _ = require(`lodash`)\nconst is32BitInteger = require(`./is-32-bit-integer`)\nconst { isDate } = require(`../types/date`)\n\nconst getExampleValue = ({\n  nodes,\n  typeName,\n  typeConflictReporter,\n  ignoreFields,\n}) => {\n  const exampleValue = getExampleObject({\n    nodes,\n    prefix: typeName,\n    typeConflictReporter,\n    ignoreFields,\n  })\n  return exampleValue\n}\n\nmodule.exports = {\n  getExampleValue,\n}\n\nconst getExampleObject = ({\n  nodes,\n  prefix,\n  typeConflictReporter,\n  ignoreFields = [],\n}) => {\n  const allKeys = nodes.reduce(\n    (acc, node) =>\n      Object.keys(node).forEach(\n        key => key && !ignoreFields.includes(key) && acc.add(key)\n      ) || acc,\n    new Set()\n  )\n\n  const exampleValue = Array.from(allKeys).reduce((acc, key) => {\n    const entries = nodes\n      .map(node => {\n        const value = node[key]\n        const type = getType(value)\n        return type && { value, type, parent: node }\n      })\n      .filter(Boolean)\n\n    const selector = prefix ? `${prefix}.${key}` : key\n\n    const entriesByType = _.uniqBy(entries, entry => entry.type)\n    if (!entriesByType.length) return acc\n\n    // TODO: This whole thing could be prettier!\n    let { value, type } = entriesByType[0]\n    let arrayWrappers = 0\n    while (Array.isArray(value)) {\n      value = value[0]\n      arrayWrappers++\n    }\n\n    if (entriesByType.length > 1 || type.includes(`,`)) {\n      if (\n        isMixOfDatesAndStrings(\n          entriesByType.map(entry => entry.type),\n          arrayWrappers\n        )\n      ) {\n        // TODO: Possibly revisit this in Gatsby v3.\n        const allNonEmptyStringsAreDates = entries.every(entry => {\n          const values = Array.isArray(entry.value)\n            ? _.flatMap(entry.value)\n            : [entry.value]\n          return values.every(\n            value => value === `` || getType(value) === `date`\n          )\n        })\n        if (allNonEmptyStringsAreDates) {\n          value = `1978-09-26`\n        } else {\n          value = `String`\n        }\n      } else {\n        typeConflictReporter.addConflict(selector, entriesByType)\n        return acc\n      }\n    }\n\n    let exampleFieldValue\n    if (\n      _.isObject(value) &&\n      !_.isArray(value) &&\n      !_.isDate(value) &&\n      !_.isRegExp(value)\n    ) {\n      const objects = entries.reduce((acc, entry) => {\n        let { value } = entry\n        let arrays = arrayWrappers - 1\n        while (arrays > 0) {\n          value = value[0]\n          arrays--\n        }\n        return acc.concat(value)\n      }, [])\n      const exampleObject = getExampleObject({\n        nodes: objects,\n        prefix: selector,\n        typeConflictReporter,\n      })\n      if (!Object.keys(exampleObject).length) return acc\n      exampleFieldValue = exampleObject\n    } else if (key.includes(`___NODE`) && arrayWrappers) {\n      // For arrays on ___NODE foreign-key fields we return all values,\n      // because the array values are allowed to link to nodes of different types.\n      // For those we will create a GraphQLUnionType later.\n      arrayWrappers--\n      exampleFieldValue = entries.reduce(\n        (acc, entry) => acc.concat(entry.value),\n        []\n      )\n    } else {\n      // FIXME: Why not simply treat every number as float (instead of looping through all values again)?\n      exampleFieldValue =\n        (typeof value === `number` && findFloat(entries)) || value\n      // exampleFieldValue = value === `number` ? 0.1 : value\n    }\n    while (arrayWrappers--) {\n      exampleFieldValue = [exampleFieldValue]\n    }\n    acc[key] = exampleFieldValue\n\n    return acc\n  }, {})\n\n  return exampleValue\n}\n\nconst isMixOfDatesAndStrings = (types, arrayWrappers) => {\n  const acc = new Set()\n  types.every(type => {\n    let arrays = arrayWrappers\n    while (arrays--) {\n      if (type.startsWith(`[`)) {\n        type = type.slice(1, -1)\n      } else {\n        return false\n      }\n    }\n    type.split(`,`).forEach(t => acc.add(t.replace(/[[]]/g, ``)))\n    return true\n  })\n  return acc.size === 2 && acc.has(`date`) && acc.has(`string`)\n}\n\nconst findFloat = entries => {\n  let result\n  const find = numbers =>\n    numbers.some(value => {\n      const number = typeof value === `object` ? value.value : value\n      return Array.isArray(number)\n        ? find(number)\n        : !is32BitInteger(number) && (result = number)\n    })\n  find(entries)\n  return result\n}\n\nconst getType = value => {\n  switch (typeof value) {\n    case `number`:\n      return `number`\n    case `string`:\n      return isDate(value) ? `date` : `string`\n    case `boolean`:\n      return `boolean`\n    case `object`:\n      if (value === null) return null\n      if (value instanceof Date) return `date`\n      if (value instanceof String) return `string`\n      if (Array.isArray(value)) {\n        const uniqueValues = _.uniq(value.map(getType).filter(v => v != null))\n        return uniqueValues.length ? `[${uniqueValues.join(`,`)}]` : null\n      }\n      if (!Object.keys(value).length) return null\n      return `object`\n    default:\n      return null\n  }\n}\n"],"file":"example-value.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/schema/infer/example-value.js"],"names":["_","require","is32BitInteger","looksLikeADate","getExampleValue","nodes","typeName","typeConflictReporter","ignoreFields","exampleValue","getExampleObject","prefix","module","exports","rawNodes","filter","node","allKeys","reduce","acc","Object","keys","forEach","key","includes","add","Set","Array","from","entries","map","value","type","getType","parent","Boolean","selector","entriesByType","uniqBy","entry","length","arrayWrappers","isArray","find","v","isMixOfDatesAndStrings","allNonEmptyStringsAreDates","every","values","flatMap","addConflict","exampleFieldValue","isObject","isDate","isRegExp","objects","arrays","concat","exampleObject","findFloat","types","startsWith","slice","split","t","replace","size","has","result","numbers","some","number","Date","String","uniqueValues","uniq","join"],"mappings":"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","sourcesContent":["const _ = require(`lodash`)\nconst is32BitInteger = require(`./is-32-bit-integer`)\nconst { looksLikeADate } = require(`../types/date`)\n\nconst getExampleValue = ({\n  nodes,\n  typeName,\n  typeConflictReporter,\n  ignoreFields,\n}) => {\n  const exampleValue = getExampleObject({\n    nodes,\n    prefix: typeName,\n    typeConflictReporter,\n    ignoreFields,\n  })\n  return exampleValue\n}\n\nmodule.exports = {\n  getExampleValue,\n}\n\nconst getExampleObject = ({\n  nodes: rawNodes,\n  prefix,\n  typeConflictReporter,\n  ignoreFields = [],\n}) => {\n  const nodes = rawNodes.filter(node => node != null)\n  const allKeys = nodes.reduce(\n    (acc, node) =>\n      Object.keys(node).forEach(\n        key => key && !ignoreFields.includes(key) && acc.add(key)\n      ) || acc,\n    new Set()\n  )\n\n  const exampleValue = Array.from(allKeys).reduce((acc, key) => {\n    const entries = nodes\n      .map(node => {\n        const value = node[key]\n        const type = getType(value)\n        return type && { value, type, parent: node }\n      })\n      .filter(Boolean)\n\n    const selector = prefix ? `${prefix}.${key}` : key\n\n    const entriesByType = _.uniqBy(entries, entry => entry.type)\n    if (!entriesByType.length) return acc\n\n    // TODO: This whole thing could be prettier!\n    let { value, type } = entriesByType[0]\n    let arrayWrappers = 0\n    while (Array.isArray(value)) {\n      value = value.find(v => v != null)\n      arrayWrappers++\n    }\n\n    if (entriesByType.length > 1 || type.includes(`,`)) {\n      if (\n        isMixOfDatesAndStrings(\n          entriesByType.map(entry => entry.type),\n          arrayWrappers\n        )\n      ) {\n        // TODO: Possibly revisit this in Gatsby v3.\n        const allNonEmptyStringsAreDates = entries.every(entry => {\n          const values = Array.isArray(entry.value)\n            ? _.flatMap(entry.value)\n            : [entry.value]\n          return values.every(\n            value => value === `` || getType(value) === `date`\n          )\n        })\n        if (allNonEmptyStringsAreDates) {\n          value = `1978-09-26`\n        } else {\n          value = `String`\n        }\n      } else {\n        typeConflictReporter.addConflict(selector, entriesByType)\n        return acc\n      }\n    }\n\n    let exampleFieldValue\n    if (\n      _.isObject(value) &&\n      !_.isArray(value) &&\n      !_.isDate(value) &&\n      !_.isRegExp(value)\n    ) {\n      const objects = entries.reduce((acc, entry) => {\n        let { value } = entry\n\n        let arrays = arrayWrappers - 1\n        while (arrays > 0) {\n          value = value.find(v => v != null)\n          arrays--\n        }\n        return acc.concat(value)\n      }, [])\n      const exampleObject = getExampleObject({\n        nodes: objects,\n        prefix: selector,\n        typeConflictReporter,\n      })\n      if (!Object.keys(exampleObject).length) return acc\n      exampleFieldValue = exampleObject\n    } else if (key.includes(`___NODE`) && arrayWrappers) {\n      // For arrays on ___NODE foreign-key fields we return all values,\n      // because the array values are allowed to link to nodes of different types.\n      // For those we will create a GraphQLUnionType later.\n      arrayWrappers--\n      exampleFieldValue = entries.reduce(\n        (acc, entry) => acc.concat(entry.value),\n        []\n      )\n    } else {\n      // FIXME: Why not simply treat every number as float (instead of looping through all values again)?\n      exampleFieldValue =\n        (typeof value === `number` && findFloat(entries)) || value\n      // exampleFieldValue = value === `number` ? 0.1 : value\n    }\n    while (arrayWrappers--) {\n      exampleFieldValue = [exampleFieldValue]\n    }\n    acc[key] = exampleFieldValue\n\n    return acc\n  }, {})\n\n  return exampleValue\n}\n\nconst isMixOfDatesAndStrings = (types, arrayWrappers) => {\n  const acc = new Set()\n  types.every(type => {\n    let arrays = arrayWrappers\n    while (arrays--) {\n      if (type.startsWith(`[`)) {\n        type = type.slice(1, -1)\n      } else {\n        return false\n      }\n    }\n    type.split(`,`).forEach(t => acc.add(t.replace(/[[]]/g, ``)))\n    return true\n  })\n  return acc.size === 2 && acc.has(`date`) && acc.has(`string`)\n}\n\nconst findFloat = entries => {\n  let result\n  const find = numbers =>\n    numbers.some(value => {\n      const number = typeof value === `object` ? value.value : value\n      return Array.isArray(number)\n        ? find(number)\n        : !is32BitInteger(number) && (result = number)\n    })\n  find(entries)\n  return result\n}\n\nconst getType = value => {\n  switch (typeof value) {\n    case `number`:\n      return `number`\n    case `string`:\n      return looksLikeADate(value) ? `date` : `string`\n    case `boolean`:\n      return `boolean`\n    case `object`:\n      if (value === null) return null\n      if (value instanceof Date) return `date`\n      if (value instanceof String) return `string`\n      if (Array.isArray(value)) {\n        const uniqueValues = _.uniq(value.map(getType).filter(v => v != null))\n        return uniqueValues.length ? `[${uniqueValues.join(`,`)}]` : null\n      }\n      if (!Object.keys(value).length) return null\n      return `object`\n    default:\n      return null\n  }\n}\n"],"file":"example-value.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/schema/infer/get-infer-config.js b/node_modules/gatsby/dist/schema/infer/get-infer-config.js
index 5f0056c..da3ad85 100644
--- a/node_modules/gatsby/dist/schema/infer/get-infer-config.js
+++ b/node_modules/gatsby/dist/schema/infer/get-infer-config.js
@@ -1,8 +1,5 @@
 "use strict";
 
-const _require = require(`graphql`),
-      Kind = _require.Kind;
-
 const DEFAULT_INFER_CONFIG = {
   infer: true,
   addDefaultResolvers: true // Get inferance config from type directives
@@ -10,37 +7,11 @@ const DEFAULT_INFER_CONFIG = {
 };
 
 const getInferConfig = typeComposer => {
-  const type = typeComposer.getType();
-  const inferConfig = Object.assign({}, DEFAULT_INFER_CONFIG);
-
-  if (type.astNode && type.astNode.directives) {
-    type.astNode.directives.forEach(directive => {
-      if (directive.name.value === `infer`) {
-        inferConfig.infer = true;
-        inferConfig.addDefaultResolvers = getNoDefaultResolvers(directive);
-      } else if (directive.name.value === `dontInfer`) {
-        inferConfig.infer = false;
-        inferConfig.addDefaultResolvers = getNoDefaultResolvers(directive);
-      }
-    });
-  }
-
-  return inferConfig;
+  return {
+    infer: typeComposer.hasExtension(`infer`) ? typeComposer.getExtension(`infer`) : DEFAULT_INFER_CONFIG.infer,
+    addDefaultResolvers: typeComposer.hasExtension(`addDefaultResolvers`) ? typeComposer.getExtension(`addDefaultResolvers`) : DEFAULT_INFER_CONFIG.addDefaultResolvers
+  };
 };
 
 module.exports = getInferConfig;
-
-const getNoDefaultResolvers = directive => {
-  const noDefaultResolvers = directive.arguments.find(({
-    name
-  }) => name.value === `noDefaultResolvers`);
-
-  if (noDefaultResolvers) {
-    if (noDefaultResolvers.value.kind === Kind.BOOLEAN) {
-      return !noDefaultResolvers.value.value;
-    }
-  }
-
-  return DEFAULT_INFER_CONFIG.addDefaultResolvers;
-};
 //# sourceMappingURL=get-infer-config.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/schema/infer/get-infer-config.js.map b/node_modules/gatsby/dist/schema/infer/get-infer-config.js.map
index 59811c1..759f7a9 100644
--- a/node_modules/gatsby/dist/schema/infer/get-infer-config.js.map
+++ b/node_modules/gatsby/dist/schema/infer/get-infer-config.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/schema/infer/get-infer-config.js"],"names":["require","Kind","DEFAULT_INFER_CONFIG","infer","addDefaultResolvers","getInferConfig","typeComposer","type","getType","inferConfig","astNode","directives","forEach","directive","name","value","getNoDefaultResolvers","module","exports","noDefaultResolvers","arguments","find","kind","BOOLEAN"],"mappings":";;iBAEiBA,OAAO,CAAE,SAAF,C;MAAhBC,I,YAAAA,I;;AAOR,MAAMC,oBAAiC,GAAG;AACxCC,EAAAA,KAAK,EAAE,IADiC;AAExCC,EAAAA,mBAAmB,EAAE,IAFmB,CAK1C;;AAL0C,CAA1C;;AAMA,MAAMC,cAEU,GAAGC,YAAY,IAAI;AACjC,QAAMC,IAAI,GAAGD,YAAY,CAACE,OAAb,EAAb;AACA,QAAMC,WAAW,qBAAQP,oBAAR,CAAjB;;AACA,MAAIK,IAAI,CAACG,OAAL,IAAgBH,IAAI,CAACG,OAAL,CAAaC,UAAjC,EAA6C;AAC3CJ,IAAAA,IAAI,CAACG,OAAL,CAAaC,UAAb,CAAwBC,OAAxB,CAAgCC,SAAS,IAAI;AAC3C,UAAIA,SAAS,CAACC,IAAV,CAAeC,KAAf,KAA0B,OAA9B,EAAsC;AACpCN,QAAAA,WAAW,CAACN,KAAZ,GAAoB,IAApB;AACAM,QAAAA,WAAW,CAACL,mBAAZ,GAAkCY,qBAAqB,CAACH,SAAD,CAAvD;AACD,OAHD,MAGO,IAAIA,SAAS,CAACC,IAAV,CAAeC,KAAf,KAA0B,WAA9B,EAA0C;AAC/CN,QAAAA,WAAW,CAACN,KAAZ,GAAoB,KAApB;AACAM,QAAAA,WAAW,CAACL,mBAAZ,GAAkCY,qBAAqB,CAACH,SAAD,CAAvD;AACD;AACF,KARD;AASD;;AAED,SAAOJ,WAAP;AACD,CAlBD;;AAoBAQ,MAAM,CAACC,OAAP,GAAiBb,cAAjB;;AAEA,MAAMW,qBAAqB,GAAGH,SAAS,IAAI;AACzC,QAAMM,kBAAkB,GAAGN,SAAS,CAACO,SAAV,CAAoBC,IAApB,CACzB,CAAC;AAAEP,IAAAA;AAAF,GAAD,KAAcA,IAAI,CAACC,KAAL,KAAgB,oBADL,CAA3B;;AAGA,MAAII,kBAAJ,EAAwB;AACtB,QAAIA,kBAAkB,CAACJ,KAAnB,CAAyBO,IAAzB,KAAkCrB,IAAI,CAACsB,OAA3C,EAAoD;AAClD,aAAO,CAACJ,kBAAkB,CAACJ,KAAnB,CAAyBA,KAAjC;AACD;AACF;;AAED,SAAOb,oBAAoB,CAACE,mBAA5B;AACD,CAXD","sourcesContent":["// @flow\n\nconst { Kind } = require(`graphql`)\n\nexport interface InferConfig {\n  infer: boolean;\n  addDefaultResolvers: boolean;\n}\n\nconst DEFAULT_INFER_CONFIG: InferConfig = {\n  infer: true,\n  addDefaultResolvers: true,\n}\n\n// Get inferance config from type directives\nconst getInferConfig: (\n  typeComposer: TypeComposer\n) => InferConfig = typeComposer => {\n  const type = typeComposer.getType()\n  const inferConfig = { ...DEFAULT_INFER_CONFIG }\n  if (type.astNode && type.astNode.directives) {\n    type.astNode.directives.forEach(directive => {\n      if (directive.name.value === `infer`) {\n        inferConfig.infer = true\n        inferConfig.addDefaultResolvers = getNoDefaultResolvers(directive)\n      } else if (directive.name.value === `dontInfer`) {\n        inferConfig.infer = false\n        inferConfig.addDefaultResolvers = getNoDefaultResolvers(directive)\n      }\n    })\n  }\n\n  return inferConfig\n}\n\nmodule.exports = getInferConfig\n\nconst getNoDefaultResolvers = directive => {\n  const noDefaultResolvers = directive.arguments.find(\n    ({ name }) => name.value === `noDefaultResolvers`\n  )\n  if (noDefaultResolvers) {\n    if (noDefaultResolvers.value.kind === Kind.BOOLEAN) {\n      return !noDefaultResolvers.value.value\n    }\n  }\n\n  return DEFAULT_INFER_CONFIG.addDefaultResolvers\n}\n"],"file":"get-infer-config.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/schema/infer/get-infer-config.js"],"names":["DEFAULT_INFER_CONFIG","infer","addDefaultResolvers","getInferConfig","typeComposer","hasExtension","getExtension","module","exports"],"mappings":";;AAOA,MAAMA,oBAAiC,GAAG;AACxCC,EAAAA,KAAK,EAAE,IADiC;AAExCC,EAAAA,mBAAmB,EAAE,IAFmB,CAK1C;;AAL0C,CAA1C;;AAMA,MAAMC,cAEU,GAAGC,YAAY,IAAI;AACjC,SAAO;AACLH,IAAAA,KAAK,EAAEG,YAAY,CAACC,YAAb,CAA2B,OAA3B,IACHD,YAAY,CAACE,YAAb,CAA2B,OAA3B,CADG,GAEHN,oBAAoB,CAACC,KAHpB;AAILC,IAAAA,mBAAmB,EAAEE,YAAY,CAACC,YAAb,CAA2B,qBAA3B,IACjBD,YAAY,CAACE,YAAb,CAA2B,qBAA3B,CADiB,GAEjBN,oBAAoB,CAACE;AANpB,GAAP;AAQD,CAXD;;AAaAK,MAAM,CAACC,OAAP,GAAiBL,cAAjB","sourcesContent":["// @flow\n\nexport interface InferConfig {\n  infer: boolean;\n  addDefaultResolvers: boolean;\n}\n\nconst DEFAULT_INFER_CONFIG: InferConfig = {\n  infer: true,\n  addDefaultResolvers: true,\n}\n\n// Get inferance config from type directives\nconst getInferConfig: (\n  typeComposer: TypeComposer\n) => InferConfig = typeComposer => {\n  return {\n    infer: typeComposer.hasExtension(`infer`)\n      ? typeComposer.getExtension(`infer`)\n      : DEFAULT_INFER_CONFIG.infer,\n    addDefaultResolvers: typeComposer.hasExtension(`addDefaultResolvers`)\n      ? typeComposer.getExtension(`addDefaultResolvers`)\n      : DEFAULT_INFER_CONFIG.addDefaultResolvers,\n  }\n}\n\nmodule.exports = getInferConfig\n"],"file":"get-infer-config.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/schema/infer/index.js b/node_modules/gatsby/dist/schema/infer/index.js
index 9f7bf04..f9296dd 100644
--- a/node_modules/gatsby/dist/schema/infer/index.js
+++ b/node_modules/gatsby/dist/schema/infer/index.js
@@ -2,15 +2,18 @@
 
 const report = require(`gatsby-cli/lib/reporter`);
 
-const _require = require(`./example-value`),
-      getExampleValue = _require.getExampleValue;
+const {
+  getExampleValue
+} = require(`./example-value`);
 
-const _require2 = require(`../types/node-interface`),
-      addNodeInterface = _require2.addNodeInterface,
-      getNodeInterface = _require2.getNodeInterface;
+const {
+  addNodeInterface,
+  getNodeInterface
+} = require(`../types/node-interface`);
 
-const _require3 = require(`./add-inferred-fields`),
-      addInferredFields = _require3.addInferredFields;
+const {
+  addInferredFields
+} = require(`./add-inferred-fields`);
 
 const getInferConfig = require(`./get-infer-config`);
 
@@ -23,8 +26,14 @@ const addInferredType = ({
   parentSpan
 }) => {
   const typeName = typeComposer.getTypeName();
+  const nodes = nodeStore.getNodesByType(typeName);
+
+  if (!typeComposer.hasExtension(`plugin`) && typeComposer.getExtension(`createdFrom`) === `infer`) {
+    typeComposer.setExtension(`plugin`, nodes[0].internal.owner);
+  }
+
   const exampleValue = getExampleValue({
-    nodes: nodeStore.getNodesByType(typeName),
+    nodes,
     typeName,
     typeConflictReporter,
     ignoreFields: [...getNodeInterface({
@@ -69,6 +78,7 @@ const addInferredTypes = ({
       }
     } else {
       typeComposer = schemaComposer.createObjectTC(typeName);
+      typeComposer.setExtension(`createdFrom`, `infer`);
       addNodeInterface({
         schemaComposer,
         typeComposer
@@ -76,16 +86,14 @@ const addInferredTypes = ({
     }
   }); // XXX(freiksenet): We iterate twice to pre-create all types
 
-  const typeComposers = typeNames.map(typeName => {
-    addInferredType({
-      schemaComposer,
-      nodeStore,
-      typeConflictReporter,
-      typeComposer: schemaComposer.getOTC(typeName),
-      typeMapping,
-      parentSpan
-    });
-  });
+  const typeComposers = typeNames.map(typeName => addInferredType({
+    schemaComposer,
+    nodeStore,
+    typeConflictReporter,
+    typeComposer: schemaComposer.getOTC(typeName),
+    typeMapping,
+    parentSpan
+  }));
 
   if (noNodeInterfaceTypes.length > 0) {
     noNodeInterfaceTypes.forEach(type => {
diff --git a/node_modules/gatsby/dist/schema/infer/index.js.map b/node_modules/gatsby/dist/schema/infer/index.js.map
index e8e0916..0ff09b8 100644
--- a/node_modules/gatsby/dist/schema/infer/index.js.map
+++ b/node_modules/gatsby/dist/schema/infer/index.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/schema/infer/index.js"],"names":["report","require","getExampleValue","addNodeInterface","getNodeInterface","addInferredFields","getInferConfig","addInferredType","schemaComposer","typeComposer","nodeStore","typeConflictReporter","typeMapping","parentSpan","typeName","getTypeName","exampleValue","nodes","getNodesByType","ignoreFields","getFieldNames","inferConfig","addInferredTypes","typeNames","putFileFirst","getTypes","noNodeInterfaceTypes","forEach","has","getOTC","infer","hasInterface","push","getType","createObjectTC","typeComposers","map","length","type","warn","panic","index","indexOf","slice","module","exports"],"mappings":"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","sourcesContent":["const report = require(`gatsby-cli/lib/reporter`)\nconst { getExampleValue } = require(`./example-value`)\nconst {\n  addNodeInterface,\n  getNodeInterface,\n} = require(`../types/node-interface`)\nconst { addInferredFields } = require(`./add-inferred-fields`)\nconst getInferConfig = require(`./get-infer-config`)\n\nconst addInferredType = ({\n  schemaComposer,\n  typeComposer,\n  nodeStore,\n  typeConflictReporter,\n  typeMapping,\n  parentSpan,\n}) => {\n  const typeName = typeComposer.getTypeName()\n  const exampleValue = getExampleValue({\n    nodes: nodeStore.getNodesByType(typeName),\n    typeName,\n    typeConflictReporter,\n    ignoreFields: [\n      ...getNodeInterface({ schemaComposer }).getFieldNames(),\n      `$loki`,\n    ],\n  })\n\n  addInferredFields({\n    schemaComposer,\n    typeComposer,\n    nodeStore,\n    exampleValue,\n    inferConfig: getInferConfig(typeComposer),\n    typeMapping,\n    parentSpan,\n  })\n  return typeComposer\n}\n\nconst addInferredTypes = ({\n  schemaComposer,\n  nodeStore,\n  typeConflictReporter,\n  typeMapping,\n  parentSpan,\n}) => {\n  // XXX(freiksenet): Won't be needed after plugins set typedefs\n  // Infer File first so all the links to it would work\n  const typeNames = putFileFirst(nodeStore.getTypes())\n  const noNodeInterfaceTypes = []\n\n  typeNames.forEach(typeName => {\n    let typeComposer\n    let inferConfig\n    if (schemaComposer.has(typeName)) {\n      typeComposer = schemaComposer.getOTC(typeName)\n      inferConfig = getInferConfig(typeComposer)\n      if (inferConfig.infer) {\n        if (!typeComposer.hasInterface(`Node`)) {\n          noNodeInterfaceTypes.push(typeComposer.getType())\n        }\n      }\n    } else {\n      typeComposer = schemaComposer.createObjectTC(typeName)\n      addNodeInterface({ schemaComposer, typeComposer })\n    }\n  })\n\n  // XXX(freiksenet): We iterate twice to pre-create all types\n  const typeComposers = typeNames.map(typeName => {\n    addInferredType({\n      schemaComposer,\n      nodeStore,\n      typeConflictReporter,\n      typeComposer: schemaComposer.getOTC(typeName),\n      typeMapping,\n      parentSpan,\n    })\n  })\n\n  if (noNodeInterfaceTypes.length > 0) {\n    noNodeInterfaceTypes.forEach(type => {\n      report.warn(\n        `Type \\`${type}\\` declared in \\`createTypes\\` looks like a node, ` +\n          `but doesn't implement a \\`Node\\` interface. It's likely that you should ` +\n          `add the \\`Node\\` interface to your type def:\\n\\n` +\n          `\\`type ${type} implements Node { ... }\\`\\n\\n` +\n          `If you know that you don't want it to be a node (which would mean no ` +\n          `root queries to retrieve it), you can explicitly disable inference ` +\n          `for it:\\n\\n` +\n          `\\`type ${type} @dontInfer { ... }\\``\n      )\n    })\n    report.panic(`Building schema failed`)\n  }\n\n  return typeComposers\n}\n\nconst putFileFirst = typeNames => {\n  const index = typeNames.indexOf(`File`)\n  if (index !== -1) {\n    return [`File`, ...typeNames.slice(0, index), ...typeNames.slice(index + 1)]\n  } else {\n    return typeNames\n  }\n}\n\nmodule.exports = {\n  addInferredType,\n  addInferredTypes,\n}\n"],"file":"index.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/schema/infer/index.js"],"names":["report","require","getExampleValue","addNodeInterface","getNodeInterface","addInferredFields","getInferConfig","addInferredType","schemaComposer","typeComposer","nodeStore","typeConflictReporter","typeMapping","parentSpan","typeName","getTypeName","nodes","getNodesByType","hasExtension","getExtension","setExtension","internal","owner","exampleValue","ignoreFields","getFieldNames","inferConfig","addInferredTypes","typeNames","putFileFirst","getTypes","noNodeInterfaceTypes","forEach","has","getOTC","infer","hasInterface","push","getType","createObjectTC","typeComposers","map","length","type","warn","panic","index","indexOf","slice","module","exports"],"mappings":"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","sourcesContent":["const report = require(`gatsby-cli/lib/reporter`)\nconst { getExampleValue } = require(`./example-value`)\nconst {\n  addNodeInterface,\n  getNodeInterface,\n} = require(`../types/node-interface`)\nconst { addInferredFields } = require(`./add-inferred-fields`)\nconst getInferConfig = require(`./get-infer-config`)\n\nconst addInferredType = ({\n  schemaComposer,\n  typeComposer,\n  nodeStore,\n  typeConflictReporter,\n  typeMapping,\n  parentSpan,\n}) => {\n  const typeName = typeComposer.getTypeName()\n  const nodes = nodeStore.getNodesByType(typeName)\n  if (\n    !typeComposer.hasExtension(`plugin`) &&\n    typeComposer.getExtension(`createdFrom`) === `infer`\n  ) {\n    typeComposer.setExtension(`plugin`, nodes[0].internal.owner)\n  }\n  const exampleValue = getExampleValue({\n    nodes,\n    typeName,\n    typeConflictReporter,\n    ignoreFields: [\n      ...getNodeInterface({ schemaComposer }).getFieldNames(),\n      `$loki`,\n    ],\n  })\n\n  addInferredFields({\n    schemaComposer,\n    typeComposer,\n    nodeStore,\n    exampleValue,\n    inferConfig: getInferConfig(typeComposer),\n    typeMapping,\n    parentSpan,\n  })\n  return typeComposer\n}\n\nconst addInferredTypes = ({\n  schemaComposer,\n  nodeStore,\n  typeConflictReporter,\n  typeMapping,\n  parentSpan,\n}) => {\n  // XXX(freiksenet): Won't be needed after plugins set typedefs\n  // Infer File first so all the links to it would work\n  const typeNames = putFileFirst(nodeStore.getTypes())\n  const noNodeInterfaceTypes = []\n\n  typeNames.forEach(typeName => {\n    let typeComposer\n    let inferConfig\n    if (schemaComposer.has(typeName)) {\n      typeComposer = schemaComposer.getOTC(typeName)\n      inferConfig = getInferConfig(typeComposer)\n      if (inferConfig.infer) {\n        if (!typeComposer.hasInterface(`Node`)) {\n          noNodeInterfaceTypes.push(typeComposer.getType())\n        }\n      }\n    } else {\n      typeComposer = schemaComposer.createObjectTC(typeName)\n      typeComposer.setExtension(`createdFrom`, `infer`)\n      addNodeInterface({ schemaComposer, typeComposer })\n    }\n  })\n\n  // XXX(freiksenet): We iterate twice to pre-create all types\n  const typeComposers = typeNames.map(typeName =>\n    addInferredType({\n      schemaComposer,\n      nodeStore,\n      typeConflictReporter,\n      typeComposer: schemaComposer.getOTC(typeName),\n      typeMapping,\n      parentSpan,\n    })\n  )\n\n  if (noNodeInterfaceTypes.length > 0) {\n    noNodeInterfaceTypes.forEach(type => {\n      report.warn(\n        `Type \\`${type}\\` declared in \\`createTypes\\` looks like a node, ` +\n          `but doesn't implement a \\`Node\\` interface. It's likely that you should ` +\n          `add the \\`Node\\` interface to your type def:\\n\\n` +\n          `\\`type ${type} implements Node { ... }\\`\\n\\n` +\n          `If you know that you don't want it to be a node (which would mean no ` +\n          `root queries to retrieve it), you can explicitly disable inference ` +\n          `for it:\\n\\n` +\n          `\\`type ${type} @dontInfer { ... }\\``\n      )\n    })\n    report.panic(`Building schema failed`)\n  }\n\n  return typeComposers\n}\n\nconst putFileFirst = typeNames => {\n  const index = typeNames.indexOf(`File`)\n  if (index !== -1) {\n    return [`File`, ...typeNames.slice(0, index), ...typeNames.slice(index + 1)]\n  } else {\n    return typeNames\n  }\n}\n\nmodule.exports = {\n  addInferredType,\n  addInferredTypes,\n}\n"],"file":"index.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/schema/infer/is-file.js b/node_modules/gatsby/dist/schema/infer/is-file.js
index 036cddc..af0e4f1 100644
--- a/node_modules/gatsby/dist/schema/infer/is-file.js
+++ b/node_modules/gatsby/dist/schema/infer/is-file.js
@@ -10,8 +10,9 @@ const isRelative = require(`is-relative`);
 
 const isRelativeUrl = require(`is-relative-url`);
 
-const _require = require(`../utils/get-value-at`),
-      getValueAt = _require.getValueAt;
+const {
+  getValueAt
+} = require(`../utils/get-value-at`);
 
 const isFile = (nodeStore, field, relativePath) => {
   const filePath = getFilePath(nodeStore, field, relativePath);
@@ -35,10 +36,7 @@ const getFirstValueAt = (node, selector) => {
 };
 
 const getFilePath = (nodeStore, field, relativePath) => {
-  const _field$split = field.split(`.`),
-        typeName = _field$split[0],
-        selector = _field$split.slice(1);
-
+  const [typeName, ...selector] = field.split(`.`);
   if (typeName === `File`) return null;
   const looksLikeFile = !path.isAbsolute(relativePath) && mime.getType(relativePath) !== null && // FIXME: Do we need all of this?
   mime.getType(relativePath) !== `application/x-msdownload` && isRelative(relativePath) && isRelativeUrl(relativePath);
@@ -56,9 +54,9 @@ const getAbsolutePath = (nodeStore, node, relativePath) => {
 
 const getBaseDir = (nodeStore, node) => {
   if (node) {
-    const _ref = findAncestorNode(nodeStore, node, node => node.internal.type === `File`) || {},
-          dir = _ref.dir;
-
+    const {
+      dir
+    } = findAncestorNode(nodeStore, node, node => node.internal.type === `File`) || {};
     return dir;
   }
 
diff --git a/node_modules/gatsby/dist/schema/infer/is-file.js.map b/node_modules/gatsby/dist/schema/infer/is-file.js.map
index 12dc309..3989705 100644
--- a/node_modules/gatsby/dist/schema/infer/is-file.js.map
+++ b/node_modules/gatsby/dist/schema/infer/is-file.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/schema/infer/is-file.js"],"names":["path","require","slash","mime","isRelative","isRelativeUrl","getValueAt","isFile","nodeStore","field","relativePath","filePath","getFilePath","filePathExists","getNodesByType","some","node","absolutePath","module","exports","getFirstValueAt","selector","value","Array","isArray","split","typeName","looksLikeFile","isAbsolute","getType","normalizedPath","find","getAbsolutePath","dir","getBaseDir","withDir","withBaseDir","map","findAncestorNode","internal","type","p","posix","join","childNode","predicate","parent","getNode"],"mappings":"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","sourcesContent":["const path = require(`path`)\nconst slash = require(`slash`)\nconst mime = require(`mime`)\nconst isRelative = require(`is-relative`)\nconst isRelativeUrl = require(`is-relative-url`)\nconst { getValueAt } = require(`../utils/get-value-at`)\n\nconst isFile = (nodeStore, field, relativePath) => {\n  const filePath = getFilePath(nodeStore, field, relativePath)\n  if (!filePath) return false\n  const filePathExists = nodeStore\n    .getNodesByType(`File`)\n    .some(node => node.absolutePath === filePath)\n  return filePathExists\n}\n\nmodule.exports = {\n  isFile,\n}\n\nconst getFirstValueAt = (node, selector) => {\n  let value = getValueAt(node, selector)\n  while (Array.isArray(value)) {\n    value = value[0]\n  }\n  return value\n}\n\nconst getFilePath = (nodeStore, field, relativePath) => {\n  const [typeName, ...selector] = field.split(`.`)\n\n  if (typeName === `File`) return null\n\n  const looksLikeFile =\n    !path.isAbsolute(relativePath) &&\n    mime.getType(relativePath) !== null &&\n    // FIXME: Do we need all of this?\n    mime.getType(relativePath) !== `application/x-msdownload` &&\n    isRelative(relativePath) &&\n    isRelativeUrl(relativePath)\n\n  if (!looksLikeFile) return null\n\n  const normalizedPath = slash(relativePath)\n  const node = nodeStore\n    .getNodesByType(typeName)\n    .find(node => getFirstValueAt(node, selector) === normalizedPath)\n\n  return node ? getAbsolutePath(nodeStore, node, normalizedPath) : null\n}\n\nconst getAbsolutePath = (nodeStore, node, relativePath) => {\n  const dir = getBaseDir(nodeStore, node)\n  const withDir = withBaseDir(dir)\n  return dir\n    ? Array.isArray(relativePath)\n      ? relativePath.map(withDir)\n      : withDir(relativePath)\n    : null\n}\n\nconst getBaseDir = (nodeStore, node) => {\n  if (node) {\n    const { dir } =\n      findAncestorNode(\n        nodeStore,\n        node,\n        node => node.internal.type === `File`\n      ) || {}\n    return dir\n  }\n  return null\n}\n\nconst withBaseDir = dir => p => path.posix.join(dir, slash(p))\n\nconst findAncestorNode = (nodeStore, childNode, predicate) => {\n  let node = childNode\n  do {\n    if (predicate(node)) {\n      return node\n    }\n  } while ((node = node.parent && nodeStore.getNode(node.parent)))\n  return null\n}\n"],"file":"is-file.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/schema/infer/is-file.js"],"names":["path","require","slash","mime","isRelative","isRelativeUrl","getValueAt","isFile","nodeStore","field","relativePath","filePath","getFilePath","filePathExists","getNodesByType","some","node","absolutePath","module","exports","getFirstValueAt","selector","value","Array","isArray","typeName","split","looksLikeFile","isAbsolute","getType","normalizedPath","find","getAbsolutePath","dir","getBaseDir","withDir","withBaseDir","map","findAncestorNode","internal","type","p","posix","join","childNode","predicate","parent","getNode"],"mappings":"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","sourcesContent":["const path = require(`path`)\nconst slash = require(`slash`)\nconst mime = require(`mime`)\nconst isRelative = require(`is-relative`)\nconst isRelativeUrl = require(`is-relative-url`)\nconst { getValueAt } = require(`../utils/get-value-at`)\n\nconst isFile = (nodeStore, field, relativePath) => {\n  const filePath = getFilePath(nodeStore, field, relativePath)\n  if (!filePath) return false\n  const filePathExists = nodeStore\n    .getNodesByType(`File`)\n    .some(node => node.absolutePath === filePath)\n  return filePathExists\n}\n\nmodule.exports = {\n  isFile,\n}\n\nconst getFirstValueAt = (node, selector) => {\n  let value = getValueAt(node, selector)\n  while (Array.isArray(value)) {\n    value = value[0]\n  }\n  return value\n}\n\nconst getFilePath = (nodeStore, field, relativePath) => {\n  const [typeName, ...selector] = field.split(`.`)\n\n  if (typeName === `File`) return null\n\n  const looksLikeFile =\n    !path.isAbsolute(relativePath) &&\n    mime.getType(relativePath) !== null &&\n    // FIXME: Do we need all of this?\n    mime.getType(relativePath) !== `application/x-msdownload` &&\n    isRelative(relativePath) &&\n    isRelativeUrl(relativePath)\n\n  if (!looksLikeFile) return null\n\n  const normalizedPath = slash(relativePath)\n  const node = nodeStore\n    .getNodesByType(typeName)\n    .find(node => getFirstValueAt(node, selector) === normalizedPath)\n\n  return node ? getAbsolutePath(nodeStore, node, normalizedPath) : null\n}\n\nconst getAbsolutePath = (nodeStore, node, relativePath) => {\n  const dir = getBaseDir(nodeStore, node)\n  const withDir = withBaseDir(dir)\n  return dir\n    ? Array.isArray(relativePath)\n      ? relativePath.map(withDir)\n      : withDir(relativePath)\n    : null\n}\n\nconst getBaseDir = (nodeStore, node) => {\n  if (node) {\n    const { dir } =\n      findAncestorNode(\n        nodeStore,\n        node,\n        node => node.internal.type === `File`\n      ) || {}\n    return dir\n  }\n  return null\n}\n\nconst withBaseDir = dir => p => path.posix.join(dir, slash(p))\n\nconst findAncestorNode = (nodeStore, childNode, predicate) => {\n  let node = childNode\n  do {\n    if (predicate(node)) {\n      return node\n    }\n  } while ((node = node.parent && nodeStore.getNode(node.parent)))\n  return null\n}\n"],"file":"is-file.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/schema/infer/type-conflict-reporter.js b/node_modules/gatsby/dist/schema/infer/type-conflict-reporter.js
index 8bbe481..c684957 100644
--- a/node_modules/gatsby/dist/schema/infer/type-conflict-reporter.js
+++ b/node_modules/gatsby/dist/schema/infer/type-conflict-reporter.js
@@ -12,8 +12,9 @@ const typeOf = require(`type-of`);
 
 const util = require(`util`);
 
-const _require = require(`../../db/node-tracking`),
-      findRootNodeAncestor = _require.findRootNodeAncestor;
+const {
+  findRootNodeAncestor
+} = require(`../../db/node-tracking`);
 
 const isNodeWithDescription = node => node && node.internal && node.internal.description;
 
diff --git a/node_modules/gatsby/dist/schema/infer/type-conflict-reporter.js.map b/node_modules/gatsby/dist/schema/infer/type-conflict-reporter.js.map
index c055a05..4b37afc 100644
--- a/node_modules/gatsby/dist/schema/infer/type-conflict-reporter.js.map
+++ b/node_modules/gatsby/dist/schema/infer/type-conflict-reporter.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/schema/infer/type-conflict-reporter.js"],"names":["_","require","report","typeOf","util","findRootNodeAncestor","isNodeWithDescription","node","internal","description","findNodeDescription","obj","formatValue","value","isArray","inspect","colors","depth","breakLength","Infinity","wasElipsisLast","usedTypes","output","forEach","item","type","indexOf","push","join","TypeConflictEntry","constructor","selector","types","Map","addExample","parent","set","printEntry","sortedByTypeName","sortBy","Array","from","entries","typeName","log","map","TypeConflictReporter","clearConflicts","clear","getEntryFromSelector","dataEntry","get","addConflict","examples","substring","entry","filter","example","printConflicts","size","warn","getConflicts","values","module","exports"],"mappings":"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","sourcesContent":["// @flow\nconst _ = require(`lodash`)\nconst report = require(`gatsby-cli/lib/reporter`)\nconst typeOf = require(`type-of`)\nconst util = require(`util`)\nconst { findRootNodeAncestor } = require(`../../db/node-tracking`)\n\nexport type TypeConflictExample = {\n  value: mixed,\n  parent: {},\n  type: string,\n  arrayTypes: string[],\n}\n\ntype TypeConflict = {\n  value: mixed,\n  description: string,\n}\n\nconst isNodeWithDescription = node =>\n  node && node.internal && node.internal.description\n\nconst findNodeDescription = obj => {\n  if (obj) {\n    const node = findRootNodeAncestor(obj, isNodeWithDescription)\n    if (isNodeWithDescription(node)) {\n      return node.internal.description\n    }\n  }\n  return ``\n}\n\nconst formatValue = value => {\n  if (!_.isArray(value)) {\n    return util.inspect(value, {\n      colors: true,\n      depth: 0,\n      breakLength: Infinity,\n    })\n  }\n\n  let wasElipsisLast = false\n  const usedTypes = []\n  const output = []\n\n  value.forEach(item => {\n    const type = typeOf(item)\n    if (usedTypes.indexOf(type) !== -1) {\n      if (!wasElipsisLast) {\n        output.push(`...`)\n        wasElipsisLast = true\n      }\n    } else {\n      output.push(formatValue(item))\n      wasElipsisLast = false\n      usedTypes.push(type)\n    }\n  })\n\n  return `[ ${output.join(`, `)} ]`\n}\n\nclass TypeConflictEntry {\n  selector: string\n  types: Map<string, TypeConflict>\n\n  constructor(selector: string) {\n    this.selector = selector\n    this.types = new Map()\n  }\n\n  addExample({ value, type, parent }: TypeConflictExample) {\n    this.types.set(type, {\n      value,\n      description: findNodeDescription(parent),\n    })\n  }\n\n  printEntry() {\n    const sortedByTypeName = _.sortBy(\n      Array.from(this.types.entries()),\n      ([typeName, value]) => typeName\n    )\n\n    report.log(\n      `${this.selector}:${sortedByTypeName\n        .map(\n          ([typeName, { value, description }]) =>\n            `\\n - type: ${typeName}\\n   value: ${formatValue(\n              value\n            )}${description && `\\n   source: ${description}`}`\n        )\n        .join(``)}`\n    )\n  }\n}\n\nclass TypeConflictReporter {\n  entries: Map<string, TypeConflictEntry>\n\n  constructor() {\n    this.entries = new Map()\n  }\n\n  clearConflicts() {\n    this.entries.clear()\n  }\n\n  getEntryFromSelector(selector: string): TypeConflictEntry {\n    let dataEntry = this.entries.get(selector)\n\n    if (!dataEntry) {\n      dataEntry = new TypeConflictEntry(selector)\n      this.entries.set(selector, dataEntry)\n    }\n\n    return dataEntry\n  }\n\n  addConflict(selector: string, examples: TypeConflictExample[]) {\n    if (selector.substring(0, 11) === `SitePlugin.`) {\n      // Don't store and print out type conflicts in plugins.\n      // This is out of user control so he/she can't do anything\n      // to hide those.\n      return\n    }\n\n    const entry = this.getEntryFromSelector(selector)\n    examples\n      .filter(example => example.value != null)\n      .forEach(example => entry.addExample(example))\n  }\n\n  printConflicts() {\n    if (this.entries.size > 0) {\n      report.warn(\n        `There are conflicting field types in your data. GraphQL schema will omit those fields.`\n      )\n      this.entries.forEach(entry => entry.printEntry())\n    }\n  }\n\n  getConflicts() {\n    return Array.from(this.entries.values())\n  }\n}\n\nmodule.exports = { TypeConflictReporter, TypeConflictEntry }\n"],"file":"type-conflict-reporter.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/schema/infer/type-conflict-reporter.js"],"names":["_","require","report","typeOf","util","findRootNodeAncestor","isNodeWithDescription","node","internal","description","findNodeDescription","obj","formatValue","value","isArray","inspect","colors","depth","breakLength","Infinity","wasElipsisLast","usedTypes","output","forEach","item","type","indexOf","push","join","TypeConflictEntry","constructor","selector","types","Map","addExample","parent","set","printEntry","sortedByTypeName","sortBy","Array","from","entries","typeName","log","map","TypeConflictReporter","clearConflicts","clear","getEntryFromSelector","dataEntry","get","addConflict","examples","substring","entry","filter","example","printConflicts","size","warn","getConflicts","values","module","exports"],"mappings":";;;;;;AACA,MAAMA,CAAC,GAAGC,OAAO,CAAE,QAAF,CAAjB;;AACA,MAAMC,MAAM,GAAGD,OAAO,CAAE,yBAAF,CAAtB;;AACA,MAAME,MAAM,GAAGF,OAAO,CAAE,SAAF,CAAtB;;AACA,MAAMG,IAAI,GAAGH,OAAO,CAAE,MAAF,CAApB;;AACA,MAAM;AAAEI,EAAAA;AAAF,IAA2BJ,OAAO,CAAE,wBAAF,CAAxC;;AAcA,MAAMK,qBAAqB,GAAGC,IAAI,IAChCA,IAAI,IAAIA,IAAI,CAACC,QAAb,IAAyBD,IAAI,CAACC,QAAL,CAAcC,WADzC;;AAGA,MAAMC,mBAAmB,GAAGC,GAAG,IAAI;AACjC,MAAIA,GAAJ,EAAS;AACP,UAAMJ,IAAI,GAAGF,oBAAoB,CAACM,GAAD,EAAML,qBAAN,CAAjC;;AACA,QAAIA,qBAAqB,CAACC,IAAD,CAAzB,EAAiC;AAC/B,aAAOA,IAAI,CAACC,QAAL,CAAcC,WAArB;AACD;AACF;;AACD,SAAQ,EAAR;AACD,CARD;;AAUA,MAAMG,WAAW,GAAGC,KAAK,IAAI;AAC3B,MAAI,CAACb,CAAC,CAACc,OAAF,CAAUD,KAAV,CAAL,EAAuB;AACrB,WAAOT,IAAI,CAACW,OAAL,CAAaF,KAAb,EAAoB;AACzBG,MAAAA,MAAM,EAAE,IADiB;AAEzBC,MAAAA,KAAK,EAAE,CAFkB;AAGzBC,MAAAA,WAAW,EAAEC;AAHY,KAApB,CAAP;AAKD;;AAED,MAAIC,cAAc,GAAG,KAArB;AACA,QAAMC,SAAS,GAAG,EAAlB;AACA,QAAMC,MAAM,GAAG,EAAf;AAEAT,EAAAA,KAAK,CAACU,OAAN,CAAcC,IAAI,IAAI;AACpB,UAAMC,IAAI,GAAGtB,MAAM,CAACqB,IAAD,CAAnB;;AACA,QAAIH,SAAS,CAACK,OAAV,CAAkBD,IAAlB,MAA4B,CAAC,CAAjC,EAAoC;AAClC,UAAI,CAACL,cAAL,EAAqB;AACnBE,QAAAA,MAAM,CAACK,IAAP,CAAa,KAAb;AACAP,QAAAA,cAAc,GAAG,IAAjB;AACD;AACF,KALD,MAKO;AACLE,MAAAA,MAAM,CAACK,IAAP,CAAYf,WAAW,CAACY,IAAD,CAAvB;AACAJ,MAAAA,cAAc,GAAG,KAAjB;AACAC,MAAAA,SAAS,CAACM,IAAV,CAAeF,IAAf;AACD;AACF,GAZD;AAcA,SAAQ,KAAIH,MAAM,CAACM,IAAP,CAAa,IAAb,CAAkB,IAA9B;AACD,CA5BD;;AA8BA,MAAMC,iBAAN,CAAwB;AAItBC,EAAAA,WAAW,CAACC,QAAD,EAAmB;AAAA;AAAA;AAC5B,SAAKA,QAAL,GAAgBA,QAAhB;AACA,SAAKC,KAAL,GAAa,IAAIC,GAAJ,EAAb;AACD;;AAEDC,EAAAA,UAAU,CAAC;AAAErB,IAAAA,KAAF;AAASY,IAAAA,IAAT;AAAeU,IAAAA;AAAf,GAAD,EAA+C;AACvD,SAAKH,KAAL,CAAWI,GAAX,CAAeX,IAAf,EAAqB;AACnBZ,MAAAA,KADmB;AAEnBJ,MAAAA,WAAW,EAAEC,mBAAmB,CAACyB,MAAD;AAFb,KAArB;AAID;;AAEDE,EAAAA,UAAU,GAAG;AACX,UAAMC,gBAAgB,GAAGtC,CAAC,CAACuC,MAAF,CACvBC,KAAK,CAACC,IAAN,CAAW,KAAKT,KAAL,CAAWU,OAAX,EAAX,CADuB,EAEvB,CAAC,CAACC,QAAD,EAAW9B,KAAX,CAAD,KAAuB8B,QAFA,CAAzB;;AAKAzC,IAAAA,MAAM,CAAC0C,GAAP,CACG,GAAE,KAAKb,QAAS,IAAGO,gBAAgB,CACjCO,GADiB,CAEhB,CAAC,CAACF,QAAD,EAAW;AAAE9B,MAAAA,KAAF;AAASJ,MAAAA;AAAT,KAAX,CAAD,KACG,cAAakC,QAAS,eAAc/B,WAAW,CAC9CC,KAD8C,CAE9C,GAAEJ,WAAW,IAAK,gBAAeA,WAAY,EAAE,EALnC,EAOjBmB,IAPiB,CAOX,EAPW,CAOR,EARd;AAUD;;AAhCqB;;AAmCxB,MAAMkB,oBAAN,CAA2B;AAGzBhB,EAAAA,WAAW,GAAG;AAAA;AACZ,SAAKY,OAAL,GAAe,IAAIT,GAAJ,EAAf;AACD;;AAEDc,EAAAA,cAAc,GAAG;AACf,SAAKL,OAAL,CAAaM,KAAb;AACD;;AAEDC,EAAAA,oBAAoB,CAAClB,QAAD,EAAsC;AACxD,QAAImB,SAAS,GAAG,KAAKR,OAAL,CAAaS,GAAb,CAAiBpB,QAAjB,CAAhB;;AAEA,QAAI,CAACmB,SAAL,EAAgB;AACdA,MAAAA,SAAS,GAAG,IAAIrB,iBAAJ,CAAsBE,QAAtB,CAAZ;AACA,WAAKW,OAAL,CAAaN,GAAb,CAAiBL,QAAjB,EAA2BmB,SAA3B;AACD;;AAED,WAAOA,SAAP;AACD;;AAEDE,EAAAA,WAAW,CAACrB,QAAD,EAAmBsB,QAAnB,EAAoD;AAC7D,QAAItB,QAAQ,CAACuB,SAAT,CAAmB,CAAnB,EAAsB,EAAtB,MAA+B,aAAnC,EAAiD;AAC/C;AACA;AACA;AACA;AACD;;AAED,UAAMC,KAAK,GAAG,KAAKN,oBAAL,CAA0BlB,QAA1B,CAAd;AACAsB,IAAAA,QAAQ,CACLG,MADH,CACUC,OAAO,IAAIA,OAAO,CAAC5C,KAAR,IAAiB,IADtC,EAEGU,OAFH,CAEWkC,OAAO,IAAIF,KAAK,CAACrB,UAAN,CAAiBuB,OAAjB,CAFtB;AAGD;;AAEDC,EAAAA,cAAc,GAAG;AACf,QAAI,KAAKhB,OAAL,CAAaiB,IAAb,GAAoB,CAAxB,EAA2B;AACzBzD,MAAAA,MAAM,CAAC0D,IAAP,CACG,wFADH;AAGA,WAAKlB,OAAL,CAAanB,OAAb,CAAqBgC,KAAK,IAAIA,KAAK,CAAClB,UAAN,EAA9B;AACD;AACF;;AAEDwB,EAAAA,YAAY,GAAG;AACb,WAAOrB,KAAK,CAACC,IAAN,CAAW,KAAKC,OAAL,CAAaoB,MAAb,EAAX,CAAP;AACD;;AA/CwB;;AAkD3BC,MAAM,CAACC,OAAP,GAAiB;AAAElB,EAAAA,oBAAF;AAAwBjB,EAAAA;AAAxB,CAAjB","sourcesContent":["// @flow\nconst _ = require(`lodash`)\nconst report = require(`gatsby-cli/lib/reporter`)\nconst typeOf = require(`type-of`)\nconst util = require(`util`)\nconst { findRootNodeAncestor } = require(`../../db/node-tracking`)\n\nexport type TypeConflictExample = {\n  value: mixed,\n  parent: {},\n  type: string,\n  arrayTypes: string[],\n}\n\ntype TypeConflict = {\n  value: mixed,\n  description: string,\n}\n\nconst isNodeWithDescription = node =>\n  node && node.internal && node.internal.description\n\nconst findNodeDescription = obj => {\n  if (obj) {\n    const node = findRootNodeAncestor(obj, isNodeWithDescription)\n    if (isNodeWithDescription(node)) {\n      return node.internal.description\n    }\n  }\n  return ``\n}\n\nconst formatValue = value => {\n  if (!_.isArray(value)) {\n    return util.inspect(value, {\n      colors: true,\n      depth: 0,\n      breakLength: Infinity,\n    })\n  }\n\n  let wasElipsisLast = false\n  const usedTypes = []\n  const output = []\n\n  value.forEach(item => {\n    const type = typeOf(item)\n    if (usedTypes.indexOf(type) !== -1) {\n      if (!wasElipsisLast) {\n        output.push(`...`)\n        wasElipsisLast = true\n      }\n    } else {\n      output.push(formatValue(item))\n      wasElipsisLast = false\n      usedTypes.push(type)\n    }\n  })\n\n  return `[ ${output.join(`, `)} ]`\n}\n\nclass TypeConflictEntry {\n  selector: string\n  types: Map<string, TypeConflict>\n\n  constructor(selector: string) {\n    this.selector = selector\n    this.types = new Map()\n  }\n\n  addExample({ value, type, parent }: TypeConflictExample) {\n    this.types.set(type, {\n      value,\n      description: findNodeDescription(parent),\n    })\n  }\n\n  printEntry() {\n    const sortedByTypeName = _.sortBy(\n      Array.from(this.types.entries()),\n      ([typeName, value]) => typeName\n    )\n\n    report.log(\n      `${this.selector}:${sortedByTypeName\n        .map(\n          ([typeName, { value, description }]) =>\n            `\\n - type: ${typeName}\\n   value: ${formatValue(\n              value\n            )}${description && `\\n   source: ${description}`}`\n        )\n        .join(``)}`\n    )\n  }\n}\n\nclass TypeConflictReporter {\n  entries: Map<string, TypeConflictEntry>\n\n  constructor() {\n    this.entries = new Map()\n  }\n\n  clearConflicts() {\n    this.entries.clear()\n  }\n\n  getEntryFromSelector(selector: string): TypeConflictEntry {\n    let dataEntry = this.entries.get(selector)\n\n    if (!dataEntry) {\n      dataEntry = new TypeConflictEntry(selector)\n      this.entries.set(selector, dataEntry)\n    }\n\n    return dataEntry\n  }\n\n  addConflict(selector: string, examples: TypeConflictExample[]) {\n    if (selector.substring(0, 11) === `SitePlugin.`) {\n      // Don't store and print out type conflicts in plugins.\n      // This is out of user control so he/she can't do anything\n      // to hide those.\n      return\n    }\n\n    const entry = this.getEntryFromSelector(selector)\n    examples\n      .filter(example => example.value != null)\n      .forEach(example => entry.addExample(example))\n  }\n\n  printConflicts() {\n    if (this.entries.size > 0) {\n      report.warn(\n        `There are conflicting field types in your data. GraphQL schema will omit those fields.`\n      )\n      this.entries.forEach(entry => entry.printEntry())\n    }\n  }\n\n  getConflicts() {\n    return Array.from(this.entries.values())\n  }\n}\n\nmodule.exports = { TypeConflictReporter, TypeConflictEntry }\n"],"file":"type-conflict-reporter.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/schema/node-model.js b/node_modules/gatsby/dist/schema/node-model.js
index 0de432e..7ba10c0 100644
--- a/node_modules/gatsby/dist/schema/node-model.js
+++ b/node_modules/gatsby/dist/schema/node-model.js
@@ -1,15 +1,12 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const _ = require(`lodash`);
 
-const _require = require(`graphql`),
-      isAbstractType = _require.isAbstractType,
-      GraphQLOutputType = _require.GraphQLOutputType,
-      GraphQLUnionType = _require.GraphQLUnionType;
+const {
+  isAbstractType,
+  GraphQLOutputType,
+  GraphQLUnionType
+} = require(`graphql`);
 
 const invariant = require(`invariant`);
 
@@ -37,10 +34,10 @@ class LocalNodeModel {
 
 
   getNodeById(args, pageDependencies) {
-    const _ref = args || {},
-          id = _ref.id,
-          type = _ref.type;
-
+    const {
+      id,
+      type
+    } = args || {};
     const node = getNodeById(this.nodeStore, id);
     let result;
 
@@ -53,9 +50,7 @@ class LocalNodeModel {
       result = nodeTypeNames.includes(node.internal.type) ? node : null;
     }
 
-    return trackPageDependencies(result, Object.assign({
-      path: this.path
-    }, pageDependencies), this.createPageDependency);
+    return this.trackPageDependencies(result, pageDependencies);
   }
   /**
    * Get nodes from the store by IDs and optional type.
@@ -69,10 +64,10 @@ class LocalNodeModel {
 
 
   getNodesByIds(args, pageDependencies) {
-    const _ref2 = args || {},
-          ids = _ref2.ids,
-          type = _ref2.type;
-
+    const {
+      ids,
+      type
+    } = args || {};
     const nodes = Array.isArray(ids) ? ids.map(id => getNodeById(this.nodeStore, id)).filter(Boolean) : [];
     let result;
 
@@ -83,12 +78,12 @@ class LocalNodeModel {
       result = nodes.filter(node => nodeTypeNames.includes(node.internal.type));
     }
 
-    return trackPageDependencies(result, Object.assign({
-      path: this.path
-    }, pageDependencies), this.createPageDependency);
+    return this.trackPageDependencies(result, pageDependencies);
   }
   /**
-   * Get all nodes in the store, or all nodes of a specified type.
+   * Get all nodes in the store, or all nodes of a specified type. Note that
+   * this doesn't add tracking to all the nodes, unless pageDependencies are
+   * passed.
    *
    * @param {Object} args
    * @param {(string|GraphQLOutputType)} [args.type] Optional type of the nodes
@@ -98,9 +93,9 @@ class LocalNodeModel {
 
 
   getAllNodes(args, pageDependencies) {
-    const _ref3 = args || {},
-          type = _ref3.type;
-
+    const {
+      type
+    } = args || {};
     let result;
 
     if (!type) {
@@ -111,9 +106,11 @@ class LocalNodeModel {
       result = nodes.filter(Boolean);
     }
 
-    return trackPageDependencies(result, Object.assign({
-      path: this.path
-    }, pageDependencies), this.createPageDependency);
+    if (pageDependencies) {
+      return this.trackPageDependencies(result, pageDependencies);
+    } else {
+      return result;
+    }
   }
   /**
    * Get nodes of a type matching the specified query.
@@ -127,48 +124,42 @@ class LocalNodeModel {
    */
 
 
-  runQuery(args, pageDependencies) {
-    var _this = this;
-
-    return (0, _asyncToGenerator2.default)(function* () {
-      const _ref4 = args || {},
-            query = _ref4.query,
-            firstOnly = _ref4.firstOnly,
-            type = _ref4.type; // We don't support querying union types (yet?), because the combined types
-      // need not have any fields in common.
+  async runQuery(args, pageDependencies) {
+    const {
+      query,
+      firstOnly,
+      type
+    } = args || {}; // We don't support querying union types (yet?), because the combined types
+    // need not have any fields in common.
 
+    const gqlType = typeof type === `string` ? this.schema.getType(type) : type;
+    invariant(!(gqlType instanceof GraphQLUnionType), `Querying GraphQLUnion types is not supported.`); // We provide nodes in case of abstract types, because `run-sift` should
+    // only need to know about node types in the store.
 
-      const gqlType = typeof type === `string` ? _this.schema.getType(type) : type;
-      invariant(!(gqlType instanceof GraphQLUnionType), `Querying GraphQLUnion types is not supported.`); // We provide nodes in case of abstract types, because `run-sift` should
-      // only need to know about node types in the store.
+    let nodes;
+    const nodeTypeNames = toNodeTypeNames(this.schema, gqlType);
 
-      let nodes;
-      const nodeTypeNames = toNodeTypeNames(_this.schema, gqlType);
-
-      if (nodeTypeNames.length > 1) {
-        nodes = nodeTypeNames.reduce((acc, typeName) => acc.concat(_this.nodeStore.getNodesByType(typeName)), []);
-      }
+    if (nodeTypeNames.length > 1) {
+      nodes = nodeTypeNames.reduce((acc, typeName) => acc.concat(this.nodeStore.getNodesByType(typeName)), []);
+    }
 
-      const queryResult = yield _this.nodeStore.runQuery({
-        queryArgs: query,
-        firstOnly,
-        gqlType,
-        nodes
-      });
-      let result = queryResult;
-
-      if (args.firstOnly) {
-        if (result && result.length > 0) {
-          result = result[0];
-        } else {
-          result = null;
-        }
+    const queryResult = await this.nodeStore.runQuery({
+      queryArgs: query,
+      firstOnly,
+      gqlType,
+      nodes
+    });
+    let result = queryResult;
+
+    if (args.firstOnly) {
+      if (result && result.length > 0) {
+        result = result[0];
+      } else {
+        result = null;
       }
+    }
 
-      return trackPageDependencies(result, Object.assign({
-        path: _this.path
-      }, pageDependencies), _this.createPageDependency);
-    })();
+    return this.trackPageDependencies(result, pageDependencies);
   }
   /**
    * Get the names of all node types in the store.
@@ -193,6 +184,44 @@ class LocalNodeModel {
   findRootNodeAncestor(obj, predicate) {
     return this.nodeStore.findRootNodeAncestor(obj, predicate);
   }
+  /**
+   * Given a result, that's either a single node or an array of them, track them
+   * using pageDependencies. Defaults to tracking according to current resolver
+   * path. Returns the result back.
+   *
+   * @param {Node | Node[]} result
+   * @param {PageDependencies} [pageDependencies]
+   * @returns {Node | Node[]}
+   */
+
+
+  trackPageDependencies(result, pageDependencies) {
+    const fullDependencies = {
+      path: this.path,
+      ...(pageDependencies || {})
+    };
+    const {
+      path,
+      connectionType
+    } = fullDependencies;
+
+    if (path) {
+      if (connectionType) {
+        this.createPageDependency({
+          path,
+          connection: connectionType
+        });
+      } else {
+        const nodes = Array.isArray(result) ? result : [result];
+        nodes.filter(Boolean).map(node => this.createPageDependency({
+          path,
+          nodeId: node.id
+        }));
+      }
+    }
+
+    return result;
+  }
 
 }
 
@@ -214,28 +243,6 @@ const toNodeTypeNames = (schema, gqlTypeName) => {
   return possibleTypes.filter(type => type.getInterfaces().some(iface => iface.name === `Node`)).map(type => type.name);
 };
 
-const trackPageDependencies = (result, pageDependencies, createPageDependency) => {
-  const path = pageDependencies.path,
-        connectionType = pageDependencies.connectionType;
-
-  if (path) {
-    if (connectionType) {
-      createPageDependency({
-        path,
-        connection: connectionType
-      });
-    } else {
-      const nodes = Array.isArray(result) ? result : [result];
-      nodes.filter(Boolean).map(node => createPageDependency({
-        path,
-        nodeId: node.id
-      }));
-    }
-  }
-
-  return result;
-};
-
 module.exports = {
   LocalNodeModel
 };
diff --git a/node_modules/gatsby/dist/schema/node-model.js.map b/node_modules/gatsby/dist/schema/node-model.js.map
index bfdd18d..9265b72 100644
--- a/node_modules/gatsby/dist/schema/node-model.js.map
+++ b/node_modules/gatsby/dist/schema/node-model.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/schema/node-model.js"],"names":["_","require","isAbstractType","GraphQLOutputType","GraphQLUnionType","invariant","LocalNodeModel","constructor","schema","nodeStore","createPageDependency","path","getNodeById","args","pageDependencies","id","type","node","result","nodeTypeNames","toNodeTypeNames","includes","internal","trackPageDependencies","getNodesByIds","ids","nodes","Array","isArray","map","filter","Boolean","length","getAllNodes","getNodes","reduce","acc","typeName","concat","getNodesByType","runQuery","query","firstOnly","gqlType","getType","queryResult","queryArgs","getTypes","findRootNodeAncestor","obj","predicate","isPlainObject","getNode","gqlTypeName","possibleTypes","getPossibleTypes","getInterfaces","some","iface","name","connectionType","connection","nodeId","module","exports"],"mappings":"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","sourcesContent":["// @flow\n\nconst _ = require(`lodash`)\nconst {\n  isAbstractType,\n  GraphQLOutputType,\n  GraphQLUnionType,\n} = require(`graphql`)\nconst invariant = require(`invariant`)\n\ntype IDOrNode = string | { id: string }\ntype TypeOrTypeName = string | GraphQLOutputType\n\n/**\n * Optional page dependency information.\n *\n * @typedef {Object} PageDependencies\n * @property {string} path The path of the page that depends on the retrieved nodes' data\n * @property {string} [connectionType] Mark this dependency as a connection\n */\ninterface PageDependencies {\n  path: string;\n  connectionType?: string;\n}\n\ninterface QueryArguments {\n  type: TypeOrTypeName;\n  query: { filter: Object, sort?: Object, skip?: number, limit?: number };\n  firstOnly?: boolean;\n}\n\nexport interface NodeModel {\n  getNodeById(\n    { id: IDOrNode, type?: TypeOrTypeName },\n    pageDependencies?: PageDependencies\n  ): any | null;\n  getNodesByIds(\n    { ids: Array<IDOrNode>, type?: TypeOrTypeName },\n    pageDependencies?: PageDependencies\n  ): Array<any>;\n  getAllNodes(\n    { type?: TypeOrTypeName },\n    pageDependencies?: PageDependencies\n  ): Array<any>;\n  runQuery(\n    args: QueryArguments,\n    pageDependencies?: PageDependencies\n  ): Promise<any>;\n  getTypes(): Array<string>;\n}\n\nclass LocalNodeModel {\n  constructor({ schema, nodeStore, createPageDependency, path }) {\n    this.schema = schema\n    this.nodeStore = nodeStore\n    this.createPageDependency = createPageDependency\n    this.path = path\n  }\n\n  /**\n   * Get a node from the store by ID and optional type.\n   *\n   * @param {Object} args\n   * @param {string} args.id ID of the requested node\n   * @param {(string|GraphQLOutputType)} [args.type] Optional type of the node\n   * @param {PageDependencies} [pageDependencies]\n   * @returns {(Node|null)}\n   */\n  getNodeById(args, pageDependencies) {\n    const { id, type } = args || {}\n\n    const node = getNodeById(this.nodeStore, id)\n\n    let result\n    if (!node) {\n      result = null\n    } else if (!type) {\n      result = node\n    } else {\n      const nodeTypeNames = toNodeTypeNames(this.schema, type)\n      result = nodeTypeNames.includes(node.internal.type) ? node : null\n    }\n\n    return trackPageDependencies(\n      result,\n      { path: this.path, ...pageDependencies },\n      this.createPageDependency\n    )\n  }\n\n  /**\n   * Get nodes from the store by IDs and optional type.\n   *\n   * @param {Object} args\n   * @param {string[]} args.ids IDs of the requested nodes\n   * @param {(string|GraphQLOutputType)} [args.type] Optional type of the nodes\n   * @param {PageDependencies} [pageDependencies]\n   * @returns {Node[]}\n   */\n  getNodesByIds(args, pageDependencies) {\n    const { ids, type } = args || {}\n\n    const nodes = Array.isArray(ids)\n      ? ids.map(id => getNodeById(this.nodeStore, id)).filter(Boolean)\n      : []\n\n    let result\n    if (!nodes.length || !type) {\n      result = nodes\n    } else {\n      const nodeTypeNames = toNodeTypeNames(this.schema, type)\n      result = nodes.filter(node => nodeTypeNames.includes(node.internal.type))\n    }\n\n    return trackPageDependencies(\n      result,\n      { path: this.path, ...pageDependencies },\n      this.createPageDependency\n    )\n  }\n\n  /**\n   * Get all nodes in the store, or all nodes of a specified type.\n   *\n   * @param {Object} args\n   * @param {(string|GraphQLOutputType)} [args.type] Optional type of the nodes\n   * @param {PageDependencies} [pageDependencies]\n   * @returns {Node[]}\n   */\n  getAllNodes(args, pageDependencies) {\n    const { type } = args || {}\n\n    let result\n    if (!type) {\n      result = this.nodeStore.getNodes()\n    } else {\n      const nodeTypeNames = toNodeTypeNames(this.schema, type)\n      const nodes = nodeTypeNames.reduce(\n        (acc, typeName) => acc.concat(this.nodeStore.getNodesByType(typeName)),\n        []\n      )\n      result = nodes.filter(Boolean)\n    }\n\n    return trackPageDependencies(\n      result,\n      { path: this.path, ...pageDependencies },\n      this.createPageDependency\n    )\n  }\n\n  /**\n   * Get nodes of a type matching the specified query.\n   *\n   * @param {Object} args\n   * @param {Object} args.query Query arguments (`filter`, `sort`, `limit`, `skip`)\n   * @param {(string|GraphQLOutputType)} args.type Type\n   * @param {boolean} [args.firstOnly] If true, return only first match\n   * @param {PageDependencies} [pageDependencies]\n   * @returns {Promise<Node[]>}\n   */\n  async runQuery(args, pageDependencies) {\n    const { query, firstOnly, type } = args || {}\n\n    // We don't support querying union types (yet?), because the combined types\n    // need not have any fields in common.\n    const gqlType = typeof type === `string` ? this.schema.getType(type) : type\n    invariant(\n      !(gqlType instanceof GraphQLUnionType),\n      `Querying GraphQLUnion types is not supported.`\n    )\n\n    // We provide nodes in case of abstract types, because `run-sift` should\n    // only need to know about node types in the store.\n    let nodes\n    const nodeTypeNames = toNodeTypeNames(this.schema, gqlType)\n    if (nodeTypeNames.length > 1) {\n      nodes = nodeTypeNames.reduce(\n        (acc, typeName) => acc.concat(this.nodeStore.getNodesByType(typeName)),\n        []\n      )\n    }\n\n    const queryResult = await this.nodeStore.runQuery({\n      queryArgs: query,\n      firstOnly,\n      gqlType,\n      nodes,\n    })\n\n    let result = queryResult\n    if (args.firstOnly) {\n      if (result && result.length > 0) {\n        result = result[0]\n      } else {\n        result = null\n      }\n    }\n\n    return trackPageDependencies(\n      result,\n      { path: this.path, ...pageDependencies },\n      this.createPageDependency\n    )\n  }\n\n  /**\n   * Get the names of all node types in the store.\n   *\n   * @returns {string[]}\n   */\n  getTypes() {\n    return this.nodeStore.getTypes()\n  }\n\n  /**\n   * Get the root ancestor node for an object's parent node, or its first\n   * ancestor matching a specified condition.\n   *\n   * @param {(Object|Array)} obj An object belonging to a Node, or a Node object\n   * @param {Function} [predicate] Optional condition to match\n   * @returns {(Node|null)}\n   */\n  findRootNodeAncestor(obj, predicate) {\n    return this.nodeStore.findRootNodeAncestor(obj, predicate)\n  }\n}\n\nconst getNodeById = (nodeStore, id) => {\n  // This is for cases when the `id` has already been resolved\n  // to a full Node for the input filter, and is also in the selection\n  // set. E.g. `{ foo(parent: { id: { eq: 1 } } ) { parent { id } } }`.\n  if (_.isPlainObject(id) && id.id) {\n    return id\n  }\n  return id != null ? nodeStore.getNode(id) : null\n}\n\nconst toNodeTypeNames = (schema, gqlTypeName) => {\n  const gqlType =\n    typeof gqlTypeName === `string` ? schema.getType(gqlTypeName) : gqlTypeName\n\n  if (!gqlType) return []\n\n  const possibleTypes = isAbstractType(gqlType)\n    ? schema.getPossibleTypes(gqlType)\n    : [gqlType]\n\n  return possibleTypes\n    .filter(type => type.getInterfaces().some(iface => iface.name === `Node`))\n    .map(type => type.name)\n}\n\nconst trackPageDependencies = (\n  result,\n  pageDependencies,\n  createPageDependency\n) => {\n  const { path, connectionType } = pageDependencies\n  if (path) {\n    if (connectionType) {\n      createPageDependency({ path, connection: connectionType })\n    } else {\n      const nodes = Array.isArray(result) ? result : [result]\n      nodes\n        .filter(Boolean)\n        .map(node => createPageDependency({ path, nodeId: node.id }))\n    }\n  }\n\n  return result\n}\n\nmodule.exports = {\n  LocalNodeModel,\n}\n"],"file":"node-model.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/schema/node-model.js"],"names":["_","require","isAbstractType","GraphQLOutputType","GraphQLUnionType","invariant","LocalNodeModel","constructor","schema","nodeStore","createPageDependency","path","getNodeById","args","pageDependencies","id","type","node","result","nodeTypeNames","toNodeTypeNames","includes","internal","trackPageDependencies","getNodesByIds","ids","nodes","Array","isArray","map","filter","Boolean","length","getAllNodes","getNodes","reduce","acc","typeName","concat","getNodesByType","runQuery","query","firstOnly","gqlType","getType","queryResult","queryArgs","getTypes","findRootNodeAncestor","obj","predicate","fullDependencies","connectionType","connection","nodeId","isPlainObject","getNode","gqlTypeName","possibleTypes","getPossibleTypes","getInterfaces","some","iface","name","module","exports"],"mappings":"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","sourcesContent":["// @flow\n\nconst _ = require(`lodash`)\nconst {\n  isAbstractType,\n  GraphQLOutputType,\n  GraphQLUnionType,\n} = require(`graphql`)\nconst invariant = require(`invariant`)\n\ntype IDOrNode = string | { id: string }\ntype TypeOrTypeName = string | GraphQLOutputType\n\n/**\n * Optional page dependency information.\n *\n * @typedef {Object} PageDependencies\n * @property {string} path The path of the page that depends on the retrieved nodes' data\n * @property {string} [connectionType] Mark this dependency as a connection\n */\ninterface PageDependencies {\n  path: string;\n  connectionType?: string;\n}\n\ninterface QueryArguments {\n  type: TypeOrTypeName;\n  query: { filter: Object, sort?: Object, skip?: number, limit?: number };\n  firstOnly?: boolean;\n}\n\nexport interface NodeModel {\n  getNodeById(\n    { id: IDOrNode, type?: TypeOrTypeName },\n    pageDependencies?: PageDependencies\n  ): any | null;\n  getNodesByIds(\n    { ids: Array<IDOrNode>, type?: TypeOrTypeName },\n    pageDependencies?: PageDependencies\n  ): Array<any>;\n  getAllNodes(\n    { type?: TypeOrTypeName },\n    pageDependencies?: PageDependencies\n  ): Array<any>;\n  runQuery(\n    args: QueryArguments,\n    pageDependencies?: PageDependencies\n  ): Promise<any>;\n  getTypes(): Array<string>;\n  trackPageDependencies<nodeOrNodes: Node | Node[]>(\n    result: nodeOrNodes,\n    pageDependencies?: PageDependencies\n  ): nodesOrNodes;\n}\n\nclass LocalNodeModel {\n  constructor({ schema, nodeStore, createPageDependency, path }) {\n    this.schema = schema\n    this.nodeStore = nodeStore\n    this.createPageDependency = createPageDependency\n    this.path = path\n  }\n\n  /**\n   * Get a node from the store by ID and optional type.\n   *\n   * @param {Object} args\n   * @param {string} args.id ID of the requested node\n   * @param {(string|GraphQLOutputType)} [args.type] Optional type of the node\n   * @param {PageDependencies} [pageDependencies]\n   * @returns {(Node|null)}\n   */\n  getNodeById(args, pageDependencies) {\n    const { id, type } = args || {}\n\n    const node = getNodeById(this.nodeStore, id)\n\n    let result\n    if (!node) {\n      result = null\n    } else if (!type) {\n      result = node\n    } else {\n      const nodeTypeNames = toNodeTypeNames(this.schema, type)\n      result = nodeTypeNames.includes(node.internal.type) ? node : null\n    }\n\n    return this.trackPageDependencies(result, pageDependencies)\n  }\n\n  /**\n   * Get nodes from the store by IDs and optional type.\n   *\n   * @param {Object} args\n   * @param {string[]} args.ids IDs of the requested nodes\n   * @param {(string|GraphQLOutputType)} [args.type] Optional type of the nodes\n   * @param {PageDependencies} [pageDependencies]\n   * @returns {Node[]}\n   */\n  getNodesByIds(args, pageDependencies) {\n    const { ids, type } = args || {}\n\n    const nodes = Array.isArray(ids)\n      ? ids.map(id => getNodeById(this.nodeStore, id)).filter(Boolean)\n      : []\n\n    let result\n    if (!nodes.length || !type) {\n      result = nodes\n    } else {\n      const nodeTypeNames = toNodeTypeNames(this.schema, type)\n      result = nodes.filter(node => nodeTypeNames.includes(node.internal.type))\n    }\n\n    return this.trackPageDependencies(result, pageDependencies)\n  }\n\n  /**\n   * Get all nodes in the store, or all nodes of a specified type. Note that\n   * this doesn't add tracking to all the nodes, unless pageDependencies are\n   * passed.\n   *\n   * @param {Object} args\n   * @param {(string|GraphQLOutputType)} [args.type] Optional type of the nodes\n   * @param {PageDependencies} [pageDependencies]\n   * @returns {Node[]}\n   */\n  getAllNodes(args, pageDependencies) {\n    const { type } = args || {}\n\n    let result\n    if (!type) {\n      result = this.nodeStore.getNodes()\n    } else {\n      const nodeTypeNames = toNodeTypeNames(this.schema, type)\n      const nodes = nodeTypeNames.reduce(\n        (acc, typeName) => acc.concat(this.nodeStore.getNodesByType(typeName)),\n        []\n      )\n      result = nodes.filter(Boolean)\n    }\n\n    if (pageDependencies) {\n      return this.trackPageDependencies(result, pageDependencies)\n    } else {\n      return result\n    }\n  }\n\n  /**\n   * Get nodes of a type matching the specified query.\n   *\n   * @param {Object} args\n   * @param {Object} args.query Query arguments (`filter`, `sort`, `limit`, `skip`)\n   * @param {(string|GraphQLOutputType)} args.type Type\n   * @param {boolean} [args.firstOnly] If true, return only first match\n   * @param {PageDependencies} [pageDependencies]\n   * @returns {Promise<Node[]>}\n   */\n  async runQuery(args, pageDependencies) {\n    const { query, firstOnly, type } = args || {}\n\n    // We don't support querying union types (yet?), because the combined types\n    // need not have any fields in common.\n    const gqlType = typeof type === `string` ? this.schema.getType(type) : type\n    invariant(\n      !(gqlType instanceof GraphQLUnionType),\n      `Querying GraphQLUnion types is not supported.`\n    )\n\n    // We provide nodes in case of abstract types, because `run-sift` should\n    // only need to know about node types in the store.\n    let nodes\n    const nodeTypeNames = toNodeTypeNames(this.schema, gqlType)\n    if (nodeTypeNames.length > 1) {\n      nodes = nodeTypeNames.reduce(\n        (acc, typeName) => acc.concat(this.nodeStore.getNodesByType(typeName)),\n        []\n      )\n    }\n\n    const queryResult = await this.nodeStore.runQuery({\n      queryArgs: query,\n      firstOnly,\n      gqlType,\n      nodes,\n    })\n\n    let result = queryResult\n    if (args.firstOnly) {\n      if (result && result.length > 0) {\n        result = result[0]\n      } else {\n        result = null\n      }\n    }\n\n    return this.trackPageDependencies(result, pageDependencies)\n  }\n\n  /**\n   * Get the names of all node types in the store.\n   *\n   * @returns {string[]}\n   */\n  getTypes() {\n    return this.nodeStore.getTypes()\n  }\n\n  /**\n   * Get the root ancestor node for an object's parent node, or its first\n   * ancestor matching a specified condition.\n   *\n   * @param {(Object|Array)} obj An object belonging to a Node, or a Node object\n   * @param {Function} [predicate] Optional condition to match\n   * @returns {(Node|null)}\n   */\n  findRootNodeAncestor(obj, predicate) {\n    return this.nodeStore.findRootNodeAncestor(obj, predicate)\n  }\n\n  /**\n   * Given a result, that's either a single node or an array of them, track them\n   * using pageDependencies. Defaults to tracking according to current resolver\n   * path. Returns the result back.\n   *\n   * @param {Node | Node[]} result\n   * @param {PageDependencies} [pageDependencies]\n   * @returns {Node | Node[]}\n   */\n  trackPageDependencies(result, pageDependencies) {\n    const fullDependencies = {\n      path: this.path,\n      ...(pageDependencies || {}),\n    }\n    const { path, connectionType } = fullDependencies\n    if (path) {\n      if (connectionType) {\n        this.createPageDependency({ path, connection: connectionType })\n      } else {\n        const nodes = Array.isArray(result) ? result : [result]\n        nodes\n          .filter(Boolean)\n          .map(node => this.createPageDependency({ path, nodeId: node.id }))\n      }\n    }\n\n    return result\n  }\n}\n\nconst getNodeById = (nodeStore, id) => {\n  // This is for cases when the `id` has already been resolved\n  // to a full Node for the input filter, and is also in the selection\n  // set. E.g. `{ foo(parent: { id: { eq: 1 } } ) { parent { id } } }`.\n  if (_.isPlainObject(id) && id.id) {\n    return id\n  }\n  return id != null ? nodeStore.getNode(id) : null\n}\n\nconst toNodeTypeNames = (schema, gqlTypeName) => {\n  const gqlType =\n    typeof gqlTypeName === `string` ? schema.getType(gqlTypeName) : gqlTypeName\n\n  if (!gqlType) return []\n\n  const possibleTypes = isAbstractType(gqlType)\n    ? schema.getPossibleTypes(gqlType)\n    : [gqlType]\n\n  return possibleTypes\n    .filter(type => type.getInterfaces().some(iface => iface.name === `Node`))\n    .map(type => type.name)\n}\n\nmodule.exports = {\n  LocalNodeModel,\n}\n"],"file":"node-model.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/schema/resolvers.js b/node_modules/gatsby/dist/schema/resolvers.js
index db385ba..731bb31 100644
--- a/node_modules/gatsby/dist/schema/resolvers.js
+++ b/node_modules/gatsby/dist/schema/resolvers.js
@@ -1,22 +1,20 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const systemPath = require(`path`);
 
 const normalize = require(`normalize-path`);
 
 const _ = require(`lodash`);
 
-const _require = require(`graphql`),
-      GraphQLList = _require.GraphQLList,
-      getNullableType = _require.getNullableType,
-      getNamedType = _require.getNamedType;
+const {
+  GraphQLList,
+  getNullableType,
+  getNamedType
+} = require(`graphql`);
 
-const _require2 = require(`./utils/get-value-at`),
-      getValueAt = _require2.getValueAt;
+const {
+  getValueAt
+} = require(`./utils/get-value-at`);
 
 const findMany = typeName => ({
   args,
@@ -45,25 +43,21 @@ const findOne = typeName => ({
   path: context.path
 });
 
-const findManyPaginated = typeName =>
-/*#__PURE__*/
-function () {
-  var _ref = (0, _asyncToGenerator2.default)(function* (rp) {
-    const result = yield findMany(typeName)(rp);
-    return paginate(result, {
-      skip: rp.args.skip,
-      limit: rp.args.limit
-    });
+const findManyPaginated = typeName => async rp => {
+  const result = await findMany(typeName)(rp);
+  return paginate(result, {
+    skip: rp.args.skip,
+    limit: rp.args.limit
   });
-
-  return function (_x) {
-    return _ref.apply(this, arguments);
-  };
-}();
+};
 
 const distinct = (source, args, context, info) => {
-  const field = args.field;
-  const edges = source.edges;
+  const {
+    field
+  } = args;
+  const {
+    edges
+  } = source;
   const values = edges.reduce((acc, {
     node
   }) => {
@@ -74,8 +68,12 @@ const distinct = (source, args, context, info) => {
 };
 
 const group = (source, args, context, info) => {
-  const field = args.field;
-  const edges = source.edges;
+  const {
+    field
+  } = args;
+  const {
+    edges
+  } = source;
   const groupedResults = edges.reduce((acc, {
     node
   }) => {
@@ -88,10 +86,10 @@ const group = (source, args, context, info) => {
     return acc;
   }, {});
   return Object.keys(groupedResults).sort().reduce((acc, fieldValue) => {
-    acc.push(Object.assign({}, paginate(groupedResults[fieldValue], args), {
+    acc.push({ ...paginate(groupedResults[fieldValue], args),
       field,
       fieldValue
-    }));
+    });
     return acc;
   }, []);
 };
@@ -126,103 +124,89 @@ const paginate = (results = [], {
 const link = ({
   by,
   from
-}) =>
-/*#__PURE__*/
-function () {
-  var _ref2 = (0, _asyncToGenerator2.default)(function* (source, args, context, info) {
-    const fieldValue = source && source[from || info.fieldName];
-    if (fieldValue == null || _.isPlainObject(fieldValue)) return fieldValue;
-
-    if (Array.isArray(fieldValue) && (fieldValue[0] == null || _.isPlainObject(fieldValue[0]))) {
-      return fieldValue;
-    }
+}) => async (source, args, context, info) => {
+  const fieldValue = source && source[from || info.fieldName];
+  if (fieldValue == null || _.isPlainObject(fieldValue)) return fieldValue;
 
-    const returnType = getNullableType(info.returnType);
-    const type = getNamedType(returnType);
-
-    if (by === `id`) {
-      if (Array.isArray(fieldValue)) {
-        return context.nodeModel.getNodesByIds({
-          ids: fieldValue,
-          type: type
-        }, {
-          path: context.path
-        });
-      } else {
-        return context.nodeModel.getNodeById({
-          id: fieldValue,
-          type: type
-        }, {
-          path: context.path
-        });
-      }
+  if (Array.isArray(fieldValue) && (fieldValue[0] == null || _.isPlainObject(fieldValue[0]))) {
+    return fieldValue;
+  }
+
+  const returnType = getNullableType(info.returnType);
+  const type = getNamedType(returnType);
+
+  if (by === `id`) {
+    if (Array.isArray(fieldValue)) {
+      return context.nodeModel.getNodesByIds({
+        ids: fieldValue,
+        type: type
+      }, {
+        path: context.path
+      });
+    } else {
+      return context.nodeModel.getNodeById({
+        id: fieldValue,
+        type: type
+      }, {
+        path: context.path
+      });
     }
+  }
 
-    const equals = value => {
-      return {
-        eq: value
-      };
+  const equals = value => {
+    return {
+      eq: value
     };
+  };
 
-    const oneOf = value => {
-      return {
-        in: value
-      };
+  const oneOf = value => {
+    return {
+      in: value
     };
+  };
 
-    const operator = Array.isArray(fieldValue) ? oneOf : equals;
-    args.filter = by.split(`.`).reduceRight((acc, key, i, {
-      length
-    }) => {
-      return {
-        [key]: i === length - 1 ? operator(acc) : acc
-      };
-    }, fieldValue);
-    return context.nodeModel.runQuery({
-      query: args,
-      firstOnly: !(returnType instanceof GraphQLList),
-      type
-    }, {
-      path: context.path
-    });
+  const operator = Array.isArray(fieldValue) ? oneOf : equals;
+  args.filter = by.split(`.`).reduceRight((acc, key, i, {
+    length
+  }) => {
+    return {
+      [key]: i === length - 1 ? operator(acc) : acc
+    };
+  }, fieldValue);
+  return context.nodeModel.runQuery({
+    query: args,
+    firstOnly: !(returnType instanceof GraphQLList),
+    type
+  }, {
+    path: context.path
   });
-
-  return function (_x2, _x3, _x4, _x5) {
-    return _ref2.apply(this, arguments);
-  };
-}();
+};
 
 const fileByPath = (source, args, context, info) => {
-  let fieldValue = source[info.fieldName];
-  const isArray = getNullableType(info.returnType) instanceof GraphQLList;
+  const fieldValue = source && source[info.fieldName];
+  if (fieldValue == null || _.isPlainObject(fieldValue)) return fieldValue;
 
-  if (!fieldValue) {
-    return null;
+  if (Array.isArray(fieldValue) && (fieldValue[0] == null || _.isPlainObject(fieldValue[0]))) {
+    return fieldValue;
   }
 
-  const findLinkedFileNode =
-  /*#__PURE__*/
-  function () {
-    var _ref3 = (0, _asyncToGenerator2.default)(function* (relativePath) {
-      // Use the parent File node to create the absolute path to
-      // the linked file.
-      const fileLinkPath = normalize(systemPath.resolve(parentFileNode.dir, relativePath)); // Use that path to find the linked File node.
+  const isArray = getNullableType(info.returnType) instanceof GraphQLList;
 
-      const linkedFileNode = _.find((yield context.nodeModel.getAllNodes({
-        type: `File`
-      })), n => n.absolutePath === fileLinkPath);
+  const findLinkedFileNode = async relativePath => {
+    // Use the parent File node to create the absolute path to
+    // the linked file.
+    const fileLinkPath = normalize(systemPath.resolve(parentFileNode.dir, relativePath)); // Use that path to find the linked File node.
 
-      return linkedFileNode;
-    });
+    const linkedFileNode = _.find((await context.nodeModel.getAllNodes({
+      type: `File`
+    })), n => n.absolutePath === fileLinkPath);
 
-    return function findLinkedFileNode(_x6) {
-      return _ref3.apply(this, arguments);
-    };
-  }(); // Find the File node for this node (we assume the node is something
+    return linkedFileNode;
+  }; // Find the File node for this node (we assume the node is something
   // like markdown which would be a child node of a File node).
 
 
-  const parentFileNode = context.nodeModel.findRootNodeAncestor(source); // Find the linked File node(s)
+  const parentFileNode = context.nodeModel.findRootNodeAncestor(source, node => node.internal && node.internal.type === `File`); // Find the linked File node(s)
 
   if (isArray) {
     return Promise.all(fieldValue.map(findLinkedFileNode));
diff --git a/node_modules/gatsby/dist/schema/resolvers.js.map b/node_modules/gatsby/dist/schema/resolvers.js.map
index 3a27ff2..a1c62af 100644
--- a/node_modules/gatsby/dist/schema/resolvers.js.map
+++ b/node_modules/gatsby/dist/schema/resolvers.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/schema/resolvers.js"],"names":["systemPath","require","normalize","_","GraphQLList","getNullableType","getNamedType","getValueAt","findMany","typeName","args","context","info","nodeModel","runQuery","query","firstOnly","type","schema","getType","path","connectionType","findOne","filter","findManyPaginated","rp","result","paginate","skip","limit","distinct","source","field","edges","values","reduce","acc","node","value","concat","Date","toISOString","Array","from","Set","sort","group","groupedResults","isArray","forEach","key","Object","keys","fieldValue","push","results","count","length","items","slice","hasNextPage","totalCount","map","item","i","arr","next","previous","nodes","pageInfo","link","by","fieldName","isPlainObject","returnType","getNodesByIds","ids","getNodeById","id","equals","eq","oneOf","in","operator","split","reduceRight","fileByPath","findLinkedFileNode","relativePath","fileLinkPath","resolve","parentFileNode","dir","linkedFileNode","find","getAllNodes","n","absolutePath","findRootNodeAncestor","Promise","all","module","exports"],"mappings":"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","sourcesContent":["const systemPath = require(`path`)\nconst normalize = require(`normalize-path`)\nconst _ = require(`lodash`)\nconst { GraphQLList, getNullableType, getNamedType } = require(`graphql`)\nconst { getValueAt } = require(`./utils/get-value-at`)\n\nconst findMany = typeName => ({ args, context, info }) =>\n  context.nodeModel.runQuery(\n    {\n      query: args,\n      firstOnly: false,\n      type: info.schema.getType(typeName),\n    },\n    { path: context.path, connectionType: typeName }\n  )\n\nconst findOne = typeName => ({ args, context, info }) =>\n  context.nodeModel.runQuery(\n    {\n      query: { filter: args },\n      firstOnly: true,\n      type: info.schema.getType(typeName),\n    },\n    { path: context.path }\n  )\n\nconst findManyPaginated = typeName => async rp => {\n  const result = await findMany(typeName)(rp)\n  return paginate(result, { skip: rp.args.skip, limit: rp.args.limit })\n}\n\nconst distinct = (source, args, context, info) => {\n  const { field } = args\n  const { edges } = source\n  const values = edges.reduce((acc, { node }) => {\n    const value = getValueAt(node, field)\n    return value != null\n      ? acc.concat(value instanceof Date ? value.toISOString() : value)\n      : acc\n  }, [])\n  return Array.from(new Set(values)).sort()\n}\n\nconst group = (source, args, context, info) => {\n  const { field } = args\n  const { edges } = source\n  const groupedResults = edges.reduce((acc, { node }) => {\n    const value = getValueAt(node, field)\n    const values = Array.isArray(value) ? value : [value]\n    values\n      .filter(value => value != null)\n      .forEach(value => {\n        const key = value instanceof Date ? value.toISOString() : value\n        acc[key] = (acc[key] || []).concat(node)\n      })\n    return acc\n  }, {})\n  return Object.keys(groupedResults)\n    .sort()\n    .reduce((acc, fieldValue) => {\n      acc.push({\n        ...paginate(groupedResults[fieldValue], args),\n        field,\n        fieldValue,\n      })\n      return acc\n    }, [])\n}\n\nconst paginate = (results = [], { skip = 0, limit }) => {\n  if (results === null) {\n    results = []\n  }\n\n  const count = results.length\n  const items = results.slice(skip, limit && skip + limit)\n\n  const hasNextPage = skip + limit < count\n\n  return {\n    totalCount: items.length,\n    edges: items.map((item, i, arr) => {\n      return {\n        node: item,\n        next: arr[i + 1],\n        previous: arr[i - 1],\n      }\n    }),\n    nodes: items,\n    pageInfo: {\n      hasNextPage,\n    },\n  }\n}\n\nconst link = ({ by, from }) => async (source, args, context, info) => {\n  const fieldValue = source && source[from || info.fieldName]\n\n  if (fieldValue == null || _.isPlainObject(fieldValue)) return fieldValue\n  if (\n    Array.isArray(fieldValue) &&\n    (fieldValue[0] == null || _.isPlainObject(fieldValue[0]))\n  ) {\n    return fieldValue\n  }\n\n  const returnType = getNullableType(info.returnType)\n  const type = getNamedType(returnType)\n\n  if (by === `id`) {\n    if (Array.isArray(fieldValue)) {\n      return context.nodeModel.getNodesByIds(\n        { ids: fieldValue, type: type },\n        { path: context.path }\n      )\n    } else {\n      return context.nodeModel.getNodeById(\n        { id: fieldValue, type: type },\n        { path: context.path }\n      )\n    }\n  }\n\n  const equals = value => {\n    return { eq: value }\n  }\n  const oneOf = value => {\n    return { in: value }\n  }\n  const operator = Array.isArray(fieldValue) ? oneOf : equals\n  args.filter = by.split(`.`).reduceRight((acc, key, i, { length }) => {\n    return {\n      [key]: i === length - 1 ? operator(acc) : acc,\n    }\n  }, fieldValue)\n\n  return context.nodeModel.runQuery(\n    { query: args, firstOnly: !(returnType instanceof GraphQLList), type },\n    { path: context.path }\n  )\n}\n\nconst fileByPath = (source, args, context, info) => {\n  let fieldValue = source[info.fieldName]\n\n  const isArray = getNullableType(info.returnType) instanceof GraphQLList\n\n  if (!fieldValue) {\n    return null\n  }\n\n  const findLinkedFileNode = async relativePath => {\n    // Use the parent File node to create the absolute path to\n    // the linked file.\n    const fileLinkPath = normalize(\n      systemPath.resolve(parentFileNode.dir, relativePath)\n    )\n\n    // Use that path to find the linked File node.\n    const linkedFileNode = _.find(\n      await context.nodeModel.getAllNodes({ type: `File` }),\n      n => n.absolutePath === fileLinkPath\n    )\n    return linkedFileNode\n  }\n\n  // Find the File node for this node (we assume the node is something\n  // like markdown which would be a child node of a File node).\n  const parentFileNode = context.nodeModel.findRootNodeAncestor(source)\n\n  // Find the linked File node(s)\n  if (isArray) {\n    return Promise.all(fieldValue.map(findLinkedFileNode))\n  } else {\n    return findLinkedFileNode(fieldValue)\n  }\n}\n\nmodule.exports = {\n  findManyPaginated,\n  findOne,\n  fileByPath,\n  link,\n  distinct,\n  group,\n}\n"],"file":"resolvers.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/schema/resolvers.js"],"names":["systemPath","require","normalize","_","GraphQLList","getNullableType","getNamedType","getValueAt","findMany","typeName","args","context","info","nodeModel","runQuery","query","firstOnly","type","schema","getType","path","connectionType","findOne","filter","findManyPaginated","rp","result","paginate","skip","limit","distinct","source","field","edges","values","reduce","acc","node","value","concat","Date","toISOString","Array","from","Set","sort","group","groupedResults","isArray","forEach","key","Object","keys","fieldValue","push","results","count","length","items","slice","hasNextPage","totalCount","map","item","i","arr","next","previous","nodes","pageInfo","link","by","fieldName","isPlainObject","returnType","getNodesByIds","ids","getNodeById","id","equals","eq","oneOf","in","operator","split","reduceRight","fileByPath","findLinkedFileNode","relativePath","fileLinkPath","resolve","parentFileNode","dir","linkedFileNode","find","getAllNodes","n","absolutePath","findRootNodeAncestor","internal","Promise","all","module","exports"],"mappings":";;AAAA,MAAMA,UAAU,GAAGC,OAAO,CAAE,MAAF,CAA1B;;AACA,MAAMC,SAAS,GAAGD,OAAO,CAAE,gBAAF,CAAzB;;AACA,MAAME,CAAC,GAAGF,OAAO,CAAE,QAAF,CAAjB;;AACA,MAAM;AAAEG,EAAAA,WAAF;AAAeC,EAAAA,eAAf;AAAgCC,EAAAA;AAAhC,IAAiDL,OAAO,CAAE,SAAF,CAA9D;;AACA,MAAM;AAAEM,EAAAA;AAAF,IAAiBN,OAAO,CAAE,sBAAF,CAA9B;;AAEA,MAAMO,QAAQ,GAAGC,QAAQ,IAAI,CAAC;AAAEC,EAAAA,IAAF;AAAQC,EAAAA,OAAR;AAAiBC,EAAAA;AAAjB,CAAD,KAC3BD,OAAO,CAACE,SAAR,CAAkBC,QAAlB,CACE;AACEC,EAAAA,KAAK,EAAEL,IADT;AAEEM,EAAAA,SAAS,EAAE,KAFb;AAGEC,EAAAA,IAAI,EAAEL,IAAI,CAACM,MAAL,CAAYC,OAAZ,CAAoBV,QAApB;AAHR,CADF,EAME;AAAEW,EAAAA,IAAI,EAAET,OAAO,CAACS,IAAhB;AAAsBC,EAAAA,cAAc,EAAEZ;AAAtC,CANF,CADF;;AAUA,MAAMa,OAAO,GAAGb,QAAQ,IAAI,CAAC;AAAEC,EAAAA,IAAF;AAAQC,EAAAA,OAAR;AAAiBC,EAAAA;AAAjB,CAAD,KAC1BD,OAAO,CAACE,SAAR,CAAkBC,QAAlB,CACE;AACEC,EAAAA,KAAK,EAAE;AAAEQ,IAAAA,MAAM,EAAEb;AAAV,GADT;AAEEM,EAAAA,SAAS,EAAE,IAFb;AAGEC,EAAAA,IAAI,EAAEL,IAAI,CAACM,MAAL,CAAYC,OAAZ,CAAoBV,QAApB;AAHR,CADF,EAME;AAAEW,EAAAA,IAAI,EAAET,OAAO,CAACS;AAAhB,CANF,CADF;;AAUA,MAAMI,iBAAiB,GAAGf,QAAQ,IAAI,MAAMgB,EAAN,IAAY;AAChD,QAAMC,MAAM,GAAG,MAAMlB,QAAQ,CAACC,QAAD,CAAR,CAAmBgB,EAAnB,CAArB;AACA,SAAOE,QAAQ,CAACD,MAAD,EAAS;AAAEE,IAAAA,IAAI,EAAEH,EAAE,CAACf,IAAH,CAAQkB,IAAhB;AAAsBC,IAAAA,KAAK,EAAEJ,EAAE,CAACf,IAAH,CAAQmB;AAArC,GAAT,CAAf;AACD,CAHD;;AAKA,MAAMC,QAAQ,GAAG,CAACC,MAAD,EAASrB,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,KAAiC;AAChD,QAAM;AAAEoB,IAAAA;AAAF,MAAYtB,IAAlB;AACA,QAAM;AAAEuB,IAAAA;AAAF,MAAYF,MAAlB;AACA,QAAMG,MAAM,GAAGD,KAAK,CAACE,MAAN,CAAa,CAACC,GAAD,EAAM;AAAEC,IAAAA;AAAF,GAAN,KAAmB;AAC7C,UAAMC,KAAK,GAAG/B,UAAU,CAAC8B,IAAD,EAAOL,KAAP,CAAxB;AACA,WAAOM,KAAK,IAAI,IAAT,GACHF,GAAG,CAACG,MAAJ,CAAWD,KAAK,YAAYE,IAAjB,GAAwBF,KAAK,CAACG,WAAN,EAAxB,GAA8CH,KAAzD,CADG,GAEHF,GAFJ;AAGD,GALc,EAKZ,EALY,CAAf;AAMA,SAAOM,KAAK,CAACC,IAAN,CAAW,IAAIC,GAAJ,CAAQV,MAAR,CAAX,EAA4BW,IAA5B,EAAP;AACD,CAVD;;AAYA,MAAMC,KAAK,GAAG,CAACf,MAAD,EAASrB,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,KAAiC;AAC7C,QAAM;AAAEoB,IAAAA;AAAF,MAAYtB,IAAlB;AACA,QAAM;AAAEuB,IAAAA;AAAF,MAAYF,MAAlB;AACA,QAAMgB,cAAc,GAAGd,KAAK,CAACE,MAAN,CAAa,CAACC,GAAD,EAAM;AAAEC,IAAAA;AAAF,GAAN,KAAmB;AACrD,UAAMC,KAAK,GAAG/B,UAAU,CAAC8B,IAAD,EAAOL,KAAP,CAAxB;AACA,UAAME,MAAM,GAAGQ,KAAK,CAACM,OAAN,CAAcV,KAAd,IAAuBA,KAAvB,GAA+B,CAACA,KAAD,CAA9C;AACAJ,IAAAA,MAAM,CACHX,MADH,CACUe,KAAK,IAAIA,KAAK,IAAI,IAD5B,EAEGW,OAFH,CAEWX,KAAK,IAAI;AAChB,YAAMY,GAAG,GAAGZ,KAAK,YAAYE,IAAjB,GAAwBF,KAAK,CAACG,WAAN,EAAxB,GAA8CH,KAA1D;AACAF,MAAAA,GAAG,CAACc,GAAD,CAAH,GAAW,CAACd,GAAG,CAACc,GAAD,CAAH,IAAY,EAAb,EAAiBX,MAAjB,CAAwBF,IAAxB,CAAX;AACD,KALH;AAMA,WAAOD,GAAP;AACD,GAVsB,EAUpB,EAVoB,CAAvB;AAWA,SAAOe,MAAM,CAACC,IAAP,CAAYL,cAAZ,EACJF,IADI,GAEJV,MAFI,CAEG,CAACC,GAAD,EAAMiB,UAAN,KAAqB;AAC3BjB,IAAAA,GAAG,CAACkB,IAAJ,CAAS,EACP,GAAG3B,QAAQ,CAACoB,cAAc,CAACM,UAAD,CAAf,EAA6B3C,IAA7B,CADJ;AAEPsB,MAAAA,KAFO;AAGPqB,MAAAA;AAHO,KAAT;AAKA,WAAOjB,GAAP;AACD,GATI,EASF,EATE,CAAP;AAUD,CAxBD;;AA0BA,MAAMT,QAAQ,GAAG,CAAC4B,OAAO,GAAG,EAAX,EAAe;AAAE3B,EAAAA,IAAI,GAAG,CAAT;AAAYC,EAAAA;AAAZ,CAAf,KAAuC;AACtD,MAAI0B,OAAO,KAAK,IAAhB,EAAsB;AACpBA,IAAAA,OAAO,GAAG,EAAV;AACD;;AAED,QAAMC,KAAK,GAAGD,OAAO,CAACE,MAAtB;AACA,QAAMC,KAAK,GAAGH,OAAO,CAACI,KAAR,CAAc/B,IAAd,EAAoBC,KAAK,IAAID,IAAI,GAAGC,KAApC,CAAd;AAEA,QAAM+B,WAAW,GAAGhC,IAAI,GAAGC,KAAP,GAAe2B,KAAnC;AAEA,SAAO;AACLK,IAAAA,UAAU,EAAEH,KAAK,CAACD,MADb;AAELxB,IAAAA,KAAK,EAAEyB,KAAK,CAACI,GAAN,CAAU,CAACC,IAAD,EAAOC,CAAP,EAAUC,GAAV,KAAkB;AACjC,aAAO;AACL5B,QAAAA,IAAI,EAAE0B,IADD;AAELG,QAAAA,IAAI,EAAED,GAAG,CAACD,CAAC,GAAG,CAAL,CAFJ;AAGLG,QAAAA,QAAQ,EAAEF,GAAG,CAACD,CAAC,GAAG,CAAL;AAHR,OAAP;AAKD,KANM,CAFF;AASLI,IAAAA,KAAK,EAAEV,KATF;AAULW,IAAAA,QAAQ,EAAE;AACRT,MAAAA;AADQ;AAVL,GAAP;AAcD,CAxBD;;AA0BA,MAAMU,IAAI,GAAG,CAAC;AAAEC,EAAAA,EAAF;AAAM5B,EAAAA;AAAN,CAAD,KAAkB,OAAOZ,MAAP,EAAerB,IAAf,EAAqBC,OAArB,EAA8BC,IAA9B,KAAuC;AACpE,QAAMyC,UAAU,GAAGtB,MAAM,IAAIA,MAAM,CAACY,IAAI,IAAI/B,IAAI,CAAC4D,SAAd,CAAnC;AAEA,MAAInB,UAAU,IAAI,IAAd,IAAsBlD,CAAC,CAACsE,aAAF,CAAgBpB,UAAhB,CAA1B,EAAuD,OAAOA,UAAP;;AACvD,MACEX,KAAK,CAACM,OAAN,CAAcK,UAAd,MACCA,UAAU,CAAC,CAAD,CAAV,IAAiB,IAAjB,IAAyBlD,CAAC,CAACsE,aAAF,CAAgBpB,UAAU,CAAC,CAAD,CAA1B,CAD1B,CADF,EAGE;AACA,WAAOA,UAAP;AACD;;AAED,QAAMqB,UAAU,GAAGrE,eAAe,CAACO,IAAI,CAAC8D,UAAN,CAAlC;AACA,QAAMzD,IAAI,GAAGX,YAAY,CAACoE,UAAD,CAAzB;;AAEA,MAAIH,EAAE,KAAM,IAAZ,EAAiB;AACf,QAAI7B,KAAK,CAACM,OAAN,CAAcK,UAAd,CAAJ,EAA+B;AAC7B,aAAO1C,OAAO,CAACE,SAAR,CAAkB8D,aAAlB,CACL;AAAEC,QAAAA,GAAG,EAAEvB,UAAP;AAAmBpC,QAAAA,IAAI,EAAEA;AAAzB,OADK,EAEL;AAAEG,QAAAA,IAAI,EAAET,OAAO,CAACS;AAAhB,OAFK,CAAP;AAID,KALD,MAKO;AACL,aAAOT,OAAO,CAACE,SAAR,CAAkBgE,WAAlB,CACL;AAAEC,QAAAA,EAAE,EAAEzB,UAAN;AAAkBpC,QAAAA,IAAI,EAAEA;AAAxB,OADK,EAEL;AAAEG,QAAAA,IAAI,EAAET,OAAO,CAACS;AAAhB,OAFK,CAAP;AAID;AACF;;AAED,QAAM2D,MAAM,GAAGzC,KAAK,IAAI;AACtB,WAAO;AAAE0C,MAAAA,EAAE,EAAE1C;AAAN,KAAP;AACD,GAFD;;AAGA,QAAM2C,KAAK,GAAG3C,KAAK,IAAI;AACrB,WAAO;AAAE4C,MAAAA,EAAE,EAAE5C;AAAN,KAAP;AACD,GAFD;;AAGA,QAAM6C,QAAQ,GAAGzC,KAAK,CAACM,OAAN,CAAcK,UAAd,IAA4B4B,KAA5B,GAAoCF,MAArD;AACArE,EAAAA,IAAI,CAACa,MAAL,GAAcgD,EAAE,CAACa,KAAH,CAAU,GAAV,EAAcC,WAAd,CAA0B,CAACjD,GAAD,EAAMc,GAAN,EAAWc,CAAX,EAAc;AAAEP,IAAAA;AAAF,GAAd,KAA6B;AACnE,WAAO;AACL,OAACP,GAAD,GAAOc,CAAC,KAAKP,MAAM,GAAG,CAAf,GAAmB0B,QAAQ,CAAC/C,GAAD,CAA3B,GAAmCA;AADrC,KAAP;AAGD,GAJa,EAIXiB,UAJW,CAAd;AAMA,SAAO1C,OAAO,CAACE,SAAR,CAAkBC,QAAlB,CACL;AAAEC,IAAAA,KAAK,EAAEL,IAAT;AAAeM,IAAAA,SAAS,EAAE,EAAE0D,UAAU,YAAYtE,WAAxB,CAA1B;AAAgEa,IAAAA;AAAhE,GADK,EAEL;AAAEG,IAAAA,IAAI,EAAET,OAAO,CAACS;AAAhB,GAFK,CAAP;AAID,CA7CD;;AA+CA,MAAMkE,UAAU,GAAG,CAACvD,MAAD,EAASrB,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,KAAiC;AAClD,QAAMyC,UAAU,GAAGtB,MAAM,IAAIA,MAAM,CAACnB,IAAI,CAAC4D,SAAN,CAAnC;AAEA,MAAInB,UAAU,IAAI,IAAd,IAAsBlD,CAAC,CAACsE,aAAF,CAAgBpB,UAAhB,CAA1B,EAAuD,OAAOA,UAAP;;AACvD,MACEX,KAAK,CAACM,OAAN,CAAcK,UAAd,MACCA,UAAU,CAAC,CAAD,CAAV,IAAiB,IAAjB,IAAyBlD,CAAC,CAACsE,aAAF,CAAgBpB,UAAU,CAAC,CAAD,CAA1B,CAD1B,CADF,EAGE;AACA,WAAOA,UAAP;AACD;;AAED,QAAML,OAAO,GAAG3C,eAAe,CAACO,IAAI,CAAC8D,UAAN,CAAf,YAA4CtE,WAA5D;;AAEA,QAAMmF,kBAAkB,GAAG,MAAMC,YAAN,IAAsB;AAC/C;AACA;AACA,UAAMC,YAAY,GAAGvF,SAAS,CAC5BF,UAAU,CAAC0F,OAAX,CAAmBC,cAAc,CAACC,GAAlC,EAAuCJ,YAAvC,CAD4B,CAA9B,CAH+C,CAO/C;;AACA,UAAMK,cAAc,GAAG1F,CAAC,CAAC2F,IAAF,EACrB,MAAMnF,OAAO,CAACE,SAAR,CAAkBkF,WAAlB,CAA8B;AAAE9E,MAAAA,IAAI,EAAG;AAAT,KAA9B,CADe,GAErB+E,CAAC,IAAIA,CAAC,CAACC,YAAF,KAAmBR,YAFH,CAAvB;;AAIA,WAAOI,cAAP;AACD,GAbD,CAbkD,CA4BlD;AACA;;;AACA,QAAMF,cAAc,GAAGhF,OAAO,CAACE,SAAR,CAAkBqF,oBAAlB,CACrBnE,MADqB,EAErBM,IAAI,IAAIA,IAAI,CAAC8D,QAAL,IAAiB9D,IAAI,CAAC8D,QAAL,CAAclF,IAAd,KAAwB,MAF5B,CAAvB,CA9BkD,CAmClD;;AACA,MAAI+B,OAAJ,EAAa;AACX,WAAOoD,OAAO,CAACC,GAAR,CAAYhD,UAAU,CAACS,GAAX,CAAeyB,kBAAf,CAAZ,CAAP;AACD,GAFD,MAEO;AACL,WAAOA,kBAAkB,CAAClC,UAAD,CAAzB;AACD;AACF,CAzCD;;AA2CAiD,MAAM,CAACC,OAAP,GAAiB;AACf/E,EAAAA,iBADe;AAEfF,EAAAA,OAFe;AAGfgE,EAAAA,UAHe;AAIfhB,EAAAA,IAJe;AAKfxC,EAAAA,QALe;AAMfgB,EAAAA;AANe,CAAjB","sourcesContent":["const systemPath = require(`path`)\nconst normalize = require(`normalize-path`)\nconst _ = require(`lodash`)\nconst { GraphQLList, getNullableType, getNamedType } = require(`graphql`)\nconst { getValueAt } = require(`./utils/get-value-at`)\n\nconst findMany = typeName => ({ args, context, info }) =>\n  context.nodeModel.runQuery(\n    {\n      query: args,\n      firstOnly: false,\n      type: info.schema.getType(typeName),\n    },\n    { path: context.path, connectionType: typeName }\n  )\n\nconst findOne = typeName => ({ args, context, info }) =>\n  context.nodeModel.runQuery(\n    {\n      query: { filter: args },\n      firstOnly: true,\n      type: info.schema.getType(typeName),\n    },\n    { path: context.path }\n  )\n\nconst findManyPaginated = typeName => async rp => {\n  const result = await findMany(typeName)(rp)\n  return paginate(result, { skip: rp.args.skip, limit: rp.args.limit })\n}\n\nconst distinct = (source, args, context, info) => {\n  const { field } = args\n  const { edges } = source\n  const values = edges.reduce((acc, { node }) => {\n    const value = getValueAt(node, field)\n    return value != null\n      ? acc.concat(value instanceof Date ? value.toISOString() : value)\n      : acc\n  }, [])\n  return Array.from(new Set(values)).sort()\n}\n\nconst group = (source, args, context, info) => {\n  const { field } = args\n  const { edges } = source\n  const groupedResults = edges.reduce((acc, { node }) => {\n    const value = getValueAt(node, field)\n    const values = Array.isArray(value) ? value : [value]\n    values\n      .filter(value => value != null)\n      .forEach(value => {\n        const key = value instanceof Date ? value.toISOString() : value\n        acc[key] = (acc[key] || []).concat(node)\n      })\n    return acc\n  }, {})\n  return Object.keys(groupedResults)\n    .sort()\n    .reduce((acc, fieldValue) => {\n      acc.push({\n        ...paginate(groupedResults[fieldValue], args),\n        field,\n        fieldValue,\n      })\n      return acc\n    }, [])\n}\n\nconst paginate = (results = [], { skip = 0, limit }) => {\n  if (results === null) {\n    results = []\n  }\n\n  const count = results.length\n  const items = results.slice(skip, limit && skip + limit)\n\n  const hasNextPage = skip + limit < count\n\n  return {\n    totalCount: items.length,\n    edges: items.map((item, i, arr) => {\n      return {\n        node: item,\n        next: arr[i + 1],\n        previous: arr[i - 1],\n      }\n    }),\n    nodes: items,\n    pageInfo: {\n      hasNextPage,\n    },\n  }\n}\n\nconst link = ({ by, from }) => async (source, args, context, info) => {\n  const fieldValue = source && source[from || info.fieldName]\n\n  if (fieldValue == null || _.isPlainObject(fieldValue)) return fieldValue\n  if (\n    Array.isArray(fieldValue) &&\n    (fieldValue[0] == null || _.isPlainObject(fieldValue[0]))\n  ) {\n    return fieldValue\n  }\n\n  const returnType = getNullableType(info.returnType)\n  const type = getNamedType(returnType)\n\n  if (by === `id`) {\n    if (Array.isArray(fieldValue)) {\n      return context.nodeModel.getNodesByIds(\n        { ids: fieldValue, type: type },\n        { path: context.path }\n      )\n    } else {\n      return context.nodeModel.getNodeById(\n        { id: fieldValue, type: type },\n        { path: context.path }\n      )\n    }\n  }\n\n  const equals = value => {\n    return { eq: value }\n  }\n  const oneOf = value => {\n    return { in: value }\n  }\n  const operator = Array.isArray(fieldValue) ? oneOf : equals\n  args.filter = by.split(`.`).reduceRight((acc, key, i, { length }) => {\n    return {\n      [key]: i === length - 1 ? operator(acc) : acc,\n    }\n  }, fieldValue)\n\n  return context.nodeModel.runQuery(\n    { query: args, firstOnly: !(returnType instanceof GraphQLList), type },\n    { path: context.path }\n  )\n}\n\nconst fileByPath = (source, args, context, info) => {\n  const fieldValue = source && source[info.fieldName]\n\n  if (fieldValue == null || _.isPlainObject(fieldValue)) return fieldValue\n  if (\n    Array.isArray(fieldValue) &&\n    (fieldValue[0] == null || _.isPlainObject(fieldValue[0]))\n  ) {\n    return fieldValue\n  }\n\n  const isArray = getNullableType(info.returnType) instanceof GraphQLList\n\n  const findLinkedFileNode = async relativePath => {\n    // Use the parent File node to create the absolute path to\n    // the linked file.\n    const fileLinkPath = normalize(\n      systemPath.resolve(parentFileNode.dir, relativePath)\n    )\n\n    // Use that path to find the linked File node.\n    const linkedFileNode = _.find(\n      await context.nodeModel.getAllNodes({ type: `File` }),\n      n => n.absolutePath === fileLinkPath\n    )\n    return linkedFileNode\n  }\n\n  // Find the File node for this node (we assume the node is something\n  // like markdown which would be a child node of a File node).\n  const parentFileNode = context.nodeModel.findRootNodeAncestor(\n    source,\n    node => node.internal && node.internal.type === `File`\n  )\n\n  // Find the linked File node(s)\n  if (isArray) {\n    return Promise.all(fieldValue.map(findLinkedFileNode))\n  } else {\n    return findLinkedFileNode(fieldValue)\n  }\n}\n\nmodule.exports = {\n  findManyPaginated,\n  findOne,\n  fileByPath,\n  link,\n  distinct,\n  group,\n}\n"],"file":"resolvers.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/schema/schema-composer.js b/node_modules/gatsby/dist/schema/schema-composer.js
index ecb8f53..6092b58 100644
--- a/node_modules/gatsby/dist/schema/schema-composer.js
+++ b/node_modules/gatsby/dist/schema/schema-composer.js
@@ -1,17 +1,21 @@
 "use strict";
 
-const _require = require(`graphql-compose`),
-      SchemaComposer = _require.SchemaComposer;
+const {
+  SchemaComposer
+} = require(`graphql-compose`);
 
-const _require2 = require(`./types/node-interface`),
-      getNodeInterface = _require2.getNodeInterface;
+const {
+  getNodeInterface
+} = require(`./types/node-interface`);
 
-const _require3 = require(`./types/date`),
-      GraphQLDate = _require3.GraphQLDate;
+const {
+  GraphQLDate
+} = require(`./types/date`);
 
-const _require4 = require(`./types/directives`),
-      InferDirective = _require4.InferDirective,
-      DontInferDirective = _require4.DontInferDirective;
+const {
+  InferDirective,
+  DontInferDirective
+} = require(`./types/directives`);
 
 const createSchemaComposer = () => {
   const schemaComposer = new SchemaComposer();
diff --git a/node_modules/gatsby/dist/schema/schema-composer.js.map b/node_modules/gatsby/dist/schema/schema-composer.js.map
index aa25e86..df49fde 100644
--- a/node_modules/gatsby/dist/schema/schema-composer.js.map
+++ b/node_modules/gatsby/dist/schema/schema-composer.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/schema/schema-composer.js"],"names":["require","SchemaComposer","getNodeInterface","GraphQLDate","InferDirective","DontInferDirective","createSchemaComposer","schemaComposer","addAsComposer","addDirective","module","exports"],"mappings":";;iBAA2BA,OAAO,CAAE,iBAAF,C;MAA1BC,c,YAAAA,c;;kBACqBD,OAAO,CAAE,wBAAF,C;MAA5BE,gB,aAAAA,gB;;kBACgBF,OAAO,CAAE,cAAF,C;MAAvBG,W,aAAAA,W;;kBACuCH,OAAO,CAAE,oBAAF,C;MAA9CI,c,aAAAA,c;MAAgBC,kB,aAAAA,kB;;AAExB,MAAMC,oBAAoB,GAAG,MAAM;AACjC,QAAMC,cAAc,GAAG,IAAIN,cAAJ,EAAvB;AACAC,EAAAA,gBAAgB,CAAC;AAAEK,IAAAA;AAAF,GAAD,CAAhB;AACAA,EAAAA,cAAc,CAACC,aAAf,CAA6BL,WAA7B;AACAI,EAAAA,cAAc,CAACE,YAAf,CAA4BL,cAA5B;AACAG,EAAAA,cAAc,CAACE,YAAf,CAA4BJ,kBAA5B;AACA,SAAOE,cAAP;AACD,CAPD;;AASAG,MAAM,CAACC,OAAP,GAAiB;AAAEL,EAAAA;AAAF,CAAjB","sourcesContent":["const { SchemaComposer } = require(`graphql-compose`)\nconst { getNodeInterface } = require(`./types/node-interface`)\nconst { GraphQLDate } = require(`./types/date`)\nconst { InferDirective, DontInferDirective } = require(`./types/directives`)\n\nconst createSchemaComposer = () => {\n  const schemaComposer = new SchemaComposer()\n  getNodeInterface({ schemaComposer })\n  schemaComposer.addAsComposer(GraphQLDate)\n  schemaComposer.addDirective(InferDirective)\n  schemaComposer.addDirective(DontInferDirective)\n  return schemaComposer\n}\n\nmodule.exports = { createSchemaComposer }\n"],"file":"schema-composer.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/schema/schema-composer.js"],"names":["SchemaComposer","require","getNodeInterface","GraphQLDate","InferDirective","DontInferDirective","createSchemaComposer","schemaComposer","addAsComposer","addDirective","module","exports"],"mappings":";;AAAA,MAAM;AAAEA,EAAAA;AAAF,IAAqBC,OAAO,CAAE,iBAAF,CAAlC;;AACA,MAAM;AAAEC,EAAAA;AAAF,IAAuBD,OAAO,CAAE,wBAAF,CAApC;;AACA,MAAM;AAAEE,EAAAA;AAAF,IAAkBF,OAAO,CAAE,cAAF,CAA/B;;AACA,MAAM;AAAEG,EAAAA,cAAF;AAAkBC,EAAAA;AAAlB,IAAyCJ,OAAO,CAAE,oBAAF,CAAtD;;AAEA,MAAMK,oBAAoB,GAAG,MAAM;AACjC,QAAMC,cAAc,GAAG,IAAIP,cAAJ,EAAvB;AACAE,EAAAA,gBAAgB,CAAC;AAAEK,IAAAA;AAAF,GAAD,CAAhB;AACAA,EAAAA,cAAc,CAACC,aAAf,CAA6BL,WAA7B;AACAI,EAAAA,cAAc,CAACE,YAAf,CAA4BL,cAA5B;AACAG,EAAAA,cAAc,CAACE,YAAf,CAA4BJ,kBAA5B;AACA,SAAOE,cAAP;AACD,CAPD;;AASAG,MAAM,CAACC,OAAP,GAAiB;AAAEL,EAAAA;AAAF,CAAjB","sourcesContent":["const { SchemaComposer } = require(`graphql-compose`)\nconst { getNodeInterface } = require(`./types/node-interface`)\nconst { GraphQLDate } = require(`./types/date`)\nconst { InferDirective, DontInferDirective } = require(`./types/directives`)\n\nconst createSchemaComposer = () => {\n  const schemaComposer = new SchemaComposer()\n  getNodeInterface({ schemaComposer })\n  schemaComposer.addAsComposer(GraphQLDate)\n  schemaComposer.addDirective(InferDirective)\n  schemaComposer.addDirective(DontInferDirective)\n  return schemaComposer\n}\n\nmodule.exports = { createSchemaComposer }\n"],"file":"schema-composer.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/schema/schema.js b/node_modules/gatsby/dist/schema/schema.js
index 94e618d..a5542f5 100644
--- a/node_modules/gatsby/dist/schema/schema.js
+++ b/node_modules/gatsby/dist/schema/schema.js
@@ -1,58 +1,70 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const _ = require(`lodash`);
 
 const invariant = require(`invariant`);
 
-const _require = require(`graphql`),
-      isSpecifiedScalarType = _require.isSpecifiedScalarType,
-      isIntrospectionType = _require.isIntrospectionType,
-      defaultFieldResolver = _require.defaultFieldResolver,
-      assertValidName = _require.assertValidName,
-      getNamedType = _require.getNamedType;
-
-const _require2 = require(`graphql-compose`),
-      ObjectTypeComposer = _require2.ObjectTypeComposer,
-      InterfaceTypeComposer = _require2.InterfaceTypeComposer,
-      UnionTypeComposer = _require2.UnionTypeComposer,
-      InputTypeComposer = _require2.InputTypeComposer;
+const {
+  isSpecifiedScalarType,
+  isIntrospectionType,
+  defaultFieldResolver,
+  assertValidName,
+  getNamedType,
+  Kind
+} = require(`graphql`);
+
+const {
+  ObjectTypeComposer,
+  InterfaceTypeComposer,
+  UnionTypeComposer,
+  InputTypeComposer
+} = require(`graphql-compose`);
 
 const apiRunner = require(`../utils/api-runner-node`);
 
 const report = require(`gatsby-cli/lib/reporter`);
 
-const _require3 = require(`./types/node-interface`),
-      addNodeInterfaceFields = _require3.addNodeInterfaceFields;
+const {
+  addNodeInterfaceFields
+} = require(`./types/node-interface`);
 
-const _require4 = require(`./infer`),
-      addInferredType = _require4.addInferredType,
-      addInferredTypes = _require4.addInferredTypes;
+const {
+  addInferredType,
+  addInferredTypes
+} = require(`./infer`);
 
-const _require5 = require(`./resolvers`),
-      findOne = _require5.findOne,
-      findManyPaginated = _require5.findManyPaginated;
+const {
+  findOne,
+  findManyPaginated
+} = require(`./resolvers`);
 
-const _require6 = require(`./types/pagination`),
-      getPagination = _require6.getPagination;
+const {
+  getPagination
+} = require(`./types/pagination`);
 
-const _require7 = require(`./types/sort`),
-      getSortInput = _require7.getSortInput;
+const {
+  getSortInput
+} = require(`./types/sort`);
 
-const _require8 = require(`./types/filter`),
-      getFilterInput = _require8.getFilterInput;
+const {
+  getFilterInput
+} = require(`./types/filter`);
 
-const _require9 = require(`./types/type-builders`),
-      isGatsbyType = _require9.isGatsbyType,
-      GatsbyGraphQLTypeKind = _require9.GatsbyGraphQLTypeKind;
+const {
+  isGatsbyType,
+  GatsbyGraphQLTypeKind
+} = require(`./types/type-builders`);
 
-const buildSchema =
-/*#__PURE__*/
-function () {
-  var _ref = (0, _asyncToGenerator2.default)(function* ({
+const buildSchema = async ({
+  schemaComposer,
+  nodeStore,
+  types,
+  thirdPartySchemas,
+  typeMapping,
+  typeConflictReporter,
+  parentSpan
+}) => {
+  await updateSchemaComposer({
     schemaComposer,
     nodeStore,
     types,
@@ -60,160 +72,125 @@ function () {
     typeMapping,
     typeConflictReporter,
     parentSpan
-  }) {
-    yield updateSchemaComposer({
-      schemaComposer,
-      nodeStore,
-      types,
-      thirdPartySchemas,
-      typeMapping,
-      typeConflictReporter,
-      parentSpan
-    }); // const { printSchema } = require(`graphql`)
+  }); // const { printSchema } = require(`graphql`)
 
-    const schema = schemaComposer.buildSchema(); // console.log(printSchema(schema))
+  const schema = schemaComposer.buildSchema(); // console.log(printSchema(schema))
 
-    return schema;
-  });
-
-  return function buildSchema(_x) {
-    return _ref.apply(this, arguments);
-  };
-}();
+  return schema;
+};
 
-const rebuildSchemaWithSitePage =
-/*#__PURE__*/
-function () {
-  var _ref2 = (0, _asyncToGenerator2.default)(function* ({
+const rebuildSchemaWithSitePage = async ({
+  schemaComposer,
+  nodeStore,
+  typeMapping,
+  typeConflictReporter,
+  parentSpan
+}) => {
+  const typeComposer = addInferredType({
     schemaComposer,
+    typeComposer: schemaComposer.getOTC(`SitePage`),
     nodeStore,
-    typeMapping,
     typeConflictReporter,
+    typeMapping,
     parentSpan
-  }) {
-    const typeComposer = addInferredType({
-      schemaComposer,
-      typeComposer: schemaComposer.getOTC(`SitePage`),
-      nodeStore,
-      typeConflictReporter,
-      typeMapping,
-      parentSpan
-    });
-    yield processTypeComposer({
-      schemaComposer,
-      typeComposer,
-      nodeStore,
-      parentSpan
-    });
-    return schemaComposer.buildSchema();
   });
-
-  return function rebuildSchemaWithSitePage(_x2) {
-    return _ref2.apply(this, arguments);
-  };
-}();
+  await processTypeComposer({
+    schemaComposer,
+    typeComposer,
+    nodeStore,
+    parentSpan
+  });
+  return schemaComposer.buildSchema();
+};
 
 module.exports = {
   buildSchema,
   rebuildSchemaWithSitePage
 };
 
-const updateSchemaComposer =
-/*#__PURE__*/
-function () {
-  var _ref3 = (0, _asyncToGenerator2.default)(function* ({
+const updateSchemaComposer = async ({
+  schemaComposer,
+  nodeStore,
+  types,
+  typeMapping,
+  thirdPartySchemas,
+  typeConflictReporter,
+  parentSpan
+}) => {
+  await addTypes({
+    schemaComposer,
+    parentSpan,
+    types
+  });
+  await addInferredTypes({
     schemaComposer,
     nodeStore,
-    types,
+    typeConflictReporter,
     typeMapping,
+    parentSpan
+  });
+  await addSetFieldsOnGraphQLNodeTypeFields({
+    schemaComposer,
+    nodeStore,
+    parentSpan
+  });
+  await Promise.all(Array.from(schemaComposer.values()).map(typeComposer => processTypeComposer({
+    schemaComposer,
+    typeComposer,
+    nodeStore,
+    parentSpan
+  })));
+  await addThirdPartySchemas({
+    schemaComposer,
     thirdPartySchemas,
-    typeConflictReporter,
     parentSpan
-  }) {
-    yield addTypes({
-      schemaComposer,
-      parentSpan,
-      types
-    });
-    yield addInferredTypes({
+  });
+  await addCustomResolveFunctions({
+    schemaComposer,
+    parentSpan
+  });
+};
+
+const processTypeComposer = async ({
+  schemaComposer,
+  typeComposer,
+  nodeStore,
+  parentSpan
+}) => {
+  if (typeComposer instanceof ObjectTypeComposer && typeComposer.hasInterface(`Node`)) {
+    await addNodeInterfaceFields({
       schemaComposer,
-      nodeStore,
-      typeConflictReporter,
-      typeMapping,
+      typeComposer,
       parentSpan
     });
-    yield addSetFieldsOnGraphQLNodeTypeFields({
+    await addResolvers({
       schemaComposer,
-      nodeStore,
+      typeComposer,
       parentSpan
     });
-    yield Promise.all(Array.from(schemaComposer.values()).map(typeComposer => processTypeComposer({
+    await addConvenienceChildrenFields({
       schemaComposer,
       typeComposer,
       nodeStore,
       parentSpan
-    })));
-    yield addThirdPartySchemas({
-      schemaComposer,
-      thirdPartySchemas,
-      parentSpan
     });
-    yield addCustomResolveFunctions({
+    await addTypeToRootQuery({
       schemaComposer,
+      typeComposer,
       parentSpan
     });
-  });
-
-  return function updateSchemaComposer(_x3) {
-    return _ref3.apply(this, arguments);
-  };
-}();
-
-const processTypeComposer =
-/*#__PURE__*/
-function () {
-  var _ref4 = (0, _asyncToGenerator2.default)(function* ({
-    schemaComposer,
-    typeComposer,
-    nodeStore,
-    parentSpan
-  }) {
-    if (typeComposer instanceof ObjectTypeComposer && typeComposer.hasInterface(`Node`)) {
-      yield addNodeInterfaceFields({
-        schemaComposer,
-        typeComposer,
-        parentSpan
-      });
-      yield addResolvers({
-        schemaComposer,
-        typeComposer,
-        parentSpan
-      });
-      yield addConvenienceChildrenFields({
-        schemaComposer,
-        typeComposer,
-        nodeStore,
-        parentSpan
-      });
-      yield addTypeToRootQuery({
-        schemaComposer,
-        typeComposer,
-        parentSpan
-      });
-    }
-  });
-
-  return function processTypeComposer(_x4) {
-    return _ref4.apply(this, arguments);
-  };
-}();
+  }
+};
 
 const addTypes = ({
   schemaComposer,
   types,
   parentSpan
 }) => {
-  types.forEach(typeOrTypeDef => {
+  types.forEach(({
+    typeOrTypeDef,
+    plugin
+  }) => {
     if (typeof typeOrTypeDef === `string`) {
       let addedTypes;
 
@@ -223,11 +200,15 @@ const addTypes = ({
         reportParsingError(error);
       }
 
-      addedTypes.forEach(type => processAddedType({
-        schemaComposer,
-        type,
-        parentSpan
-      }));
+      addedTypes.forEach(type => {
+        processAddedType({
+          schemaComposer,
+          type,
+          parentSpan,
+          createdFrom: `sdl`,
+          plugin
+        });
+      });
     } else if (isGatsbyType(typeOrTypeDef)) {
       const type = createTypeComposerFromGatsbyType({
         schemaComposer,
@@ -239,14 +220,18 @@ const addTypes = ({
         processAddedType({
           schemaComposer,
           type,
-          parentSpan
+          parentSpan,
+          createdFrom: `typeBuilder`,
+          plugin
         });
       }
     } else {
       processAddedType({
         schemaComposer,
         type: typeOrTypeDef,
-        parentSpan
+        parentSpan,
+        createdFrom: `graphql-js`,
+        plugin
       });
     }
   });
@@ -255,7 +240,9 @@ const addTypes = ({
 const processAddedType = ({
   schemaComposer,
   type,
-  parentSpan
+  parentSpan,
+  createdFrom,
+  plugin
 }) => {
   const typeName = schemaComposer.addAsComposer(type);
   checkIsAllowedTypeName(typeName);
@@ -268,6 +255,38 @@ const processAddedType = ({
   }
 
   schemaComposer.addSchemaMustHaveType(typeComposer);
+  typeComposer.setExtension(`createdFrom`, createdFrom);
+  typeComposer.setExtension(`plugin`, plugin ? plugin.name : null);
+
+  if (createdFrom === `sdl`) {
+    if (type.astNode && type.astNode.directives) {
+      type.astNode.directives.forEach(directive => {
+        if (directive.name.value === `infer`) {
+          typeComposer.setExtension(`infer`, true);
+          typeComposer.setExtension(`addDefaultResolvers`, getNoDefaultResolvers(directive));
+        } else if (directive.name.value === `dontInfer`) {
+          typeComposer.setExtension(`infer`, false);
+          typeComposer.setExtension(`addDefaultResolvers`, getNoDefaultResolvers(directive));
+        }
+      });
+    }
+  }
+
+  return typeComposer;
+};
+
+const getNoDefaultResolvers = directive => {
+  const noDefaultResolvers = directive.arguments.find(({
+    name
+  }) => name.value === `noDefaultResolvers`);
+
+  if (noDefaultResolvers) {
+    if (noDefaultResolvers.value.kind === Kind.BOOLEAN) {
+      return !noDefaultResolvers.value.value;
+    }
+  }
+
+  return null;
 };
 
 const checkIsAllowedTypeName = name => {
@@ -285,7 +304,7 @@ const createTypeComposerFromGatsbyType = ({
   switch (type.kind) {
     case GatsbyGraphQLTypeKind.OBJECT:
       {
-        return ObjectTypeComposer.createTemp(Object.assign({}, type.config, {
+        return ObjectTypeComposer.createTemp({ ...type.config,
           interfaces: () => {
             if (type.config.interfaces) {
               return type.config.interfaces.map(iface => {
@@ -299,7 +318,7 @@ const createTypeComposerFromGatsbyType = ({
               return [];
             }
           }
-        }), schemaComposer);
+        }, schemaComposer);
       }
 
     case GatsbyGraphQLTypeKind.INPUT_OBJECT:
@@ -309,15 +328,15 @@ const createTypeComposerFromGatsbyType = ({
 
     case GatsbyGraphQLTypeKind.UNION:
       {
-        return UnionTypeComposer.createTemp(Object.assign({}, type.config, {
+        return UnionTypeComposer.createTemp({ ...type.config,
           types: () => {
-            if (type.types) {
-              return type.types.map(typeName => schemaComposer.getOTC(typeName).getType());
+            if (type.config.types) {
+              return type.config.types.map(typeName => schemaComposer.getOTC(typeName).getType());
             } else {
               return [];
             }
           }
-        }), schemaComposer);
+        }, schemaComposer);
       }
 
     case GatsbyGraphQLTypeKind.INTERFACE:
@@ -327,7 +346,7 @@ const createTypeComposerFromGatsbyType = ({
 
     default:
       {
-        console.warn(`Illegal type definition: ${JSON.stringify(type.config)}`);
+        report.warn(`Illegal type definition: ${JSON.stringify(type.config)}`);
         return null;
       }
   }
@@ -337,35 +356,27 @@ const addSetFieldsOnGraphQLNodeTypeFields = ({
   schemaComposer,
   nodeStore,
   parentSpan
-}) => Promise.all(Array.from(schemaComposer.values()).map(
-/*#__PURE__*/
-function () {
-  var _ref5 = (0, _asyncToGenerator2.default)(function* (tc) {
-    if (tc instanceof ObjectTypeComposer && tc.hasInterface(`Node`)) {
-      const typeName = tc.getTypeName();
-      const result = yield apiRunner(`setFieldsOnGraphQLNodeType`, {
-        type: {
-          name: typeName,
-          nodes: nodeStore.getNodesByType(typeName)
-        },
-        traceId: `initial-setFieldsOnGraphQLNodeType`,
-        parentSpan: parentSpan
-      });
+}) => Promise.all(Array.from(schemaComposer.values()).map(async tc => {
+  if (tc instanceof ObjectTypeComposer && tc.hasInterface(`Node`)) {
+    const typeName = tc.getTypeName();
+    const result = await apiRunner(`setFieldsOnGraphQLNodeType`, {
+      type: {
+        name: typeName,
+        nodes: nodeStore.getNodesByType(typeName)
+      },
+      traceId: `initial-setFieldsOnGraphQLNodeType`,
+      parentSpan: parentSpan
+    });
 
-      if (result) {
-        // NOTE: `setFieldsOnGraphQLNodeType` only allows setting
-        // nested fields with a path as property name, i.e.
-        // `{ 'frontmatter.published': 'Boolean' }`, but not in the form
-        // `{ frontmatter: { published: 'Boolean' }}`
-        result.forEach(fields => tc.addNestedFields(fields));
-      }
+    if (result) {
+      // NOTE: `setFieldsOnGraphQLNodeType` only allows setting
+      // nested fields with a path as property name, i.e.
+      // `{ 'frontmatter.published': 'Boolean' }`, but not in the form
+      // `{ frontmatter: { published: 'Boolean' }}`
+      result.forEach(fields => tc.addNestedFields(fields));
     }
-  });
-
-  return function (_x5) {
-    return _ref5.apply(this, arguments);
-  };
-}()));
+  }
+}));
 
 const addThirdPartySchemas = ({
   schemaComposer,
@@ -424,75 +435,67 @@ const processThirdPartyType = ({
   return typeComposer;
 };
 
-const addCustomResolveFunctions =
-/*#__PURE__*/
-function () {
-  var _ref6 = (0, _asyncToGenerator2.default)(function* ({
-    schemaComposer,
-    parentSpan
-  }) {
-    const intermediateSchema = schemaComposer.buildSchema();
-
-    const createResolvers = resolvers => {
-      Object.keys(resolvers).forEach(typeName => {
-        const fields = resolvers[typeName];
+const addCustomResolveFunctions = async ({
+  schemaComposer,
+  parentSpan
+}) => {
+  const intermediateSchema = schemaComposer.buildSchema();
 
-        if (schemaComposer.has(typeName)) {
-          const tc = schemaComposer.getOTC(typeName);
-          Object.keys(fields).forEach(fieldName => {
-            const fieldConfig = fields[fieldName];
+  const createResolvers = resolvers => {
+    Object.keys(resolvers).forEach(typeName => {
+      const fields = resolvers[typeName];
 
-            if (tc.hasField(fieldName)) {
-              const originalFieldConfig = tc.getFieldConfig(fieldName);
-              const originalTypeName = originalFieldConfig.type.toString();
-              const originalResolver = originalFieldConfig.resolve;
-              const fieldTypeName = fieldConfig.type && fieldConfig.type.toString();
+      if (schemaComposer.has(typeName)) {
+        const tc = schemaComposer.getOTC(typeName);
+        Object.keys(fields).forEach(fieldName => {
+          const fieldConfig = fields[fieldName];
 
-              if (!fieldTypeName || tc.getFieldType(fieldName) === fieldConfig.type.toString() || tc.getType().isThirdPartyType) {
-                const newConfig = {};
+          if (tc.hasField(fieldName)) {
+            const originalFieldConfig = tc.getFieldConfig(fieldName);
+            const originalTypeName = originalFieldConfig.type.toString();
+            const originalResolver = originalFieldConfig.resolve;
+            const fieldTypeName = fieldConfig.type && fieldConfig.type.toString();
 
-                if (fieldConfig.type) {
-                  newConfig.type = fieldConfig.type;
-                }
+            if (!fieldTypeName || fieldTypeName.replace(/!/g, ``) === originalTypeName.replace(/!/g, ``) || tc.getType().isThirdPartyType) {
+              const newConfig = {};
 
-                if (fieldConfig.args) {
-                  newConfig.args = fieldConfig.args;
-                }
+              if (fieldConfig.type) {
+                newConfig.type = fieldConfig.type;
+              }
 
-                if (fieldConfig.resolve) {
-                  newConfig.resolve = (source, args, context, info) => fieldConfig.resolve(source, args, context, Object.assign({}, info, {
-                    originalResolver: originalResolver || defaultFieldResolver
-                  }));
-                }
+              if (fieldConfig.args) {
+                newConfig.args = fieldConfig.args;
+              }
 
-                tc.extendField(fieldName, newConfig);
-              } else if (fieldTypeName) {
-                report.warn(`\`createResolvers\` passed resolvers for field ` + `\`${typeName}.${fieldName}\` with type \`${fieldTypeName}\`. ` + `Such a field with type \`${originalTypeName}\` already exists ` + `on the type. Use \`createTypes\` to override type fields.`);
+              if (fieldConfig.resolve) {
+                newConfig.resolve = (source, args, context, info) => fieldConfig.resolve(source, args, context, { ...info,
+                  originalResolver: originalResolver || defaultFieldResolver
+                });
               }
-            } else {
-              tc.addFields({
-                [fieldName]: fieldConfig
-              });
-            }
-          });
-        } else {
-          report.warn(`\`createResolvers\` passed resolvers for type \`${typeName}\` that ` + `doesn't exist in the schema. Use \`createTypes\` to add the type ` + `before adding resolvers.`);
-        }
-      });
-    };
 
-    yield apiRunner(`createResolvers`, {
-      schema: intermediateSchema,
-      createResolvers,
-      traceId: `initial-createResolvers`,
-      parentSpan: parentSpan
+              tc.extendField(fieldName, newConfig);
+            } else if (fieldTypeName) {
+              report.warn(`\`createResolvers\` passed resolvers for field ` + `\`${typeName}.${fieldName}\` with type \`${fieldTypeName}\`. ` + `Such a field with type \`${originalTypeName}\` already exists ` + `on the type. Use \`createTypes\` to override type fields.`);
+            }
+          } else {
+            tc.addFields({
+              [fieldName]: fieldConfig
+            });
+          }
+        });
+      } else {
+        report.warn(`\`createResolvers\` passed resolvers for type \`${typeName}\` that ` + `doesn't exist in the schema. Use \`createTypes\` to add the type ` + `before adding resolvers.`);
+      }
     });
-  });
-
-  return function addCustomResolveFunctions(_x6) {
-    return _ref6.apply(this, arguments);
   };
-}();
+
+  await apiRunner(`createResolvers`, {
+    schema: intermediateSchema,
+    createResolvers,
+    traceId: `initial-createResolvers`,
+    parentSpan: parentSpan
+  });
+};
 
 const addResolvers = ({
   schemaComposer,
@@ -518,7 +521,8 @@ const addResolvers = ({
   typeComposer.addResolver({
     name: `findOne`,
     type: typeComposer,
-    args: Object.assign({}, filterInputTC.getFields()),
+    args: { ...filterInputTC.getFields()
+    },
     resolve: findOne(typeName)
   });
   typeComposer.addResolver({
@@ -565,7 +569,9 @@ function createChildrenField(typeName) {
       type: () => [typeName],
 
       resolve(source, args, context) {
-        const path = context.path;
+        const {
+          path
+        } = context;
         return context.nodeModel.getNodesByIds({
           ids: source.children,
           type: typeName
@@ -583,22 +589,22 @@ function createChildField(typeName) {
     [_.camelCase(`child ${typeName}`)]: {
       type: () => typeName,
 
-      resolve(source, args, context) {
-        return (0, _asyncToGenerator2.default)(function* () {
-          const path = context.path;
-          const result = yield context.nodeModel.getNodesByIds({
-            ids: source.children,
-            type: typeName
-          }, {
-            path
-          });
-
-          if (result && result.length > 0) {
-            return result[0];
-          } else {
-            return null;
-          }
-        })();
+      async resolve(source, args, context) {
+        const {
+          path
+        } = context;
+        const result = await context.nodeModel.getNodesByIds({
+          ids: source.children,
+          type: typeName
+        }, {
+          path
+        });
+
+        if (result && result.length > 0) {
+          return result[0];
+        } else {
+          return null;
+        }
       }
 
     }
@@ -629,15 +635,18 @@ const addTypeToRootQuery = ({
 };
 
 const reportParsingError = error => {
-  const message = error.message,
-        source = error.source,
-        locations = error.locations;
+  const {
+    message,
+    source,
+    locations
+  } = error;
 
   if (source && locations && locations.length) {
     const report = require(`gatsby-cli/lib/reporter`);
 
-    const _require10 = require(`@babel/code-frame`),
-          codeFrameColumns = _require10.codeFrameColumns;
+    const {
+      codeFrameColumns
+    } = require(`@babel/code-frame`);
 
     const frame = codeFrameColumns(source.body, {
       start: locations[0]
diff --git a/node_modules/gatsby/dist/schema/schema.js.map b/node_modules/gatsby/dist/schema/schema.js.map
index b50dd30..394dae1 100644
--- a/node_modules/gatsby/dist/schema/schema.js.map
+++ b/node_modules/gatsby/dist/schema/schema.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/schema/schema.js"],"names":["_","require","invariant","isSpecifiedScalarType","isIntrospectionType","defaultFieldResolver","assertValidName","getNamedType","ObjectTypeComposer","InterfaceTypeComposer","UnionTypeComposer","InputTypeComposer","apiRunner","report","addNodeInterfaceFields","addInferredType","addInferredTypes","findOne","findManyPaginated","getPagination","getSortInput","getFilterInput","isGatsbyType","GatsbyGraphQLTypeKind","buildSchema","schemaComposer","nodeStore","types","thirdPartySchemas","typeMapping","typeConflictReporter","parentSpan","updateSchemaComposer","schema","rebuildSchemaWithSitePage","typeComposer","getOTC","processTypeComposer","module","exports","addTypes","addSetFieldsOnGraphQLNodeTypeFields","Promise","all","Array","from","values","map","addThirdPartySchemas","addCustomResolveFunctions","hasInterface","addResolvers","addConvenienceChildrenFields","addTypeToRootQuery","forEach","typeOrTypeDef","addedTypes","addTypeDefs","error","reportParsingError","type","processAddedType","createTypeComposerFromGatsbyType","typeName","addAsComposer","checkIsAllowedTypeName","get","getResolveType","setResolveType","node","internal","addSchemaMustHaveType","name","endsWith","includes","kind","OBJECT","createTemp","config","interfaces","iface","getIFTC","getType","INPUT_OBJECT","UNION","INTERFACE","console","warn","JSON","stringify","tc","getTypeName","result","nodes","getNodesByType","traceId","fields","addNestedFields","schemaQueryType","getQueryType","queryTC","processThirdPartyType","getFields","Query","addFields","getTypeMap","Object","keys","getAnyTC","isThirdPartyType","getFieldNames","fieldName","fieldType","getFieldType","extendField","toString","replace","intermediateSchema","createResolvers","resolvers","has","fieldConfig","hasField","originalFieldConfig","getFieldConfig","originalTypeName","originalResolver","resolve","fieldTypeName","newConfig","args","source","context","info","removeInputTypeComposer","sortInputTC","filterInputTC","paginationTC","addResolver","filter","sort","skip","limit","childNodesByType","groupChildNodesByType","typeChildren","maxChildCount","maxBy","groupBy","c","parent","g","length","createChildrenField","createChildField","camelCase","path","nodeModel","getNodesByIds","ids","children","flatMap","getNode","undefined","value","queryName","queryNamePlural","getResolver","message","locations","codeFrameColumns","frame","body","start","linesAbove","linesBelow","panic"],"mappings":"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","sourcesContent":["const _ = require(`lodash`)\nconst invariant = require(`invariant`)\nconst {\n  isSpecifiedScalarType,\n  isIntrospectionType,\n  defaultFieldResolver,\n  assertValidName,\n  getNamedType,\n} = require(`graphql`)\nconst {\n  ObjectTypeComposer,\n  InterfaceTypeComposer,\n  UnionTypeComposer,\n  InputTypeComposer,\n} = require(`graphql-compose`)\nconst apiRunner = require(`../utils/api-runner-node`)\nconst report = require(`gatsby-cli/lib/reporter`)\nconst { addNodeInterfaceFields } = require(`./types/node-interface`)\nconst { addInferredType, addInferredTypes } = require(`./infer`)\nconst { findOne, findManyPaginated } = require(`./resolvers`)\nconst { getPagination } = require(`./types/pagination`)\nconst { getSortInput } = require(`./types/sort`)\nconst { getFilterInput } = require(`./types/filter`)\nconst { isGatsbyType, GatsbyGraphQLTypeKind } = require(`./types/type-builders`)\n\nconst buildSchema = async ({\n  schemaComposer,\n  nodeStore,\n  types,\n  thirdPartySchemas,\n  typeMapping,\n  typeConflictReporter,\n  parentSpan,\n}) => {\n  await updateSchemaComposer({\n    schemaComposer,\n    nodeStore,\n    types,\n    thirdPartySchemas,\n    typeMapping,\n    typeConflictReporter,\n    parentSpan,\n  })\n  // const { printSchema } = require(`graphql`)\n  const schema = schemaComposer.buildSchema()\n  // console.log(printSchema(schema))\n  return schema\n}\n\nconst rebuildSchemaWithSitePage = async ({\n  schemaComposer,\n  nodeStore,\n  typeMapping,\n  typeConflictReporter,\n  parentSpan,\n}) => {\n  const typeComposer = addInferredType({\n    schemaComposer,\n    typeComposer: schemaComposer.getOTC(`SitePage`),\n    nodeStore,\n    typeConflictReporter,\n    typeMapping,\n    parentSpan,\n  })\n  await processTypeComposer({\n    schemaComposer,\n    typeComposer,\n    nodeStore,\n    parentSpan,\n  })\n  return schemaComposer.buildSchema()\n}\n\nmodule.exports = {\n  buildSchema,\n  rebuildSchemaWithSitePage,\n}\n\nconst updateSchemaComposer = async ({\n  schemaComposer,\n  nodeStore,\n  types,\n  typeMapping,\n  thirdPartySchemas,\n  typeConflictReporter,\n  parentSpan,\n}) => {\n  await addTypes({ schemaComposer, parentSpan, types })\n  await addInferredTypes({\n    schemaComposer,\n    nodeStore,\n    typeConflictReporter,\n    typeMapping,\n    parentSpan,\n  })\n  await addSetFieldsOnGraphQLNodeTypeFields({\n    schemaComposer,\n    nodeStore,\n    parentSpan,\n  })\n  await Promise.all(\n    Array.from(schemaComposer.values()).map(typeComposer =>\n      processTypeComposer({\n        schemaComposer,\n        typeComposer,\n        nodeStore,\n        parentSpan,\n      })\n    )\n  )\n  await addThirdPartySchemas({ schemaComposer, thirdPartySchemas, parentSpan })\n  await addCustomResolveFunctions({ schemaComposer, parentSpan })\n}\n\nconst processTypeComposer = async ({\n  schemaComposer,\n  typeComposer,\n  nodeStore,\n  parentSpan,\n}) => {\n  if (\n    typeComposer instanceof ObjectTypeComposer &&\n    typeComposer.hasInterface(`Node`)\n  ) {\n    await addNodeInterfaceFields({ schemaComposer, typeComposer, parentSpan })\n    await addResolvers({ schemaComposer, typeComposer, parentSpan })\n    await addConvenienceChildrenFields({\n      schemaComposer,\n      typeComposer,\n      nodeStore,\n      parentSpan,\n    })\n    await addTypeToRootQuery({ schemaComposer, typeComposer, parentSpan })\n  }\n}\n\nconst addTypes = ({ schemaComposer, types, parentSpan }) => {\n  types.forEach(typeOrTypeDef => {\n    if (typeof typeOrTypeDef === `string`) {\n      let addedTypes\n      try {\n        addedTypes = schemaComposer.addTypeDefs(typeOrTypeDef)\n      } catch (error) {\n        reportParsingError(error)\n      }\n      addedTypes.forEach(type =>\n        processAddedType({ schemaComposer, type, parentSpan })\n      )\n    } else if (isGatsbyType(typeOrTypeDef)) {\n      const type = createTypeComposerFromGatsbyType({\n        schemaComposer,\n        type: typeOrTypeDef,\n        parentSpan,\n      })\n      if (type) {\n        processAddedType({ schemaComposer, type, parentSpan })\n      }\n    } else {\n      processAddedType({ schemaComposer, type: typeOrTypeDef, parentSpan })\n    }\n  })\n}\n\nconst processAddedType = ({ schemaComposer, type, parentSpan }) => {\n  const typeName = schemaComposer.addAsComposer(type)\n  checkIsAllowedTypeName(typeName)\n  const typeComposer = schemaComposer.get(typeName)\n  if (\n    typeComposer instanceof InterfaceTypeComposer ||\n    typeComposer instanceof UnionTypeComposer\n  ) {\n    if (!typeComposer.getResolveType()) {\n      typeComposer.setResolveType(node => node.internal.type)\n    }\n  }\n  schemaComposer.addSchemaMustHaveType(typeComposer)\n}\n\nconst checkIsAllowedTypeName = name => {\n  invariant(\n    name !== `Node`,\n    `The GraphQL type \\`Node\\` is reserved for internal use.`\n  )\n  invariant(\n    !name.endsWith(`FilterInput`) && !name.endsWith(`SortInput`),\n    `GraphQL type names ending with \"FilterInput\" or \"SortInput\" are ` +\n      `reserved for internal use. Please rename \\`${name}\\`.`\n  )\n  invariant(\n    ![`Boolean`, `Date`, `Float`, `ID`, `Int`, `JSON`, `String`].includes(name),\n    `The GraphQL type \\`${name}\\` is reserved for internal use by ` +\n      `built-in scalar types.`\n  )\n  assertValidName(name)\n}\n\nconst createTypeComposerFromGatsbyType = ({\n  schemaComposer,\n  type,\n  parentSpan,\n}) => {\n  switch (type.kind) {\n    case GatsbyGraphQLTypeKind.OBJECT: {\n      return ObjectTypeComposer.createTemp(\n        {\n          ...type.config,\n          interfaces: () => {\n            if (type.config.interfaces) {\n              return type.config.interfaces.map(iface => {\n                if (typeof iface === `string`) {\n                  return schemaComposer.getIFTC(iface).getType()\n                } else {\n                  return iface\n                }\n              })\n            } else {\n              return []\n            }\n          },\n        },\n        schemaComposer\n      )\n    }\n    case GatsbyGraphQLTypeKind.INPUT_OBJECT: {\n      return InputTypeComposer.createTemp(type.config, schemaComposer)\n    }\n    case GatsbyGraphQLTypeKind.UNION: {\n      return UnionTypeComposer.createTemp(\n        {\n          ...type.config,\n          types: () => {\n            if (type.types) {\n              return type.types.map(typeName =>\n                schemaComposer.getOTC(typeName).getType()\n              )\n            } else {\n              return []\n            }\n          },\n        },\n        schemaComposer\n      )\n    }\n    case GatsbyGraphQLTypeKind.INTERFACE: {\n      return InterfaceTypeComposer.createTemp(type.config, schemaComposer)\n    }\n    default: {\n      console.warn(`Illegal type definition: ${JSON.stringify(type.config)}`)\n      return null\n    }\n  }\n}\n\nconst addSetFieldsOnGraphQLNodeTypeFields = ({\n  schemaComposer,\n  nodeStore,\n  parentSpan,\n}) =>\n  Promise.all(\n    Array.from(schemaComposer.values()).map(async tc => {\n      if (tc instanceof ObjectTypeComposer && tc.hasInterface(`Node`)) {\n        const typeName = tc.getTypeName()\n        const result = await apiRunner(`setFieldsOnGraphQLNodeType`, {\n          type: {\n            name: typeName,\n            nodes: nodeStore.getNodesByType(typeName),\n          },\n          traceId: `initial-setFieldsOnGraphQLNodeType`,\n          parentSpan: parentSpan,\n        })\n        if (result) {\n          // NOTE: `setFieldsOnGraphQLNodeType` only allows setting\n          // nested fields with a path as property name, i.e.\n          // `{ 'frontmatter.published': 'Boolean' }`, but not in the form\n          // `{ frontmatter: { published: 'Boolean' }}`\n          result.forEach(fields => tc.addNestedFields(fields))\n        }\n      }\n    })\n  )\n\nconst addThirdPartySchemas = ({\n  schemaComposer,\n  thirdPartySchemas,\n  parentSpan,\n}) => {\n  thirdPartySchemas.forEach(schema => {\n    const schemaQueryType = schema.getQueryType()\n    const queryTC = ObjectTypeComposer.createTemp(schemaQueryType)\n    processThirdPartyType({\n      schemaComposer,\n      typeComposer: queryTC,\n      schemaQueryType,\n    })\n    const fields = queryTC.getFields()\n    schemaComposer.Query.addFields(fields)\n\n    // Explicitly add the third-party schema's types, so they can be targeted\n    // in `createResolvers` API.\n    const types = schema.getTypeMap()\n    Object.keys(types).forEach(typeName => {\n      const type = types[typeName]\n      if (\n        type !== schemaQueryType &&\n        !isSpecifiedScalarType(type) &&\n        !isIntrospectionType(type)\n      ) {\n        schemaComposer.addAsComposer(type)\n        const typeComposer = schemaComposer.getAnyTC(type.name)\n        processThirdPartyType({ schemaComposer, typeComposer, schemaQueryType })\n        schemaComposer.addSchemaMustHaveType(typeComposer)\n      }\n    })\n  })\n}\n\nconst processThirdPartyType = ({\n  schemaComposer,\n  typeComposer,\n  schemaQueryType,\n}) => {\n  typeComposer.getType().isThirdPartyType = true\n  // Fix for types that refer to Query. Thanks Relay Classic!\n  if (\n    typeComposer instanceof ObjectTypeComposer ||\n    typeComposer instanceof InterfaceTypeComposer\n  ) {\n    typeComposer.getFieldNames().forEach(fieldName => {\n      const fieldType = typeComposer.getFieldType(fieldName)\n      if (getNamedType(fieldType) === schemaQueryType) {\n        typeComposer.extendField(fieldName, {\n          type: fieldType.toString().replace(schemaQueryType.name, `Query`),\n        })\n      }\n    })\n  }\n  return typeComposer\n}\n\nconst addCustomResolveFunctions = async ({ schemaComposer, parentSpan }) => {\n  const intermediateSchema = schemaComposer.buildSchema()\n  const createResolvers = resolvers => {\n    Object.keys(resolvers).forEach(typeName => {\n      const fields = resolvers[typeName]\n      if (schemaComposer.has(typeName)) {\n        const tc = schemaComposer.getOTC(typeName)\n        Object.keys(fields).forEach(fieldName => {\n          const fieldConfig = fields[fieldName]\n          if (tc.hasField(fieldName)) {\n            const originalFieldConfig = tc.getFieldConfig(fieldName)\n            const originalTypeName = originalFieldConfig.type.toString()\n            const originalResolver = originalFieldConfig.resolve\n            const fieldTypeName =\n              fieldConfig.type && fieldConfig.type.toString()\n            if (\n              !fieldTypeName ||\n              tc.getFieldType(fieldName) === fieldConfig.type.toString() ||\n              tc.getType().isThirdPartyType\n            ) {\n              const newConfig = {}\n              if (fieldConfig.type) {\n                newConfig.type = fieldConfig.type\n              }\n              if (fieldConfig.args) {\n                newConfig.args = fieldConfig.args\n              }\n              if (fieldConfig.resolve) {\n                newConfig.resolve = (source, args, context, info) =>\n                  fieldConfig.resolve(source, args, context, {\n                    ...info,\n                    originalResolver: originalResolver || defaultFieldResolver,\n                  })\n              }\n              tc.extendField(fieldName, newConfig)\n            } else if (fieldTypeName) {\n              report.warn(\n                `\\`createResolvers\\` passed resolvers for field ` +\n                  `\\`${typeName}.${fieldName}\\` with type \\`${fieldTypeName}\\`. ` +\n                  `Such a field with type \\`${originalTypeName}\\` already exists ` +\n                  `on the type. Use \\`createTypes\\` to override type fields.`\n              )\n            }\n          } else {\n            tc.addFields({ [fieldName]: fieldConfig })\n          }\n        })\n      } else {\n        report.warn(\n          `\\`createResolvers\\` passed resolvers for type \\`${typeName}\\` that ` +\n            `doesn't exist in the schema. Use \\`createTypes\\` to add the type ` +\n            `before adding resolvers.`\n        )\n      }\n    })\n  }\n  await apiRunner(`createResolvers`, {\n    schema: intermediateSchema,\n    createResolvers,\n    traceId: `initial-createResolvers`,\n    parentSpan: parentSpan,\n  })\n}\n\nconst addResolvers = ({ schemaComposer, typeComposer }) => {\n  const typeName = typeComposer.getTypeName()\n\n  // TODO: We should have an abstraction for keeping and clearing\n  // related TypeComposers and InputTypeComposers.\n  // Also see the comment on the skipped test in `rebuild-schema`.\n  typeComposer.removeInputTypeComposer()\n\n  const sortInputTC = getSortInput({\n    schemaComposer,\n    typeComposer,\n  })\n  const filterInputTC = getFilterInput({\n    schemaComposer,\n    typeComposer,\n  })\n  const paginationTC = getPagination({\n    schemaComposer,\n    typeComposer,\n  })\n  typeComposer.addResolver({\n    name: `findOne`,\n    type: typeComposer,\n    args: {\n      ...filterInputTC.getFields(),\n    },\n    resolve: findOne(typeName),\n  })\n  typeComposer.addResolver({\n    name: `findManyPaginated`,\n    type: paginationTC,\n    args: {\n      filter: filterInputTC,\n      sort: sortInputTC,\n      skip: `Int`,\n      limit: `Int`,\n      // page: `Int`,\n      // perPage: { type: `Int`, defaultValue: 20 },\n    },\n    resolve: findManyPaginated(typeName),\n  })\n}\n\nconst addConvenienceChildrenFields = ({\n  schemaComposer,\n  typeComposer,\n  nodeStore,\n}) => {\n  const nodes = nodeStore.getNodesByType(typeComposer.getTypeName())\n\n  const childNodesByType = groupChildNodesByType({ nodeStore, nodes })\n\n  Object.keys(childNodesByType).forEach(typeName => {\n    const typeChildren = childNodesByType[typeName]\n    const maxChildCount = _.maxBy(\n      _.values(_.groupBy(typeChildren, c => c.parent)),\n      g => g.length\n    ).length\n\n    if (maxChildCount > 1) {\n      typeComposer.addFields(createChildrenField(typeName))\n    } else {\n      typeComposer.addFields(createChildField(typeName))\n    }\n  })\n}\n\nfunction createChildrenField(typeName) {\n  return {\n    [_.camelCase(`children ${typeName}`)]: {\n      type: () => [typeName],\n      resolve(source, args, context) {\n        const { path } = context\n        return context.nodeModel.getNodesByIds(\n          { ids: source.children, type: typeName },\n          { path }\n        )\n      },\n    },\n  }\n}\n\nfunction createChildField(typeName) {\n  return {\n    [_.camelCase(`child ${typeName}`)]: {\n      type: () => typeName,\n      async resolve(source, args, context) {\n        const { path } = context\n        const result = await context.nodeModel.getNodesByIds(\n          { ids: source.children, type: typeName },\n          { path }\n        )\n        if (result && result.length > 0) {\n          return result[0]\n        } else {\n          return null\n        }\n      },\n    },\n  }\n}\n\nfunction groupChildNodesByType({ nodeStore, nodes }) {\n  return _(nodes)\n    .flatMap(node => (node.children || []).map(nodeStore.getNode))\n    .groupBy(node => (node.internal ? node.internal.type : undefined))\n    .value()\n}\n\nconst addTypeToRootQuery = ({ schemaComposer, typeComposer }) => {\n  const typeName = typeComposer.getTypeName()\n  // not strictly correctly, result is `npmPackage` and `allNpmPackage` from type `NPMPackage`\n  const queryName = _.camelCase(typeName)\n  const queryNamePlural = _.camelCase(`all ${typeName}`)\n  schemaComposer.Query.addFields({\n    [queryName]: typeComposer.getResolver(`findOne`),\n    [queryNamePlural]: typeComposer.getResolver(`findManyPaginated`),\n  })\n}\n\nconst reportParsingError = error => {\n  const { message, source, locations } = error\n\n  if (source && locations && locations.length) {\n    const report = require(`gatsby-cli/lib/reporter`)\n    const { codeFrameColumns } = require(`@babel/code-frame`)\n\n    const frame = codeFrameColumns(\n      source.body,\n      { start: locations[0] },\n      { linesAbove: 5, linesBelow: 5 }\n    )\n    report.panic(\n      `Encountered an error parsing the provided GraphQL type definitions:\\n` +\n        message +\n        `\\n\\n` +\n        frame +\n        `\\n`\n    )\n  } else {\n    throw error\n  }\n}\n"],"file":"schema.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/schema/schema.js"],"names":["_","require","invariant","isSpecifiedScalarType","isIntrospectionType","defaultFieldResolver","assertValidName","getNamedType","Kind","ObjectTypeComposer","InterfaceTypeComposer","UnionTypeComposer","InputTypeComposer","apiRunner","report","addNodeInterfaceFields","addInferredType","addInferredTypes","findOne","findManyPaginated","getPagination","getSortInput","getFilterInput","isGatsbyType","GatsbyGraphQLTypeKind","buildSchema","schemaComposer","nodeStore","types","thirdPartySchemas","typeMapping","typeConflictReporter","parentSpan","updateSchemaComposer","schema","rebuildSchemaWithSitePage","typeComposer","getOTC","processTypeComposer","module","exports","addTypes","addSetFieldsOnGraphQLNodeTypeFields","Promise","all","Array","from","values","map","addThirdPartySchemas","addCustomResolveFunctions","hasInterface","addResolvers","addConvenienceChildrenFields","addTypeToRootQuery","forEach","typeOrTypeDef","plugin","addedTypes","addTypeDefs","error","reportParsingError","type","processAddedType","createdFrom","createTypeComposerFromGatsbyType","typeName","addAsComposer","checkIsAllowedTypeName","get","getResolveType","setResolveType","node","internal","addSchemaMustHaveType","setExtension","name","astNode","directives","directive","value","getNoDefaultResolvers","noDefaultResolvers","arguments","find","kind","BOOLEAN","endsWith","includes","OBJECT","createTemp","config","interfaces","iface","getIFTC","getType","INPUT_OBJECT","UNION","INTERFACE","warn","JSON","stringify","tc","getTypeName","result","nodes","getNodesByType","traceId","fields","addNestedFields","schemaQueryType","getQueryType","queryTC","processThirdPartyType","getFields","Query","addFields","getTypeMap","Object","keys","getAnyTC","isThirdPartyType","getFieldNames","fieldName","fieldType","getFieldType","extendField","toString","replace","intermediateSchema","createResolvers","resolvers","has","fieldConfig","hasField","originalFieldConfig","getFieldConfig","originalTypeName","originalResolver","resolve","fieldTypeName","newConfig","args","source","context","info","removeInputTypeComposer","sortInputTC","filterInputTC","paginationTC","addResolver","filter","sort","skip","limit","childNodesByType","groupChildNodesByType","typeChildren","maxChildCount","maxBy","groupBy","c","parent","g","length","createChildrenField","createChildField","camelCase","path","nodeModel","getNodesByIds","ids","children","flatMap","getNode","undefined","queryName","queryNamePlural","getResolver","message","locations","codeFrameColumns","frame","body","start","linesAbove","linesBelow","panic"],"mappings":"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","sourcesContent":["const _ = require(`lodash`)\nconst invariant = require(`invariant`)\nconst {\n  isSpecifiedScalarType,\n  isIntrospectionType,\n  defaultFieldResolver,\n  assertValidName,\n  getNamedType,\n  Kind,\n} = require(`graphql`)\nconst {\n  ObjectTypeComposer,\n  InterfaceTypeComposer,\n  UnionTypeComposer,\n  InputTypeComposer,\n} = require(`graphql-compose`)\nconst apiRunner = require(`../utils/api-runner-node`)\nconst report = require(`gatsby-cli/lib/reporter`)\nconst { addNodeInterfaceFields } = require(`./types/node-interface`)\nconst { addInferredType, addInferredTypes } = require(`./infer`)\nconst { findOne, findManyPaginated } = require(`./resolvers`)\nconst { getPagination } = require(`./types/pagination`)\nconst { getSortInput } = require(`./types/sort`)\nconst { getFilterInput } = require(`./types/filter`)\nconst { isGatsbyType, GatsbyGraphQLTypeKind } = require(`./types/type-builders`)\n\nconst buildSchema = async ({\n  schemaComposer,\n  nodeStore,\n  types,\n  thirdPartySchemas,\n  typeMapping,\n  typeConflictReporter,\n  parentSpan,\n}) => {\n  await updateSchemaComposer({\n    schemaComposer,\n    nodeStore,\n    types,\n    thirdPartySchemas,\n    typeMapping,\n    typeConflictReporter,\n    parentSpan,\n  })\n  // const { printSchema } = require(`graphql`)\n  const schema = schemaComposer.buildSchema()\n  // console.log(printSchema(schema))\n  return schema\n}\n\nconst rebuildSchemaWithSitePage = async ({\n  schemaComposer,\n  nodeStore,\n  typeMapping,\n  typeConflictReporter,\n  parentSpan,\n}) => {\n  const typeComposer = addInferredType({\n    schemaComposer,\n    typeComposer: schemaComposer.getOTC(`SitePage`),\n    nodeStore,\n    typeConflictReporter,\n    typeMapping,\n    parentSpan,\n  })\n  await processTypeComposer({\n    schemaComposer,\n    typeComposer,\n    nodeStore,\n    parentSpan,\n  })\n  return schemaComposer.buildSchema()\n}\n\nmodule.exports = {\n  buildSchema,\n  rebuildSchemaWithSitePage,\n}\n\nconst updateSchemaComposer = async ({\n  schemaComposer,\n  nodeStore,\n  types,\n  typeMapping,\n  thirdPartySchemas,\n  typeConflictReporter,\n  parentSpan,\n}) => {\n  await addTypes({ schemaComposer, parentSpan, types })\n  await addInferredTypes({\n    schemaComposer,\n    nodeStore,\n    typeConflictReporter,\n    typeMapping,\n    parentSpan,\n  })\n  await addSetFieldsOnGraphQLNodeTypeFields({\n    schemaComposer,\n    nodeStore,\n    parentSpan,\n  })\n  await Promise.all(\n    Array.from(schemaComposer.values()).map(typeComposer =>\n      processTypeComposer({\n        schemaComposer,\n        typeComposer,\n        nodeStore,\n        parentSpan,\n      })\n    )\n  )\n  await addThirdPartySchemas({ schemaComposer, thirdPartySchemas, parentSpan })\n  await addCustomResolveFunctions({ schemaComposer, parentSpan })\n}\n\nconst processTypeComposer = async ({\n  schemaComposer,\n  typeComposer,\n  nodeStore,\n  parentSpan,\n}) => {\n  if (\n    typeComposer instanceof ObjectTypeComposer &&\n    typeComposer.hasInterface(`Node`)\n  ) {\n    await addNodeInterfaceFields({ schemaComposer, typeComposer, parentSpan })\n    await addResolvers({ schemaComposer, typeComposer, parentSpan })\n    await addConvenienceChildrenFields({\n      schemaComposer,\n      typeComposer,\n      nodeStore,\n      parentSpan,\n    })\n    await addTypeToRootQuery({ schemaComposer, typeComposer, parentSpan })\n  }\n}\n\nconst addTypes = ({ schemaComposer, types, parentSpan }) => {\n  types.forEach(({ typeOrTypeDef, plugin }) => {\n    if (typeof typeOrTypeDef === `string`) {\n      let addedTypes\n      try {\n        addedTypes = schemaComposer.addTypeDefs(typeOrTypeDef)\n      } catch (error) {\n        reportParsingError(error)\n      }\n      addedTypes.forEach(type => {\n        processAddedType({\n          schemaComposer,\n          type,\n          parentSpan,\n          createdFrom: `sdl`,\n          plugin,\n        })\n      })\n    } else if (isGatsbyType(typeOrTypeDef)) {\n      const type = createTypeComposerFromGatsbyType({\n        schemaComposer,\n        type: typeOrTypeDef,\n        parentSpan,\n      })\n\n      if (type) {\n        processAddedType({\n          schemaComposer,\n          type,\n          parentSpan,\n          createdFrom: `typeBuilder`,\n          plugin,\n        })\n      }\n    } else {\n      processAddedType({\n        schemaComposer,\n        type: typeOrTypeDef,\n        parentSpan,\n        createdFrom: `graphql-js`,\n        plugin,\n      })\n    }\n  })\n}\n\nconst processAddedType = ({\n  schemaComposer,\n  type,\n  parentSpan,\n  createdFrom,\n  plugin,\n}) => {\n  const typeName = schemaComposer.addAsComposer(type)\n  checkIsAllowedTypeName(typeName)\n  const typeComposer = schemaComposer.get(typeName)\n  if (\n    typeComposer instanceof InterfaceTypeComposer ||\n    typeComposer instanceof UnionTypeComposer\n  ) {\n    if (!typeComposer.getResolveType()) {\n      typeComposer.setResolveType(node => node.internal.type)\n    }\n  }\n  schemaComposer.addSchemaMustHaveType(typeComposer)\n\n  typeComposer.setExtension(`createdFrom`, createdFrom)\n  typeComposer.setExtension(`plugin`, plugin ? plugin.name : null)\n\n  if (createdFrom === `sdl`) {\n    if (type.astNode && type.astNode.directives) {\n      type.astNode.directives.forEach(directive => {\n        if (directive.name.value === `infer`) {\n          typeComposer.setExtension(`infer`, true)\n          typeComposer.setExtension(\n            `addDefaultResolvers`,\n            getNoDefaultResolvers(directive)\n          )\n        } else if (directive.name.value === `dontInfer`) {\n          typeComposer.setExtension(`infer`, false)\n          typeComposer.setExtension(\n            `addDefaultResolvers`,\n            getNoDefaultResolvers(directive)\n          )\n        }\n      })\n    }\n  }\n\n  return typeComposer\n}\n\nconst getNoDefaultResolvers = directive => {\n  const noDefaultResolvers = directive.arguments.find(\n    ({ name }) => name.value === `noDefaultResolvers`\n  )\n  if (noDefaultResolvers) {\n    if (noDefaultResolvers.value.kind === Kind.BOOLEAN) {\n      return !noDefaultResolvers.value.value\n    }\n  }\n\n  return null\n}\n\nconst checkIsAllowedTypeName = name => {\n  invariant(\n    name !== `Node`,\n    `The GraphQL type \\`Node\\` is reserved for internal use.`\n  )\n  invariant(\n    !name.endsWith(`FilterInput`) && !name.endsWith(`SortInput`),\n    `GraphQL type names ending with \"FilterInput\" or \"SortInput\" are ` +\n      `reserved for internal use. Please rename \\`${name}\\`.`\n  )\n  invariant(\n    ![`Boolean`, `Date`, `Float`, `ID`, `Int`, `JSON`, `String`].includes(name),\n    `The GraphQL type \\`${name}\\` is reserved for internal use by ` +\n      `built-in scalar types.`\n  )\n  assertValidName(name)\n}\n\nconst createTypeComposerFromGatsbyType = ({\n  schemaComposer,\n  type,\n  parentSpan,\n}) => {\n  switch (type.kind) {\n    case GatsbyGraphQLTypeKind.OBJECT: {\n      return ObjectTypeComposer.createTemp(\n        {\n          ...type.config,\n          interfaces: () => {\n            if (type.config.interfaces) {\n              return type.config.interfaces.map(iface => {\n                if (typeof iface === `string`) {\n                  return schemaComposer.getIFTC(iface).getType()\n                } else {\n                  return iface\n                }\n              })\n            } else {\n              return []\n            }\n          },\n        },\n        schemaComposer\n      )\n    }\n    case GatsbyGraphQLTypeKind.INPUT_OBJECT: {\n      return InputTypeComposer.createTemp(type.config, schemaComposer)\n    }\n    case GatsbyGraphQLTypeKind.UNION: {\n      return UnionTypeComposer.createTemp(\n        {\n          ...type.config,\n          types: () => {\n            if (type.config.types) {\n              return type.config.types.map(typeName =>\n                schemaComposer.getOTC(typeName).getType()\n              )\n            } else {\n              return []\n            }\n          },\n        },\n        schemaComposer\n      )\n    }\n    case GatsbyGraphQLTypeKind.INTERFACE: {\n      return InterfaceTypeComposer.createTemp(type.config, schemaComposer)\n    }\n    default: {\n      report.warn(`Illegal type definition: ${JSON.stringify(type.config)}`)\n      return null\n    }\n  }\n}\n\nconst addSetFieldsOnGraphQLNodeTypeFields = ({\n  schemaComposer,\n  nodeStore,\n  parentSpan,\n}) =>\n  Promise.all(\n    Array.from(schemaComposer.values()).map(async tc => {\n      if (tc instanceof ObjectTypeComposer && tc.hasInterface(`Node`)) {\n        const typeName = tc.getTypeName()\n        const result = await apiRunner(`setFieldsOnGraphQLNodeType`, {\n          type: {\n            name: typeName,\n            nodes: nodeStore.getNodesByType(typeName),\n          },\n          traceId: `initial-setFieldsOnGraphQLNodeType`,\n          parentSpan: parentSpan,\n        })\n        if (result) {\n          // NOTE: `setFieldsOnGraphQLNodeType` only allows setting\n          // nested fields with a path as property name, i.e.\n          // `{ 'frontmatter.published': 'Boolean' }`, but not in the form\n          // `{ frontmatter: { published: 'Boolean' }}`\n          result.forEach(fields => tc.addNestedFields(fields))\n        }\n      }\n    })\n  )\n\nconst addThirdPartySchemas = ({\n  schemaComposer,\n  thirdPartySchemas,\n  parentSpan,\n}) => {\n  thirdPartySchemas.forEach(schema => {\n    const schemaQueryType = schema.getQueryType()\n    const queryTC = ObjectTypeComposer.createTemp(schemaQueryType)\n    processThirdPartyType({\n      schemaComposer,\n      typeComposer: queryTC,\n      schemaQueryType,\n    })\n    const fields = queryTC.getFields()\n    schemaComposer.Query.addFields(fields)\n\n    // Explicitly add the third-party schema's types, so they can be targeted\n    // in `createResolvers` API.\n    const types = schema.getTypeMap()\n    Object.keys(types).forEach(typeName => {\n      const type = types[typeName]\n      if (\n        type !== schemaQueryType &&\n        !isSpecifiedScalarType(type) &&\n        !isIntrospectionType(type)\n      ) {\n        schemaComposer.addAsComposer(type)\n        const typeComposer = schemaComposer.getAnyTC(type.name)\n        processThirdPartyType({ schemaComposer, typeComposer, schemaQueryType })\n        schemaComposer.addSchemaMustHaveType(typeComposer)\n      }\n    })\n  })\n}\n\nconst processThirdPartyType = ({\n  schemaComposer,\n  typeComposer,\n  schemaQueryType,\n}) => {\n  typeComposer.getType().isThirdPartyType = true\n  // Fix for types that refer to Query. Thanks Relay Classic!\n  if (\n    typeComposer instanceof ObjectTypeComposer ||\n    typeComposer instanceof InterfaceTypeComposer\n  ) {\n    typeComposer.getFieldNames().forEach(fieldName => {\n      const fieldType = typeComposer.getFieldType(fieldName)\n      if (getNamedType(fieldType) === schemaQueryType) {\n        typeComposer.extendField(fieldName, {\n          type: fieldType.toString().replace(schemaQueryType.name, `Query`),\n        })\n      }\n    })\n  }\n  return typeComposer\n}\n\nconst addCustomResolveFunctions = async ({ schemaComposer, parentSpan }) => {\n  const intermediateSchema = schemaComposer.buildSchema()\n  const createResolvers = resolvers => {\n    Object.keys(resolvers).forEach(typeName => {\n      const fields = resolvers[typeName]\n      if (schemaComposer.has(typeName)) {\n        const tc = schemaComposer.getOTC(typeName)\n        Object.keys(fields).forEach(fieldName => {\n          const fieldConfig = fields[fieldName]\n          if (tc.hasField(fieldName)) {\n            const originalFieldConfig = tc.getFieldConfig(fieldName)\n            const originalTypeName = originalFieldConfig.type.toString()\n            const originalResolver = originalFieldConfig.resolve\n            const fieldTypeName =\n              fieldConfig.type && fieldConfig.type.toString()\n            if (\n              !fieldTypeName ||\n              fieldTypeName.replace(/!/g, ``) ===\n                originalTypeName.replace(/!/g, ``) ||\n              tc.getType().isThirdPartyType\n            ) {\n              const newConfig = {}\n              if (fieldConfig.type) {\n                newConfig.type = fieldConfig.type\n              }\n              if (fieldConfig.args) {\n                newConfig.args = fieldConfig.args\n              }\n              if (fieldConfig.resolve) {\n                newConfig.resolve = (source, args, context, info) =>\n                  fieldConfig.resolve(source, args, context, {\n                    ...info,\n                    originalResolver: originalResolver || defaultFieldResolver,\n                  })\n              }\n              tc.extendField(fieldName, newConfig)\n            } else if (fieldTypeName) {\n              report.warn(\n                `\\`createResolvers\\` passed resolvers for field ` +\n                  `\\`${typeName}.${fieldName}\\` with type \\`${fieldTypeName}\\`. ` +\n                  `Such a field with type \\`${originalTypeName}\\` already exists ` +\n                  `on the type. Use \\`createTypes\\` to override type fields.`\n              )\n            }\n          } else {\n            tc.addFields({ [fieldName]: fieldConfig })\n          }\n        })\n      } else {\n        report.warn(\n          `\\`createResolvers\\` passed resolvers for type \\`${typeName}\\` that ` +\n            `doesn't exist in the schema. Use \\`createTypes\\` to add the type ` +\n            `before adding resolvers.`\n        )\n      }\n    })\n  }\n  await apiRunner(`createResolvers`, {\n    schema: intermediateSchema,\n    createResolvers,\n    traceId: `initial-createResolvers`,\n    parentSpan: parentSpan,\n  })\n}\n\nconst addResolvers = ({ schemaComposer, typeComposer }) => {\n  const typeName = typeComposer.getTypeName()\n\n  // TODO: We should have an abstraction for keeping and clearing\n  // related TypeComposers and InputTypeComposers.\n  // Also see the comment on the skipped test in `rebuild-schema`.\n  typeComposer.removeInputTypeComposer()\n\n  const sortInputTC = getSortInput({\n    schemaComposer,\n    typeComposer,\n  })\n  const filterInputTC = getFilterInput({\n    schemaComposer,\n    typeComposer,\n  })\n  const paginationTC = getPagination({\n    schemaComposer,\n    typeComposer,\n  })\n  typeComposer.addResolver({\n    name: `findOne`,\n    type: typeComposer,\n    args: {\n      ...filterInputTC.getFields(),\n    },\n    resolve: findOne(typeName),\n  })\n  typeComposer.addResolver({\n    name: `findManyPaginated`,\n    type: paginationTC,\n    args: {\n      filter: filterInputTC,\n      sort: sortInputTC,\n      skip: `Int`,\n      limit: `Int`,\n      // page: `Int`,\n      // perPage: { type: `Int`, defaultValue: 20 },\n    },\n    resolve: findManyPaginated(typeName),\n  })\n}\n\nconst addConvenienceChildrenFields = ({\n  schemaComposer,\n  typeComposer,\n  nodeStore,\n}) => {\n  const nodes = nodeStore.getNodesByType(typeComposer.getTypeName())\n\n  const childNodesByType = groupChildNodesByType({ nodeStore, nodes })\n\n  Object.keys(childNodesByType).forEach(typeName => {\n    const typeChildren = childNodesByType[typeName]\n    const maxChildCount = _.maxBy(\n      _.values(_.groupBy(typeChildren, c => c.parent)),\n      g => g.length\n    ).length\n\n    if (maxChildCount > 1) {\n      typeComposer.addFields(createChildrenField(typeName))\n    } else {\n      typeComposer.addFields(createChildField(typeName))\n    }\n  })\n}\n\nfunction createChildrenField(typeName) {\n  return {\n    [_.camelCase(`children ${typeName}`)]: {\n      type: () => [typeName],\n      resolve(source, args, context) {\n        const { path } = context\n        return context.nodeModel.getNodesByIds(\n          { ids: source.children, type: typeName },\n          { path }\n        )\n      },\n    },\n  }\n}\n\nfunction createChildField(typeName) {\n  return {\n    [_.camelCase(`child ${typeName}`)]: {\n      type: () => typeName,\n      async resolve(source, args, context) {\n        const { path } = context\n        const result = await context.nodeModel.getNodesByIds(\n          { ids: source.children, type: typeName },\n          { path }\n        )\n        if (result && result.length > 0) {\n          return result[0]\n        } else {\n          return null\n        }\n      },\n    },\n  }\n}\n\nfunction groupChildNodesByType({ nodeStore, nodes }) {\n  return _(nodes)\n    .flatMap(node => (node.children || []).map(nodeStore.getNode))\n    .groupBy(node => (node.internal ? node.internal.type : undefined))\n    .value()\n}\n\nconst addTypeToRootQuery = ({ schemaComposer, typeComposer }) => {\n  const typeName = typeComposer.getTypeName()\n  // not strictly correctly, result is `npmPackage` and `allNpmPackage` from type `NPMPackage`\n  const queryName = _.camelCase(typeName)\n  const queryNamePlural = _.camelCase(`all ${typeName}`)\n  schemaComposer.Query.addFields({\n    [queryName]: typeComposer.getResolver(`findOne`),\n    [queryNamePlural]: typeComposer.getResolver(`findManyPaginated`),\n  })\n}\n\nconst reportParsingError = error => {\n  const { message, source, locations } = error\n\n  if (source && locations && locations.length) {\n    const report = require(`gatsby-cli/lib/reporter`)\n    const { codeFrameColumns } = require(`@babel/code-frame`)\n\n    const frame = codeFrameColumns(\n      source.body,\n      { start: locations[0] },\n      { linesAbove: 5, linesBelow: 5 }\n    )\n    report.panic(\n      `Encountered an error parsing the provided GraphQL type definitions:\\n` +\n        message +\n        `\\n\\n` +\n        frame +\n        `\\n`\n    )\n  } else {\n    throw error\n  }\n}\n"],"file":"schema.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/schema/types/date.js b/node_modules/gatsby/dist/schema/types/date.js
index 6760d4c..67eb220 100644
--- a/node_modules/gatsby/dist/schema/types/date.js
+++ b/node_modules/gatsby/dist/schema/types/date.js
@@ -2,14 +2,16 @@
 
 const moment = require(`moment`);
 
-const _require = require(`graphql`),
-      GraphQLString = _require.GraphQLString,
-      GraphQLBoolean = _require.GraphQLBoolean,
-      GraphQLScalarType = _require.GraphQLScalarType,
-      Kind = _require.Kind;
+const {
+  GraphQLString,
+  GraphQLBoolean,
+  GraphQLScalarType,
+  Kind
+} = require(`graphql`);
 
-const _require2 = require(`common-tags`),
-      oneLine = _require2.oneLine;
+const {
+  oneLine
+} = require(`common-tags`);
 
 const ISO_8601_FORMAT = [`YYYY`, `YYYY-MM`, `YYYY-MM-DD`, `YYYYMMDD`, // Local Time
 `YYYY-MM-DDTHH`, `YYYY-MM-DDTHH:mm`, `YYYY-MM-DDTHHmm`, `YYYY-MM-DDTHH:mm:ss`, `YYYY-MM-DDTHHmmss`, `YYYY-MM-DDTHH:mm:ss.SSS`, `YYYY-MM-DDTHHmmss.SSS`, `YYYY-MM-DDTHH:mm:ss.SSSSSS`, `YYYY-MM-DDTHHmmss.SSSSSS`, // `YYYY-MM-DDTHH:mm:ss.SSSSSSSSS`,
@@ -37,17 +39,80 @@ const GraphQLDate = new GraphQLScalarType({
     return ast.kind === Kind.STRING ? ast.value : undefined;
   }
 
-}); // Check if this is a date.
-// All the allowed ISO 8601 date-time formats used.
+});
+const momentFormattingTokens = /(\[[^[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;
+const momentFormattingRegexes = {
+  YYYY: `\\d{4}`,
+  MM: `\\d{2}`,
+  DD: `\\d{2}`,
+  DDDD: `\\d{4}`,
+  HH: `\\d{2}`,
+  mm: `\\d{2}`,
+  ss: `\\d{2}`,
+  SSS: `\\d{3}`,
+  SSSSSS: `\\d{6}`,
+  E: `\\d`,
+  W: `\\d`,
+  WW: `\\d{2}`,
+  "[W]": `W`,
+  ".": `\\.`,
+  Z: `(Z|[+-]\\d\\d(?::?\\d\\d)?)`
+};
+const ISO_8601_FORMAT_AS_REGEX = ISO_8601_FORMAT.map(format => // convert ISO string to a map of momentTokens ([YYYY, MM, DD])
+[...format.match(momentFormattingTokens)].map(token => // see if the token (YYYY or ss) is found, else we just return the value
+momentFormattingRegexes[token] ? momentFormattingRegexes[token] : token).join(``)).join(`|`); // calculate all lengths of the formats, if a string is longer or smaller it can't be valid
 
-function isDate(value) {
+const ISO_8601_FORMAT_LENGTHS = [...new Set(ISO_8601_FORMAT.reduce((acc, val) => {
+  if (!val.endsWith(`Z`)) {
+    return acc.concat(val.length);
+  } // we add count of +01 & +01:00
+
+
+  return acc.concat([val.length, val.length + 3, val.length + 5]);
+}, []))]; // lets imagine these formats: YYYY-MM-DDTHH & YYYY-MM-DD HHmmss.SSSSSS Z
+// this regex looks like (/^(\d{4}-\d{2}-\d{2}T\d{2}|\d{4}-\d{2}-\d{2} \d{2}\d{2}\d{2}.\d{6} Z)$)
+
+const quickDateValidateRegex = new RegExp(`^(${ISO_8601_FORMAT_AS_REGEX})$`);
+const looksLikeDateStartRegex = /^\d{4}/; // this regex makes sure the last characters are a number or the letter Z
+
+const looksLikeDateEndRegex = /(\d|Z)$/;
+/**
+ * looksLikeADate isn't a 100% valid check if it is a real date but at least it's something that looks like a date.
+ * It won't catch values like 2010-02-30
+ * 1) is it a number?
+ * 2) does the length of the value comply with any of our formats
+ * 3) does the str starts with 4 digites (YYYY)
+ * 4) does the str ends with something that looks like a date
+ * 5) Small regex to see if it matches any of the formats
+ * 6) check momentjs
+ *
+ * @param {*} value
+ * @return {boolean}
+ */
+
+function looksLikeADate(value) {
   // quick check if value does not look like a date
-  if (typeof value === `number` || !/^\d{4}/.test(value)) {
+  if (!value || value.length && !ISO_8601_FORMAT_LENGTHS.includes(value.length) || !looksLikeDateStartRegex.test(value) || !looksLikeDateEndRegex.test(value)) {
     return false;
+  } // If it looks like a date we parse the date with a regex to see if we can handle it.
+  // momentjs just does regex validation itself if you don't do any operations on it.
+
+
+  if (typeof value === `string` && quickDateValidateRegex.test(value)) {
+    return true;
   }
 
+  return isDate(value);
+}
+/**
+ * @param {*} value
+ * @return {boolean}
+ */
+
+
+function isDate(value) {
   const momentDate = moment.utc(value, ISO_8601_FORMAT, true);
-  return momentDate.isValid();
+  return typeof value !== `number` && momentDate.isValid();
 }
 
 const formatDate = ({
@@ -106,17 +171,20 @@ const dateResolver = {
   }) {
     const date = source[fieldName];
     if (date == null) return null;
-    return Array.isArray(date) ? date.map(d => formatDate(Object.assign({
-      date: d
-    }, args))) : formatDate(Object.assign({
-      date
-    }, args));
+    return Array.isArray(date) ? date.map(d => formatDate({
+      date: d,
+      ...args
+    })) : formatDate({
+      date,
+      ...args
+    });
   }
 
 };
 module.exports = {
   GraphQLDate,
   dateResolver,
-  isDate
+  isDate,
+  looksLikeADate
 };
 //# sourceMappingURL=date.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/schema/types/date.js.map b/node_modules/gatsby/dist/schema/types/date.js.map
index f84c8f2..99f0afc 100644
--- a/node_modules/gatsby/dist/schema/types/date.js.map
+++ b/node_modules/gatsby/dist/schema/types/date.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/schema/types/date.js"],"names":["moment","require","GraphQLString","GraphQLBoolean","GraphQLScalarType","Kind","oneLine","ISO_8601_FORMAT","GraphQLDate","name","description","serialize","String","parseValue","parseLiteral","ast","kind","STRING","value","undefined","isDate","test","momentDate","utc","isValid","formatDate","date","fromNow","difference","formatString","locale","normalizedDate","JSON","parse","stringify","format","diff","dateResolver","type","args","resolve","source","context","fieldName","Array","isArray","map","d","module","exports"],"mappings":"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","sourcesContent":["const moment = require(`moment`)\nconst {\n  GraphQLString,\n  GraphQLBoolean,\n  GraphQLScalarType,\n  Kind,\n} = require(`graphql`)\nconst { oneLine } = require(`common-tags`)\n\nconst ISO_8601_FORMAT = [\n  `YYYY`,\n  `YYYY-MM`,\n  `YYYY-MM-DD`,\n  `YYYYMMDD`,\n\n  // Local Time\n  `YYYY-MM-DDTHH`,\n  `YYYY-MM-DDTHH:mm`,\n  `YYYY-MM-DDTHHmm`,\n  `YYYY-MM-DDTHH:mm:ss`,\n  `YYYY-MM-DDTHHmmss`,\n  `YYYY-MM-DDTHH:mm:ss.SSS`,\n  `YYYY-MM-DDTHHmmss.SSS`,\n  `YYYY-MM-DDTHH:mm:ss.SSSSSS`,\n  `YYYY-MM-DDTHHmmss.SSSSSS`,\n  // `YYYY-MM-DDTHH:mm:ss.SSSSSSSSS`,\n  // `YYYY-MM-DDTHHmmss.SSSSSSSSS`,\n\n  // Local Time (Omit T)\n  `YYYY-MM-DD HH`,\n  `YYYY-MM-DD HH:mm`,\n  `YYYY-MM-DD HHmm`,\n  `YYYY-MM-DD HH:mm:ss`,\n  `YYYY-MM-DD HHmmss`,\n  `YYYY-MM-DD HH:mm:ss.SSS`,\n  `YYYY-MM-DD HHmmss.SSS`,\n  `YYYY-MM-DD HH:mm:ss.SSSSSS`,\n  `YYYY-MM-DD HHmmss.SSSSSS`,\n  // `YYYY-MM-DD HH:mm:ss.SSSSSSSSS`,\n  // `YYYY-MM-DD HHmmss.SSSSSSSSS`,\n\n  // Coordinated Universal Time (UTC)\n  `YYYY-MM-DDTHHZ`,\n  `YYYY-MM-DDTHH:mmZ`,\n  `YYYY-MM-DDTHHmmZ`,\n  `YYYY-MM-DDTHH:mm:ssZ`,\n  `YYYY-MM-DDTHHmmssZ`,\n  `YYYY-MM-DDTHH:mm:ss.SSSZ`,\n  `YYYY-MM-DDTHHmmss.SSSZ`,\n  `YYYY-MM-DDTHH:mm:ss.SSSSSSZ`,\n  `YYYY-MM-DDTHHmmss.SSSSSSZ`,\n  // `YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ`,\n  // `YYYY-MM-DDTHHmmss.SSSSSSSSSZ`,\n\n  // Coordinated Universal Time (UTC) (Omit T)\n  `YYYY-MM-DD HHZ`,\n  `YYYY-MM-DD HH:mmZ`,\n  `YYYY-MM-DD HHmmZ`,\n  `YYYY-MM-DD HH:mm:ssZ`,\n  `YYYY-MM-DD HHmmssZ`,\n  `YYYY-MM-DD HH:mm:ss.SSSZ`,\n  `YYYY-MM-DD HHmmss.SSSZ`,\n  `YYYY-MM-DD HH:mm:ss.SSSSSSZ`,\n  `YYYY-MM-DD HHmmss.SSSSSSZ`,\n  // `YYYY-MM-DD HH:mm:ss.SSSSSSSSSZ`,\n  // `YYYY-MM-DD HHmmss.SSSSSSSSSZ`,\n\n  // Coordinated Universal Time (UTC) (Omit T, Extra Space before Z)\n  `YYYY-MM-DD HH Z`,\n  `YYYY-MM-DD HH:mm Z`,\n  `YYYY-MM-DD HHmm Z`,\n  `YYYY-MM-DD HH:mm:ss Z`,\n  `YYYY-MM-DD HHmmss Z`,\n  `YYYY-MM-DD HH:mm:ss.SSS Z`,\n  `YYYY-MM-DD HHmmss.SSS Z`,\n  `YYYY-MM-DD HH:mm:ss.SSSSSS Z`,\n  `YYYY-MM-DD HHmmss.SSSSSS Z`,\n\n  `YYYY-[W]WW`,\n  `YYYY[W]WW`,\n  `YYYY-[W]WW-E`,\n  `YYYY[W]WWE`,\n  `YYYY-DDDD`,\n  `YYYYDDDD`,\n]\n\nconst GraphQLDate = new GraphQLScalarType({\n  name: `Date`,\n  description: oneLine`\n    A date string, such as 2007-12-03, compliant with the ISO 8601 standard\n    for representation of dates and times using the Gregorian calendar.`,\n  serialize: String,\n  parseValue: String,\n  parseLiteral(ast) {\n    return ast.kind === Kind.STRING ? ast.value : undefined\n  },\n})\n\n// Check if this is a date.\n// All the allowed ISO 8601 date-time formats used.\nfunction isDate(value) {\n  // quick check if value does not look like a date\n  if (typeof value === `number` || !/^\\d{4}/.test(value)) {\n    return false\n  }\n\n  const momentDate = moment.utc(value, ISO_8601_FORMAT, true)\n  return momentDate.isValid()\n}\n\nconst formatDate = ({\n  date,\n  fromNow,\n  difference,\n  formatString,\n  locale = `en`,\n}) => {\n  const normalizedDate = JSON.parse(JSON.stringify(date))\n  if (formatString) {\n    return moment\n      .utc(normalizedDate, ISO_8601_FORMAT, true)\n      .locale(locale)\n      .format(formatString)\n  } else if (fromNow) {\n    return moment\n      .utc(normalizedDate, ISO_8601_FORMAT, true)\n      .locale(locale)\n      .fromNow()\n  } else if (difference) {\n    return moment().diff(\n      moment.utc(normalizedDate, ISO_8601_FORMAT, true).locale(locale),\n      difference\n    )\n  }\n  return normalizedDate\n}\n\nconst dateResolver = {\n  type: `Date`,\n  args: {\n    formatString: {\n      type: GraphQLString,\n      description: oneLine`\n        Format the date using Moment.js' date tokens, e.g.\n        \\`date(formatString: \"YYYY MMMM DD\")\\`.\n        See https://momentjs.com/docs/#/displaying/format/\n        for documentation for different tokens.`,\n    },\n    fromNow: {\n      type: GraphQLBoolean,\n      description: oneLine`\n        Returns a string generated with Moment.js' \\`fromNow\\` function`,\n    },\n    difference: {\n      type: GraphQLString,\n      description: oneLine`\n        Returns the difference between this date and the current time.\n        Defaults to \"miliseconds\" but you can also pass in as the\n        measurement \"years\", \"months\", \"weeks\", \"days\", \"hours\", \"minutes\",\n        and \"seconds\".`,\n    },\n    locale: {\n      type: GraphQLString,\n      description: oneLine`\n        Configures the locale Moment.js will use to format the date.`,\n    },\n  },\n  resolve(source, args, context, { fieldName }) {\n    const date = source[fieldName]\n    if (date == null) return null\n\n    return Array.isArray(date)\n      ? date.map(d => formatDate({ date: d, ...args }))\n      : formatDate({ date, ...args })\n  },\n}\n\nmodule.exports = { GraphQLDate, dateResolver, isDate }\n"],"file":"date.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/schema/types/date.js"],"names":["moment","require","GraphQLString","GraphQLBoolean","GraphQLScalarType","Kind","oneLine","ISO_8601_FORMAT","GraphQLDate","name","description","serialize","String","parseValue","parseLiteral","ast","kind","STRING","value","undefined","momentFormattingTokens","momentFormattingRegexes","YYYY","MM","DD","DDDD","HH","mm","ss","SSS","SSSSSS","E","W","WW","Z","ISO_8601_FORMAT_AS_REGEX","map","format","match","token","join","ISO_8601_FORMAT_LENGTHS","Set","reduce","acc","val","endsWith","concat","length","quickDateValidateRegex","RegExp","looksLikeDateStartRegex","looksLikeDateEndRegex","looksLikeADate","includes","test","isDate","momentDate","utc","isValid","formatDate","date","fromNow","difference","formatString","locale","normalizedDate","JSON","parse","stringify","diff","dateResolver","type","args","resolve","source","context","fieldName","Array","isArray","d","module","exports"],"mappings":"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","sourcesContent":["const moment = require(`moment`)\nconst {\n  GraphQLString,\n  GraphQLBoolean,\n  GraphQLScalarType,\n  Kind,\n} = require(`graphql`)\nconst { oneLine } = require(`common-tags`)\n\nconst ISO_8601_FORMAT = [\n  `YYYY`,\n  `YYYY-MM`,\n  `YYYY-MM-DD`,\n  `YYYYMMDD`,\n\n  // Local Time\n  `YYYY-MM-DDTHH`,\n  `YYYY-MM-DDTHH:mm`,\n  `YYYY-MM-DDTHHmm`,\n  `YYYY-MM-DDTHH:mm:ss`,\n  `YYYY-MM-DDTHHmmss`,\n  `YYYY-MM-DDTHH:mm:ss.SSS`,\n  `YYYY-MM-DDTHHmmss.SSS`,\n  `YYYY-MM-DDTHH:mm:ss.SSSSSS`,\n  `YYYY-MM-DDTHHmmss.SSSSSS`,\n  // `YYYY-MM-DDTHH:mm:ss.SSSSSSSSS`,\n  // `YYYY-MM-DDTHHmmss.SSSSSSSSS`,\n\n  // Local Time (Omit T)\n  `YYYY-MM-DD HH`,\n  `YYYY-MM-DD HH:mm`,\n  `YYYY-MM-DD HHmm`,\n  `YYYY-MM-DD HH:mm:ss`,\n  `YYYY-MM-DD HHmmss`,\n  `YYYY-MM-DD HH:mm:ss.SSS`,\n  `YYYY-MM-DD HHmmss.SSS`,\n  `YYYY-MM-DD HH:mm:ss.SSSSSS`,\n  `YYYY-MM-DD HHmmss.SSSSSS`,\n  // `YYYY-MM-DD HH:mm:ss.SSSSSSSSS`,\n  // `YYYY-MM-DD HHmmss.SSSSSSSSS`,\n\n  // Coordinated Universal Time (UTC)\n  `YYYY-MM-DDTHHZ`,\n  `YYYY-MM-DDTHH:mmZ`,\n  `YYYY-MM-DDTHHmmZ`,\n  `YYYY-MM-DDTHH:mm:ssZ`,\n  `YYYY-MM-DDTHHmmssZ`,\n  `YYYY-MM-DDTHH:mm:ss.SSSZ`,\n  `YYYY-MM-DDTHHmmss.SSSZ`,\n  `YYYY-MM-DDTHH:mm:ss.SSSSSSZ`,\n  `YYYY-MM-DDTHHmmss.SSSSSSZ`,\n  // `YYYY-MM-DDTHH:mm:ss.SSSSSSSSSZ`,\n  // `YYYY-MM-DDTHHmmss.SSSSSSSSSZ`,\n\n  // Coordinated Universal Time (UTC) (Omit T)\n  `YYYY-MM-DD HHZ`,\n  `YYYY-MM-DD HH:mmZ`,\n  `YYYY-MM-DD HHmmZ`,\n  `YYYY-MM-DD HH:mm:ssZ`,\n  `YYYY-MM-DD HHmmssZ`,\n  `YYYY-MM-DD HH:mm:ss.SSSZ`,\n  `YYYY-MM-DD HHmmss.SSSZ`,\n  `YYYY-MM-DD HH:mm:ss.SSSSSSZ`,\n  `YYYY-MM-DD HHmmss.SSSSSSZ`,\n  // `YYYY-MM-DD HH:mm:ss.SSSSSSSSSZ`,\n  // `YYYY-MM-DD HHmmss.SSSSSSSSSZ`,\n\n  // Coordinated Universal Time (UTC) (Omit T, Extra Space before Z)\n  `YYYY-MM-DD HH Z`,\n  `YYYY-MM-DD HH:mm Z`,\n  `YYYY-MM-DD HHmm Z`,\n  `YYYY-MM-DD HH:mm:ss Z`,\n  `YYYY-MM-DD HHmmss Z`,\n  `YYYY-MM-DD HH:mm:ss.SSS Z`,\n  `YYYY-MM-DD HHmmss.SSS Z`,\n  `YYYY-MM-DD HH:mm:ss.SSSSSS Z`,\n  `YYYY-MM-DD HHmmss.SSSSSS Z`,\n\n  `YYYY-[W]WW`,\n  `YYYY[W]WW`,\n  `YYYY-[W]WW-E`,\n  `YYYY[W]WWE`,\n  `YYYY-DDDD`,\n  `YYYYDDDD`,\n]\n\nconst GraphQLDate = new GraphQLScalarType({\n  name: `Date`,\n  description: oneLine`\n    A date string, such as 2007-12-03, compliant with the ISO 8601 standard\n    for representation of dates and times using the Gregorian calendar.`,\n  serialize: String,\n  parseValue: String,\n  parseLiteral(ast) {\n    return ast.kind === Kind.STRING ? ast.value : undefined\n  },\n})\n\nconst momentFormattingTokens = /(\\[[^[]*\\])|(\\\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g\nconst momentFormattingRegexes = {\n  YYYY: `\\\\d{4}`,\n  MM: `\\\\d{2}`,\n  DD: `\\\\d{2}`,\n  DDDD: `\\\\d{4}`,\n  HH: `\\\\d{2}`,\n  mm: `\\\\d{2}`,\n  ss: `\\\\d{2}`,\n  SSS: `\\\\d{3}`,\n  SSSSSS: `\\\\d{6}`,\n  E: `\\\\d`,\n  W: `\\\\d`,\n  WW: `\\\\d{2}`,\n  \"[W]\": `W`,\n  \".\": `\\\\.`,\n  Z: `(Z|[+-]\\\\d\\\\d(?::?\\\\d\\\\d)?)`,\n}\nconst ISO_8601_FORMAT_AS_REGEX = ISO_8601_FORMAT.map(format =>\n  // convert ISO string to a map of momentTokens ([YYYY, MM, DD])\n  [...format.match(momentFormattingTokens)]\n    .map(token =>\n      // see if the token (YYYY or ss) is found, else we just return the value\n      momentFormattingRegexes[token] ? momentFormattingRegexes[token] : token\n    )\n    .join(``)\n).join(`|`)\n\n// calculate all lengths of the formats, if a string is longer or smaller it can't be valid\nconst ISO_8601_FORMAT_LENGTHS = [\n  ...new Set(\n    ISO_8601_FORMAT.reduce((acc, val) => {\n      if (!val.endsWith(`Z`)) {\n        return acc.concat(val.length)\n      }\n\n      // we add count of +01 & +01:00\n      return acc.concat([val.length, val.length + 3, val.length + 5])\n    }, [])\n  ),\n]\n\n// lets imagine these formats: YYYY-MM-DDTHH & YYYY-MM-DD HHmmss.SSSSSS Z\n// this regex looks like (/^(\\d{4}-\\d{2}-\\d{2}T\\d{2}|\\d{4}-\\d{2}-\\d{2} \\d{2}\\d{2}\\d{2}.\\d{6} Z)$)\nconst quickDateValidateRegex = new RegExp(`^(${ISO_8601_FORMAT_AS_REGEX})$`)\n\nconst looksLikeDateStartRegex = /^\\d{4}/\n// this regex makes sure the last characters are a number or the letter Z\nconst looksLikeDateEndRegex = /(\\d|Z)$/\n\n/**\n * looksLikeADate isn't a 100% valid check if it is a real date but at least it's something that looks like a date.\n * It won't catch values like 2010-02-30\n * 1) is it a number?\n * 2) does the length of the value comply with any of our formats\n * 3) does the str starts with 4 digites (YYYY)\n * 4) does the str ends with something that looks like a date\n * 5) Small regex to see if it matches any of the formats\n * 6) check momentjs\n *\n * @param {*} value\n * @return {boolean}\n */\nfunction looksLikeADate(value) {\n  // quick check if value does not look like a date\n  if (\n    !value ||\n    (value.length && !ISO_8601_FORMAT_LENGTHS.includes(value.length)) ||\n    !looksLikeDateStartRegex.test(value) ||\n    !looksLikeDateEndRegex.test(value)\n  ) {\n    return false\n  }\n\n  // If it looks like a date we parse the date with a regex to see if we can handle it.\n  // momentjs just does regex validation itself if you don't do any operations on it.\n  if (typeof value === `string` && quickDateValidateRegex.test(value)) {\n    return true\n  }\n\n  return isDate(value)\n}\n\n/**\n * @param {*} value\n * @return {boolean}\n */\nfunction isDate(value) {\n  const momentDate = moment.utc(value, ISO_8601_FORMAT, true)\n  return typeof value !== `number` && momentDate.isValid()\n}\n\nconst formatDate = ({\n  date,\n  fromNow,\n  difference,\n  formatString,\n  locale = `en`,\n}) => {\n  const normalizedDate = JSON.parse(JSON.stringify(date))\n  if (formatString) {\n    return moment\n      .utc(normalizedDate, ISO_8601_FORMAT, true)\n      .locale(locale)\n      .format(formatString)\n  } else if (fromNow) {\n    return moment\n      .utc(normalizedDate, ISO_8601_FORMAT, true)\n      .locale(locale)\n      .fromNow()\n  } else if (difference) {\n    return moment().diff(\n      moment.utc(normalizedDate, ISO_8601_FORMAT, true).locale(locale),\n      difference\n    )\n  }\n  return normalizedDate\n}\n\nconst dateResolver = {\n  type: `Date`,\n  args: {\n    formatString: {\n      type: GraphQLString,\n      description: oneLine`\n        Format the date using Moment.js' date tokens, e.g.\n        \\`date(formatString: \"YYYY MMMM DD\")\\`.\n        See https://momentjs.com/docs/#/displaying/format/\n        for documentation for different tokens.`,\n    },\n    fromNow: {\n      type: GraphQLBoolean,\n      description: oneLine`\n        Returns a string generated with Moment.js' \\`fromNow\\` function`,\n    },\n    difference: {\n      type: GraphQLString,\n      description: oneLine`\n        Returns the difference between this date and the current time.\n        Defaults to \"miliseconds\" but you can also pass in as the\n        measurement \"years\", \"months\", \"weeks\", \"days\", \"hours\", \"minutes\",\n        and \"seconds\".`,\n    },\n    locale: {\n      type: GraphQLString,\n      description: oneLine`\n        Configures the locale Moment.js will use to format the date.`,\n    },\n  },\n  resolve(source, args, context, { fieldName }) {\n    const date = source[fieldName]\n    if (date == null) return null\n\n    return Array.isArray(date)\n      ? date.map(d => formatDate({ date: d, ...args }))\n      : formatDate({ date, ...args })\n  },\n}\n\nmodule.exports = { GraphQLDate, dateResolver, isDate, looksLikeADate }\n"],"file":"date.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/schema/types/directives.js b/node_modules/gatsby/dist/schema/types/directives.js
index 3cec7c0..85e5e74 100644
--- a/node_modules/gatsby/dist/schema/types/directives.js
+++ b/node_modules/gatsby/dist/schema/types/directives.js
@@ -1,10 +1,11 @@
 "use strict";
 
-const _require = require(`graphql`),
-      GraphQLBoolean = _require.GraphQLBoolean,
-      GraphQLNonNull = _require.GraphQLNonNull,
-      GraphQLDirective = _require.GraphQLDirective,
-      DirectiveLocation = _require.DirectiveLocation;
+const {
+  GraphQLBoolean,
+  GraphQLNonNull,
+  GraphQLDirective,
+  DirectiveLocation
+} = require(`graphql`);
 
 const InferDirective = new GraphQLDirective({
   name: `infer`,
@@ -14,7 +15,8 @@ const InferDirective = new GraphQLDirective({
     noDefaultResolvers: {
       type: new GraphQLNonNull(GraphQLBoolean),
       default: false,
-      description: `Don't add default resolvers to defined fields.`
+      description: `Don't add default resolvers to defined fields.`,
+      deprecationReason: `noDefaultResolvers is deprecated, annotate individual fields.`
     }
   }
 });
@@ -26,7 +28,8 @@ const DontInferDirective = new GraphQLDirective({
     noDefaultResolvers: {
       type: new GraphQLNonNull(GraphQLBoolean),
       default: false,
-      description: `Don't add default resolvers to defined fields.`
+      description: `Don't add default resolvers to defined fields.`,
+      deprecationReason: `noDefaultResolvers is deprecated, annotate individual fields.`
     }
   }
 });
diff --git a/node_modules/gatsby/dist/schema/types/directives.js.map b/node_modules/gatsby/dist/schema/types/directives.js.map
index 68d1b94..e879043 100644
--- a/node_modules/gatsby/dist/schema/types/directives.js.map
+++ b/node_modules/gatsby/dist/schema/types/directives.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/schema/types/directives.js"],"names":["require","GraphQLBoolean","GraphQLNonNull","GraphQLDirective","DirectiveLocation","InferDirective","name","description","locations","OBJECT","args","noDefaultResolvers","type","default","DontInferDirective","module","exports"],"mappings":";;iBAKIA,OAAO,CAAE,SAAF,C;MAJTC,c,YAAAA,c;MACAC,c,YAAAA,c;MACAC,gB,YAAAA,gB;MACAC,iB,YAAAA,iB;;AAGF,MAAMC,cAAc,GAAG,IAAIF,gBAAJ,CAAqB;AAC1CG,EAAAA,IAAI,EAAG,OADmC;AAE1CC,EAAAA,WAAW,EAAG,wCAF4B;AAG1CC,EAAAA,SAAS,EAAE,CAACJ,iBAAiB,CAACK,MAAnB,CAH+B;AAI1CC,EAAAA,IAAI,EAAE;AACJC,IAAAA,kBAAkB,EAAE;AAClBC,MAAAA,IAAI,EAAE,IAAIV,cAAJ,CAAmBD,cAAnB,CADY;AAElBY,MAAAA,OAAO,EAAE,KAFS;AAGlBN,MAAAA,WAAW,EAAG;AAHI;AADhB;AAJoC,CAArB,CAAvB;AAaA,MAAMO,kBAAkB,GAAG,IAAIX,gBAAJ,CAAqB;AAC9CG,EAAAA,IAAI,EAAG,WADuC;AAE9CC,EAAAA,WAAW,EAAG,0DAFgC;AAG9CC,EAAAA,SAAS,EAAE,CAACJ,iBAAiB,CAACK,MAAnB,CAHmC;AAI9CC,EAAAA,IAAI,EAAE;AACJC,IAAAA,kBAAkB,EAAE;AAClBC,MAAAA,IAAI,EAAE,IAAIV,cAAJ,CAAmBD,cAAnB,CADY;AAElBY,MAAAA,OAAO,EAAE,KAFS;AAGlBN,MAAAA,WAAW,EAAG;AAHI;AADhB;AAJwC,CAArB,CAA3B;AAaAQ,MAAM,CAACC,OAAP,GAAiB;AACfX,EAAAA,cADe;AAEfS,EAAAA;AAFe,CAAjB","sourcesContent":["const {\n  GraphQLBoolean,\n  GraphQLNonNull,\n  GraphQLDirective,\n  DirectiveLocation,\n} = require(`graphql`)\n\nconst InferDirective = new GraphQLDirective({\n  name: `infer`,\n  description: `Infer fields for this type from nodes.`,\n  locations: [DirectiveLocation.OBJECT],\n  args: {\n    noDefaultResolvers: {\n      type: new GraphQLNonNull(GraphQLBoolean),\n      default: false,\n      description: `Don't add default resolvers to defined fields.`,\n    },\n  },\n})\n\nconst DontInferDirective = new GraphQLDirective({\n  name: `dontInfer`,\n  description: `Do not infer additional fields for this type from nodes.`,\n  locations: [DirectiveLocation.OBJECT],\n  args: {\n    noDefaultResolvers: {\n      type: new GraphQLNonNull(GraphQLBoolean),\n      default: false,\n      description: `Don't add default resolvers to defined fields.`,\n    },\n  },\n})\n\nmodule.exports = {\n  InferDirective,\n  DontInferDirective,\n}\n"],"file":"directives.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/schema/types/directives.js"],"names":["GraphQLBoolean","GraphQLNonNull","GraphQLDirective","DirectiveLocation","require","InferDirective","name","description","locations","OBJECT","args","noDefaultResolvers","type","default","deprecationReason","DontInferDirective","module","exports"],"mappings":";;AAAA,MAAM;AACJA,EAAAA,cADI;AAEJC,EAAAA,cAFI;AAGJC,EAAAA,gBAHI;AAIJC,EAAAA;AAJI,IAKFC,OAAO,CAAE,SAAF,CALX;;AAOA,MAAMC,cAAc,GAAG,IAAIH,gBAAJ,CAAqB;AAC1CI,EAAAA,IAAI,EAAG,OADmC;AAE1CC,EAAAA,WAAW,EAAG,wCAF4B;AAG1CC,EAAAA,SAAS,EAAE,CAACL,iBAAiB,CAACM,MAAnB,CAH+B;AAI1CC,EAAAA,IAAI,EAAE;AACJC,IAAAA,kBAAkB,EAAE;AAClBC,MAAAA,IAAI,EAAE,IAAIX,cAAJ,CAAmBD,cAAnB,CADY;AAElBa,MAAAA,OAAO,EAAE,KAFS;AAGlBN,MAAAA,WAAW,EAAG,gDAHI;AAIlBO,MAAAA,iBAAiB,EAAG;AAJF;AADhB;AAJoC,CAArB,CAAvB;AAcA,MAAMC,kBAAkB,GAAG,IAAIb,gBAAJ,CAAqB;AAC9CI,EAAAA,IAAI,EAAG,WADuC;AAE9CC,EAAAA,WAAW,EAAG,0DAFgC;AAG9CC,EAAAA,SAAS,EAAE,CAACL,iBAAiB,CAACM,MAAnB,CAHmC;AAI9CC,EAAAA,IAAI,EAAE;AACJC,IAAAA,kBAAkB,EAAE;AAClBC,MAAAA,IAAI,EAAE,IAAIX,cAAJ,CAAmBD,cAAnB,CADY;AAElBa,MAAAA,OAAO,EAAE,KAFS;AAGlBN,MAAAA,WAAW,EAAG,gDAHI;AAIlBO,MAAAA,iBAAiB,EAAG;AAJF;AADhB;AAJwC,CAArB,CAA3B;AAcAE,MAAM,CAACC,OAAP,GAAiB;AACfZ,EAAAA,cADe;AAEfU,EAAAA;AAFe,CAAjB","sourcesContent":["const {\n  GraphQLBoolean,\n  GraphQLNonNull,\n  GraphQLDirective,\n  DirectiveLocation,\n} = require(`graphql`)\n\nconst InferDirective = new GraphQLDirective({\n  name: `infer`,\n  description: `Infer fields for this type from nodes.`,\n  locations: [DirectiveLocation.OBJECT],\n  args: {\n    noDefaultResolvers: {\n      type: new GraphQLNonNull(GraphQLBoolean),\n      default: false,\n      description: `Don't add default resolvers to defined fields.`,\n      deprecationReason: `noDefaultResolvers is deprecated, annotate individual fields.`,\n    },\n  },\n})\n\nconst DontInferDirective = new GraphQLDirective({\n  name: `dontInfer`,\n  description: `Do not infer additional fields for this type from nodes.`,\n  locations: [DirectiveLocation.OBJECT],\n  args: {\n    noDefaultResolvers: {\n      type: new GraphQLNonNull(GraphQLBoolean),\n      default: false,\n      description: `Don't add default resolvers to defined fields.`,\n      deprecationReason: `noDefaultResolvers is deprecated, annotate individual fields.`,\n    },\n  },\n})\n\nmodule.exports = {\n  InferDirective,\n  DontInferDirective,\n}\n"],"file":"directives.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/schema/types/filter.js b/node_modules/gatsby/dist/schema/types/filter.js
index 7fe0d49..f7e5349 100644
--- a/node_modules/gatsby/dist/schema/types/filter.js
+++ b/node_modules/gatsby/dist/schema/types/filter.js
@@ -1,21 +1,25 @@
 "use strict";
 
-const _require = require(`graphql`),
-      getNamedType = _require.getNamedType,
-      getNullableType = _require.getNullableType,
-      GraphQLInputObjectType = _require.GraphQLInputObjectType,
-      GraphQLEnumType = _require.GraphQLEnumType,
-      GraphQLList = _require.GraphQLList,
-      isSpecifiedScalarType = _require.isSpecifiedScalarType;
-
-const _require2 = require(`graphql-compose`),
-      InputTypeComposer = _require2.InputTypeComposer;
-
-const _require3 = require(`graphql-compose`),
-      GraphQLJSON = _require3.GraphQLJSON;
-
-const _require4 = require(`./date`),
-      GraphQLDate = _require4.GraphQLDate;
+const {
+  getNamedType,
+  getNullableType,
+  GraphQLInputObjectType,
+  GraphQLEnumType,
+  GraphQLList,
+  isSpecifiedScalarType
+} = require(`graphql`);
+
+const {
+  InputTypeComposer
+} = require(`graphql-compose`);
+
+const {
+  GraphQLJSON
+} = require(`graphql-compose`);
+
+const {
+  GraphQLDate
+} = require(`./date`);
 
 const convert = ({
   schemaComposer,
diff --git a/node_modules/gatsby/dist/schema/types/filter.js.map b/node_modules/gatsby/dist/schema/types/filter.js.map
index ae869d4..4de516b 100644
--- a/node_modules/gatsby/dist/schema/types/filter.js.map
+++ b/node_modules/gatsby/dist/schema/types/filter.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/schema/types/filter.js"],"names":["require","getNamedType","getNullableType","GraphQLInputObjectType","GraphQLEnumType","GraphQLList","isSpecifiedScalarType","InputTypeComposer","GraphQLJSON","GraphQLDate","convert","schemaComposer","inputTypeComposer","filterInputComposer","inputTypeName","getTypeName","replace","convertedITC","has","getITC","name","fields","addAsComposer","fieldNames","getFieldNames","convertedFields","forEach","fieldName","fieldConfig","getFieldConfig","type","itc","operatorsInputTC","isListType","getQueryOperatorListInput","operatorFields","getQueryOperatorInput","addFields","removeEmptyFields","cache","Set","add","getFields","nonEmptyFields","Object","keys","fieldITC","length","setFields","getFilterInput","typeComposer","typeName","getOrCreateITC","getInputTypeComposer","hasField","getFieldType","extendField","filterInputTC","module","exports","EQ","NE","GT","GTE","LT","LTE","IN","NIN","REGEX","GLOB","ALLOWED_OPERATORS","Boolean","Date","Float","ID","Int","JSON","String","Enum","CustomScalar","ARRAY_OPERATORS","getOperatorFields","fieldType","operators","result","op","includes","isBuiltInScalarType","elemMatch"],"mappings":"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","sourcesContent":["const {\n  getNamedType,\n  getNullableType,\n  GraphQLInputObjectType,\n  GraphQLEnumType,\n  GraphQLList,\n  isSpecifiedScalarType,\n} = require(`graphql`)\nconst { InputTypeComposer } = require(`graphql-compose`)\nconst { GraphQLJSON } = require(`graphql-compose`)\nconst { GraphQLDate } = require(`./date`)\n\nconst convert = ({\n  schemaComposer,\n  inputTypeComposer,\n  filterInputComposer,\n}) => {\n  const inputTypeName = inputTypeComposer\n    .getTypeName()\n    .replace(/Input$/, `FilterInput`)\n\n  let convertedITC\n  if (filterInputComposer) {\n    convertedITC = filterInputComposer\n  } else if (schemaComposer.has(inputTypeName)) {\n    return schemaComposer.getITC(inputTypeName)\n  } else {\n    convertedITC = new InputTypeComposer(\n      new GraphQLInputObjectType({\n        name: inputTypeName,\n        fields: {},\n      }),\n      schemaComposer\n    )\n  }\n\n  schemaComposer.addAsComposer(convertedITC)\n\n  const fieldNames = inputTypeComposer.getFieldNames()\n  const convertedFields = {}\n  fieldNames.forEach(fieldName => {\n    const fieldConfig = inputTypeComposer.getFieldConfig(fieldName)\n    const type = getNamedType(fieldConfig.type)\n\n    if (type instanceof GraphQLInputObjectType) {\n      const itc = new InputTypeComposer(type, schemaComposer)\n\n      const operatorsInputTC = convert({\n        schemaComposer,\n        inputTypeComposer: itc,\n      })\n\n      // TODO: array of arrays?\n      const isListType =\n        getNullableType(fieldConfig.type) instanceof GraphQLList\n\n      // elemMatch operator\n      convertedFields[fieldName] = isListType\n        ? getQueryOperatorListInput({\n            schemaComposer,\n            inputTypeComposer: operatorsInputTC,\n          })\n        : operatorsInputTC\n    } else {\n      // GraphQLScalarType || GraphQLEnumType\n      const operatorFields = getQueryOperatorInput({ schemaComposer, type })\n      if (operatorFields) {\n        convertedFields[fieldName] = operatorFields\n      }\n    }\n  })\n\n  convertedITC.addFields(convertedFields)\n  return convertedITC\n}\n\nconst removeEmptyFields = (\n  { schemaComposer, inputTypeComposer },\n  cache = new Set()\n) => {\n  const convert = itc => {\n    if (cache.has(itc)) {\n      return itc\n    }\n    cache.add(itc)\n    const fields = itc.getFields()\n    const nonEmptyFields = {}\n    Object.keys(fields).forEach(fieldName => {\n      const fieldITC = fields[fieldName]\n      if (fieldITC instanceof InputTypeComposer) {\n        const convertedITC = convert(fieldITC)\n        if (convertedITC.getFieldNames().length) {\n          nonEmptyFields[fieldName] = convertedITC\n        }\n      } else {\n        nonEmptyFields[fieldName] = fieldITC\n      }\n    })\n    itc.setFields(nonEmptyFields)\n    return itc\n  }\n  return convert(inputTypeComposer)\n}\n\nconst getFilterInput = ({ schemaComposer, typeComposer }) => {\n  const typeName = typeComposer.getTypeName()\n  const filterInputComposer = schemaComposer.getOrCreateITC(\n    `${typeName}FilterInput`\n  )\n  const inputTypeComposer = typeComposer.getInputTypeComposer()\n\n  // TODO: In Gatsby v2, the NodeInput.id field is of type String, not ID.\n  // Remove this workaround for v3.\n  if (\n    inputTypeComposer.hasField(`id`) &&\n    getNamedType(inputTypeComposer.getFieldType(`id`)).name === `ID`\n  ) {\n    inputTypeComposer.extendField(`id`, { type: `String` })\n  }\n\n  const filterInputTC = convert({\n    schemaComposer,\n    inputTypeComposer,\n    filterInputComposer,\n  })\n\n  return removeEmptyFields({ schemaComposer, inputTypeComposer: filterInputTC })\n}\n\nmodule.exports = { getFilterInput }\n\nconst EQ = `eq`\nconst NE = `ne`\nconst GT = `gt`\nconst GTE = `gte`\nconst LT = `lt`\nconst LTE = `lte`\nconst IN = `in`\nconst NIN = `nin`\nconst REGEX = `regex`\nconst GLOB = `glob`\n\nconst ALLOWED_OPERATORS = {\n  Boolean: [EQ, NE, IN, NIN],\n  Date: [EQ, NE, GT, GTE, LT, LTE, IN, NIN],\n  Float: [EQ, NE, GT, GTE, LT, LTE, IN, NIN],\n  ID: [EQ, NE, IN, NIN],\n  Int: [EQ, NE, GT, GTE, LT, LTE, IN, NIN],\n  JSON: [EQ, NE, IN, NIN, REGEX, GLOB],\n  String: [EQ, NE, IN, NIN, REGEX, GLOB],\n  Enum: [EQ, NE, IN, NIN],\n  CustomScalar: [EQ, NE, IN, NIN],\n}\n\nconst ARRAY_OPERATORS = [IN, NIN]\n\nconst getOperatorFields = (fieldType, operators) => {\n  const result = {}\n  operators.forEach(op => {\n    if (ARRAY_OPERATORS.includes(op)) {\n      result[op] = [fieldType]\n    } else {\n      result[op] = fieldType\n    }\n  })\n  return result\n}\n\nconst getQueryOperatorInput = ({ schemaComposer, type }) => {\n  let typeName\n  if (type instanceof GraphQLEnumType) {\n    typeName = `Enum`\n  } else if (isBuiltInScalarType(type)) {\n    typeName = type.name\n  } else {\n    typeName = `CustomScalar`\n  }\n  const operators = ALLOWED_OPERATORS[typeName]\n  return schemaComposer.getOrCreateITC(type.name + `QueryOperatorInput`, itc =>\n    itc.addFields(getOperatorFields(type, operators))\n  )\n}\n\nconst getQueryOperatorListInput = ({ schemaComposer, inputTypeComposer }) => {\n  const typeName = inputTypeComposer.getTypeName().replace(/Input/, `ListInput`)\n  return schemaComposer.getOrCreateITC(typeName, itc => {\n    itc.addFields({\n      elemMatch: inputTypeComposer,\n    })\n  })\n}\n\nconst isBuiltInScalarType = type =>\n  isSpecifiedScalarType(type) || type === GraphQLDate || type === GraphQLJSON\n"],"file":"filter.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/schema/types/filter.js"],"names":["getNamedType","getNullableType","GraphQLInputObjectType","GraphQLEnumType","GraphQLList","isSpecifiedScalarType","require","InputTypeComposer","GraphQLJSON","GraphQLDate","convert","schemaComposer","inputTypeComposer","filterInputComposer","inputTypeName","getTypeName","replace","convertedITC","has","getITC","name","fields","addAsComposer","fieldNames","getFieldNames","convertedFields","forEach","fieldName","fieldConfig","getFieldConfig","type","itc","operatorsInputTC","isListType","getQueryOperatorListInput","operatorFields","getQueryOperatorInput","addFields","removeEmptyFields","cache","Set","add","getFields","nonEmptyFields","Object","keys","fieldITC","length","setFields","getFilterInput","typeComposer","typeName","getOrCreateITC","getInputTypeComposer","hasField","getFieldType","extendField","filterInputTC","module","exports","EQ","NE","GT","GTE","LT","LTE","IN","NIN","REGEX","GLOB","ALLOWED_OPERATORS","Boolean","Date","Float","ID","Int","JSON","String","Enum","CustomScalar","ARRAY_OPERATORS","getOperatorFields","fieldType","operators","result","op","includes","isBuiltInScalarType","elemMatch"],"mappings":"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","sourcesContent":["const {\n  getNamedType,\n  getNullableType,\n  GraphQLInputObjectType,\n  GraphQLEnumType,\n  GraphQLList,\n  isSpecifiedScalarType,\n} = require(`graphql`)\nconst { InputTypeComposer } = require(`graphql-compose`)\nconst { GraphQLJSON } = require(`graphql-compose`)\nconst { GraphQLDate } = require(`./date`)\n\nconst convert = ({\n  schemaComposer,\n  inputTypeComposer,\n  filterInputComposer,\n}) => {\n  const inputTypeName = inputTypeComposer\n    .getTypeName()\n    .replace(/Input$/, `FilterInput`)\n\n  let convertedITC\n  if (filterInputComposer) {\n    convertedITC = filterInputComposer\n  } else if (schemaComposer.has(inputTypeName)) {\n    return schemaComposer.getITC(inputTypeName)\n  } else {\n    convertedITC = new InputTypeComposer(\n      new GraphQLInputObjectType({\n        name: inputTypeName,\n        fields: {},\n      }),\n      schemaComposer\n    )\n  }\n\n  schemaComposer.addAsComposer(convertedITC)\n\n  const fieldNames = inputTypeComposer.getFieldNames()\n  const convertedFields = {}\n  fieldNames.forEach(fieldName => {\n    const fieldConfig = inputTypeComposer.getFieldConfig(fieldName)\n    const type = getNamedType(fieldConfig.type)\n\n    if (type instanceof GraphQLInputObjectType) {\n      const itc = new InputTypeComposer(type, schemaComposer)\n\n      const operatorsInputTC = convert({\n        schemaComposer,\n        inputTypeComposer: itc,\n      })\n\n      // TODO: array of arrays?\n      const isListType =\n        getNullableType(fieldConfig.type) instanceof GraphQLList\n\n      // elemMatch operator\n      convertedFields[fieldName] = isListType\n        ? getQueryOperatorListInput({\n            schemaComposer,\n            inputTypeComposer: operatorsInputTC,\n          })\n        : operatorsInputTC\n    } else {\n      // GraphQLScalarType || GraphQLEnumType\n      const operatorFields = getQueryOperatorInput({ schemaComposer, type })\n      if (operatorFields) {\n        convertedFields[fieldName] = operatorFields\n      }\n    }\n  })\n\n  convertedITC.addFields(convertedFields)\n  return convertedITC\n}\n\nconst removeEmptyFields = (\n  { schemaComposer, inputTypeComposer },\n  cache = new Set()\n) => {\n  const convert = itc => {\n    if (cache.has(itc)) {\n      return itc\n    }\n    cache.add(itc)\n    const fields = itc.getFields()\n    const nonEmptyFields = {}\n    Object.keys(fields).forEach(fieldName => {\n      const fieldITC = fields[fieldName]\n      if (fieldITC instanceof InputTypeComposer) {\n        const convertedITC = convert(fieldITC)\n        if (convertedITC.getFieldNames().length) {\n          nonEmptyFields[fieldName] = convertedITC\n        }\n      } else {\n        nonEmptyFields[fieldName] = fieldITC\n      }\n    })\n    itc.setFields(nonEmptyFields)\n    return itc\n  }\n  return convert(inputTypeComposer)\n}\n\nconst getFilterInput = ({ schemaComposer, typeComposer }) => {\n  const typeName = typeComposer.getTypeName()\n  const filterInputComposer = schemaComposer.getOrCreateITC(\n    `${typeName}FilterInput`\n  )\n  const inputTypeComposer = typeComposer.getInputTypeComposer()\n\n  // TODO: In Gatsby v2, the NodeInput.id field is of type String, not ID.\n  // Remove this workaround for v3.\n  if (\n    inputTypeComposer.hasField(`id`) &&\n    getNamedType(inputTypeComposer.getFieldType(`id`)).name === `ID`\n  ) {\n    inputTypeComposer.extendField(`id`, { type: `String` })\n  }\n\n  const filterInputTC = convert({\n    schemaComposer,\n    inputTypeComposer,\n    filterInputComposer,\n  })\n\n  return removeEmptyFields({ schemaComposer, inputTypeComposer: filterInputTC })\n}\n\nmodule.exports = { getFilterInput }\n\nconst EQ = `eq`\nconst NE = `ne`\nconst GT = `gt`\nconst GTE = `gte`\nconst LT = `lt`\nconst LTE = `lte`\nconst IN = `in`\nconst NIN = `nin`\nconst REGEX = `regex`\nconst GLOB = `glob`\n\nconst ALLOWED_OPERATORS = {\n  Boolean: [EQ, NE, IN, NIN],\n  Date: [EQ, NE, GT, GTE, LT, LTE, IN, NIN],\n  Float: [EQ, NE, GT, GTE, LT, LTE, IN, NIN],\n  ID: [EQ, NE, IN, NIN],\n  Int: [EQ, NE, GT, GTE, LT, LTE, IN, NIN],\n  JSON: [EQ, NE, IN, NIN, REGEX, GLOB],\n  String: [EQ, NE, IN, NIN, REGEX, GLOB],\n  Enum: [EQ, NE, IN, NIN],\n  CustomScalar: [EQ, NE, IN, NIN],\n}\n\nconst ARRAY_OPERATORS = [IN, NIN]\n\nconst getOperatorFields = (fieldType, operators) => {\n  const result = {}\n  operators.forEach(op => {\n    if (ARRAY_OPERATORS.includes(op)) {\n      result[op] = [fieldType]\n    } else {\n      result[op] = fieldType\n    }\n  })\n  return result\n}\n\nconst getQueryOperatorInput = ({ schemaComposer, type }) => {\n  let typeName\n  if (type instanceof GraphQLEnumType) {\n    typeName = `Enum`\n  } else if (isBuiltInScalarType(type)) {\n    typeName = type.name\n  } else {\n    typeName = `CustomScalar`\n  }\n  const operators = ALLOWED_OPERATORS[typeName]\n  return schemaComposer.getOrCreateITC(type.name + `QueryOperatorInput`, itc =>\n    itc.addFields(getOperatorFields(type, operators))\n  )\n}\n\nconst getQueryOperatorListInput = ({ schemaComposer, inputTypeComposer }) => {\n  const typeName = inputTypeComposer.getTypeName().replace(/Input/, `ListInput`)\n  return schemaComposer.getOrCreateITC(typeName, itc => {\n    itc.addFields({\n      elemMatch: inputTypeComposer,\n    })\n  })\n}\n\nconst isBuiltInScalarType = type =>\n  isSpecifiedScalarType(type) || type === GraphQLDate || type === GraphQLJSON\n"],"file":"filter.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/schema/types/node-interface.js b/node_modules/gatsby/dist/schema/types/node-interface.js
index f5dcca9..476cb63 100644
--- a/node_modules/gatsby/dist/schema/types/node-interface.js
+++ b/node_modules/gatsby/dist/schema/types/node-interface.js
@@ -25,7 +25,9 @@ const getOrCreateNodeInterface = schemaComposer => {
       parent: {
         type: `Node`,
         resolve: (source, args, context, info) => {
-          const path = context.path;
+          const {
+            path
+          } = context;
           return context.nodeModel.getNodeById({
             id: source.parent
           }, {
@@ -36,7 +38,9 @@ const getOrCreateNodeInterface = schemaComposer => {
       children: {
         type: `[Node!]!`,
         resolve: (source, args, context, info) => {
-          const path = context.path;
+          const {
+            path
+          } = context;
           return context.nodeModel.getNodesByIds({
             ids: source.children
           }, {
diff --git a/node_modules/gatsby/dist/schema/types/node-interface.js.map b/node_modules/gatsby/dist/schema/types/node-interface.js.map
index d3b9a38..ab95cc6 100644
--- a/node_modules/gatsby/dist/schema/types/node-interface.js.map
+++ b/node_modules/gatsby/dist/schema/types/node-interface.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/schema/types/node-interface.js"],"names":["getOrCreateNodeInterface","schemaComposer","internalTC","getOrCreateOTC","tc","addFields","content","contentDigest","description","fieldOwners","ignoreType","mediaType","owner","type","getInputTypeComposer","nodeInterfaceTC","getOrCreateIFTC","setDescription","id","parent","resolve","source","args","context","info","path","nodeModel","getNodeById","children","getNodesByIds","ids","internal","getTypeNonNull","nodeInputTC","extendField","addNodeInterface","typeComposer","addInterface","addNodeInterfaceFields","getFields","setResolveType","node","addSchemaMustHaveType","getNodeInterface","module","exports"],"mappings":"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","sourcesContent":["const getOrCreateNodeInterface = schemaComposer => {\n  // TODO: why is `mediaType` on Internal? Applies only to File!?\n  // `fieldOwners` is an object\n  // Should we drop ignoreType?\n  const internalTC = schemaComposer.getOrCreateOTC(`Internal`, tc => {\n    tc.addFields({\n      content: `String`,\n      contentDigest: `String!`,\n      description: `String`,\n      fieldOwners: [`String`],\n      ignoreType: `Boolean`,\n      mediaType: `String`,\n      owner: `String!`,\n      type: `String!`,\n    })\n    // TODO: Can be removed with graphql-compose 5.11\n    tc.getInputTypeComposer()\n  })\n\n  const nodeInterfaceTC = schemaComposer.getOrCreateIFTC(`Node`, tc => {\n    tc.setDescription(`Node Interface`)\n    tc.addFields({\n      id: `ID!`,\n      parent: {\n        type: `Node`,\n        resolve: (source, args, context, info) => {\n          const { path } = context\n          return context.nodeModel.getNodeById({ id: source.parent }, { path })\n        },\n      },\n      children: {\n        type: `[Node!]!`,\n        resolve: (source, args, context, info) => {\n          const { path } = context\n          return context.nodeModel.getNodesByIds(\n            { ids: source.children },\n            { path }\n          )\n        },\n      },\n      internal: internalTC.getTypeNonNull(),\n    })\n    // TODO: In Gatsby v2, the NodeInput.id field is of type String, not ID.\n    // Remove this workaround for v3.\n    const nodeInputTC = tc.getInputTypeComposer()\n    nodeInputTC.extendField(`id`, { type: `String` })\n  })\n\n  return nodeInterfaceTC\n}\n\nconst addNodeInterface = ({ schemaComposer, typeComposer }) => {\n  const nodeInterfaceTC = getOrCreateNodeInterface(schemaComposer)\n  typeComposer.addInterface(nodeInterfaceTC)\n  addNodeInterfaceFields({ schemaComposer, typeComposer })\n}\n\nconst addNodeInterfaceFields = ({ schemaComposer, typeComposer }) => {\n  const nodeInterfaceTC = getOrCreateNodeInterface(schemaComposer)\n  typeComposer.addFields(nodeInterfaceTC.getFields())\n  nodeInterfaceTC.setResolveType(node => node.internal.type)\n  schemaComposer.addSchemaMustHaveType(typeComposer)\n}\n\nconst getNodeInterface = ({ schemaComposer }) =>\n  getOrCreateNodeInterface(schemaComposer)\n\nmodule.exports = {\n  addNodeInterface,\n  addNodeInterfaceFields,\n  getNodeInterface,\n}\n"],"file":"node-interface.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/schema/types/node-interface.js"],"names":["getOrCreateNodeInterface","schemaComposer","internalTC","getOrCreateOTC","tc","addFields","content","contentDigest","description","fieldOwners","ignoreType","mediaType","owner","type","getInputTypeComposer","nodeInterfaceTC","getOrCreateIFTC","setDescription","id","parent","resolve","source","args","context","info","path","nodeModel","getNodeById","children","getNodesByIds","ids","internal","getTypeNonNull","nodeInputTC","extendField","addNodeInterface","typeComposer","addInterface","addNodeInterfaceFields","getFields","setResolveType","node","addSchemaMustHaveType","getNodeInterface","module","exports"],"mappings":"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","sourcesContent":["const getOrCreateNodeInterface = schemaComposer => {\n  // TODO: why is `mediaType` on Internal? Applies only to File!?\n  // `fieldOwners` is an object\n  // Should we drop ignoreType?\n  const internalTC = schemaComposer.getOrCreateOTC(`Internal`, tc => {\n    tc.addFields({\n      content: `String`,\n      contentDigest: `String!`,\n      description: `String`,\n      fieldOwners: [`String`],\n      ignoreType: `Boolean`,\n      mediaType: `String`,\n      owner: `String!`,\n      type: `String!`,\n    })\n    // TODO: Can be removed with graphql-compose 5.11\n    tc.getInputTypeComposer()\n  })\n\n  const nodeInterfaceTC = schemaComposer.getOrCreateIFTC(`Node`, tc => {\n    tc.setDescription(`Node Interface`)\n    tc.addFields({\n      id: `ID!`,\n      parent: {\n        type: `Node`,\n        resolve: (source, args, context, info) => {\n          const { path } = context\n          return context.nodeModel.getNodeById({ id: source.parent }, { path })\n        },\n      },\n      children: {\n        type: `[Node!]!`,\n        resolve: (source, args, context, info) => {\n          const { path } = context\n          return context.nodeModel.getNodesByIds(\n            { ids: source.children },\n            { path }\n          )\n        },\n      },\n      internal: internalTC.getTypeNonNull(),\n    })\n    // TODO: In Gatsby v2, the NodeInput.id field is of type String, not ID.\n    // Remove this workaround for v3.\n    const nodeInputTC = tc.getInputTypeComposer()\n    nodeInputTC.extendField(`id`, { type: `String` })\n  })\n\n  return nodeInterfaceTC\n}\n\nconst addNodeInterface = ({ schemaComposer, typeComposer }) => {\n  const nodeInterfaceTC = getOrCreateNodeInterface(schemaComposer)\n  typeComposer.addInterface(nodeInterfaceTC)\n  addNodeInterfaceFields({ schemaComposer, typeComposer })\n}\n\nconst addNodeInterfaceFields = ({ schemaComposer, typeComposer }) => {\n  const nodeInterfaceTC = getOrCreateNodeInterface(schemaComposer)\n  typeComposer.addFields(nodeInterfaceTC.getFields())\n  nodeInterfaceTC.setResolveType(node => node.internal.type)\n  schemaComposer.addSchemaMustHaveType(typeComposer)\n}\n\nconst getNodeInterface = ({ schemaComposer }) =>\n  getOrCreateNodeInterface(schemaComposer)\n\nmodule.exports = {\n  addNodeInterface,\n  addNodeInterfaceFields,\n  getNodeInterface,\n}\n"],"file":"node-interface.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/schema/types/pagination.js b/node_modules/gatsby/dist/schema/types/pagination.js
index 9350740..c497f49 100644
--- a/node_modules/gatsby/dist/schema/types/pagination.js
+++ b/node_modules/gatsby/dist/schema/types/pagination.js
@@ -1,11 +1,13 @@
 "use strict";
 
-const _require = require(`./sort`),
-      getFieldsEnum = _require.getFieldsEnum;
+const {
+  getFieldsEnum
+} = require(`./sort`);
 
-const _require2 = require(`../resolvers`),
-      distinct = _require2.distinct,
-      group = _require2.group;
+const {
+  distinct,
+  group
+} = require(`../resolvers`);
 
 const getPageInfo = ({
   schemaComposer
@@ -41,7 +43,7 @@ const createPagination = ({
   typeName
 }) => {
   const paginationTypeComposer = schemaComposer.getOrCreateOTC(typeName, tc => {
-    tc.addFields(Object.assign({
+    tc.addFields({
       totalCount: `Int!`,
       edges: [getEdge({
         schemaComposer,
@@ -50,8 +52,9 @@ const createPagination = ({
       nodes: [typeComposer.getTypeNonNull()],
       pageInfo: getPageInfo({
         schemaComposer
-      }).getTypeNonNull()
-    }, fields));
+      }).getTypeNonNull(),
+      ...fields
+    });
   });
   paginationTypeComposer.makeFieldNonNull(`edges`);
   paginationTypeComposer.makeFieldNonNull(`nodes`);
diff --git a/node_modules/gatsby/dist/schema/types/pagination.js.map b/node_modules/gatsby/dist/schema/types/pagination.js.map
index 81ef2e5..76e74cf 100644
--- a/node_modules/gatsby/dist/schema/types/pagination.js.map
+++ b/node_modules/gatsby/dist/schema/types/pagination.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/schema/types/pagination.js"],"names":["require","getFieldsEnum","distinct","group","getPageInfo","schemaComposer","getOrCreateOTC","tc","addFields","hasNextPage","getEdge","typeComposer","typeName","getTypeName","next","node","getTypeNonNull","previous","createPagination","fields","paginationTypeComposer","totalCount","edges","nodes","pageInfo","makeFieldNonNull","getGroup","field","fieldValue","getPagination","inputTypeComposer","getInputTypeComposer","fieldsEnumTC","type","args","resolve","skip","limit","module","exports"],"mappings":";;iBAA0BA,OAAO,CAAE,QAAF,C;MAAzBC,a,YAAAA,a;;kBACoBD,OAAO,CAAE,cAAF,C;MAA3BE,Q,aAAAA,Q;MAAUC,K,aAAAA,K;;AAElB,MAAMC,WAAW,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KAClBA,cAAc,CAACC,cAAf,CAA+B,UAA/B,EAA0CC,EAAE,IAAI;AAC9CA,EAAAA,EAAE,CAACC,SAAH,CAAa;AACXC,IAAAA,WAAW,EAAG,UADH,CAEX;AACA;AACA;AACA;AACA;;AANW,GAAb;AAQD,CATD,CADF;;AAYA,MAAMC,OAAO,GAAG,CAAC;AAAEL,EAAAA,cAAF;AAAkBM,EAAAA;AAAlB,CAAD,KAAsC;AACpD,QAAMC,QAAQ,GAAGD,YAAY,CAACE,WAAb,KAA8B,MAA/C;AACA,SAAOR,cAAc,CAACC,cAAf,CAA8BM,QAA9B,EAAwCL,EAAE,IAAI;AACnDA,IAAAA,EAAE,CAACC,SAAH,CAAa;AACXM,MAAAA,IAAI,EAAEH,YADK;AAEXI,MAAAA,IAAI,EAAEJ,YAAY,CAACK,cAAb,EAFK;AAGXC,MAAAA,QAAQ,EAAEN;AAHC,KAAb;AAKD,GANM,CAAP;AAOD,CATD;;AAWA,MAAMO,gBAAgB,GAAG,CAAC;AACxBb,EAAAA,cADwB;AAExBM,EAAAA,YAFwB;AAGxBQ,EAAAA,MAHwB;AAIxBP,EAAAA;AAJwB,CAAD,KAKnB;AACJ,QAAMQ,sBAAsB,GAAGf,cAAc,CAACC,cAAf,CAA8BM,QAA9B,EAAwCL,EAAE,IAAI;AAC3EA,IAAAA,EAAE,CAACC,SAAH;AACEa,MAAAA,UAAU,EAAG,MADf;AAEEC,MAAAA,KAAK,EAAE,CAACZ,OAAO,CAAC;AAAEL,QAAAA,cAAF;AAAkBM,QAAAA;AAAlB,OAAD,CAAP,CAA0CK,cAA1C,EAAD,CAFT;AAGEO,MAAAA,KAAK,EAAE,CAACZ,YAAY,CAACK,cAAb,EAAD,CAHT;AAIEQ,MAAAA,QAAQ,EAAEpB,WAAW,CAAC;AAAEC,QAAAA;AAAF,OAAD,CAAX,CAAgCW,cAAhC;AAJZ,OAKKG,MALL;AAOD,GAR8B,CAA/B;AASAC,EAAAA,sBAAsB,CAACK,gBAAvB,CAAyC,OAAzC;AACAL,EAAAA,sBAAsB,CAACK,gBAAvB,CAAyC,OAAzC;AACA,SAAOL,sBAAP;AACD,CAlBD;;AAoBA,MAAMM,QAAQ,GAAG,CAAC;AAAErB,EAAAA,cAAF;AAAkBM,EAAAA;AAAlB,CAAD,KAAsC;AACrD,QAAMC,QAAQ,GAAGD,YAAY,CAACE,WAAb,KAA8B,iBAA/C;AACA,QAAMM,MAAM,GAAG;AACbQ,IAAAA,KAAK,EAAG,SADK;AAEbC,IAAAA,UAAU,EAAG;AAFA,GAAf;AAIA,SAAOV,gBAAgB,CAAC;AAAEb,IAAAA,cAAF;AAAkBM,IAAAA,YAAlB;AAAgCQ,IAAAA,MAAhC;AAAwCP,IAAAA;AAAxC,GAAD,CAAvB;AACD,CAPD;;AASA,MAAMiB,aAAa,GAAG,CAAC;AAAExB,EAAAA,cAAF;AAAkBM,EAAAA;AAAlB,CAAD,KAAsC;AAC1D,QAAMmB,iBAAiB,GAAGnB,YAAY,CAACoB,oBAAb,EAA1B;AACA,QAAMnB,QAAQ,GAAGD,YAAY,CAACE,WAAb,KAA8B,YAA/C;AACA,QAAMmB,YAAY,GAAG/B,aAAa,CAAC;AACjCI,IAAAA,cADiC;AAEjCM,IAAAA,YAFiC;AAGjCmB,IAAAA;AAHiC,GAAD,CAAlC;AAKA,QAAMX,MAAM,GAAG;AACbjB,IAAAA,QAAQ,EAAE;AACR+B,MAAAA,IAAI,EAAE,CAAE,SAAF,CADE;AAERC,MAAAA,IAAI,EAAE;AACJP,QAAAA,KAAK,EAAEK,YAAY,CAAChB,cAAb;AADH,OAFE;AAKRmB,MAAAA,OAAO,EAAEjC;AALD,KADG;AAQbC,IAAAA,KAAK,EAAE;AACL8B,MAAAA,IAAI,EAAE,CAACP,QAAQ,CAAC;AAAErB,QAAAA,cAAF;AAAkBM,QAAAA;AAAlB,OAAD,CAAR,CAA2CK,cAA3C,EAAD,CADD;AAELkB,MAAAA,IAAI,EAAE;AACJE,QAAAA,IAAI,EAAG,KADH;AAEJC,QAAAA,KAAK,EAAG,KAFJ;AAGJV,QAAAA,KAAK,EAAEK,YAAY,CAAChB,cAAb;AAHH,OAFD;AAOLmB,MAAAA,OAAO,EAAEhC;AAPJ;AARM,GAAf;AAkBA,QAAMiB,sBAAsB,GAAGF,gBAAgB,CAAC;AAC9Cb,IAAAA,cAD8C;AAE9CM,IAAAA,YAF8C;AAG9CQ,IAAAA,MAH8C;AAI9CP,IAAAA;AAJ8C,GAAD,CAA/C;AAMAQ,EAAAA,sBAAsB,CAACK,gBAAvB,CAAyC,UAAzC;AACAL,EAAAA,sBAAsB,CAACK,gBAAvB,CAAyC,OAAzC;AACA,SAAOL,sBAAP;AACD,CAnCD;;AAqCAkB,MAAM,CAACC,OAAP,GAAiB;AACfnC,EAAAA,WADe;AAEfM,EAAAA,OAFe;AAGfgB,EAAAA,QAHe;AAIfG,EAAAA;AAJe,CAAjB","sourcesContent":["const { getFieldsEnum } = require(`./sort`)\nconst { distinct, group } = require(`../resolvers`)\n\nconst getPageInfo = ({ schemaComposer }) =>\n  schemaComposer.getOrCreateOTC(`PageInfo`, tc => {\n    tc.addFields({\n      hasNextPage: `Boolean!`,\n      // currentPage: `Int!`,\n      // hasPreviousPage: `Boolean!`,\n      // itemCount: `Int!`,\n      // pageCount: `Int!`,\n      // perPage: `Int`,\n    })\n  })\n\nconst getEdge = ({ schemaComposer, typeComposer }) => {\n  const typeName = typeComposer.getTypeName() + `Edge`\n  return schemaComposer.getOrCreateOTC(typeName, tc => {\n    tc.addFields({\n      next: typeComposer,\n      node: typeComposer.getTypeNonNull(),\n      previous: typeComposer,\n    })\n  })\n}\n\nconst createPagination = ({\n  schemaComposer,\n  typeComposer,\n  fields,\n  typeName,\n}) => {\n  const paginationTypeComposer = schemaComposer.getOrCreateOTC(typeName, tc => {\n    tc.addFields({\n      totalCount: `Int!`,\n      edges: [getEdge({ schemaComposer, typeComposer }).getTypeNonNull()],\n      nodes: [typeComposer.getTypeNonNull()],\n      pageInfo: getPageInfo({ schemaComposer }).getTypeNonNull(),\n      ...fields,\n    })\n  })\n  paginationTypeComposer.makeFieldNonNull(`edges`)\n  paginationTypeComposer.makeFieldNonNull(`nodes`)\n  return paginationTypeComposer\n}\n\nconst getGroup = ({ schemaComposer, typeComposer }) => {\n  const typeName = typeComposer.getTypeName() + `GroupConnection`\n  const fields = {\n    field: `String!`,\n    fieldValue: `String`,\n  }\n  return createPagination({ schemaComposer, typeComposer, fields, typeName })\n}\n\nconst getPagination = ({ schemaComposer, typeComposer }) => {\n  const inputTypeComposer = typeComposer.getInputTypeComposer()\n  const typeName = typeComposer.getTypeName() + `Connection`\n  const fieldsEnumTC = getFieldsEnum({\n    schemaComposer,\n    typeComposer,\n    inputTypeComposer,\n  })\n  const fields = {\n    distinct: {\n      type: [`String!`],\n      args: {\n        field: fieldsEnumTC.getTypeNonNull(),\n      },\n      resolve: distinct,\n    },\n    group: {\n      type: [getGroup({ schemaComposer, typeComposer }).getTypeNonNull()],\n      args: {\n        skip: `Int`,\n        limit: `Int`,\n        field: fieldsEnumTC.getTypeNonNull(),\n      },\n      resolve: group,\n    },\n  }\n  const paginationTypeComposer = createPagination({\n    schemaComposer,\n    typeComposer,\n    fields,\n    typeName,\n  })\n  paginationTypeComposer.makeFieldNonNull(`distinct`)\n  paginationTypeComposer.makeFieldNonNull(`group`)\n  return paginationTypeComposer\n}\n\nmodule.exports = {\n  getPageInfo,\n  getEdge,\n  getGroup,\n  getPagination,\n}\n"],"file":"pagination.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/schema/types/pagination.js"],"names":["getFieldsEnum","require","distinct","group","getPageInfo","schemaComposer","getOrCreateOTC","tc","addFields","hasNextPage","getEdge","typeComposer","typeName","getTypeName","next","node","getTypeNonNull","previous","createPagination","fields","paginationTypeComposer","totalCount","edges","nodes","pageInfo","makeFieldNonNull","getGroup","field","fieldValue","getPagination","inputTypeComposer","getInputTypeComposer","fieldsEnumTC","type","args","resolve","skip","limit","module","exports"],"mappings":"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","sourcesContent":["const { getFieldsEnum } = require(`./sort`)\nconst { distinct, group } = require(`../resolvers`)\n\nconst getPageInfo = ({ schemaComposer }) =>\n  schemaComposer.getOrCreateOTC(`PageInfo`, tc => {\n    tc.addFields({\n      hasNextPage: `Boolean!`,\n      // currentPage: `Int!`,\n      // hasPreviousPage: `Boolean!`,\n      // itemCount: `Int!`,\n      // pageCount: `Int!`,\n      // perPage: `Int`,\n    })\n  })\n\nconst getEdge = ({ schemaComposer, typeComposer }) => {\n  const typeName = typeComposer.getTypeName() + `Edge`\n  return schemaComposer.getOrCreateOTC(typeName, tc => {\n    tc.addFields({\n      next: typeComposer,\n      node: typeComposer.getTypeNonNull(),\n      previous: typeComposer,\n    })\n  })\n}\n\nconst createPagination = ({\n  schemaComposer,\n  typeComposer,\n  fields,\n  typeName,\n}) => {\n  const paginationTypeComposer = schemaComposer.getOrCreateOTC(typeName, tc => {\n    tc.addFields({\n      totalCount: `Int!`,\n      edges: [getEdge({ schemaComposer, typeComposer }).getTypeNonNull()],\n      nodes: [typeComposer.getTypeNonNull()],\n      pageInfo: getPageInfo({ schemaComposer }).getTypeNonNull(),\n      ...fields,\n    })\n  })\n  paginationTypeComposer.makeFieldNonNull(`edges`)\n  paginationTypeComposer.makeFieldNonNull(`nodes`)\n  return paginationTypeComposer\n}\n\nconst getGroup = ({ schemaComposer, typeComposer }) => {\n  const typeName = typeComposer.getTypeName() + `GroupConnection`\n  const fields = {\n    field: `String!`,\n    fieldValue: `String`,\n  }\n  return createPagination({ schemaComposer, typeComposer, fields, typeName })\n}\n\nconst getPagination = ({ schemaComposer, typeComposer }) => {\n  const inputTypeComposer = typeComposer.getInputTypeComposer()\n  const typeName = typeComposer.getTypeName() + `Connection`\n  const fieldsEnumTC = getFieldsEnum({\n    schemaComposer,\n    typeComposer,\n    inputTypeComposer,\n  })\n  const fields = {\n    distinct: {\n      type: [`String!`],\n      args: {\n        field: fieldsEnumTC.getTypeNonNull(),\n      },\n      resolve: distinct,\n    },\n    group: {\n      type: [getGroup({ schemaComposer, typeComposer }).getTypeNonNull()],\n      args: {\n        skip: `Int`,\n        limit: `Int`,\n        field: fieldsEnumTC.getTypeNonNull(),\n      },\n      resolve: group,\n    },\n  }\n  const paginationTypeComposer = createPagination({\n    schemaComposer,\n    typeComposer,\n    fields,\n    typeName,\n  })\n  paginationTypeComposer.makeFieldNonNull(`distinct`)\n  paginationTypeComposer.makeFieldNonNull(`group`)\n  return paginationTypeComposer\n}\n\nmodule.exports = {\n  getPageInfo,\n  getEdge,\n  getGroup,\n  getPagination,\n}\n"],"file":"pagination.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/schema/types/sort.js b/node_modules/gatsby/dist/schema/types/sort.js
index e3c60a5..4903644 100644
--- a/node_modules/gatsby/dist/schema/types/sort.js
+++ b/node_modules/gatsby/dist/schema/types/sort.js
@@ -1,10 +1,11 @@
 "use strict";
 
-const _require = require(`graphql`),
-      getNamedType = _require.getNamedType,
-      getNullableType = _require.getNullableType,
-      GraphQLInputObjectType = _require.GraphQLInputObjectType,
-      GraphQLList = _require.GraphQLList;
+const {
+  getNamedType,
+  getNullableType,
+  GraphQLInputObjectType,
+  GraphQLList
+} = require(`graphql`);
 
 const getSortOrderEnum = ({
   schemaComposer
diff --git a/node_modules/gatsby/dist/schema/types/sort.js.map b/node_modules/gatsby/dist/schema/types/sort.js.map
index 7a27249..dbb6dda 100644
--- a/node_modules/gatsby/dist/schema/types/sort.js.map
+++ b/node_modules/gatsby/dist/schema/types/sort.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/schema/types/sort.js"],"names":["require","getNamedType","getNullableType","GraphQLInputObjectType","GraphQLList","getSortOrderEnum","schemaComposer","getOrCreateETC","etc","setFields","ASC","value","DESC","getFieldsEnum","typeComposer","inputTypeComposer","typeName","getTypeName","fieldsEnumTypeComposer","fields","convert","getFields","getSortInput","getInputTypeComposer","sortOrderEnumTC","fieldsEnumTC","getOrCreateITC","itc","addFields","order","type","defaultValue","module","exports","MAX_SORT_DEPTH","SORT_FIELD_DELIMITER","prefix","depth","sortFields","Object","keys","forEach","fieldName","fieldConfig","sortKey","sortKeyFieldName","split","join","assign"],"mappings":";;iBAOIA,OAAO,CAAE,SAAF,C;MAJTC,Y,YAAAA,Y;MACAC,e,YAAAA,e;MACAC,sB,YAAAA,sB;MACAC,W,YAAAA,W;;AAGF,MAAMC,gBAAgB,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KACvBA,cAAc,CAACC,cAAf,CAA+B,eAA/B,EAA+CC,GAAG,IAAI;AACpDA,EAAAA,GAAG,CAACC,SAAJ,CAAc;AACZC,IAAAA,GAAG,EAAE;AAAEC,MAAAA,KAAK,EAAG;AAAV,KADO;AAEZC,IAAAA,IAAI,EAAE;AAAED,MAAAA,KAAK,EAAG;AAAV;AAFM,GAAd;AAID,CALD,CADF;;AAQA,MAAME,aAAa,GAAG,CAAC;AAAEP,EAAAA,cAAF;AAAkBQ,EAAAA,YAAlB;AAAgCC,EAAAA;AAAhC,CAAD,KAAyD;AAC7E,QAAMC,QAAQ,GAAGF,YAAY,CAACG,WAAb,EAAjB;AACA,QAAMC,sBAAsB,GAAGZ,cAAc,CAACC,cAAf,CAC5B,GAAES,QAAS,YADiB,CAA/B;AAGA,QAAMG,MAAM,GAAGC,OAAO,CAACL,iBAAiB,CAACM,SAAlB,EAAD,CAAtB;AACAH,EAAAA,sBAAsB,CAACT,SAAvB,CAAiCU,MAAjC;AACA,SAAOD,sBAAP;AACD,CARD;;AAUA,MAAMI,YAAY,GAAG,CAAC;AAAEhB,EAAAA,cAAF;AAAkBQ,EAAAA;AAAlB,CAAD,KAAsC;AACzD,QAAMC,iBAAiB,GAAGD,YAAY,CAACS,oBAAb,EAA1B;AACA,QAAMC,eAAe,GAAGnB,gBAAgB,CAAC;AAAEC,IAAAA;AAAF,GAAD,CAAxC;AACA,QAAMmB,YAAY,GAAGZ,aAAa,CAAC;AACjCP,IAAAA,cADiC;AAEjCQ,IAAAA,YAFiC;AAGjCC,IAAAA;AAHiC,GAAD,CAAlC;AAKA,QAAMC,QAAQ,GAAGF,YAAY,CAACG,WAAb,EAAjB;AAEA,SAAOX,cAAc,CAACoB,cAAf,CAA+B,GAAEV,QAAS,WAA1C,EAAsDW,GAAG,IAAI;AAClEA,IAAAA,GAAG,CAACC,SAAJ,CAAc;AACZT,MAAAA,MAAM,EAAE,CAACM,YAAD,CADI;AAEZI,MAAAA,KAAK,EAAE;AAAEC,QAAAA,IAAI,EAAE,CAACN,eAAD,CAAR;AAA2BO,QAAAA,YAAY,EAAE,CAAE,KAAF;AAAzC;AAFK,KAAd;AAID,GALM,CAAP;AAMD,CAhBD;;AAkBAC,MAAM,CAACC,OAAP,GAAiB;AAAEX,EAAAA,YAAF;AAAgBT,EAAAA,aAAhB;AAA+BR,EAAAA;AAA/B,CAAjB;AAEA,MAAM6B,cAAc,GAAG,CAAvB;AACA,MAAMC,oBAAoB,GAAI,KAA9B;;AAEA,MAAMf,OAAO,GAAG,CAACD,MAAD,EAASiB,MAAM,GAAG,IAAlB,EAAwBC,KAAK,GAAG,CAAhC,KAAsC;AACpD,QAAMC,UAAU,GAAG,EAAnB;AAEAC,EAAAA,MAAM,CAACC,IAAP,CAAYrB,MAAZ,EAAoBsB,OAApB,CAA4BC,SAAS,IAAI;AACvC,UAAMC,WAAW,GAAGxB,MAAM,CAACuB,SAAD,CAA1B;AACA,UAAME,OAAO,GAAGR,MAAM,GAAI,GAAEA,MAAO,IAAGM,SAAU,EAA1B,GAA8BA,SAApD;AACA,UAAMG,gBAAgB,GAAGD,OAAO,CAACE,KAAR,CAAe,GAAf,EAAmBC,IAAnB,CAAwBZ,oBAAxB,CAAzB,CAHuC,CAKvC;;AACA,QAAIjC,eAAe,CAACyC,WAAW,CAACb,IAAb,CAAf,YAA6C1B,WAAjD,EAA8D;AAC5DkC,MAAAA,UAAU,CAACO,gBAAD,CAAV,GAA+B;AAC7BlC,QAAAA,KAAK,EAAEiC;AADsB,OAA/B;AAGD;;AAED,UAAMd,IAAI,GAAG7B,YAAY,CAAC0C,WAAW,CAACb,IAAb,CAAzB;;AACA,QAAIA,IAAI,YAAY3B,sBAApB,EAA4C;AAC1C,UAAIkC,KAAK,GAAGH,cAAZ,EAA4B;AAC1BK,QAAAA,MAAM,CAACS,MAAP,CAAcV,UAAd,EAA0BlB,OAAO,CAACU,IAAI,CAACT,SAAL,EAAD,EAAmBuB,OAAnB,EAA4BP,KAAK,GAAG,CAApC,CAAjC;AACD;AACF,KAJD,MAIO;AACL;AACAC,MAAAA,UAAU,CAACO,gBAAD,CAAV,GAA+B;AAC7BlC,QAAAA,KAAK,EAAEiC;AADsB,OAA/B;AAGD;AACF,GAvBD;AAwBA,SAAON,UAAP;AACD,CA5BD","sourcesContent":["// @flow\n\nconst {\n  getNamedType,\n  getNullableType,\n  GraphQLInputObjectType,\n  GraphQLList,\n} = require(`graphql`)\n\nconst getSortOrderEnum = ({ schemaComposer }) =>\n  schemaComposer.getOrCreateETC(`SortOrderEnum`, etc => {\n    etc.setFields({\n      ASC: { value: `ASC` },\n      DESC: { value: `DESC` },\n    })\n  })\n\nconst getFieldsEnum = ({ schemaComposer, typeComposer, inputTypeComposer }) => {\n  const typeName = typeComposer.getTypeName()\n  const fieldsEnumTypeComposer = schemaComposer.getOrCreateETC(\n    `${typeName}FieldsEnum`\n  )\n  const fields = convert(inputTypeComposer.getFields())\n  fieldsEnumTypeComposer.setFields(fields)\n  return fieldsEnumTypeComposer\n}\n\nconst getSortInput = ({ schemaComposer, typeComposer }) => {\n  const inputTypeComposer = typeComposer.getInputTypeComposer()\n  const sortOrderEnumTC = getSortOrderEnum({ schemaComposer })\n  const fieldsEnumTC = getFieldsEnum({\n    schemaComposer,\n    typeComposer,\n    inputTypeComposer,\n  })\n  const typeName = typeComposer.getTypeName()\n\n  return schemaComposer.getOrCreateITC(`${typeName}SortInput`, itc => {\n    itc.addFields({\n      fields: [fieldsEnumTC],\n      order: { type: [sortOrderEnumTC], defaultValue: [`ASC`] },\n    })\n  })\n}\n\nmodule.exports = { getSortInput, getFieldsEnum, getSortOrderEnum }\n\nconst MAX_SORT_DEPTH = 3\nconst SORT_FIELD_DELIMITER = `___`\n\nconst convert = (fields, prefix = null, depth = 0) => {\n  const sortFields = {}\n\n  Object.keys(fields).forEach(fieldName => {\n    const fieldConfig = fields[fieldName]\n    const sortKey = prefix ? `${prefix}.${fieldName}` : fieldName\n    const sortKeyFieldName = sortKey.split(`.`).join(SORT_FIELD_DELIMITER)\n\n    // XXX(freiksenet): this is to preserve legacy behaviour, this probably doesn't actually sort\n    if (getNullableType(fieldConfig.type) instanceof GraphQLList) {\n      sortFields[sortKeyFieldName] = {\n        value: sortKey,\n      }\n    }\n\n    const type = getNamedType(fieldConfig.type)\n    if (type instanceof GraphQLInputObjectType) {\n      if (depth < MAX_SORT_DEPTH) {\n        Object.assign(sortFields, convert(type.getFields(), sortKey, depth + 1))\n      }\n    } else {\n      // GraphQLScalarType || GraphQLEnumType\n      sortFields[sortKeyFieldName] = {\n        value: sortKey,\n      }\n    }\n  })\n  return sortFields\n}\n"],"file":"sort.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/schema/types/sort.js"],"names":["getNamedType","getNullableType","GraphQLInputObjectType","GraphQLList","require","getSortOrderEnum","schemaComposer","getOrCreateETC","etc","setFields","ASC","value","DESC","getFieldsEnum","typeComposer","inputTypeComposer","typeName","getTypeName","fieldsEnumTypeComposer","fields","convert","getFields","getSortInput","getInputTypeComposer","sortOrderEnumTC","fieldsEnumTC","getOrCreateITC","itc","addFields","order","type","defaultValue","module","exports","MAX_SORT_DEPTH","SORT_FIELD_DELIMITER","prefix","depth","sortFields","Object","keys","forEach","fieldName","fieldConfig","sortKey","sortKeyFieldName","split","join","assign"],"mappings":"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","sourcesContent":["// @flow\n\nconst {\n  getNamedType,\n  getNullableType,\n  GraphQLInputObjectType,\n  GraphQLList,\n} = require(`graphql`)\n\nconst getSortOrderEnum = ({ schemaComposer }) =>\n  schemaComposer.getOrCreateETC(`SortOrderEnum`, etc => {\n    etc.setFields({\n      ASC: { value: `ASC` },\n      DESC: { value: `DESC` },\n    })\n  })\n\nconst getFieldsEnum = ({ schemaComposer, typeComposer, inputTypeComposer }) => {\n  const typeName = typeComposer.getTypeName()\n  const fieldsEnumTypeComposer = schemaComposer.getOrCreateETC(\n    `${typeName}FieldsEnum`\n  )\n  const fields = convert(inputTypeComposer.getFields())\n  fieldsEnumTypeComposer.setFields(fields)\n  return fieldsEnumTypeComposer\n}\n\nconst getSortInput = ({ schemaComposer, typeComposer }) => {\n  const inputTypeComposer = typeComposer.getInputTypeComposer()\n  const sortOrderEnumTC = getSortOrderEnum({ schemaComposer })\n  const fieldsEnumTC = getFieldsEnum({\n    schemaComposer,\n    typeComposer,\n    inputTypeComposer,\n  })\n  const typeName = typeComposer.getTypeName()\n\n  return schemaComposer.getOrCreateITC(`${typeName}SortInput`, itc => {\n    itc.addFields({\n      fields: [fieldsEnumTC],\n      order: { type: [sortOrderEnumTC], defaultValue: [`ASC`] },\n    })\n  })\n}\n\nmodule.exports = { getSortInput, getFieldsEnum, getSortOrderEnum }\n\nconst MAX_SORT_DEPTH = 3\nconst SORT_FIELD_DELIMITER = `___`\n\nconst convert = (fields, prefix = null, depth = 0) => {\n  const sortFields = {}\n\n  Object.keys(fields).forEach(fieldName => {\n    const fieldConfig = fields[fieldName]\n    const sortKey = prefix ? `${prefix}.${fieldName}` : fieldName\n    const sortKeyFieldName = sortKey.split(`.`).join(SORT_FIELD_DELIMITER)\n\n    // XXX(freiksenet): this is to preserve legacy behaviour, this probably doesn't actually sort\n    if (getNullableType(fieldConfig.type) instanceof GraphQLList) {\n      sortFields[sortKeyFieldName] = {\n        value: sortKey,\n      }\n    }\n\n    const type = getNamedType(fieldConfig.type)\n    if (type instanceof GraphQLInputObjectType) {\n      if (depth < MAX_SORT_DEPTH) {\n        Object.assign(sortFields, convert(type.getFields(), sortKey, depth + 1))\n      }\n    } else {\n      // GraphQLScalarType || GraphQLEnumType\n      sortFields[sortKeyFieldName] = {\n        value: sortKey,\n      }\n    }\n  })\n  return sortFields\n}\n"],"file":"sort.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/schema/utils/get-value-at.js b/node_modules/gatsby/dist/schema/utils/get-value-at.js
index 5d88e88..7094fbc 100644
--- a/node_modules/gatsby/dist/schema/utils/get-value-at.js
+++ b/node_modules/gatsby/dist/schema/utils/get-value-at.js
@@ -5,7 +5,7 @@ const getValueAt = (obj, selector) => {
   return selectors.reduce((acc, key) => {
     if (acc && typeof acc === `object`) {
       if (Array.isArray(acc)) {
-        return acc.map(a => a[key]).filter(a => a !== undefined);
+        return acc.map(a => a && typeof a === `object` ? a[key] : undefined).filter(a => a !== undefined);
       }
 
       return acc[key];
diff --git a/node_modules/gatsby/dist/schema/utils/get-value-at.js.map b/node_modules/gatsby/dist/schema/utils/get-value-at.js.map
index 53ed6ca..3eeeab0 100644
--- a/node_modules/gatsby/dist/schema/utils/get-value-at.js.map
+++ b/node_modules/gatsby/dist/schema/utils/get-value-at.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/schema/utils/get-value-at.js"],"names":["getValueAt","obj","selector","selectors","Array","isArray","split","reduce","acc","key","map","a","filter","undefined","module","exports"],"mappings":";;AAAA,MAAMA,UAAU,GAAG,CAACC,GAAD,EAAMC,QAAN,KAAmB;AACpC,QAAMC,SAAS,GAAGC,KAAK,CAACC,OAAN,CAAcH,QAAd,IAA0BA,QAA1B,GAAqCA,QAAQ,CAACI,KAAT,CAAgB,GAAhB,CAAvD;AACA,SAAOH,SAAS,CAACI,MAAV,CAAiB,CAACC,GAAD,EAAMC,GAAN,KAAc;AACpC,QAAID,GAAG,IAAI,OAAOA,GAAP,KAAgB,QAA3B,EAAoC;AAClC,UAAIJ,KAAK,CAACC,OAAN,CAAcG,GAAd,CAAJ,EAAwB;AACtB,eAAOA,GAAG,CAACE,GAAJ,CAAQC,CAAC,IAAIA,CAAC,CAACF,GAAD,CAAd,EAAqBG,MAArB,CAA4BD,CAAC,IAAIA,CAAC,KAAKE,SAAvC,CAAP;AACD;;AACD,aAAOL,GAAG,CAACC,GAAD,CAAV;AACD;;AACD,WAAOI,SAAP;AACD,GARM,EAQJZ,GARI,CAAP;AASD,CAXD;;AAaAa,MAAM,CAACC,OAAP,GAAiB;AAAEf,EAAAA;AAAF,CAAjB","sourcesContent":["const getValueAt = (obj, selector) => {\n  const selectors = Array.isArray(selector) ? selector : selector.split(`.`)\n  return selectors.reduce((acc, key) => {\n    if (acc && typeof acc === `object`) {\n      if (Array.isArray(acc)) {\n        return acc.map(a => a[key]).filter(a => a !== undefined)\n      }\n      return acc[key]\n    }\n    return undefined\n  }, obj)\n}\n\nmodule.exports = { getValueAt }\n"],"file":"get-value-at.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/schema/utils/get-value-at.js"],"names":["getValueAt","obj","selector","selectors","Array","isArray","split","reduce","acc","key","map","a","undefined","filter","module","exports"],"mappings":";;AAAA,MAAMA,UAAU,GAAG,CAACC,GAAD,EAAMC,QAAN,KAAmB;AACpC,QAAMC,SAAS,GAAGC,KAAK,CAACC,OAAN,CAAcH,QAAd,IAA0BA,QAA1B,GAAqCA,QAAQ,CAACI,KAAT,CAAgB,GAAhB,CAAvD;AACA,SAAOH,SAAS,CAACI,MAAV,CAAiB,CAACC,GAAD,EAAMC,GAAN,KAAc;AACpC,QAAID,GAAG,IAAI,OAAOA,GAAP,KAAgB,QAA3B,EAAoC;AAClC,UAAIJ,KAAK,CAACC,OAAN,CAAcG,GAAd,CAAJ,EAAwB;AACtB,eAAOA,GAAG,CACPE,GADI,CACAC,CAAC,IAAKA,CAAC,IAAI,OAAOA,CAAP,KAAc,QAAnB,GAA6BA,CAAC,CAACF,GAAD,CAA9B,GAAsCG,SAD5C,EAEJC,MAFI,CAEGF,CAAC,IAAIA,CAAC,KAAKC,SAFd,CAAP;AAGD;;AACD,aAAOJ,GAAG,CAACC,GAAD,CAAV;AACD;;AACD,WAAOG,SAAP;AACD,GAVM,EAUJX,GAVI,CAAP;AAWD,CAbD;;AAeAa,MAAM,CAACC,OAAP,GAAiB;AAAEf,EAAAA;AAAF,CAAjB","sourcesContent":["const getValueAt = (obj, selector) => {\n  const selectors = Array.isArray(selector) ? selector : selector.split(`.`)\n  return selectors.reduce((acc, key) => {\n    if (acc && typeof acc === `object`) {\n      if (Array.isArray(acc)) {\n        return acc\n          .map(a => (a && typeof a === `object` ? a[key] : undefined))\n          .filter(a => a !== undefined)\n      }\n      return acc[key]\n    }\n    return undefined\n  }, obj)\n}\n\nmodule.exports = { getValueAt }\n"],"file":"get-value-at.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/utils/api-runner-node.js b/node_modules/gatsby/dist/utils/api-runner-node.js
index 4c5391c..1378b05 100644
--- a/node_modules/gatsby/dist/utils/api-runner-node.js
+++ b/node_modules/gatsby/dist/utils/api-runner-node.js
@@ -1,13 +1,7 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const Promise = require(`bluebird`);
 
-const glob = require(`glob`);
-
 const _ = require(`lodash`);
 
 const chalk = require(`chalk`);
@@ -24,24 +18,34 @@ const createNodeId = require(`./create-node-id`);
 
 const createContentDigest = require(`./create-content-digest`);
 
-const _require = require(`../schema/types/type-builders`),
-      buildObjectType = _require.buildObjectType,
-      buildUnionType = _require.buildUnionType,
-      buildInterfaceType = _require.buildInterfaceType,
-      buildInputObjectType = _require.buildInputObjectType;
-
-const _require2 = require(`../redux`),
-      emitter = _require2.emitter;
-
-const _require3 = require(`./stack-trace-utils`),
-      getNonGatsbyCodeFrame = _require3.getNonGatsbyCodeFrame; // Bind action creators per plugin so we can auto-add
+const {
+  buildObjectType,
+  buildUnionType,
+  buildInterfaceType,
+  buildInputObjectType
+} = require(`../schema/types/type-builders`);
+
+const {
+  emitter
+} = require(`../redux`);
+
+const {
+  getNonGatsbyCodeFrame
+} = require(`./stack-trace-utils`);
+
+const {
+  trackBuildError,
+  decorateEvent
+} = require(`gatsby-telemetry`); // Bind action creators per plugin so we can auto-add
 // metadata to actions they create.
 
 
 const boundPluginActionCreators = {};
 
 const doubleBind = (boundActionCreators, api, plugin, actionOptions) => {
-  const traceId = actionOptions.traceId;
+  const {
+    traceId
+  } = actionOptions;
 
   if (boundPluginActionCreators[plugin.name + api + traceId]) {
     return boundPluginActionCreators[plugin.name + api + traceId];
@@ -99,24 +103,27 @@ const runAPI = (plugin, api, args) => {
     pluginSpan.setTag(`plugin`, plugin.name);
     let pathPrefix = ``;
 
-    const _require4 = require(`../redux`),
-          store = _require4.store,
-          emitter = _require4.emitter;
+    const {
+      store,
+      emitter
+    } = require(`../redux`);
 
-    const _require5 = require(`../db/nodes`),
-          loadNodeContent = _require5.loadNodeContent,
-          getNodes = _require5.getNodes,
-          getNode = _require5.getNode,
-          getNodesByType = _require5.getNodesByType,
-          hasNodeChanged = _require5.hasNodeChanged,
-          getNodeAndSavePathDependency = _require5.getNodeAndSavePathDependency;
+    const {
+      loadNodeContent,
+      getNodes,
+      getNode,
+      getNodesByType,
+      hasNodeChanged,
+      getNodeAndSavePathDependency
+    } = require(`../db/nodes`);
 
-    const _require6 = require(`../redux/actions`),
-          boundActionCreators = _require6.boundActionCreators;
+    const {
+      boundActionCreators
+    } = require(`../redux/actions`);
 
-    const doubleBoundActionCreators = doubleBind(boundActionCreators, api, plugin, Object.assign({}, args, {
+    const doubleBoundActionCreators = doubleBind(boundActionCreators, api, plugin, { ...args,
       parentSpan: pluginSpan
-    }));
+    });
 
     if (store.getState().program.prefixPaths) {
       pathPrefix = store.getState().config.pathPrefix;
@@ -138,7 +145,7 @@ const runAPI = (plugin, api, args) => {
       // reassign createPage field as this would cause this extra logic
       // to be used in subsequent APIs and we only want to target this `createPages` call.
 
-      actions = Object.assign({}, actions, {
+      actions = { ...actions,
         createPage: (...args) => {
           createPageAction(...args);
 
@@ -158,10 +165,10 @@ const runAPI = (plugin, api, args) => {
             alreadyDisplayed = true;
           }
         }
-      });
+      };
     }
 
-    const apiCallArgs = [Object.assign({}, args, {
+    const apiCallArgs = [{ ...args,
       pathPrefix,
       boundActionCreators: actions,
       actions,
@@ -185,7 +192,7 @@ const runAPI = (plugin, api, args) => {
         buildInterfaceType,
         buildInputObjectType
       }
-    }), plugin.pluginOptions]; // If the plugin is using a callback use that otherwise
+    }, plugin.pluginOptions]; // If the plugin is using a callback use that otherwise
     // expect a Promise to be returned.
 
     if (gatsbyNode[api].length === 3) {
@@ -196,7 +203,15 @@ const runAPI = (plugin, api, args) => {
           apiFinished = true;
         };
 
-        gatsbyNode[api](...apiCallArgs, cb);
+        try {
+          gatsbyNode[api](...apiCallArgs, cb);
+        } catch (e) {
+          trackBuildError(api, {
+            error: e,
+            pluginName: `${plugin.name}@${plugin.version}`
+          });
+          throw e;
+        }
       });
     } else {
       const result = gatsbyNode[api](...apiCallArgs);
@@ -211,185 +226,167 @@ const runAPI = (plugin, api, args) => {
   return null;
 };
 
-let filteredPlugins;
-
-const hasAPIFile = plugin => glob.sync(`${plugin.resolve}/gatsby-node*`)[0];
-
 let apisRunningById = new Map();
 let apisRunningByTraceId = new Map();
 let waitingForCasacadeToFinish = [];
 
-module.exports =
-/*#__PURE__*/
-function () {
-  var _ref = (0, _asyncToGenerator2.default)(function* (api, args = {}, pluginSource) {
-    return new Promise(resolve => {
-      const parentSpan = args.parentSpan;
-      const apiSpanArgs = parentSpan ? {
-        childOf: parentSpan
-      } : {};
-      const apiSpan = tracer.startSpan(`run-api`, apiSpanArgs);
-      apiSpan.setTag(`api`, api);
-
-      _.forEach(args.traceTags, (value, key) => {
-        apiSpan.setTag(key, value);
-      }); // Check that the API is documented.
-      // "FAKE_API_CALL" is used when code needs to trigger something
-      // to happen once the the API queue is empty. Ideally of course
-      // we'd have an API (returning a promise) for that. But this
-      // works nicely in the meantime.
-
-
-      if (!apiList[api] && api !== `FAKE_API_CALL`) {
-        reporter.panic(`api: "${api}" is not a valid Gatsby api`);
-      }
-
-      const _require7 = require(`../redux`),
-            store = _require7.store;
-
-      const plugins = store.getState().flattenedPlugins; // Get the list of plugins that implement gatsby-node
-
-      if (!filteredPlugins) {
-        filteredPlugins = plugins.filter(plugin => hasAPIFile(plugin));
-      } // Break infinite loops.
-      // Sometimes a plugin will implement an API and call an
-      // action which will trigger the same API being called.
-      // "onCreatePage" is the only example right now.
-      // In these cases, we should avoid calling the originating plugin
-      // again.
+module.exports = async (api, args = {}, pluginSource) => new Promise(resolve => {
+  const {
+    parentSpan
+  } = args;
+  const apiSpanArgs = parentSpan ? {
+    childOf: parentSpan
+  } : {};
+  const apiSpan = tracer.startSpan(`run-api`, apiSpanArgs);
+  apiSpan.setTag(`api`, api);
+
+  _.forEach(args.traceTags, (value, key) => {
+    apiSpan.setTag(key, value);
+  }); // Check that the API is documented.
+  // "FAKE_API_CALL" is used when code needs to trigger something
+  // to happen once the the API queue is empty. Ideally of course
+  // we'd have an API (returning a promise) for that. But this
+  // works nicely in the meantime.
+
+
+  if (!apiList[api] && api !== `FAKE_API_CALL`) {
+    reporter.panic(`api: "${api}" is not a valid Gatsby api`);
+  }
 
+  const {
+    store
+  } = require(`../redux`);
+
+  const plugins = store.getState().flattenedPlugins; // Get the list of plugins that implement this API.
+  // Also: Break infinite loops. Sometimes a plugin will implement an API and
+  // call an action which will trigger the same API being called.
+  // `onCreatePage` is the only example right now. In these cases, we should
+  // avoid calling the originating plugin again.
+
+  const implementingPlugins = plugins.filter(plugin => plugin.nodeAPIs.includes(api) && plugin.name !== pluginSource);
+  const apiRunInstance = {
+    api,
+    args,
+    pluginSource,
+    resolve,
+    span: apiSpan,
+    startTime: new Date().toJSON(),
+    traceId: args.traceId // Generate IDs for api runs. Most IDs we generate from the args
+    // but some API calls can have very large argument objects so we
+    // have special ways of generating IDs for those to avoid stringifying
+    // large objects.
 
-      let noSourcePluginPlugins = filteredPlugins;
+  };
+  let id;
+
+  if (api === `setFieldsOnGraphQLNodeType`) {
+    id = `${api}${apiRunInstance.startTime}${args.type.name}${args.traceId}`;
+  } else if (api === `onCreateNode`) {
+    id = `${api}${apiRunInstance.startTime}${args.node.internal.contentDigest}${args.traceId}`;
+  } else if (api === `preprocessSource`) {
+    id = `${api}${apiRunInstance.startTime}${args.filename}${args.traceId}`;
+  } else if (api === `onCreatePage`) {
+    id = `${api}${apiRunInstance.startTime}${args.page.path}${args.traceId}`;
+  } else {
+    // When tracing is turned on, the `args` object will have a
+    // `parentSpan` field that can be quite large. So we omit it
+    // before calling stringify
+    const argsJson = JSON.stringify(_.omit(args, `parentSpan`));
+    id = `${api}|${apiRunInstance.startTime}|${apiRunInstance.traceId}|${argsJson}`;
+  }
 
-      if (pluginSource) {
-        noSourcePluginPlugins = filteredPlugins.filter(p => p.name !== pluginSource);
-      }
+  apiRunInstance.id = id;
 
-      const apiRunInstance = {
-        api,
-        args,
-        pluginSource,
-        resolve,
-        span: apiSpan,
-        startTime: new Date().toJSON(),
-        traceId: args.traceId // Generate IDs for api runs. Most IDs we generate from the args
-        // but some API calls can have very large argument objects so we
-        // have special ways of generating IDs for those to avoid stringifying
-        // large objects.
+  if (args.waitForCascadingActions) {
+    waitingForCasacadeToFinish.push(apiRunInstance);
+  }
 
-      };
-      let id;
-
-      if (api === `setFieldsOnGraphQLNodeType`) {
-        id = `${api}${apiRunInstance.startTime}${args.type.name}${args.traceId}`;
-      } else if (api === `onCreateNode`) {
-        id = `${api}${apiRunInstance.startTime}${args.node.internal.contentDigest}${args.traceId}`;
-      } else if (api === `preprocessSource`) {
-        id = `${api}${apiRunInstance.startTime}${args.filename}${args.traceId}`;
-      } else if (api === `onCreatePage`) {
-        id = `${api}${apiRunInstance.startTime}${args.page.path}${args.traceId}`;
-      } else {
-        // When tracing is turned on, the `args` object will have a
-        // `parentSpan` field that can be quite large. So we omit it
-        // before calling stringify
-        const argsJson = JSON.stringify(_.omit(args, `parentSpan`));
-        id = `${api}|${apiRunInstance.startTime}|${apiRunInstance.traceId}|${argsJson}`;
-      }
+  apisRunningById.set(apiRunInstance.id, apiRunInstance);
 
-      apiRunInstance.id = id;
+  if (apisRunningByTraceId.has(apiRunInstance.traceId)) {
+    const currentCount = apisRunningByTraceId.get(apiRunInstance.traceId);
+    apisRunningByTraceId.set(apiRunInstance.traceId, currentCount + 1);
+  } else {
+    apisRunningByTraceId.set(apiRunInstance.traceId, 1);
+  }
 
-      if (args.waitForCascadingActions) {
-        waitingForCasacadeToFinish.push(apiRunInstance);
-      }
+  let stopQueuedApiRuns = false;
+  let onAPIRunComplete = null;
 
-      apisRunningById.set(apiRunInstance.id, apiRunInstance);
+  if (api === `onCreatePage`) {
+    const path = args.page.path;
 
-      if (apisRunningByTraceId.has(apiRunInstance.traceId)) {
-        const currentCount = apisRunningByTraceId.get(apiRunInstance.traceId);
-        apisRunningByTraceId.set(apiRunInstance.traceId, currentCount + 1);
-      } else {
-        apisRunningByTraceId.set(apiRunInstance.traceId, 1);
+    const actionHandler = action => {
+      if (action.payload.path === path) {
+        stopQueuedApiRuns = true;
       }
+    };
 
-      let stopQueuedApiRuns = false;
-      let onAPIRunComplete = null;
-
-      if (api === `onCreatePage`) {
-        const path = args.page.path;
-
-        const actionHandler = action => {
-          if (action.payload.path === path) {
-            stopQueuedApiRuns = true;
-          }
-        };
-
-        emitter.on(`DELETE_PAGE`, actionHandler);
+    emitter.on(`DELETE_PAGE`, actionHandler);
 
-        onAPIRunComplete = () => {
-          emitter.off(`DELETE_PAGE`, actionHandler);
-        };
-      }
+    onAPIRunComplete = () => {
+      emitter.off(`DELETE_PAGE`, actionHandler);
+    };
+  }
 
-      Promise.mapSeries(noSourcePluginPlugins, plugin => {
-        if (stopQueuedApiRuns) {
-          return null;
-        }
+  Promise.mapSeries(implementingPlugins, plugin => {
+    if (stopQueuedApiRuns) {
+      return null;
+    }
 
-        let pluginName = plugin.name === `default-site-plugin` ? `gatsby-node.js` : `Plugin ${plugin.name}`;
-        return new Promise(resolve => {
-          resolve(runAPI(plugin, api, Object.assign({}, args, {
-            parentSpan: apiSpan
-          })));
-        }).catch(err => {
-          reporter.panicOnBuild(`${pluginName} returned an error`, err);
-          return null;
-        });
-      }).then(results => {
-        if (onAPIRunComplete) {
-          onAPIRunComplete();
-        } // Remove runner instance
+    let pluginName = plugin.name === `default-site-plugin` ? `gatsby-node.js` : `Plugin ${plugin.name}`;
+    return new Promise(resolve => {
+      resolve(runAPI(plugin, api, { ...args,
+        parentSpan: apiSpan
+      }));
+    }).catch(err => {
+      decorateEvent(`BUILD_PANIC`, {
+        pluginName: `${plugin.name}@${plugin.version}`
+      });
+      reporter.panicOnBuild(`${pluginName} returned an error`, err);
+      return null;
+    });
+  }).then(results => {
+    if (onAPIRunComplete) {
+      onAPIRunComplete();
+    } // Remove runner instance
 
 
-        apisRunningById.delete(apiRunInstance.id);
-        const currentCount = apisRunningByTraceId.get(apiRunInstance.traceId);
-        apisRunningByTraceId.set(apiRunInstance.traceId, currentCount - 1);
+    apisRunningById.delete(apiRunInstance.id);
+    const currentCount = apisRunningByTraceId.get(apiRunInstance.traceId);
+    apisRunningByTraceId.set(apiRunInstance.traceId, currentCount - 1);
 
-        if (apisRunningById.size === 0) {
-          const _require8 = require(`../redux`),
-                emitter = _require8.emitter;
+    if (apisRunningById.size === 0) {
+      const {
+        emitter
+      } = require(`../redux`);
 
-          emitter.emit(`API_RUNNING_QUEUE_EMPTY`);
-        } // Filter empty results
+      emitter.emit(`API_RUNNING_QUEUE_EMPTY`);
+    } // Filter empty results
 
 
-        apiRunInstance.results = results.filter(result => !_.isEmpty(result)); // Filter out empty responses and return if the
-        // api caller isn't waiting for cascading actions to finish.
+    apiRunInstance.results = results.filter(result => !_.isEmpty(result)); // Filter out empty responses and return if the
+    // api caller isn't waiting for cascading actions to finish.
 
-        if (!args.waitForCascadingActions) {
-          apiSpan.finish();
-          resolve(apiRunInstance.results);
-        } // Check if any of our waiters are done.
+    if (!args.waitForCascadingActions) {
+      apiSpan.finish();
+      resolve(apiRunInstance.results);
+    } // Check if any of our waiters are done.
 
 
-        waitingForCasacadeToFinish = waitingForCasacadeToFinish.filter(instance => {
-          // If none of its trace IDs are running, it's done.
-          const apisByTraceIdCount = apisRunningByTraceId.get(instance.traceId);
+    waitingForCasacadeToFinish = waitingForCasacadeToFinish.filter(instance => {
+      // If none of its trace IDs are running, it's done.
+      const apisByTraceIdCount = apisRunningByTraceId.get(instance.traceId);
 
-          if (apisByTraceIdCount === 0) {
-            instance.span.finish();
-            instance.resolve(instance.results);
-            return false;
-          } else {
-            return true;
-          }
-        });
-        return;
-      });
+      if (apisByTraceIdCount === 0) {
+        instance.span.finish();
+        instance.resolve(instance.results);
+        return false;
+      } else {
+        return true;
+      }
     });
+    return;
   });
-
-  return function (_x) {
-    return _ref.apply(this, arguments);
-  };
-}();
+});
 //# sourceMappingURL=api-runner-node.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/utils/api-runner-node.js.map b/node_modules/gatsby/dist/utils/api-runner-node.js.map
index a44ac61..a73c5c8 100644
--- a/node_modules/gatsby/dist/utils/api-runner-node.js.map
+++ b/node_modules/gatsby/dist/utils/api-runner-node.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/utils/api-runner-node.js"],"names":["Promise","require","glob","_","chalk","tracer","globalTracer","reporter","getCache","apiList","createNodeId","createContentDigest","buildObjectType","buildUnionType","buildInterfaceType","buildInputObjectType","emitter","getNonGatsbyCodeFrame","boundPluginActionCreators","doubleBind","boundActionCreators","api","plugin","actionOptions","traceId","name","keys","Object","doubleBoundActionCreators","i","length","key","boundActionCreator","args","initAPICallTracing","parentSpan","startSpan","spanName","spanArgs","defaultSpanArgs","childOf","merge","runAPI","gatsbyNode","resolve","spanOptions","pluginSpan","setTag","pathPrefix","store","loadNodeContent","getNodes","getNode","getNodesByType","hasNodeChanged","getNodeAndSavePathDependency","getState","program","prefixPaths","config","namespacedCreateNodeId","id","tracing","cache","actions","apiFinished","alreadyDisplayed","createPageAction","createPage","warning","stripIndent","bold","possiblyCodeFrame","push","warn","join","apiCallArgs","schema","pluginOptions","fromCallback","callback","cb","err","val","finish","result","then","res","filteredPlugins","hasAPIFile","sync","apisRunningById","Map","apisRunningByTraceId","waitingForCasacadeToFinish","module","exports","pluginSource","apiSpanArgs","apiSpan","forEach","traceTags","value","panic","plugins","flattenedPlugins","filter","noSourcePluginPlugins","p","apiRunInstance","span","startTime","Date","toJSON","type","node","internal","contentDigest","filename","page","path","argsJson","JSON","stringify","omit","waitForCascadingActions","set","has","currentCount","get","stopQueuedApiRuns","onAPIRunComplete","actionHandler","action","payload","on","off","mapSeries","pluginName","catch","panicOnBuild","results","delete","size","emit","isEmpty","instance","apisByTraceIdCount"],"mappings":"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","sourcesContent":["const Promise = require(`bluebird`)\nconst glob = require(`glob`)\nconst _ = require(`lodash`)\nconst chalk = require(`chalk`)\n\nconst tracer = require(`opentracing`).globalTracer()\nconst reporter = require(`gatsby-cli/lib/reporter`)\nconst getCache = require(`./get-cache`)\nconst apiList = require(`./api-node-docs`)\nconst createNodeId = require(`./create-node-id`)\nconst createContentDigest = require(`./create-content-digest`)\nconst {\n  buildObjectType,\n  buildUnionType,\n  buildInterfaceType,\n  buildInputObjectType,\n} = require(`../schema/types/type-builders`)\nconst { emitter } = require(`../redux`)\nconst { getNonGatsbyCodeFrame } = require(`./stack-trace-utils`)\n\n// Bind action creators per plugin so we can auto-add\n// metadata to actions they create.\nconst boundPluginActionCreators = {}\nconst doubleBind = (boundActionCreators, api, plugin, actionOptions) => {\n  const { traceId } = actionOptions\n  if (boundPluginActionCreators[plugin.name + api + traceId]) {\n    return boundPluginActionCreators[plugin.name + api + traceId]\n  } else {\n    const keys = Object.keys(boundActionCreators)\n    const doubleBoundActionCreators = {}\n    for (let i = 0; i < keys.length; i++) {\n      const key = keys[i]\n      const boundActionCreator = boundActionCreators[key]\n      if (typeof boundActionCreator === `function`) {\n        doubleBoundActionCreators[key] = (...args) => {\n          // Let action callers override who the plugin is. Shouldn't be\n          // used that often.\n          if (args.length === 1) {\n            boundActionCreator(args[0], plugin, actionOptions)\n          } else if (args.length === 2) {\n            boundActionCreator(args[0], args[1], actionOptions)\n          }\n        }\n      }\n    }\n    boundPluginActionCreators[\n      plugin.name + api + traceId\n    ] = doubleBoundActionCreators\n    return doubleBoundActionCreators\n  }\n}\n\nconst initAPICallTracing = parentSpan => {\n  const startSpan = (spanName, spanArgs = {}) => {\n    const defaultSpanArgs = { childOf: parentSpan }\n\n    return tracer.startSpan(spanName, _.merge(defaultSpanArgs, spanArgs))\n  }\n\n  return {\n    tracer,\n    parentSpan,\n    startSpan,\n  }\n}\n\nconst runAPI = (plugin, api, args) => {\n  const gatsbyNode = require(`${plugin.resolve}/gatsby-node`)\n  if (gatsbyNode[api]) {\n    const parentSpan = args && args.parentSpan\n    const spanOptions = parentSpan ? { childOf: parentSpan } : {}\n    const pluginSpan = tracer.startSpan(`run-plugin`, spanOptions)\n\n    pluginSpan.setTag(`api`, api)\n    pluginSpan.setTag(`plugin`, plugin.name)\n\n    let pathPrefix = ``\n    const { store, emitter } = require(`../redux`)\n    const {\n      loadNodeContent,\n      getNodes,\n      getNode,\n      getNodesByType,\n      hasNodeChanged,\n      getNodeAndSavePathDependency,\n    } = require(`../db/nodes`)\n    const { boundActionCreators } = require(`../redux/actions`)\n\n    const doubleBoundActionCreators = doubleBind(\n      boundActionCreators,\n      api,\n      plugin,\n      { ...args, parentSpan: pluginSpan }\n    )\n\n    if (store.getState().program.prefixPaths) {\n      pathPrefix = store.getState().config.pathPrefix\n    }\n\n    const namespacedCreateNodeId = id => createNodeId(id, plugin.name)\n\n    const tracing = initAPICallTracing(pluginSpan)\n\n    const cache = getCache(plugin.name)\n\n    // Ideally this would be more abstracted and applied to more situations, but right now\n    // this can be potentially breaking so targeting `createPages` API and `createPage` action\n    let actions = doubleBoundActionCreators\n    let apiFinished = false\n    if (api === `createPages`) {\n      let alreadyDisplayed = false\n      const createPageAction = actions.createPage\n      // create new actions object with wrapped createPage action\n      // doubleBoundActionCreators is memoized, so we can't just\n      // reassign createPage field as this would cause this extra logic\n      // to be used in subsequent APIs and we only want to target this `createPages` call.\n      actions = {\n        ...actions,\n        createPage: (...args) => {\n          createPageAction(...args)\n          if (apiFinished && !alreadyDisplayed) {\n            const warning = [\n              reporter.stripIndent(`\n              Action ${chalk.bold(\n                `createPage`\n              )} was called outside of its expected asynchronous lifecycle ${chalk.bold(\n                `createPages`\n              )} in ${chalk.bold(plugin.name)}.\n              Ensure that you return a Promise from ${chalk.bold(\n                `createPages`\n              )} and are awaiting any asynchronous method invocations (like ${chalk.bold(\n                `graphql`\n              )} or http requests).\n              For more info and debugging tips: see ${chalk.bold(\n                `https://gatsby.dev/sync-actions`\n              )}\n            `),\n            ]\n\n            const possiblyCodeFrame = getNonGatsbyCodeFrame()\n            if (possiblyCodeFrame) {\n              warning.push(possiblyCodeFrame)\n            }\n\n            reporter.warn(warning.join(`\\n\\n`))\n            alreadyDisplayed = true\n          }\n        },\n      }\n    }\n\n    const apiCallArgs = [\n      {\n        ...args,\n        pathPrefix,\n        boundActionCreators: actions,\n        actions,\n        loadNodeContent,\n        store,\n        emitter,\n        getCache,\n        getNodes,\n        getNode,\n        getNodesByType,\n        hasNodeChanged,\n        reporter,\n        getNodeAndSavePathDependency,\n        cache,\n        createNodeId: namespacedCreateNodeId,\n        createContentDigest,\n        tracing,\n        schema: {\n          buildObjectType,\n          buildUnionType,\n          buildInterfaceType,\n          buildInputObjectType,\n        },\n      },\n      plugin.pluginOptions,\n    ]\n\n    // If the plugin is using a callback use that otherwise\n    // expect a Promise to be returned.\n    if (gatsbyNode[api].length === 3) {\n      return Promise.fromCallback(callback => {\n        const cb = (err, val) => {\n          pluginSpan.finish()\n          callback(err, val)\n          apiFinished = true\n        }\n        gatsbyNode[api](...apiCallArgs, cb)\n      })\n    } else {\n      const result = gatsbyNode[api](...apiCallArgs)\n      pluginSpan.finish()\n      return Promise.resolve(result).then(res => {\n        apiFinished = true\n        return res\n      })\n    }\n  }\n\n  return null\n}\n\nlet filteredPlugins\nconst hasAPIFile = plugin => glob.sync(`${plugin.resolve}/gatsby-node*`)[0]\n\nlet apisRunningById = new Map()\nlet apisRunningByTraceId = new Map()\nlet waitingForCasacadeToFinish = []\n\nmodule.exports = async (api, args = {}, pluginSource) =>\n  new Promise(resolve => {\n    const { parentSpan } = args\n    const apiSpanArgs = parentSpan ? { childOf: parentSpan } : {}\n    const apiSpan = tracer.startSpan(`run-api`, apiSpanArgs)\n\n    apiSpan.setTag(`api`, api)\n    _.forEach(args.traceTags, (value, key) => {\n      apiSpan.setTag(key, value)\n    })\n\n    // Check that the API is documented.\n    // \"FAKE_API_CALL\" is used when code needs to trigger something\n    // to happen once the the API queue is empty. Ideally of course\n    // we'd have an API (returning a promise) for that. But this\n    // works nicely in the meantime.\n    if (!apiList[api] && api !== `FAKE_API_CALL`) {\n      reporter.panic(`api: \"${api}\" is not a valid Gatsby api`)\n    }\n\n    const { store } = require(`../redux`)\n    const plugins = store.getState().flattenedPlugins\n    // Get the list of plugins that implement gatsby-node\n    if (!filteredPlugins) {\n      filteredPlugins = plugins.filter(plugin => hasAPIFile(plugin))\n    }\n\n    // Break infinite loops.\n    // Sometimes a plugin will implement an API and call an\n    // action which will trigger the same API being called.\n    // \"onCreatePage\" is the only example right now.\n    // In these cases, we should avoid calling the originating plugin\n    // again.\n    let noSourcePluginPlugins = filteredPlugins\n    if (pluginSource) {\n      noSourcePluginPlugins = filteredPlugins.filter(\n        p => p.name !== pluginSource\n      )\n    }\n\n    const apiRunInstance = {\n      api,\n      args,\n      pluginSource,\n      resolve,\n      span: apiSpan,\n      startTime: new Date().toJSON(),\n      traceId: args.traceId,\n    }\n\n    // Generate IDs for api runs. Most IDs we generate from the args\n    // but some API calls can have very large argument objects so we\n    // have special ways of generating IDs for those to avoid stringifying\n    // large objects.\n    let id\n    if (api === `setFieldsOnGraphQLNodeType`) {\n      id = `${api}${apiRunInstance.startTime}${args.type.name}${args.traceId}`\n    } else if (api === `onCreateNode`) {\n      id = `${api}${apiRunInstance.startTime}${\n        args.node.internal.contentDigest\n      }${args.traceId}`\n    } else if (api === `preprocessSource`) {\n      id = `${api}${apiRunInstance.startTime}${args.filename}${args.traceId}`\n    } else if (api === `onCreatePage`) {\n      id = `${api}${apiRunInstance.startTime}${args.page.path}${args.traceId}`\n    } else {\n      // When tracing is turned on, the `args` object will have a\n      // `parentSpan` field that can be quite large. So we omit it\n      // before calling stringify\n      const argsJson = JSON.stringify(_.omit(args, `parentSpan`))\n      id = `${api}|${apiRunInstance.startTime}|${\n        apiRunInstance.traceId\n      }|${argsJson}`\n    }\n    apiRunInstance.id = id\n\n    if (args.waitForCascadingActions) {\n      waitingForCasacadeToFinish.push(apiRunInstance)\n    }\n\n    apisRunningById.set(apiRunInstance.id, apiRunInstance)\n    if (apisRunningByTraceId.has(apiRunInstance.traceId)) {\n      const currentCount = apisRunningByTraceId.get(apiRunInstance.traceId)\n      apisRunningByTraceId.set(apiRunInstance.traceId, currentCount + 1)\n    } else {\n      apisRunningByTraceId.set(apiRunInstance.traceId, 1)\n    }\n\n    let stopQueuedApiRuns = false\n    let onAPIRunComplete = null\n    if (api === `onCreatePage`) {\n      const path = args.page.path\n      const actionHandler = action => {\n        if (action.payload.path === path) {\n          stopQueuedApiRuns = true\n        }\n      }\n      emitter.on(`DELETE_PAGE`, actionHandler)\n      onAPIRunComplete = () => {\n        emitter.off(`DELETE_PAGE`, actionHandler)\n      }\n    }\n\n    Promise.mapSeries(noSourcePluginPlugins, plugin => {\n      if (stopQueuedApiRuns) {\n        return null\n      }\n\n      let pluginName =\n        plugin.name === `default-site-plugin`\n          ? `gatsby-node.js`\n          : `Plugin ${plugin.name}`\n\n      return new Promise(resolve => {\n        resolve(runAPI(plugin, api, { ...args, parentSpan: apiSpan }))\n      }).catch(err => {\n        reporter.panicOnBuild(`${pluginName} returned an error`, err)\n        return null\n      })\n    }).then(results => {\n      if (onAPIRunComplete) {\n        onAPIRunComplete()\n      }\n      // Remove runner instance\n      apisRunningById.delete(apiRunInstance.id)\n      const currentCount = apisRunningByTraceId.get(apiRunInstance.traceId)\n      apisRunningByTraceId.set(apiRunInstance.traceId, currentCount - 1)\n\n      if (apisRunningById.size === 0) {\n        const { emitter } = require(`../redux`)\n        emitter.emit(`API_RUNNING_QUEUE_EMPTY`)\n      }\n\n      // Filter empty results\n      apiRunInstance.results = results.filter(result => !_.isEmpty(result))\n\n      // Filter out empty responses and return if the\n      // api caller isn't waiting for cascading actions to finish.\n      if (!args.waitForCascadingActions) {\n        apiSpan.finish()\n        resolve(apiRunInstance.results)\n      }\n\n      // Check if any of our waiters are done.\n      waitingForCasacadeToFinish = waitingForCasacadeToFinish.filter(\n        instance => {\n          // If none of its trace IDs are running, it's done.\n          const apisByTraceIdCount = apisRunningByTraceId.get(instance.traceId)\n          if (apisByTraceIdCount === 0) {\n            instance.span.finish()\n            instance.resolve(instance.results)\n            return false\n          } else {\n            return true\n          }\n        }\n      )\n      return\n    })\n  })\n"],"file":"api-runner-node.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/utils/api-runner-node.js"],"names":["Promise","require","_","chalk","tracer","globalTracer","reporter","getCache","apiList","createNodeId","createContentDigest","buildObjectType","buildUnionType","buildInterfaceType","buildInputObjectType","emitter","getNonGatsbyCodeFrame","trackBuildError","decorateEvent","boundPluginActionCreators","doubleBind","boundActionCreators","api","plugin","actionOptions","traceId","name","keys","Object","doubleBoundActionCreators","i","length","key","boundActionCreator","args","initAPICallTracing","parentSpan","startSpan","spanName","spanArgs","defaultSpanArgs","childOf","merge","runAPI","gatsbyNode","resolve","spanOptions","pluginSpan","setTag","pathPrefix","store","loadNodeContent","getNodes","getNode","getNodesByType","hasNodeChanged","getNodeAndSavePathDependency","getState","program","prefixPaths","config","namespacedCreateNodeId","id","tracing","cache","actions","apiFinished","alreadyDisplayed","createPageAction","createPage","warning","stripIndent","bold","possiblyCodeFrame","push","warn","join","apiCallArgs","schema","pluginOptions","fromCallback","callback","cb","err","val","finish","e","error","pluginName","version","result","then","res","apisRunningById","Map","apisRunningByTraceId","waitingForCasacadeToFinish","module","exports","pluginSource","apiSpanArgs","apiSpan","forEach","traceTags","value","panic","plugins","flattenedPlugins","implementingPlugins","filter","nodeAPIs","includes","apiRunInstance","span","startTime","Date","toJSON","type","node","internal","contentDigest","filename","page","path","argsJson","JSON","stringify","omit","waitForCascadingActions","set","has","currentCount","get","stopQueuedApiRuns","onAPIRunComplete","actionHandler","action","payload","on","off","mapSeries","catch","panicOnBuild","results","delete","size","emit","isEmpty","instance","apisByTraceIdCount"],"mappings":"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","sourcesContent":["const Promise = require(`bluebird`)\nconst _ = require(`lodash`)\nconst chalk = require(`chalk`)\n\nconst tracer = require(`opentracing`).globalTracer()\nconst reporter = require(`gatsby-cli/lib/reporter`)\nconst getCache = require(`./get-cache`)\nconst apiList = require(`./api-node-docs`)\nconst createNodeId = require(`./create-node-id`)\nconst createContentDigest = require(`./create-content-digest`)\nconst {\n  buildObjectType,\n  buildUnionType,\n  buildInterfaceType,\n  buildInputObjectType,\n} = require(`../schema/types/type-builders`)\nconst { emitter } = require(`../redux`)\nconst { getNonGatsbyCodeFrame } = require(`./stack-trace-utils`)\nconst { trackBuildError, decorateEvent } = require(`gatsby-telemetry`)\n\n// Bind action creators per plugin so we can auto-add\n// metadata to actions they create.\nconst boundPluginActionCreators = {}\nconst doubleBind = (boundActionCreators, api, plugin, actionOptions) => {\n  const { traceId } = actionOptions\n  if (boundPluginActionCreators[plugin.name + api + traceId]) {\n    return boundPluginActionCreators[plugin.name + api + traceId]\n  } else {\n    const keys = Object.keys(boundActionCreators)\n    const doubleBoundActionCreators = {}\n    for (let i = 0; i < keys.length; i++) {\n      const key = keys[i]\n      const boundActionCreator = boundActionCreators[key]\n      if (typeof boundActionCreator === `function`) {\n        doubleBoundActionCreators[key] = (...args) => {\n          // Let action callers override who the plugin is. Shouldn't be\n          // used that often.\n          if (args.length === 1) {\n            boundActionCreator(args[0], plugin, actionOptions)\n          } else if (args.length === 2) {\n            boundActionCreator(args[0], args[1], actionOptions)\n          }\n        }\n      }\n    }\n    boundPluginActionCreators[\n      plugin.name + api + traceId\n    ] = doubleBoundActionCreators\n    return doubleBoundActionCreators\n  }\n}\n\nconst initAPICallTracing = parentSpan => {\n  const startSpan = (spanName, spanArgs = {}) => {\n    const defaultSpanArgs = { childOf: parentSpan }\n\n    return tracer.startSpan(spanName, _.merge(defaultSpanArgs, spanArgs))\n  }\n\n  return {\n    tracer,\n    parentSpan,\n    startSpan,\n  }\n}\n\nconst runAPI = (plugin, api, args) => {\n  const gatsbyNode = require(`${plugin.resolve}/gatsby-node`)\n  if (gatsbyNode[api]) {\n    const parentSpan = args && args.parentSpan\n    const spanOptions = parentSpan ? { childOf: parentSpan } : {}\n    const pluginSpan = tracer.startSpan(`run-plugin`, spanOptions)\n\n    pluginSpan.setTag(`api`, api)\n    pluginSpan.setTag(`plugin`, plugin.name)\n\n    let pathPrefix = ``\n    const { store, emitter } = require(`../redux`)\n    const {\n      loadNodeContent,\n      getNodes,\n      getNode,\n      getNodesByType,\n      hasNodeChanged,\n      getNodeAndSavePathDependency,\n    } = require(`../db/nodes`)\n    const { boundActionCreators } = require(`../redux/actions`)\n\n    const doubleBoundActionCreators = doubleBind(\n      boundActionCreators,\n      api,\n      plugin,\n      { ...args, parentSpan: pluginSpan }\n    )\n\n    if (store.getState().program.prefixPaths) {\n      pathPrefix = store.getState().config.pathPrefix\n    }\n\n    const namespacedCreateNodeId = id => createNodeId(id, plugin.name)\n\n    const tracing = initAPICallTracing(pluginSpan)\n\n    const cache = getCache(plugin.name)\n\n    // Ideally this would be more abstracted and applied to more situations, but right now\n    // this can be potentially breaking so targeting `createPages` API and `createPage` action\n    let actions = doubleBoundActionCreators\n    let apiFinished = false\n    if (api === `createPages`) {\n      let alreadyDisplayed = false\n      const createPageAction = actions.createPage\n      // create new actions object with wrapped createPage action\n      // doubleBoundActionCreators is memoized, so we can't just\n      // reassign createPage field as this would cause this extra logic\n      // to be used in subsequent APIs and we only want to target this `createPages` call.\n      actions = {\n        ...actions,\n        createPage: (...args) => {\n          createPageAction(...args)\n          if (apiFinished && !alreadyDisplayed) {\n            const warning = [\n              reporter.stripIndent(`\n              Action ${chalk.bold(\n                `createPage`\n              )} was called outside of its expected asynchronous lifecycle ${chalk.bold(\n                `createPages`\n              )} in ${chalk.bold(plugin.name)}.\n              Ensure that you return a Promise from ${chalk.bold(\n                `createPages`\n              )} and are awaiting any asynchronous method invocations (like ${chalk.bold(\n                `graphql`\n              )} or http requests).\n              For more info and debugging tips: see ${chalk.bold(\n                `https://gatsby.dev/sync-actions`\n              )}\n            `),\n            ]\n\n            const possiblyCodeFrame = getNonGatsbyCodeFrame()\n            if (possiblyCodeFrame) {\n              warning.push(possiblyCodeFrame)\n            }\n\n            reporter.warn(warning.join(`\\n\\n`))\n            alreadyDisplayed = true\n          }\n        },\n      }\n    }\n\n    const apiCallArgs = [\n      {\n        ...args,\n        pathPrefix,\n        boundActionCreators: actions,\n        actions,\n        loadNodeContent,\n        store,\n        emitter,\n        getCache,\n        getNodes,\n        getNode,\n        getNodesByType,\n        hasNodeChanged,\n        reporter,\n        getNodeAndSavePathDependency,\n        cache,\n        createNodeId: namespacedCreateNodeId,\n        createContentDigest,\n        tracing,\n        schema: {\n          buildObjectType,\n          buildUnionType,\n          buildInterfaceType,\n          buildInputObjectType,\n        },\n      },\n      plugin.pluginOptions,\n    ]\n\n    // If the plugin is using a callback use that otherwise\n    // expect a Promise to be returned.\n    if (gatsbyNode[api].length === 3) {\n      return Promise.fromCallback(callback => {\n        const cb = (err, val) => {\n          pluginSpan.finish()\n          callback(err, val)\n          apiFinished = true\n        }\n\n        try {\n          gatsbyNode[api](...apiCallArgs, cb)\n        } catch (e) {\n          trackBuildError(api, {\n            error: e,\n            pluginName: `${plugin.name}@${plugin.version}`,\n          })\n          throw e\n        }\n      })\n    } else {\n      const result = gatsbyNode[api](...apiCallArgs)\n      pluginSpan.finish()\n      return Promise.resolve(result).then(res => {\n        apiFinished = true\n        return res\n      })\n    }\n  }\n\n  return null\n}\n\nlet apisRunningById = new Map()\nlet apisRunningByTraceId = new Map()\nlet waitingForCasacadeToFinish = []\n\nmodule.exports = async (api, args = {}, pluginSource) =>\n  new Promise(resolve => {\n    const { parentSpan } = args\n    const apiSpanArgs = parentSpan ? { childOf: parentSpan } : {}\n    const apiSpan = tracer.startSpan(`run-api`, apiSpanArgs)\n\n    apiSpan.setTag(`api`, api)\n    _.forEach(args.traceTags, (value, key) => {\n      apiSpan.setTag(key, value)\n    })\n\n    // Check that the API is documented.\n    // \"FAKE_API_CALL\" is used when code needs to trigger something\n    // to happen once the the API queue is empty. Ideally of course\n    // we'd have an API (returning a promise) for that. But this\n    // works nicely in the meantime.\n    if (!apiList[api] && api !== `FAKE_API_CALL`) {\n      reporter.panic(`api: \"${api}\" is not a valid Gatsby api`)\n    }\n\n    const { store } = require(`../redux`)\n    const plugins = store.getState().flattenedPlugins\n\n    // Get the list of plugins that implement this API.\n    // Also: Break infinite loops. Sometimes a plugin will implement an API and\n    // call an action which will trigger the same API being called.\n    // `onCreatePage` is the only example right now. In these cases, we should\n    // avoid calling the originating plugin again.\n    const implementingPlugins = plugins.filter(\n      plugin => plugin.nodeAPIs.includes(api) && plugin.name !== pluginSource\n    )\n\n    const apiRunInstance = {\n      api,\n      args,\n      pluginSource,\n      resolve,\n      span: apiSpan,\n      startTime: new Date().toJSON(),\n      traceId: args.traceId,\n    }\n\n    // Generate IDs for api runs. Most IDs we generate from the args\n    // but some API calls can have very large argument objects so we\n    // have special ways of generating IDs for those to avoid stringifying\n    // large objects.\n    let id\n    if (api === `setFieldsOnGraphQLNodeType`) {\n      id = `${api}${apiRunInstance.startTime}${args.type.name}${args.traceId}`\n    } else if (api === `onCreateNode`) {\n      id = `${api}${apiRunInstance.startTime}${\n        args.node.internal.contentDigest\n      }${args.traceId}`\n    } else if (api === `preprocessSource`) {\n      id = `${api}${apiRunInstance.startTime}${args.filename}${args.traceId}`\n    } else if (api === `onCreatePage`) {\n      id = `${api}${apiRunInstance.startTime}${args.page.path}${args.traceId}`\n    } else {\n      // When tracing is turned on, the `args` object will have a\n      // `parentSpan` field that can be quite large. So we omit it\n      // before calling stringify\n      const argsJson = JSON.stringify(_.omit(args, `parentSpan`))\n      id = `${api}|${apiRunInstance.startTime}|${\n        apiRunInstance.traceId\n      }|${argsJson}`\n    }\n    apiRunInstance.id = id\n\n    if (args.waitForCascadingActions) {\n      waitingForCasacadeToFinish.push(apiRunInstance)\n    }\n\n    apisRunningById.set(apiRunInstance.id, apiRunInstance)\n    if (apisRunningByTraceId.has(apiRunInstance.traceId)) {\n      const currentCount = apisRunningByTraceId.get(apiRunInstance.traceId)\n      apisRunningByTraceId.set(apiRunInstance.traceId, currentCount + 1)\n    } else {\n      apisRunningByTraceId.set(apiRunInstance.traceId, 1)\n    }\n\n    let stopQueuedApiRuns = false\n    let onAPIRunComplete = null\n    if (api === `onCreatePage`) {\n      const path = args.page.path\n      const actionHandler = action => {\n        if (action.payload.path === path) {\n          stopQueuedApiRuns = true\n        }\n      }\n      emitter.on(`DELETE_PAGE`, actionHandler)\n      onAPIRunComplete = () => {\n        emitter.off(`DELETE_PAGE`, actionHandler)\n      }\n    }\n\n    Promise.mapSeries(implementingPlugins, plugin => {\n      if (stopQueuedApiRuns) {\n        return null\n      }\n\n      let pluginName =\n        plugin.name === `default-site-plugin`\n          ? `gatsby-node.js`\n          : `Plugin ${plugin.name}`\n\n      return new Promise(resolve => {\n        resolve(runAPI(plugin, api, { ...args, parentSpan: apiSpan }))\n      }).catch(err => {\n        decorateEvent(`BUILD_PANIC`, {\n          pluginName: `${plugin.name}@${plugin.version}`,\n        })\n        reporter.panicOnBuild(`${pluginName} returned an error`, err)\n        return null\n      })\n    }).then(results => {\n      if (onAPIRunComplete) {\n        onAPIRunComplete()\n      }\n      // Remove runner instance\n      apisRunningById.delete(apiRunInstance.id)\n      const currentCount = apisRunningByTraceId.get(apiRunInstance.traceId)\n      apisRunningByTraceId.set(apiRunInstance.traceId, currentCount - 1)\n\n      if (apisRunningById.size === 0) {\n        const { emitter } = require(`../redux`)\n        emitter.emit(`API_RUNNING_QUEUE_EMPTY`)\n      }\n\n      // Filter empty results\n      apiRunInstance.results = results.filter(result => !_.isEmpty(result))\n\n      // Filter out empty responses and return if the\n      // api caller isn't waiting for cascading actions to finish.\n      if (!args.waitForCascadingActions) {\n        apiSpan.finish()\n        resolve(apiRunInstance.results)\n      }\n\n      // Check if any of our waiters are done.\n      waitingForCasacadeToFinish = waitingForCasacadeToFinish.filter(\n        instance => {\n          // If none of its trace IDs are running, it's done.\n          const apisByTraceIdCount = apisRunningByTraceId.get(instance.traceId)\n          if (apisByTraceIdCount === 0) {\n            instance.span.finish()\n            instance.resolve(instance.results)\n            return false\n          } else {\n            return true\n          }\n        }\n      )\n      return\n    })\n  })\n"],"file":"api-runner-node.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/utils/babel-loader.js b/node_modules/gatsby/dist/utils/babel-loader.js
index 9b40d14..942e107 100644
--- a/node_modules/gatsby/dist/utils/babel-loader.js
+++ b/node_modules/gatsby/dist/utils/babel-loader.js
@@ -2,10 +2,11 @@
 
 const babelLoader = require(`babel-loader`);
 
-const _require = require(`./babel-loader-helpers`),
-      prepareOptions = _require.prepareOptions,
-      getCustomOptions = _require.getCustomOptions,
-      mergeConfigItemOptions = _require.mergeConfigItemOptions;
+const {
+  prepareOptions,
+  getCustomOptions,
+  mergeConfigItemOptions
+} = require(`./babel-loader-helpers`);
 /**
  * Gatsby's custom loader for webpack & babel
  *
@@ -28,37 +29,34 @@ module.exports = babelLoader.custom(babel => {
     // Passed the loader options.
     customOptions(options) {
       return {
-        loader: Object.assign({
+        loader: {
           cacheDirectory: true,
-          sourceType: `unambiguous`
-        }, getCustomOptions(), options)
+          sourceType: `unambiguous`,
+          ...getCustomOptions(),
+          ...options
+        }
       };
     },
 
     // Passed Babel's 'PartialConfig' object.
     config(partialConfig) {
-      let options = partialConfig.options;
-
-      const _prepareOptions = prepareOptions(babel),
-            reduxPresets = _prepareOptions[0],
-            reduxPlugins = _prepareOptions[1],
-            requiredPresets = _prepareOptions[2],
-            requiredPlugins = _prepareOptions[3],
-            fallbackPresets = _prepareOptions[4]; // If there is no filesystem babel config present, add our fallback
+      let {
+        options
+      } = partialConfig;
+      const [reduxPresets, reduxPlugins, requiredPresets, requiredPlugins, fallbackPresets] = prepareOptions(babel); // If there is no filesystem babel config present, add our fallback
       // presets/plugins.
 
-
       if (!partialConfig.hasFilesystemConfig()) {
-        options = Object.assign({}, options, {
+        options = { ...options,
           plugins: requiredPlugins,
           presets: [...fallbackPresets, ...requiredPresets]
-        });
+        };
       } else {
         // With a babelrc present, only add our required plugins/presets
-        options = Object.assign({}, options, {
+        options = { ...options,
           plugins: [...options.plugins, ...requiredPlugins],
           presets: [...options.presets, ...requiredPresets]
-        });
+        };
       } // Merge in presets/plugins added from gatsby plugins.
 
 
diff --git a/node_modules/gatsby/dist/utils/babel-loader.js.map b/node_modules/gatsby/dist/utils/babel-loader.js.map
index 76686f5..e5be5ad 100644
--- a/node_modules/gatsby/dist/utils/babel-loader.js.map
+++ b/node_modules/gatsby/dist/utils/babel-loader.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/utils/babel-loader.js"],"names":["babelLoader","require","prepareOptions","getCustomOptions","mergeConfigItemOptions","module","exports","custom","babel","toReturn","customOptions","options","loader","cacheDirectory","sourceType","config","partialConfig","reduxPresets","reduxPlugins","requiredPresets","requiredPlugins","fallbackPresets","hasFilesystemConfig","plugins","presets","forEach","preset","items","itemToMerge","type","plugin"],"mappings":";;AAAA,MAAMA,WAAW,GAAGC,OAAO,CAAE,cAAF,CAA3B;;iBAMIA,OAAO,CAAE,wBAAF,C;MAHTC,c,YAAAA,c;MACAC,gB,YAAAA,gB;MACAC,sB,YAAAA,sB;AAGF;;;;;;;;;;;;;;;;;AAeAC,MAAM,CAACC,OAAP,GAAiBN,WAAW,CAACO,MAAZ,CAAmBC,KAAK,IAAI;AAC3C,QAAMC,QAAQ,GAAG;AACf;AACAC,IAAAA,aAAa,CAACC,OAAD,EAAU;AACrB,aAAO;AACLC,QAAAA,MAAM;AACJC,UAAAA,cAAc,EAAE,IADZ;AAEJC,UAAAA,UAAU,EAAG;AAFT,WAGDX,gBAAgB,EAHf,EAIDQ,OAJC;AADD,OAAP;AAQD,KAXc;;AAaf;AACAI,IAAAA,MAAM,CAACC,aAAD,EAAgB;AAAA,UACdL,OADc,GACFK,aADE,CACdL,OADc;;AAAA,8BAQhBT,cAAc,CAACM,KAAD,CARE;AAAA,YAGlBS,YAHkB;AAAA,YAIlBC,YAJkB;AAAA,YAKlBC,eALkB;AAAA,YAMlBC,eANkB;AAAA,YAOlBC,eAPkB,uBAUpB;AACA;;;AACA,UAAI,CAACL,aAAa,CAACM,mBAAd,EAAL,EAA0C;AACxCX,QAAAA,OAAO,qBACFA,OADE;AAELY,UAAAA,OAAO,EAAEH,eAFJ;AAGLI,UAAAA,OAAO,EAAE,CAAC,GAAGH,eAAJ,EAAqB,GAAGF,eAAxB;AAHJ,UAAP;AAKD,OAND,MAMO;AACL;AACAR,QAAAA,OAAO,qBACFA,OADE;AAELY,UAAAA,OAAO,EAAE,CAAC,GAAGZ,OAAO,CAACY,OAAZ,EAAqB,GAAGH,eAAxB,CAFJ;AAGLI,UAAAA,OAAO,EAAE,CAAC,GAAGb,OAAO,CAACa,OAAZ,EAAqB,GAAGL,eAAxB;AAHJ,UAAP;AAKD,OAzBmB,CA2BpB;;;AACAF,MAAAA,YAAY,CAACQ,OAAb,CAAqBC,MAAM,IAAI;AAC7Bf,QAAAA,OAAO,CAACa,OAAR,GAAkBpB,sBAAsB,CAAC;AACvCuB,UAAAA,KAAK,EAAEhB,OAAO,CAACa,OADwB;AAEvCI,UAAAA,WAAW,EAAEF,MAF0B;AAGvCG,UAAAA,IAAI,EAAG,QAHgC;AAIvCrB,UAAAA;AAJuC,SAAD,CAAxC;AAMD,OAPD;AASAU,MAAAA,YAAY,CAACO,OAAb,CAAqBK,MAAM,IAAI;AAC7BnB,QAAAA,OAAO,CAACY,OAAR,GAAkBnB,sBAAsB,CAAC;AACvCuB,UAAAA,KAAK,EAAEhB,OAAO,CAACY,OADwB;AAEvCK,UAAAA,WAAW,EAAEE,MAF0B;AAGvCD,UAAAA,IAAI,EAAG,QAHgC;AAIvCrB,UAAAA;AAJuC,SAAD,CAAxC;AAMD,OAPD;AASA,aAAOG,OAAP;AACD;;AA7Dc,GAAjB;AAgEA,SAAOF,QAAP;AACD,CAlEgB,CAAjB","sourcesContent":["const babelLoader = require(`babel-loader`)\n\nconst {\n  prepareOptions,\n  getCustomOptions,\n  mergeConfigItemOptions,\n} = require(`./babel-loader-helpers`)\n\n/**\n * Gatsby's custom loader for webpack & babel\n *\n * Gatsby allows sites to either use our Babel setup (the default)\n * or to add a .babelrc to take control.\n *\n * Our default setup is defined in the fallbackPlugins/fallbackPresets arrays\n * below.\n *\n * After using either the fallback or user supplied setup, we add on a handful\n * of required plugins and finally merge in any presets/plugins supplied\n * by Gatsby plugins.\n *\n * You can find documentation for the custom loader here: https://babeljs.io/docs/en/next/babel-core.html#loadpartialconfig\n */\nmodule.exports = babelLoader.custom(babel => {\n  const toReturn = {\n    // Passed the loader options.\n    customOptions(options) {\n      return {\n        loader: {\n          cacheDirectory: true,\n          sourceType: `unambiguous`,\n          ...getCustomOptions(),\n          ...options,\n        },\n      }\n    },\n\n    // Passed Babel's 'PartialConfig' object.\n    config(partialConfig) {\n      let { options } = partialConfig\n      const [\n        reduxPresets,\n        reduxPlugins,\n        requiredPresets,\n        requiredPlugins,\n        fallbackPresets,\n      ] = prepareOptions(babel)\n\n      // If there is no filesystem babel config present, add our fallback\n      // presets/plugins.\n      if (!partialConfig.hasFilesystemConfig()) {\n        options = {\n          ...options,\n          plugins: requiredPlugins,\n          presets: [...fallbackPresets, ...requiredPresets],\n        }\n      } else {\n        // With a babelrc present, only add our required plugins/presets\n        options = {\n          ...options,\n          plugins: [...options.plugins, ...requiredPlugins],\n          presets: [...options.presets, ...requiredPresets],\n        }\n      }\n\n      // Merge in presets/plugins added from gatsby plugins.\n      reduxPresets.forEach(preset => {\n        options.presets = mergeConfigItemOptions({\n          items: options.presets,\n          itemToMerge: preset,\n          type: `preset`,\n          babel,\n        })\n      })\n\n      reduxPlugins.forEach(plugin => {\n        options.plugins = mergeConfigItemOptions({\n          items: options.plugins,\n          itemToMerge: plugin,\n          type: `plugin`,\n          babel,\n        })\n      })\n\n      return options\n    },\n  }\n\n  return toReturn\n})\n"],"file":"babel-loader.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/utils/babel-loader.js"],"names":["babelLoader","require","prepareOptions","getCustomOptions","mergeConfigItemOptions","module","exports","custom","babel","toReturn","customOptions","options","loader","cacheDirectory","sourceType","config","partialConfig","reduxPresets","reduxPlugins","requiredPresets","requiredPlugins","fallbackPresets","hasFilesystemConfig","plugins","presets","forEach","preset","items","itemToMerge","type","plugin"],"mappings":";;AAAA,MAAMA,WAAW,GAAGC,OAAO,CAAE,cAAF,CAA3B;;AAEA,MAAM;AACJC,EAAAA,cADI;AAEJC,EAAAA,gBAFI;AAGJC,EAAAA;AAHI,IAIFH,OAAO,CAAE,wBAAF,CAJX;AAMA;;;;;;;;;;;;;;;;;AAeAI,MAAM,CAACC,OAAP,GAAiBN,WAAW,CAACO,MAAZ,CAAmBC,KAAK,IAAI;AAC3C,QAAMC,QAAQ,GAAG;AACf;AACAC,IAAAA,aAAa,CAACC,OAAD,EAAU;AACrB,aAAO;AACLC,QAAAA,MAAM,EAAE;AACNC,UAAAA,cAAc,EAAE,IADV;AAENC,UAAAA,UAAU,EAAG,aAFP;AAGN,aAAGX,gBAAgB,EAHb;AAIN,aAAGQ;AAJG;AADH,OAAP;AAQD,KAXc;;AAaf;AACAI,IAAAA,MAAM,CAACC,aAAD,EAAgB;AACpB,UAAI;AAAEL,QAAAA;AAAF,UAAcK,aAAlB;AACA,YAAM,CACJC,YADI,EAEJC,YAFI,EAGJC,eAHI,EAIJC,eAJI,EAKJC,eALI,IAMFnB,cAAc,CAACM,KAAD,CANlB,CAFoB,CAUpB;AACA;;AACA,UAAI,CAACQ,aAAa,CAACM,mBAAd,EAAL,EAA0C;AACxCX,QAAAA,OAAO,GAAG,EACR,GAAGA,OADK;AAERY,UAAAA,OAAO,EAAEH,eAFD;AAGRI,UAAAA,OAAO,EAAE,CAAC,GAAGH,eAAJ,EAAqB,GAAGF,eAAxB;AAHD,SAAV;AAKD,OAND,MAMO;AACL;AACAR,QAAAA,OAAO,GAAG,EACR,GAAGA,OADK;AAERY,UAAAA,OAAO,EAAE,CAAC,GAAGZ,OAAO,CAACY,OAAZ,EAAqB,GAAGH,eAAxB,CAFD;AAGRI,UAAAA,OAAO,EAAE,CAAC,GAAGb,OAAO,CAACa,OAAZ,EAAqB,GAAGL,eAAxB;AAHD,SAAV;AAKD,OAzBmB,CA2BpB;;;AACAF,MAAAA,YAAY,CAACQ,OAAb,CAAqBC,MAAM,IAAI;AAC7Bf,QAAAA,OAAO,CAACa,OAAR,GAAkBpB,sBAAsB,CAAC;AACvCuB,UAAAA,KAAK,EAAEhB,OAAO,CAACa,OADwB;AAEvCI,UAAAA,WAAW,EAAEF,MAF0B;AAGvCG,UAAAA,IAAI,EAAG,QAHgC;AAIvCrB,UAAAA;AAJuC,SAAD,CAAxC;AAMD,OAPD;AASAU,MAAAA,YAAY,CAACO,OAAb,CAAqBK,MAAM,IAAI;AAC7BnB,QAAAA,OAAO,CAACY,OAAR,GAAkBnB,sBAAsB,CAAC;AACvCuB,UAAAA,KAAK,EAAEhB,OAAO,CAACY,OADwB;AAEvCK,UAAAA,WAAW,EAAEE,MAF0B;AAGvCD,UAAAA,IAAI,EAAG,QAHgC;AAIvCrB,UAAAA;AAJuC,SAAD,CAAxC;AAMD,OAPD;AASA,aAAOG,OAAP;AACD;;AA7Dc,GAAjB;AAgEA,SAAOF,QAAP;AACD,CAlEgB,CAAjB","sourcesContent":["const babelLoader = require(`babel-loader`)\n\nconst {\n  prepareOptions,\n  getCustomOptions,\n  mergeConfigItemOptions,\n} = require(`./babel-loader-helpers`)\n\n/**\n * Gatsby's custom loader for webpack & babel\n *\n * Gatsby allows sites to either use our Babel setup (the default)\n * or to add a .babelrc to take control.\n *\n * Our default setup is defined in the fallbackPlugins/fallbackPresets arrays\n * below.\n *\n * After using either the fallback or user supplied setup, we add on a handful\n * of required plugins and finally merge in any presets/plugins supplied\n * by Gatsby plugins.\n *\n * You can find documentation for the custom loader here: https://babeljs.io/docs/en/next/babel-core.html#loadpartialconfig\n */\nmodule.exports = babelLoader.custom(babel => {\n  const toReturn = {\n    // Passed the loader options.\n    customOptions(options) {\n      return {\n        loader: {\n          cacheDirectory: true,\n          sourceType: `unambiguous`,\n          ...getCustomOptions(),\n          ...options,\n        },\n      }\n    },\n\n    // Passed Babel's 'PartialConfig' object.\n    config(partialConfig) {\n      let { options } = partialConfig\n      const [\n        reduxPresets,\n        reduxPlugins,\n        requiredPresets,\n        requiredPlugins,\n        fallbackPresets,\n      ] = prepareOptions(babel)\n\n      // If there is no filesystem babel config present, add our fallback\n      // presets/plugins.\n      if (!partialConfig.hasFilesystemConfig()) {\n        options = {\n          ...options,\n          plugins: requiredPlugins,\n          presets: [...fallbackPresets, ...requiredPresets],\n        }\n      } else {\n        // With a babelrc present, only add our required plugins/presets\n        options = {\n          ...options,\n          plugins: [...options.plugins, ...requiredPlugins],\n          presets: [...options.presets, ...requiredPresets],\n        }\n      }\n\n      // Merge in presets/plugins added from gatsby plugins.\n      reduxPresets.forEach(preset => {\n        options.presets = mergeConfigItemOptions({\n          items: options.presets,\n          itemToMerge: preset,\n          type: `preset`,\n          babel,\n        })\n      })\n\n      reduxPlugins.forEach(plugin => {\n        options.plugins = mergeConfigItemOptions({\n          items: options.plugins,\n          itemToMerge: plugin,\n          type: `plugin`,\n          babel,\n        })\n      })\n\n      return options\n    },\n  }\n\n  return toReturn\n})\n"],"file":"babel-loader.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/utils/babel-parse-to-ast.js b/node_modules/gatsby/dist/utils/babel-parse-to-ast.js
index f4c4101..036b694 100644
--- a/node_modules/gatsby/dist/utils/babel-parse-to-ast.js
+++ b/node_modules/gatsby/dist/utils/babel-parse-to-ast.js
@@ -22,10 +22,12 @@ const PARSER_OPTIONS = {
 function getBabelParserOptions(filePath) {
   // Flow and typescript plugins can't be enabled simultaneously
   if (/\.tsx?/.test(filePath)) {
-    const plugins = PARSER_OPTIONS.plugins;
-    return Object.assign({}, PARSER_OPTIONS, {
+    const {
+      plugins
+    } = PARSER_OPTIONS;
+    return { ...PARSER_OPTIONS,
       plugins: plugins.map(plugin => plugin === `flow` ? `typescript` : plugin)
-    });
+    };
   }
 
   return PARSER_OPTIONS;
diff --git a/node_modules/gatsby/dist/utils/babel-parse-to-ast.js.map b/node_modules/gatsby/dist/utils/babel-parse-to-ast.js.map
index 2dc8e3d..9cba7d8 100644
--- a/node_modules/gatsby/dist/utils/babel-parse-to-ast.js.map
+++ b/node_modules/gatsby/dist/utils/babel-parse-to-ast.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/utils/babel-parse-to-ast.js"],"names":["parser","require","PARSER_OPTIONS","allowImportExportEverywhere","allowReturnOutsideFunction","allowSuperOutsideMethod","sourceType","sourceFilename","plugins","decoratorsBeforeExport","proposal","getBabelParserOptions","filePath","test","map","plugin","babelParseToAst","contents","parse"],"mappings":";;;;;;AACA,MAAMA,MAAM,GAAGC,OAAO,CAAE,eAAF,CAAtB;;AAEA,MAAMC,cAAc,GAAG;AACrBC,EAAAA,2BAA2B,EAAE,IADR;AAErBC,EAAAA,0BAA0B,EAAE,IAFP;AAGrBC,EAAAA,uBAAuB,EAAE,IAHJ;AAIrBC,EAAAA,UAAU,EAAG,aAJQ;AAKrBC,EAAAA,cAAc,EAAE,IALK;AAMrBC,EAAAA,OAAO,EAAE,CACN,KADM,EAEN,MAFM,EAGN,eAHM,EAIN,kBAJM,EAKP,CACG,YADH,EAEE;AACEC,IAAAA,sBAAsB,EAAE;AAD1B,GAFF,CALO,EAWN,iBAXM,EAYN,wBAZM,EAaN,qBAbM,EAcN,mBAdM,EAeN,qBAfM,EAgBN,iBAhBM,EAiBN,cAjBM,EAkBN,cAlBM,EAmBN,eAnBM,EAoBN,kBApBM,EAqBN,kBArBM,EAsBN,YAtBM,EAuBN,QAvBM,EAwBN,sBAxBM,EAyBN,kBAzBM,EA0BP,CACG,kBADH,EAEE;AACEC,IAAAA,QAAQ,EAAG;AADb,GAFF,CA1BO,EAgCN,2BAhCM;AANY,CAAvB;;AA0CO,SAASC,qBAAT,CAA+BC,QAA/B,EAAiD;AACtD;AACA,MAAI,SAASC,IAAT,CAAcD,QAAd,CAAJ,EAA6B;AAAA,UACnBJ,OADmB,GACPN,cADO,CACnBM,OADmB;AAE3B,6BACKN,cADL;AAEEM,MAAAA,OAAO,EAAEA,OAAO,CAACM,GAAR,CAAYC,MAAM,IACzBA,MAAM,KAAM,MAAZ,GAAqB,YAArB,GAAmCA,MAD5B;AAFX;AAMD;;AACD,SAAOb,cAAP;AACD;;AAEM,SAASc,eAAT,CAAyBC,QAAzB,EAA2CL,QAA3C,EAA6D;AAClE,SAAOZ,MAAM,CAACkB,KAAP,CAAaD,QAAb,EAAuBN,qBAAqB,CAACC,QAAD,CAA5C,CAAP;AACD","sourcesContent":["/* @flow */\nconst parser = require(`@babel/parser`)\n\nconst PARSER_OPTIONS = {\n  allowImportExportEverywhere: true,\n  allowReturnOutsideFunction: true,\n  allowSuperOutsideMethod: true,\n  sourceType: `unambigious`,\n  sourceFilename: true,\n  plugins: [\n    `jsx`,\n    `flow`,\n    `doExpressions`,\n    `objectRestSpread`,\n    [\n      `decorators`,\n      {\n        decoratorsBeforeExport: true,\n      },\n    ],\n    `classProperties`,\n    `classPrivateProperties`,\n    `classPrivateMethods`,\n    `exportDefaultFrom`,\n    `exportNamespaceFrom`,\n    `asyncGenerators`,\n    `functionBind`,\n    `functionSent`,\n    `dynamicImport`,\n    `numericSeparator`,\n    `optionalChaining`,\n    `importMeta`,\n    `bigInt`,\n    `optionalCatchBinding`,\n    `throwExpressions`,\n    [\n      `pipelineOperator`,\n      {\n        proposal: `minimal`,\n      },\n    ],\n    `nullishCoalescingOperator`,\n  ],\n}\n\nexport function getBabelParserOptions(filePath: string) {\n  // Flow and typescript plugins can't be enabled simultaneously\n  if (/\\.tsx?/.test(filePath)) {\n    const { plugins } = PARSER_OPTIONS\n    return {\n      ...PARSER_OPTIONS,\n      plugins: plugins.map(plugin =>\n        plugin === `flow` ? `typescript` : plugin\n      ),\n    }\n  }\n  return PARSER_OPTIONS\n}\n\nexport function babelParseToAst(contents: string, filePath: string) {\n  return parser.parse(contents, getBabelParserOptions(filePath))\n}\n"],"file":"babel-parse-to-ast.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/utils/babel-parse-to-ast.js"],"names":["parser","require","PARSER_OPTIONS","allowImportExportEverywhere","allowReturnOutsideFunction","allowSuperOutsideMethod","sourceType","sourceFilename","plugins","decoratorsBeforeExport","proposal","getBabelParserOptions","filePath","test","map","plugin","babelParseToAst","contents","parse"],"mappings":";;;;;;AACA,MAAMA,MAAM,GAAGC,OAAO,CAAE,eAAF,CAAtB;;AAEA,MAAMC,cAAc,GAAG;AACrBC,EAAAA,2BAA2B,EAAE,IADR;AAErBC,EAAAA,0BAA0B,EAAE,IAFP;AAGrBC,EAAAA,uBAAuB,EAAE,IAHJ;AAIrBC,EAAAA,UAAU,EAAG,aAJQ;AAKrBC,EAAAA,cAAc,EAAE,IALK;AAMrBC,EAAAA,OAAO,EAAE,CACN,KADM,EAEN,MAFM,EAGN,eAHM,EAIN,kBAJM,EAKP,CACG,YADH,EAEE;AACEC,IAAAA,sBAAsB,EAAE;AAD1B,GAFF,CALO,EAWN,iBAXM,EAYN,wBAZM,EAaN,qBAbM,EAcN,mBAdM,EAeN,qBAfM,EAgBN,iBAhBM,EAiBN,cAjBM,EAkBN,cAlBM,EAmBN,eAnBM,EAoBN,kBApBM,EAqBN,kBArBM,EAsBN,YAtBM,EAuBN,QAvBM,EAwBN,sBAxBM,EAyBN,kBAzBM,EA0BP,CACG,kBADH,EAEE;AACEC,IAAAA,QAAQ,EAAG;AADb,GAFF,CA1BO,EAgCN,2BAhCM;AANY,CAAvB;;AA0CO,SAASC,qBAAT,CAA+BC,QAA/B,EAAiD;AACtD;AACA,MAAI,SAASC,IAAT,CAAcD,QAAd,CAAJ,EAA6B;AAC3B,UAAM;AAAEJ,MAAAA;AAAF,QAAcN,cAApB;AACA,WAAO,EACL,GAAGA,cADE;AAELM,MAAAA,OAAO,EAAEA,OAAO,CAACM,GAAR,CAAYC,MAAM,IACzBA,MAAM,KAAM,MAAZ,GAAqB,YAArB,GAAmCA,MAD5B;AAFJ,KAAP;AAMD;;AACD,SAAOb,cAAP;AACD;;AAEM,SAASc,eAAT,CAAyBC,QAAzB,EAA2CL,QAA3C,EAA6D;AAClE,SAAOZ,MAAM,CAACkB,KAAP,CAAaD,QAAb,EAAuBN,qBAAqB,CAACC,QAAD,CAA5C,CAAP;AACD","sourcesContent":["/* @flow */\nconst parser = require(`@babel/parser`)\n\nconst PARSER_OPTIONS = {\n  allowImportExportEverywhere: true,\n  allowReturnOutsideFunction: true,\n  allowSuperOutsideMethod: true,\n  sourceType: `unambigious`,\n  sourceFilename: true,\n  plugins: [\n    `jsx`,\n    `flow`,\n    `doExpressions`,\n    `objectRestSpread`,\n    [\n      `decorators`,\n      {\n        decoratorsBeforeExport: true,\n      },\n    ],\n    `classProperties`,\n    `classPrivateProperties`,\n    `classPrivateMethods`,\n    `exportDefaultFrom`,\n    `exportNamespaceFrom`,\n    `asyncGenerators`,\n    `functionBind`,\n    `functionSent`,\n    `dynamicImport`,\n    `numericSeparator`,\n    `optionalChaining`,\n    `importMeta`,\n    `bigInt`,\n    `optionalCatchBinding`,\n    `throwExpressions`,\n    [\n      `pipelineOperator`,\n      {\n        proposal: `minimal`,\n      },\n    ],\n    `nullishCoalescingOperator`,\n  ],\n}\n\nexport function getBabelParserOptions(filePath: string) {\n  // Flow and typescript plugins can't be enabled simultaneously\n  if (/\\.tsx?/.test(filePath)) {\n    const { plugins } = PARSER_OPTIONS\n    return {\n      ...PARSER_OPTIONS,\n      plugins: plugins.map(plugin =>\n        plugin === `flow` ? `typescript` : plugin\n      ),\n    }\n  }\n  return PARSER_OPTIONS\n}\n\nexport function babelParseToAst(contents: string, filePath: string) {\n  return parser.parse(contents, getBabelParserOptions(filePath))\n}\n"],"file":"babel-parse-to-ast.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/utils/browserslist.js b/node_modules/gatsby/dist/utils/browserslist.js
index 5e6b58e..939a8d4 100644
--- a/node_modules/gatsby/dist/utils/browserslist.js
+++ b/node_modules/gatsby/dist/utils/browserslist.js
@@ -6,8 +6,9 @@ const browserslist = require(`browserslist/node`);
 
 function installedGatsbyVersion(directory) {
   try {
-    const _require = require(path.join(directory, `node_modules`, `gatsby`, `package.json`)),
-          version = _require.version;
+    const {
+      version
+    } = require(path.join(directory, `node_modules`, `gatsby`, `package.json`));
 
     return parseInt(version.split(`.`)[0], 10);
   } catch (e) {
diff --git a/node_modules/gatsby/dist/utils/browserslist.js.map b/node_modules/gatsby/dist/utils/browserslist.js.map
index 2f704b1..34866af 100644
--- a/node_modules/gatsby/dist/utils/browserslist.js.map
+++ b/node_modules/gatsby/dist/utils/browserslist.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/utils/browserslist.js"],"names":["path","require","browserslist","installedGatsbyVersion","directory","join","version","parseInt","split","e","undefined","module","exports","getBrowsersList","fallback","config","findConfig","defaults"],"mappings":";;AAAA,MAAMA,IAAI,GAAGC,OAAO,CAAE,MAAF,CAApB;;AACA,MAAMC,YAAY,GAAGD,OAAO,CAAE,mBAAF,CAA5B;;AAEA,SAASE,sBAAT,CAAgCC,SAAhC,EAA2C;AACzC,MAAI;AAAA,qBACkBH,OAAO,CAACD,IAAI,CAACK,IAAL,CAC1BD,SAD0B,EAEzB,cAFyB,EAGzB,QAHyB,EAIzB,cAJyB,CAAD,CADzB;AAAA,UACME,OADN,YACMA,OADN;;AAOF,WAAOC,QAAQ,CAACD,OAAO,CAACE,KAAR,CAAe,GAAf,EAAmB,CAAnB,CAAD,EAAwB,EAAxB,CAAf;AACD,GARD,CAQE,OAAOC,CAAP,EAAU;AACV,WAAOC,SAAP;AACD;AACF;;AAEDC,MAAM,CAACC,OAAP,GAAiB,SAASC,eAAT,CAAyBT,SAAzB,EAAoC;AACnD,QAAMU,QAAQ,GACZX,sBAAsB,CAACC,SAAD,CAAtB,KAAsC,CAAtC,GACI,CAAE,KAAF,EAAS,iBAAT,EAA4B,SAA5B,CADJ,GAEI,CAAE,QAAF,EAAY,UAAZ,CAHN;AAKA,QAAMW,MAAM,GAAGb,YAAY,CAACc,UAAb,CAAwBZ,SAAxB,CAAf;;AAEA,MAAIW,MAAM,IAAIA,MAAM,CAACE,QAArB,EAA+B;AAC7B,WAAOF,MAAM,CAACE,QAAd;AACD;;AAED,SAAOH,QAAP;AACD,CAbD","sourcesContent":["const path = require(`path`)\nconst browserslist = require(`browserslist/node`)\n\nfunction installedGatsbyVersion(directory) {\n  try {\n    const { version } = require(path.join(\n      directory,\n      `node_modules`,\n      `gatsby`,\n      `package.json`\n    ))\n    return parseInt(version.split(`.`)[0], 10)\n  } catch (e) {\n    return undefined\n  }\n}\n\nmodule.exports = function getBrowsersList(directory) {\n  const fallback =\n    installedGatsbyVersion(directory) === 1\n      ? [`>1%`, `last 2 versions`, `IE >= 9`]\n      : [`>0.25%`, `not dead`]\n\n  const config = browserslist.findConfig(directory)\n\n  if (config && config.defaults) {\n    return config.defaults\n  }\n\n  return fallback\n}\n"],"file":"browserslist.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/utils/browserslist.js"],"names":["path","require","browserslist","installedGatsbyVersion","directory","version","join","parseInt","split","e","undefined","module","exports","getBrowsersList","fallback","config","findConfig","defaults"],"mappings":";;AAAA,MAAMA,IAAI,GAAGC,OAAO,CAAE,MAAF,CAApB;;AACA,MAAMC,YAAY,GAAGD,OAAO,CAAE,mBAAF,CAA5B;;AAEA,SAASE,sBAAT,CAAgCC,SAAhC,EAA2C;AACzC,MAAI;AACF,UAAM;AAAEC,MAAAA;AAAF,QAAcJ,OAAO,CAACD,IAAI,CAACM,IAAL,CAC1BF,SAD0B,EAEzB,cAFyB,EAGzB,QAHyB,EAIzB,cAJyB,CAAD,CAA3B;;AAMA,WAAOG,QAAQ,CAACF,OAAO,CAACG,KAAR,CAAe,GAAf,EAAmB,CAAnB,CAAD,EAAwB,EAAxB,CAAf;AACD,GARD,CAQE,OAAOC,CAAP,EAAU;AACV,WAAOC,SAAP;AACD;AACF;;AAEDC,MAAM,CAACC,OAAP,GAAiB,SAASC,eAAT,CAAyBT,SAAzB,EAAoC;AACnD,QAAMU,QAAQ,GACZX,sBAAsB,CAACC,SAAD,CAAtB,KAAsC,CAAtC,GACI,CAAE,KAAF,EAAS,iBAAT,EAA4B,SAA5B,CADJ,GAEI,CAAE,QAAF,EAAY,UAAZ,CAHN;AAKA,QAAMW,MAAM,GAAGb,YAAY,CAACc,UAAb,CAAwBZ,SAAxB,CAAf;;AAEA,MAAIW,MAAM,IAAIA,MAAM,CAACE,QAArB,EAA+B;AAC7B,WAAOF,MAAM,CAACE,QAAd;AACD;;AAED,SAAOH,QAAP;AACD,CAbD","sourcesContent":["const path = require(`path`)\nconst browserslist = require(`browserslist/node`)\n\nfunction installedGatsbyVersion(directory) {\n  try {\n    const { version } = require(path.join(\n      directory,\n      `node_modules`,\n      `gatsby`,\n      `package.json`\n    ))\n    return parseInt(version.split(`.`)[0], 10)\n  } catch (e) {\n    return undefined\n  }\n}\n\nmodule.exports = function getBrowsersList(directory) {\n  const fallback =\n    installedGatsbyVersion(directory) === 1\n      ? [`>1%`, `last 2 versions`, `IE >= 9`]\n      : [`>0.25%`, `not dead`]\n\n  const config = browserslist.findConfig(directory)\n\n  if (config && config.defaults) {\n    return config.defaults\n  }\n\n  return fallback\n}\n"],"file":"browserslist.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/utils/gatsby-webpack-stats-extractor.js b/node_modules/gatsby/dist/utils/gatsby-webpack-stats-extractor.js
index abf8444..3375aba 100644
--- a/node_modules/gatsby/dist/utils/gatsby-webpack-stats-extractor.js
+++ b/node_modules/gatsby/dist/utils/gatsby-webpack-stats-extractor.js
@@ -17,36 +17,11 @@ class GatsbyWebpackStatsExtractor {
       let assets = {};
       let assetsMap = {};
 
-      for (var _iterator = stats.compilation.chunkGroups, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {
-        var _ref;
-
-        if (_isArray) {
-          if (_i >= _iterator.length) break;
-          _ref = _iterator[_i++];
-        } else {
-          _i = _iterator.next();
-          if (_i.done) break;
-          _ref = _i.value;
-        }
-
-        let chunkGroup = _ref;
-
+      for (let chunkGroup of stats.compilation.chunkGroups) {
         if (chunkGroup.name) {
           let files = [];
 
-          for (var _iterator2 = chunkGroup.chunks, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {
-            var _ref2;
-
-            if (_isArray2) {
-              if (_i2 >= _iterator2.length) break;
-              _ref2 = _iterator2[_i2++];
-            } else {
-              _i2 = _iterator2.next();
-              if (_i2.done) break;
-              _ref2 = _i2.value;
-            }
-
-            let chunk = _ref2;
+          for (let chunk of chunkGroup.chunks) {
             files.push(...chunk.files);
           }
 
@@ -55,12 +30,12 @@ class GatsbyWebpackStatsExtractor {
         }
       }
 
-      const webpackStats = Object.assign({}, stats.toJson({
-        all: false,
-        chunkGroups: true
-      }), {
+      const webpackStats = { ...stats.toJson({
+          all: false,
+          chunkGroups: true
+        }),
         assetsByChunkName: assets
-      });
+      };
       fs.writeFile(path.join(`public`, `chunk-map.json`), JSON.stringify(assetsMap), () => {
         fs.writeFile(path.join(`public`, `webpack.stats.json`), JSON.stringify(webpackStats), done);
       });
diff --git a/node_modules/gatsby/dist/utils/gatsby-webpack-stats-extractor.js.map b/node_modules/gatsby/dist/utils/gatsby-webpack-stats-extractor.js.map
index 294a9e9..3ea3ac5 100644
--- a/node_modules/gatsby/dist/utils/gatsby-webpack-stats-extractor.js.map
+++ b/node_modules/gatsby/dist/utils/gatsby-webpack-stats-extractor.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/utils/gatsby-webpack-stats-extractor.js"],"names":["fs","require","path","GatsbyWebpackStatsExtractor","constructor","options","plugin","name","apply","compiler","hooks","done","tapAsync","stats","assets","assetsMap","compilation","chunkGroups","chunkGroup","files","chunks","chunk","push","filter","f","slice","length","map","filename","webpackStats","toJson","all","assetsByChunkName","writeFile","join","JSON","stringify","module","exports"],"mappings":";;AAAA,MAAMA,EAAE,GAAGC,OAAO,CAAE,UAAF,CAAlB;;AACA,MAAMC,IAAI,GAAGD,OAAO,CAAE,MAAF,CAApB;;AAEA,MAAME,2BAAN,CAAkC;AAChCC,EAAAA,WAAW,CAACC,OAAD,EAAU;AACnB,SAAKC,MAAL,GAAc;AAAEC,MAAAA,IAAI,EAAG;AAAT,KAAd;AACA,SAAKF,OAAL,GAAeA,OAAO,IAAI,EAA1B;AACD;;AACDG,EAAAA,KAAK,CAACC,QAAD,EAAW;AACdA,IAAAA,QAAQ,CAACC,KAAT,CAAeC,IAAf,CAAoBC,QAApB,CAA6B,KAAKN,MAAlC,EAA0C,CAACO,KAAD,EAAQF,IAAR,KAAiB;AACzD,UAAIG,MAAM,GAAG,EAAb;AACA,UAAIC,SAAS,GAAG,EAAhB;;AACA,2BAAuBF,KAAK,CAACG,WAAN,CAAkBC,WAAzC,kHAAsD;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,YAA7CC,UAA6C;;AACpD,YAAIA,UAAU,CAACX,IAAf,EAAqB;AACnB,cAAIY,KAAK,GAAG,EAAZ;;AACA,gCAAkBD,UAAU,CAACE,MAA7B,yHAAqC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,gBAA5BC,KAA4B;AACnCF,YAAAA,KAAK,CAACG,IAAN,CAAW,GAAGD,KAAK,CAACF,KAApB;AACD;;AACDL,UAAAA,MAAM,CAACI,UAAU,CAACX,IAAZ,CAAN,GAA0BY,KAAK,CAACI,MAAN,CAAaC,CAAC,IAAIA,CAAC,CAACC,KAAF,CAAQ,CAAC,CAAT,MAAiB,MAAnC,CAA1B;AACAV,UAAAA,SAAS,CAACG,UAAU,CAACX,IAAZ,CAAT,GAA6BY,KAAK,CAC/BI,MAD0B,CAEzBC,CAAC,IACCA,CAAC,CAACC,KAAF,CAAQ,CAAC,CAAT,MAAiB,MAAjB,IACAD,CAAC,CAACC,KAAF,CAAQ,CAAR,EAAWP,UAAU,CAACX,IAAX,CAAgBmB,MAA3B,MAAuCR,UAAU,CAACX,IAJ3B,EAM1BoB,GAN0B,CAMtBC,QAAQ,IAAK,IAAGA,QAAS,EANH,CAA7B;AAOD;AACF;;AACD,YAAMC,YAAY,qBACbhB,KAAK,CAACiB,MAAN,CAAa;AAAEC,QAAAA,GAAG,EAAE,KAAP;AAAcd,QAAAA,WAAW,EAAE;AAA3B,OAAb,CADa;AAEhBe,QAAAA,iBAAiB,EAAElB;AAFH,QAAlB;AAIAd,MAAAA,EAAE,CAACiC,SAAH,CACE/B,IAAI,CAACgC,IAAL,CAAW,QAAX,EAAqB,gBAArB,CADF,EAEEC,IAAI,CAACC,SAAL,CAAerB,SAAf,CAFF,EAGE,MAAM;AACJf,QAAAA,EAAE,CAACiC,SAAH,CACE/B,IAAI,CAACgC,IAAL,CAAW,QAAX,EAAqB,oBAArB,CADF,EAEEC,IAAI,CAACC,SAAL,CAAeP,YAAf,CAFF,EAGElB,IAHF;AAKD,OATH;AAWD,KAlCD;AAmCD;;AAzC+B;;AA4ClC0B,MAAM,CAACC,OAAP,GAAiBnC,2BAAjB","sourcesContent":["const fs = require(`fs-extra`)\nconst path = require(`path`)\n\nclass GatsbyWebpackStatsExtractor {\n  constructor(options) {\n    this.plugin = { name: `GatsbyWebpackStatsExtractor` }\n    this.options = options || {}\n  }\n  apply(compiler) {\n    compiler.hooks.done.tapAsync(this.plugin, (stats, done) => {\n      let assets = {}\n      let assetsMap = {}\n      for (let chunkGroup of stats.compilation.chunkGroups) {\n        if (chunkGroup.name) {\n          let files = []\n          for (let chunk of chunkGroup.chunks) {\n            files.push(...chunk.files)\n          }\n          assets[chunkGroup.name] = files.filter(f => f.slice(-4) !== `.map`)\n          assetsMap[chunkGroup.name] = files\n            .filter(\n              f =>\n                f.slice(-4) !== `.map` &&\n                f.slice(0, chunkGroup.name.length) === chunkGroup.name\n            )\n            .map(filename => `/${filename}`)\n        }\n      }\n      const webpackStats = {\n        ...stats.toJson({ all: false, chunkGroups: true }),\n        assetsByChunkName: assets,\n      }\n      fs.writeFile(\n        path.join(`public`, `chunk-map.json`),\n        JSON.stringify(assetsMap),\n        () => {\n          fs.writeFile(\n            path.join(`public`, `webpack.stats.json`),\n            JSON.stringify(webpackStats),\n            done\n          )\n        }\n      )\n    })\n  }\n}\n\nmodule.exports = GatsbyWebpackStatsExtractor\n"],"file":"gatsby-webpack-stats-extractor.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/utils/gatsby-webpack-stats-extractor.js"],"names":["fs","require","path","GatsbyWebpackStatsExtractor","constructor","options","plugin","name","apply","compiler","hooks","done","tapAsync","stats","assets","assetsMap","chunkGroup","compilation","chunkGroups","files","chunk","chunks","push","filter","f","slice","length","map","filename","webpackStats","toJson","all","assetsByChunkName","writeFile","join","JSON","stringify","module","exports"],"mappings":";;AAAA,MAAMA,EAAE,GAAGC,OAAO,CAAE,UAAF,CAAlB;;AACA,MAAMC,IAAI,GAAGD,OAAO,CAAE,MAAF,CAApB;;AAEA,MAAME,2BAAN,CAAkC;AAChCC,EAAAA,WAAW,CAACC,OAAD,EAAU;AACnB,SAAKC,MAAL,GAAc;AAAEC,MAAAA,IAAI,EAAG;AAAT,KAAd;AACA,SAAKF,OAAL,GAAeA,OAAO,IAAI,EAA1B;AACD;;AACDG,EAAAA,KAAK,CAACC,QAAD,EAAW;AACdA,IAAAA,QAAQ,CAACC,KAAT,CAAeC,IAAf,CAAoBC,QAApB,CAA6B,KAAKN,MAAlC,EAA0C,CAACO,KAAD,EAAQF,IAAR,KAAiB;AACzD,UAAIG,MAAM,GAAG,EAAb;AACA,UAAIC,SAAS,GAAG,EAAhB;;AACA,WAAK,IAAIC,UAAT,IAAuBH,KAAK,CAACI,WAAN,CAAkBC,WAAzC,EAAsD;AACpD,YAAIF,UAAU,CAACT,IAAf,EAAqB;AACnB,cAAIY,KAAK,GAAG,EAAZ;;AACA,eAAK,IAAIC,KAAT,IAAkBJ,UAAU,CAACK,MAA7B,EAAqC;AACnCF,YAAAA,KAAK,CAACG,IAAN,CAAW,GAAGF,KAAK,CAACD,KAApB;AACD;;AACDL,UAAAA,MAAM,CAACE,UAAU,CAACT,IAAZ,CAAN,GAA0BY,KAAK,CAACI,MAAN,CAAaC,CAAC,IAAIA,CAAC,CAACC,KAAF,CAAQ,CAAC,CAAT,MAAiB,MAAnC,CAA1B;AACAV,UAAAA,SAAS,CAACC,UAAU,CAACT,IAAZ,CAAT,GAA6BY,KAAK,CAC/BI,MAD0B,CAEzBC,CAAC,IACCA,CAAC,CAACC,KAAF,CAAQ,CAAC,CAAT,MAAiB,MAAjB,IACAD,CAAC,CAACC,KAAF,CAAQ,CAAR,EAAWT,UAAU,CAACT,IAAX,CAAgBmB,MAA3B,MAAuCV,UAAU,CAACT,IAJ3B,EAM1BoB,GAN0B,CAMtBC,QAAQ,IAAK,IAAGA,QAAS,EANH,CAA7B;AAOD;AACF;;AACD,YAAMC,YAAY,GAAG,EACnB,GAAGhB,KAAK,CAACiB,MAAN,CAAa;AAAEC,UAAAA,GAAG,EAAE,KAAP;AAAcb,UAAAA,WAAW,EAAE;AAA3B,SAAb,CADgB;AAEnBc,QAAAA,iBAAiB,EAAElB;AAFA,OAArB;AAIAd,MAAAA,EAAE,CAACiC,SAAH,CACE/B,IAAI,CAACgC,IAAL,CAAW,QAAX,EAAqB,gBAArB,CADF,EAEEC,IAAI,CAACC,SAAL,CAAerB,SAAf,CAFF,EAGE,MAAM;AACJf,QAAAA,EAAE,CAACiC,SAAH,CACE/B,IAAI,CAACgC,IAAL,CAAW,QAAX,EAAqB,oBAArB,CADF,EAEEC,IAAI,CAACC,SAAL,CAAeP,YAAf,CAFF,EAGElB,IAHF;AAKD,OATH;AAWD,KAlCD;AAmCD;;AAzC+B;;AA4ClC0B,MAAM,CAACC,OAAP,GAAiBnC,2BAAjB","sourcesContent":["const fs = require(`fs-extra`)\nconst path = require(`path`)\n\nclass GatsbyWebpackStatsExtractor {\n  constructor(options) {\n    this.plugin = { name: `GatsbyWebpackStatsExtractor` }\n    this.options = options || {}\n  }\n  apply(compiler) {\n    compiler.hooks.done.tapAsync(this.plugin, (stats, done) => {\n      let assets = {}\n      let assetsMap = {}\n      for (let chunkGroup of stats.compilation.chunkGroups) {\n        if (chunkGroup.name) {\n          let files = []\n          for (let chunk of chunkGroup.chunks) {\n            files.push(...chunk.files)\n          }\n          assets[chunkGroup.name] = files.filter(f => f.slice(-4) !== `.map`)\n          assetsMap[chunkGroup.name] = files\n            .filter(\n              f =>\n                f.slice(-4) !== `.map` &&\n                f.slice(0, chunkGroup.name.length) === chunkGroup.name\n            )\n            .map(filename => `/${filename}`)\n        }\n      }\n      const webpackStats = {\n        ...stats.toJson({ all: false, chunkGroups: true }),\n        assetsByChunkName: assets,\n      }\n      fs.writeFile(\n        path.join(`public`, `chunk-map.json`),\n        JSON.stringify(assetsMap),\n        () => {\n          fs.writeFile(\n            path.join(`public`, `webpack.stats.json`),\n            JSON.stringify(webpackStats),\n            done\n          )\n        }\n      )\n    })\n  }\n}\n\nmodule.exports = GatsbyWebpackStatsExtractor\n"],"file":"gatsby-webpack-stats-extractor.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/utils/get-ssl-cert.js b/node_modules/gatsby/dist/utils/get-ssl-cert.js
index e7253ba..20d2eea 100644
--- a/node_modules/gatsby/dist/utils/get-ssl-cert.js
+++ b/node_modules/gatsby/dist/utils/get-ssl-cert.js
@@ -1,9 +1,5 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const getDevelopmentCertificate = require(`devcert-san`).default;
 
 const report = require(`gatsby-cli/lib/reporter`);
@@ -12,47 +8,39 @@ const fs = require(`fs`);
 
 const path = require(`path`);
 
-module.exports =
-/*#__PURE__*/
-function () {
-  var _ref = (0, _asyncToGenerator2.default)(function* ({
-    name,
-    certFile,
-    keyFile,
-    directory
-  }) {
-    // check that cert file and key file are both true or both false, if they are both
-    // false, it defaults to the automatic ssl
-    if (certFile ? !keyFile : keyFile) {
-      report.panic(`for custom ssl --https, --cert-file, and --key-file must be used together`);
-    }
-
-    if (certFile && keyFile) {
-      const keyPath = path.join(directory, keyFile);
-      const certPath = path.join(directory, certFile);
-      return yield {
-        keyPath,
-        certPath,
-        key: fs.readFileSync(keyPath),
-        cert: fs.readFileSync(certPath)
-      };
-    }
-
-    report.info(`setting up automatic SSL certificate (may require sudo)\n`);
-
-    try {
-      return yield getDevelopmentCertificate(name, {
-        installCertutil: true
-      });
-    } catch (err) {
-      report.panic(`\nFailed to generate dev SSL certificate`, err);
-    }
-
-    return false;
-  });
-
-  return function (_x) {
-    return _ref.apply(this, arguments);
-  };
-}();
+module.exports = async ({
+  name,
+  certFile,
+  keyFile,
+  directory
+}) => {
+  // check that cert file and key file are both true or both false, if they are both
+  // false, it defaults to the automatic ssl
+  if (certFile ? !keyFile : keyFile) {
+    report.panic(`for custom ssl --https, --cert-file, and --key-file must be used together`);
+  }
+
+  if (certFile && keyFile) {
+    const keyPath = path.join(directory, keyFile);
+    const certPath = path.join(directory, certFile);
+    return await {
+      keyPath,
+      certPath,
+      key: fs.readFileSync(keyPath),
+      cert: fs.readFileSync(certPath)
+    };
+  }
+
+  report.info(`setting up automatic SSL certificate (may require sudo)\n`);
+
+  try {
+    return await getDevelopmentCertificate(name, {
+      installCertutil: true
+    });
+  } catch (err) {
+    report.panic(`\nFailed to generate dev SSL certificate`, err);
+  }
+
+  return false;
+};
 //# sourceMappingURL=get-ssl-cert.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/utils/get-ssl-cert.js.map b/node_modules/gatsby/dist/utils/get-ssl-cert.js.map
index 6653bf5..61d1124 100644
--- a/node_modules/gatsby/dist/utils/get-ssl-cert.js.map
+++ b/node_modules/gatsby/dist/utils/get-ssl-cert.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/utils/get-ssl-cert.js"],"names":["getDevelopmentCertificate","require","default","report","fs","path","module","exports","name","certFile","keyFile","directory","panic","keyPath","join","certPath","key","readFileSync","cert","info","installCertutil","err"],"mappings":";;;;;;AAAA,MAAMA,yBAAyB,GAAGC,OAAO,CAAE,aAAF,CAAP,CAAuBC,OAAzD;;AACA,MAAMC,MAAM,GAAGF,OAAO,CAAE,yBAAF,CAAtB;;AACA,MAAMG,EAAE,GAAGH,OAAO,CAAE,IAAF,CAAlB;;AACA,MAAMI,IAAI,GAAGJ,OAAO,CAAE,MAAF,CAApB;;AAEAK,MAAM,CAACC,OAAP;AAAA;AAAA;AAAA,6CAAiB,WAAO;AAAEC,IAAAA,IAAF;AAAQC,IAAAA,QAAR;AAAkBC,IAAAA,OAAlB;AAA2BC,IAAAA;AAA3B,GAAP,EAAkD;AACjE;AACA;AACA,QAAIF,QAAQ,GAAG,CAACC,OAAJ,GAAcA,OAA1B,EAAmC;AACjCP,MAAAA,MAAM,CAACS,KAAP,CACG,2EADH;AAGD;;AAED,QAAIH,QAAQ,IAAIC,OAAhB,EAAyB;AACvB,YAAMG,OAAO,GAAGR,IAAI,CAACS,IAAL,CAAUH,SAAV,EAAqBD,OAArB,CAAhB;AACA,YAAMK,QAAQ,GAAGV,IAAI,CAACS,IAAL,CAAUH,SAAV,EAAqBF,QAArB,CAAjB;AAEA,mBAAa;AACXI,QAAAA,OADW;AAEXE,QAAAA,QAFW;AAGXC,QAAAA,GAAG,EAAEZ,EAAE,CAACa,YAAH,CAAgBJ,OAAhB,CAHM;AAIXK,QAAAA,IAAI,EAAEd,EAAE,CAACa,YAAH,CAAgBF,QAAhB;AAJK,OAAb;AAMD;;AAEDZ,IAAAA,MAAM,CAACgB,IAAP,CAAa,2DAAb;;AACA,QAAI;AACF,mBAAanB,yBAAyB,CAACQ,IAAD,EAAO;AAC3CY,QAAAA,eAAe,EAAE;AAD0B,OAAP,CAAtC;AAGD,KAJD,CAIE,OAAOC,GAAP,EAAY;AACZlB,MAAAA,MAAM,CAACS,KAAP,CAAc,0CAAd,EAAyDS,GAAzD;AACD;;AAED,WAAO,KAAP;AACD,GA/BD;;AAAA;AAAA;AAAA;AAAA","sourcesContent":["const getDevelopmentCertificate = require(`devcert-san`).default\nconst report = require(`gatsby-cli/lib/reporter`)\nconst fs = require(`fs`)\nconst path = require(`path`)\n\nmodule.exports = async ({ name, certFile, keyFile, directory }) => {\n  // check that cert file and key file are both true or both false, if they are both\n  // false, it defaults to the automatic ssl\n  if (certFile ? !keyFile : keyFile) {\n    report.panic(\n      `for custom ssl --https, --cert-file, and --key-file must be used together`\n    )\n  }\n\n  if (certFile && keyFile) {\n    const keyPath = path.join(directory, keyFile)\n    const certPath = path.join(directory, certFile)\n\n    return await {\n      keyPath,\n      certPath,\n      key: fs.readFileSync(keyPath),\n      cert: fs.readFileSync(certPath),\n    }\n  }\n\n  report.info(`setting up automatic SSL certificate (may require sudo)\\n`)\n  try {\n    return await getDevelopmentCertificate(name, {\n      installCertutil: true,\n    })\n  } catch (err) {\n    report.panic(`\\nFailed to generate dev SSL certificate`, err)\n  }\n\n  return false\n}\n"],"file":"get-ssl-cert.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/utils/get-ssl-cert.js"],"names":["getDevelopmentCertificate","require","default","report","fs","path","module","exports","name","certFile","keyFile","directory","panic","keyPath","join","certPath","key","readFileSync","cert","info","installCertutil","err"],"mappings":";;AAAA,MAAMA,yBAAyB,GAAGC,OAAO,CAAE,aAAF,CAAP,CAAuBC,OAAzD;;AACA,MAAMC,MAAM,GAAGF,OAAO,CAAE,yBAAF,CAAtB;;AACA,MAAMG,EAAE,GAAGH,OAAO,CAAE,IAAF,CAAlB;;AACA,MAAMI,IAAI,GAAGJ,OAAO,CAAE,MAAF,CAApB;;AAEAK,MAAM,CAACC,OAAP,GAAiB,OAAO;AAAEC,EAAAA,IAAF;AAAQC,EAAAA,QAAR;AAAkBC,EAAAA,OAAlB;AAA2BC,EAAAA;AAA3B,CAAP,KAAkD;AACjE;AACA;AACA,MAAIF,QAAQ,GAAG,CAACC,OAAJ,GAAcA,OAA1B,EAAmC;AACjCP,IAAAA,MAAM,CAACS,KAAP,CACG,2EADH;AAGD;;AAED,MAAIH,QAAQ,IAAIC,OAAhB,EAAyB;AACvB,UAAMG,OAAO,GAAGR,IAAI,CAACS,IAAL,CAAUH,SAAV,EAAqBD,OAArB,CAAhB;AACA,UAAMK,QAAQ,GAAGV,IAAI,CAACS,IAAL,CAAUH,SAAV,EAAqBF,QAArB,CAAjB;AAEA,WAAO,MAAM;AACXI,MAAAA,OADW;AAEXE,MAAAA,QAFW;AAGXC,MAAAA,GAAG,EAAEZ,EAAE,CAACa,YAAH,CAAgBJ,OAAhB,CAHM;AAIXK,MAAAA,IAAI,EAAEd,EAAE,CAACa,YAAH,CAAgBF,QAAhB;AAJK,KAAb;AAMD;;AAEDZ,EAAAA,MAAM,CAACgB,IAAP,CAAa,2DAAb;;AACA,MAAI;AACF,WAAO,MAAMnB,yBAAyB,CAACQ,IAAD,EAAO;AAC3CY,MAAAA,eAAe,EAAE;AAD0B,KAAP,CAAtC;AAGD,GAJD,CAIE,OAAOC,GAAP,EAAY;AACZlB,IAAAA,MAAM,CAACS,KAAP,CAAc,0CAAd,EAAyDS,GAAzD;AACD;;AAED,SAAO,KAAP;AACD,CA/BD","sourcesContent":["const getDevelopmentCertificate = require(`devcert-san`).default\nconst report = require(`gatsby-cli/lib/reporter`)\nconst fs = require(`fs`)\nconst path = require(`path`)\n\nmodule.exports = async ({ name, certFile, keyFile, directory }) => {\n  // check that cert file and key file are both true or both false, if they are both\n  // false, it defaults to the automatic ssl\n  if (certFile ? !keyFile : keyFile) {\n    report.panic(\n      `for custom ssl --https, --cert-file, and --key-file must be used together`\n    )\n  }\n\n  if (certFile && keyFile) {\n    const keyPath = path.join(directory, keyFile)\n    const certPath = path.join(directory, certFile)\n\n    return await {\n      keyPath,\n      certPath,\n      key: fs.readFileSync(keyPath),\n      cert: fs.readFileSync(certPath),\n    }\n  }\n\n  report.info(`setting up automatic SSL certificate (may require sudo)\\n`)\n  try {\n    return await getDevelopmentCertificate(name, {\n      installCertutil: true,\n    })\n  } catch (err) {\n    report.panic(`\\nFailed to generate dev SSL certificate`, err)\n  }\n\n  return false\n}\n"],"file":"get-ssl-cert.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/utils/get-static-dir.js b/node_modules/gatsby/dist/utils/get-static-dir.js
index e9f9c70..3724b91 100644
--- a/node_modules/gatsby/dist/utils/get-static-dir.js
+++ b/node_modules/gatsby/dist/utils/get-static-dir.js
@@ -5,14 +5,30 @@ const fs = require(`fs-extra`);
 const chokidar = require(`chokidar`);
 
 const nodePath = require(`path`);
+
+const {
+  store
+} = require(`../redux`);
 /**
- * copyStaticDir
+ * copyStaticDirs
  * --
  * Copy files from the static directory to the public directory
  */
 
 
-exports.copyStaticDir = () => {
+exports.copyStaticDirs = () => {
+  // access the store to get themes
+  const {
+    themes
+  } = store.getState(); // ensure there are themes
+
+  if (themes && themes.themes) {
+    themes.themes // create an array of potential theme static folders
+    .map(theme => nodePath.resolve(theme.themeDir, `static`)) // filter out the static folders that don't exist
+    .filter(themeStaticPath => fs.existsSync(themeStaticPath)) // copy the files for each folder into the user's build
+    .map(folder => fs.copySync(folder, nodePath.join(process.cwd(), `public`)));
+  }
+
   const staticDir = nodePath.join(process.cwd(), `static`);
   if (!fs.existsSync(staticDir)) return Promise.resolve();
   return fs.copySync(staticDir, nodePath.join(process.cwd(), `public`));
diff --git a/node_modules/gatsby/dist/utils/get-static-dir.js.map b/node_modules/gatsby/dist/utils/get-static-dir.js.map
index 36af64c..60a4788 100644
--- a/node_modules/gatsby/dist/utils/get-static-dir.js.map
+++ b/node_modules/gatsby/dist/utils/get-static-dir.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/utils/get-static-dir.js"],"names":["fs","require","chokidar","nodePath","exports","copyStaticDir","staticDir","join","process","cwd","existsSync","Promise","resolve","copySync","syncStaticDir","watch","on","path","relativePath","relative","copy"],"mappings":";;AAAA,MAAMA,EAAE,GAAGC,OAAO,CAAE,UAAF,CAAlB;;AACA,MAAMC,QAAQ,GAAGD,OAAO,CAAE,UAAF,CAAxB;;AACA,MAAME,QAAQ,GAAGF,OAAO,CAAE,MAAF,CAAxB;AAEA;;;;;;;AAKAG,OAAO,CAACC,aAAR,GAAwB,MAAM;AAC5B,QAAMC,SAAS,GAAGH,QAAQ,CAACI,IAAT,CAAcC,OAAO,CAACC,GAAR,EAAd,EAA8B,QAA9B,CAAlB;AACA,MAAI,CAACT,EAAE,CAACU,UAAH,CAAcJ,SAAd,CAAL,EAA+B,OAAOK,OAAO,CAACC,OAAR,EAAP;AAC/B,SAAOZ,EAAE,CAACa,QAAH,CAAYP,SAAZ,EAAuBH,QAAQ,CAACI,IAAT,CAAcC,OAAO,CAACC,GAAR,EAAd,EAA8B,QAA9B,CAAvB,CAAP;AACD,CAJD;AAMA;;;;;;;AAKAL,OAAO,CAACU,aAAR,GAAwB,MAAM;AAC5B,QAAMR,SAAS,GAAGH,QAAQ,CAACI,IAAT,CAAcC,OAAO,CAACC,GAAR,EAAd,EAA8B,QAA9B,CAAlB;AACAP,EAAAA,QAAQ,CACLa,KADH,CACST,SADT,EAEGU,EAFH,CAEO,KAFP,EAEaC,IAAI,IAAI;AACjB,UAAMC,YAAY,GAAGf,QAAQ,CAACgB,QAAT,CAAkBb,SAAlB,EAA6BW,IAA7B,CAArB;AACAjB,IAAAA,EAAE,CAACoB,IAAH,CAAQH,IAAR,EAAe,GAAET,OAAO,CAACC,GAAR,EAAc,WAAUS,YAAa,EAAtD;AACD,GALH,EAMGF,EANH,CAMO,QANP,EAMgBC,IAAI,IAAI;AACpB,UAAMC,YAAY,GAAGf,QAAQ,CAACgB,QAAT,CAAkBb,SAAlB,EAA6BW,IAA7B,CAArB;AACAjB,IAAAA,EAAE,CAACoB,IAAH,CAAQH,IAAR,EAAe,GAAET,OAAO,CAACC,GAAR,EAAc,WAAUS,YAAa,EAAtD;AACD,GATH;AAUD,CAZD","sourcesContent":["const fs = require(`fs-extra`)\nconst chokidar = require(`chokidar`)\nconst nodePath = require(`path`)\n\n/**\n * copyStaticDir\n * --\n * Copy files from the static directory to the public directory\n */\nexports.copyStaticDir = () => {\n  const staticDir = nodePath.join(process.cwd(), `static`)\n  if (!fs.existsSync(staticDir)) return Promise.resolve()\n  return fs.copySync(staticDir, nodePath.join(process.cwd(), `public`))\n}\n\n/**\n * syncStaticDir\n * --\n * Set up a watcher to sync changes from the static directory to the public directory\n */\nexports.syncStaticDir = () => {\n  const staticDir = nodePath.join(process.cwd(), `static`)\n  chokidar\n    .watch(staticDir)\n    .on(`add`, path => {\n      const relativePath = nodePath.relative(staticDir, path)\n      fs.copy(path, `${process.cwd()}/public/${relativePath}`)\n    })\n    .on(`change`, path => {\n      const relativePath = nodePath.relative(staticDir, path)\n      fs.copy(path, `${process.cwd()}/public/${relativePath}`)\n    })\n}\n"],"file":"get-static-dir.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/utils/get-static-dir.js"],"names":["fs","require","chokidar","nodePath","store","exports","copyStaticDirs","themes","getState","map","theme","resolve","themeDir","filter","themeStaticPath","existsSync","folder","copySync","join","process","cwd","staticDir","Promise","syncStaticDir","watch","on","path","relativePath","relative","copy"],"mappings":";;AAAA,MAAMA,EAAE,GAAGC,OAAO,CAAE,UAAF,CAAlB;;AACA,MAAMC,QAAQ,GAAGD,OAAO,CAAE,UAAF,CAAxB;;AACA,MAAME,QAAQ,GAAGF,OAAO,CAAE,MAAF,CAAxB;;AACA,MAAM;AAAEG,EAAAA;AAAF,IAAYH,OAAO,CAAE,UAAF,CAAzB;AAEA;;;;;;;AAKAI,OAAO,CAACC,cAAR,GAAyB,MAAM;AAC7B;AACA,QAAM;AAAEC,IAAAA;AAAF,MAAaH,KAAK,CAACI,QAAN,EAAnB,CAF6B,CAEO;;AAEpC,MAAID,MAAM,IAAIA,MAAM,CAACA,MAArB,EAA6B;AAC3BA,IAAAA,MAAM,CAACA,MAAP,CACE;AADF,KAEGE,GAFH,CAEOC,KAAK,IAAIP,QAAQ,CAACQ,OAAT,CAAiBD,KAAK,CAACE,QAAvB,EAAkC,QAAlC,CAFhB,EAGE;AAHF,KAIGC,MAJH,CAIUC,eAAe,IAAId,EAAE,CAACe,UAAH,CAAcD,eAAd,CAJ7B,EAKE;AALF,KAMGL,GANH,CAMOO,MAAM,IACThB,EAAE,CAACiB,QAAH,CAAYD,MAAZ,EAAoBb,QAAQ,CAACe,IAAT,CAAcC,OAAO,CAACC,GAAR,EAAd,EAA8B,QAA9B,CAApB,CAPJ;AASD;;AAED,QAAMC,SAAS,GAAGlB,QAAQ,CAACe,IAAT,CAAcC,OAAO,CAACC,GAAR,EAAd,EAA8B,QAA9B,CAAlB;AACA,MAAI,CAACpB,EAAE,CAACe,UAAH,CAAcM,SAAd,CAAL,EAA+B,OAAOC,OAAO,CAACX,OAAR,EAAP;AAC/B,SAAOX,EAAE,CAACiB,QAAH,CAAYI,SAAZ,EAAuBlB,QAAQ,CAACe,IAAT,CAAcC,OAAO,CAACC,GAAR,EAAd,EAA8B,QAA9B,CAAvB,CAAP;AACD,CAnBD;AAqBA;;;;;;;AAKAf,OAAO,CAACkB,aAAR,GAAwB,MAAM;AAC5B,QAAMF,SAAS,GAAGlB,QAAQ,CAACe,IAAT,CAAcC,OAAO,CAACC,GAAR,EAAd,EAA8B,QAA9B,CAAlB;AACAlB,EAAAA,QAAQ,CACLsB,KADH,CACSH,SADT,EAEGI,EAFH,CAEO,KAFP,EAEaC,IAAI,IAAI;AACjB,UAAMC,YAAY,GAAGxB,QAAQ,CAACyB,QAAT,CAAkBP,SAAlB,EAA6BK,IAA7B,CAArB;AACA1B,IAAAA,EAAE,CAAC6B,IAAH,CAAQH,IAAR,EAAe,GAAEP,OAAO,CAACC,GAAR,EAAc,WAAUO,YAAa,EAAtD;AACD,GALH,EAMGF,EANH,CAMO,QANP,EAMgBC,IAAI,IAAI;AACpB,UAAMC,YAAY,GAAGxB,QAAQ,CAACyB,QAAT,CAAkBP,SAAlB,EAA6BK,IAA7B,CAArB;AACA1B,IAAAA,EAAE,CAAC6B,IAAH,CAAQH,IAAR,EAAe,GAAEP,OAAO,CAACC,GAAR,EAAc,WAAUO,YAAa,EAAtD;AACD,GATH;AAUD,CAZD","sourcesContent":["const fs = require(`fs-extra`)\nconst chokidar = require(`chokidar`)\nconst nodePath = require(`path`)\nconst { store } = require(`../redux`)\n\n/**\n * copyStaticDirs\n * --\n * Copy files from the static directory to the public directory\n */\nexports.copyStaticDirs = () => {\n  // access the store to get themes\n  const { themes } = store.getState() // ensure there are themes\n\n  if (themes && themes.themes) {\n    themes.themes\n      // create an array of potential theme static folders\n      .map(theme => nodePath.resolve(theme.themeDir, `static`))\n      // filter out the static folders that don't exist\n      .filter(themeStaticPath => fs.existsSync(themeStaticPath))\n      // copy the files for each folder into the user's build\n      .map(folder =>\n        fs.copySync(folder, nodePath.join(process.cwd(), `public`))\n      )\n  }\n\n  const staticDir = nodePath.join(process.cwd(), `static`)\n  if (!fs.existsSync(staticDir)) return Promise.resolve()\n  return fs.copySync(staticDir, nodePath.join(process.cwd(), `public`))\n}\n\n/**\n * syncStaticDir\n * --\n * Set up a watcher to sync changes from the static directory to the public directory\n */\nexports.syncStaticDir = () => {\n  const staticDir = nodePath.join(process.cwd(), `static`)\n  chokidar\n    .watch(staticDir)\n    .on(`add`, path => {\n      const relativePath = nodePath.relative(staticDir, path)\n      fs.copy(path, `${process.cwd()}/public/${relativePath}`)\n    })\n    .on(`change`, path => {\n      const relativePath = nodePath.relative(staticDir, path)\n      fs.copy(path, `${process.cwd()}/public/${relativePath}`)\n    })\n}\n"],"file":"get-static-dir.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/utils/html-renderer-queue.js b/node_modules/gatsby/dist/utils/html-renderer-queue.js
index a9dfb2a..9472eb2 100644
--- a/node_modules/gatsby/dist/utils/html-renderer-queue.js
+++ b/node_modules/gatsby/dist/utils/html-renderer-queue.js
@@ -6,8 +6,9 @@ const convertHrtime = require(`convert-hrtime`);
 
 const Worker = require(`jest-worker`).default;
 
-const _require = require(`lodash`),
-      chunk = _require.chunk;
+const {
+  chunk
+} = require(`lodash`);
 
 const cpuCoreCount = require(`./cpu-core-count`);
 
diff --git a/node_modules/gatsby/dist/utils/html-renderer-queue.js.map b/node_modules/gatsby/dist/utils/html-renderer-queue.js.map
index 717c10a..c6b3bc3 100644
--- a/node_modules/gatsby/dist/utils/html-renderer-queue.js.map
+++ b/node_modules/gatsby/dist/utils/html-renderer-queue.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/utils/html-renderer-queue.js"],"names":["Promise","require","convertHrtime","Worker","default","chunk","cpuCoreCount","workerPool","resolve","numWorkers","forkOptions","silent","module","exports","htmlComponentRendererPath","pages","activity","reject","envVars","Object","entries","NODE_ENV","process","env","gatsby_executing_command","gatsby_log_level","start","hrtime","segments","finished","map","pageSegment","renderHTML","paths","then","length","setStatus","seconds","toFixed","catch"],"mappings":";;AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAE,UAAF,CAAvB;;AACA,MAAMC,aAAa,GAAGD,OAAO,CAAE,gBAAF,CAA7B;;AACA,MAAME,MAAM,GAAGF,OAAO,CAAE,aAAF,CAAP,CAAuBG,OAAtC;;iBACkBH,OAAO,CAAE,QAAF,C;MAAjBI,K,YAAAA,K;;AACR,MAAMC,YAAY,GAAGL,OAAO,CAAE,kBAAF,CAA5B;;AAEA,MAAMM,UAAU,GAAG,IAAIJ,MAAJ,CAAWF,OAAO,CAACO,OAAR,CAAiB,UAAjB,CAAX,EAAwC;AACzDC,EAAAA,UAAU,EAAEH,YAAY,CAAC,IAAD,CADiC;AAEzDI,EAAAA,WAAW,EAAE;AACXC,IAAAA,MAAM,EAAE;AADG;AAF4C,CAAxC,CAAnB;;AAOAC,MAAM,CAACC,OAAP,GAAiB,CAACC,yBAAD,EAA4BC,KAA5B,EAAmCC,QAAnC,KACf,IAAIhB,OAAJ,CAAY,CAACQ,OAAD,EAAUS,MAAV,KAAqB;AAC/B;AACA;AACA,QAAMC,OAAO,GAAGC,MAAM,CAACC,OAAP,CAAe;AAC7BC,IAAAA,QAAQ,EAAEC,OAAO,CAACC,GAAR,CAAYF,QADO;AAE7BG,IAAAA,wBAAwB,EAAEF,OAAO,CAACC,GAAR,CAAYC,wBAFT;AAG7BC,IAAAA,gBAAgB,EAAEH,OAAO,CAACC,GAAR,CAAYE;AAHD,GAAf,CAAhB;AAMA,QAAMC,KAAK,GAAGJ,OAAO,CAACK,MAAR,EAAd;AACA,QAAMC,QAAQ,GAAGvB,KAAK,CAACU,KAAD,EAAQ,EAAR,CAAtB;AACA,MAAIc,QAAQ,GAAG,CAAf;AAEA7B,EAAAA,OAAO,CAAC8B,GAAR,CACEF,QADF,EAEEG,WAAW,IACT,IAAI/B,OAAJ,CAAY,CAACQ,OAAD,EAAUS,MAAV,KAAqB;AAC/BV,IAAAA,UAAU,CACPyB,UADH,CACc;AACVlB,MAAAA,yBADU;AAEVmB,MAAAA,KAAK,EAAEF,WAFG;AAGVb,MAAAA;AAHU,KADd,EAMGgB,IANH,CAMQ,MAAM;AACVL,MAAAA,QAAQ,IAAIE,WAAW,CAACI,MAAxB;;AACA,UAAInB,QAAJ,EAAc;AACZA,QAAAA,QAAQ,CAACoB,SAAT,CACG,GAAEP,QAAS,IAAGd,KAAK,CAACoB,MAAO,IAAG,CAC7BN,QAAQ,GAAG3B,aAAa,CAACoB,OAAO,CAACK,MAAR,CAAeD,KAAf,CAAD,CAAb,CAAqCW,OADnB,EAE7BC,OAF6B,CAErB,CAFqB,CAElB,eAHf;AAKD;;AACD9B,MAAAA,OAAO;AACR,KAhBH,EAiBG+B,KAjBH,CAiBStB,MAjBT;AAkBD,GAnBD,CAHJ,EAwBGiB,IAxBH,CAwBQ1B,OAxBR,EAyBG+B,KAzBH,CAyBStB,MAzBT;AA0BD,CAvCD,CADF","sourcesContent":["const Promise = require(`bluebird`)\nconst convertHrtime = require(`convert-hrtime`)\nconst Worker = require(`jest-worker`).default\nconst { chunk } = require(`lodash`)\nconst cpuCoreCount = require(`./cpu-core-count`)\n\nconst workerPool = new Worker(require.resolve(`./worker`), {\n  numWorkers: cpuCoreCount(true),\n  forkOptions: {\n    silent: false,\n  },\n})\n\nmodule.exports = (htmlComponentRendererPath, pages, activity) =>\n  new Promise((resolve, reject) => {\n    // We need to only pass env vars that are set programatically in gatsby-cli\n    // to child process. Other vars will be picked up from environment.\n    const envVars = Object.entries({\n      NODE_ENV: process.env.NODE_ENV,\n      gatsby_executing_command: process.env.gatsby_executing_command,\n      gatsby_log_level: process.env.gatsby_log_level,\n    })\n\n    const start = process.hrtime()\n    const segments = chunk(pages, 50)\n    let finished = 0\n\n    Promise.map(\n      segments,\n      pageSegment =>\n        new Promise((resolve, reject) => {\n          workerPool\n            .renderHTML({\n              htmlComponentRendererPath,\n              paths: pageSegment,\n              envVars,\n            })\n            .then(() => {\n              finished += pageSegment.length\n              if (activity) {\n                activity.setStatus(\n                  `${finished}/${pages.length} ${(\n                    finished / convertHrtime(process.hrtime(start)).seconds\n                  ).toFixed(2)} pages/second`\n                )\n              }\n              resolve()\n            })\n            .catch(reject)\n        })\n    )\n      .then(resolve)\n      .catch(reject)\n  })\n"],"file":"html-renderer-queue.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/utils/html-renderer-queue.js"],"names":["Promise","require","convertHrtime","Worker","default","chunk","cpuCoreCount","workerPool","resolve","numWorkers","forkOptions","silent","module","exports","htmlComponentRendererPath","pages","activity","reject","envVars","Object","entries","NODE_ENV","process","env","gatsby_executing_command","gatsby_log_level","start","hrtime","segments","finished","map","pageSegment","renderHTML","paths","then","length","setStatus","seconds","toFixed","catch"],"mappings":";;AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAE,UAAF,CAAvB;;AACA,MAAMC,aAAa,GAAGD,OAAO,CAAE,gBAAF,CAA7B;;AACA,MAAME,MAAM,GAAGF,OAAO,CAAE,aAAF,CAAP,CAAuBG,OAAtC;;AACA,MAAM;AAAEC,EAAAA;AAAF,IAAYJ,OAAO,CAAE,QAAF,CAAzB;;AACA,MAAMK,YAAY,GAAGL,OAAO,CAAE,kBAAF,CAA5B;;AAEA,MAAMM,UAAU,GAAG,IAAIJ,MAAJ,CAAWF,OAAO,CAACO,OAAR,CAAiB,UAAjB,CAAX,EAAwC;AACzDC,EAAAA,UAAU,EAAEH,YAAY,CAAC,IAAD,CADiC;AAEzDI,EAAAA,WAAW,EAAE;AACXC,IAAAA,MAAM,EAAE;AADG;AAF4C,CAAxC,CAAnB;;AAOAC,MAAM,CAACC,OAAP,GAAiB,CAACC,yBAAD,EAA4BC,KAA5B,EAAmCC,QAAnC,KACf,IAAIhB,OAAJ,CAAY,CAACQ,OAAD,EAAUS,MAAV,KAAqB;AAC/B;AACA;AACA,QAAMC,OAAO,GAAGC,MAAM,CAACC,OAAP,CAAe;AAC7BC,IAAAA,QAAQ,EAAEC,OAAO,CAACC,GAAR,CAAYF,QADO;AAE7BG,IAAAA,wBAAwB,EAAEF,OAAO,CAACC,GAAR,CAAYC,wBAFT;AAG7BC,IAAAA,gBAAgB,EAAEH,OAAO,CAACC,GAAR,CAAYE;AAHD,GAAf,CAAhB;AAMA,QAAMC,KAAK,GAAGJ,OAAO,CAACK,MAAR,EAAd;AACA,QAAMC,QAAQ,GAAGvB,KAAK,CAACU,KAAD,EAAQ,EAAR,CAAtB;AACA,MAAIc,QAAQ,GAAG,CAAf;AAEA7B,EAAAA,OAAO,CAAC8B,GAAR,CACEF,QADF,EAEEG,WAAW,IACT,IAAI/B,OAAJ,CAAY,CAACQ,OAAD,EAAUS,MAAV,KAAqB;AAC/BV,IAAAA,UAAU,CACPyB,UADH,CACc;AACVlB,MAAAA,yBADU;AAEVmB,MAAAA,KAAK,EAAEF,WAFG;AAGVb,MAAAA;AAHU,KADd,EAMGgB,IANH,CAMQ,MAAM;AACVL,MAAAA,QAAQ,IAAIE,WAAW,CAACI,MAAxB;;AACA,UAAInB,QAAJ,EAAc;AACZA,QAAAA,QAAQ,CAACoB,SAAT,CACG,GAAEP,QAAS,IAAGd,KAAK,CAACoB,MAAO,IAAG,CAC7BN,QAAQ,GAAG3B,aAAa,CAACoB,OAAO,CAACK,MAAR,CAAeD,KAAf,CAAD,CAAb,CAAqCW,OADnB,EAE7BC,OAF6B,CAErB,CAFqB,CAElB,eAHf;AAKD;;AACD9B,MAAAA,OAAO;AACR,KAhBH,EAiBG+B,KAjBH,CAiBStB,MAjBT;AAkBD,GAnBD,CAHJ,EAwBGiB,IAxBH,CAwBQ1B,OAxBR,EAyBG+B,KAzBH,CAyBStB,MAzBT;AA0BD,CAvCD,CADF","sourcesContent":["const Promise = require(`bluebird`)\nconst convertHrtime = require(`convert-hrtime`)\nconst Worker = require(`jest-worker`).default\nconst { chunk } = require(`lodash`)\nconst cpuCoreCount = require(`./cpu-core-count`)\n\nconst workerPool = new Worker(require.resolve(`./worker`), {\n  numWorkers: cpuCoreCount(true),\n  forkOptions: {\n    silent: false,\n  },\n})\n\nmodule.exports = (htmlComponentRendererPath, pages, activity) =>\n  new Promise((resolve, reject) => {\n    // We need to only pass env vars that are set programatically in gatsby-cli\n    // to child process. Other vars will be picked up from environment.\n    const envVars = Object.entries({\n      NODE_ENV: process.env.NODE_ENV,\n      gatsby_executing_command: process.env.gatsby_executing_command,\n      gatsby_log_level: process.env.gatsby_log_level,\n    })\n\n    const start = process.hrtime()\n    const segments = chunk(pages, 50)\n    let finished = 0\n\n    Promise.map(\n      segments,\n      pageSegment =>\n        new Promise((resolve, reject) => {\n          workerPool\n            .renderHTML({\n              htmlComponentRendererPath,\n              paths: pageSegment,\n              envVars,\n            })\n            .then(() => {\n              finished += pageSegment.length\n              if (activity) {\n                activity.setStatus(\n                  `${finished}/${pages.length} ${(\n                    finished / convertHrtime(process.hrtime(start)).seconds\n                  ).toFixed(2)} pages/second`\n                )\n              }\n              resolve()\n            })\n            .catch(reject)\n        })\n    )\n      .then(resolve)\n      .catch(reject)\n  })\n"],"file":"html-renderer-queue.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/utils/js-chunk-names.js b/node_modules/gatsby/dist/utils/js-chunk-names.js
index bc4fcd6..0123356 100644
--- a/node_modules/gatsby/dist/utils/js-chunk-names.js
+++ b/node_modules/gatsby/dist/utils/js-chunk-names.js
@@ -1,14 +1,16 @@
 "use strict";
 
-const _require = require(`lodash`),
-      kebabCase = _require.kebabCase;
+const {
+  kebabCase
+} = require(`lodash`);
 
 const path = require(`path`);
 
 const kebabHash = require(`kebab-hash`);
 
-const _require2 = require(`../redux`),
-      store = _require2.store;
+const {
+  store
+} = require(`../redux`);
 
 const generatePathChunkName = path => {
   const name = path === `/` ? `index` : kebabHash(path);
diff --git a/node_modules/gatsby/dist/utils/js-chunk-names.js.map b/node_modules/gatsby/dist/utils/js-chunk-names.js.map
index 8cbfcc8..3296401 100644
--- a/node_modules/gatsby/dist/utils/js-chunk-names.js.map
+++ b/node_modules/gatsby/dist/utils/js-chunk-names.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/utils/js-chunk-names.js"],"names":["require","kebabCase","path","kebabHash","store","generatePathChunkName","name","generateComponentChunkName","componentPath","program","getState","directory","relative","exports"],"mappings":";;iBAAsBA,OAAO,CAAE,QAAF,C;MAArBC,S,YAAAA,S;;AACR,MAAMC,IAAI,GAAGF,OAAO,CAAE,MAAF,CAApB;;AACA,MAAMG,SAAS,GAAGH,OAAO,CAAE,YAAF,CAAzB;;kBACkBA,OAAO,CAAE,UAAF,C;MAAjBI,K,aAAAA,K;;AAER,MAAMC,qBAAqB,GAAGH,IAAI,IAAI;AACpC,QAAMI,IAAI,GAAGJ,IAAI,KAAM,GAAV,GAAgB,OAAhB,GAAyBC,SAAS,CAACD,IAAD,CAA/C;AACA,SAAQ,UAASI,IAAK,EAAtB;AACD,CAHD;;AAKA,MAAMC,0BAA0B,GAAGC,aAAa,IAAI;AAClD,QAAMC,OAAO,GAAGL,KAAK,CAACM,QAAN,GAAiBD,OAAjC;AACA,MAAIE,SAAS,GAAI,GAAjB;;AACA,MAAIF,OAAO,IAAIA,OAAO,CAACE,SAAvB,EAAkC;AAChCA,IAAAA,SAAS,GAAGF,OAAO,CAACE,SAApB;AACD;;AACD,QAAML,IAAI,GAAGJ,IAAI,CAACU,QAAL,CAAcD,SAAd,EAAyBH,aAAzB,CAAb;AACA,SAAQ,eAAcP,SAAS,CAACK,IAAD,CAAO,EAAtC;AACD,CARD;;AAUAO,OAAO,CAACR,qBAAR,GAAgCA,qBAAhC;AACAQ,OAAO,CAACN,0BAAR,GAAqCA,0BAArC","sourcesContent":["const { kebabCase } = require(`lodash`)\nconst path = require(`path`)\nconst kebabHash = require(`kebab-hash`)\nconst { store } = require(`../redux`)\n\nconst generatePathChunkName = path => {\n  const name = path === `/` ? `index` : kebabHash(path)\n  return `path---${name}`\n}\n\nconst generateComponentChunkName = componentPath => {\n  const program = store.getState().program\n  let directory = `/`\n  if (program && program.directory) {\n    directory = program.directory\n  }\n  const name = path.relative(directory, componentPath)\n  return `component---${kebabCase(name)}`\n}\n\nexports.generatePathChunkName = generatePathChunkName\nexports.generateComponentChunkName = generateComponentChunkName\n"],"file":"js-chunk-names.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/utils/js-chunk-names.js"],"names":["kebabCase","require","path","kebabHash","store","generatePathChunkName","name","generateComponentChunkName","componentPath","program","getState","directory","relative","exports"],"mappings":";;AAAA,MAAM;AAAEA,EAAAA;AAAF,IAAgBC,OAAO,CAAE,QAAF,CAA7B;;AACA,MAAMC,IAAI,GAAGD,OAAO,CAAE,MAAF,CAApB;;AACA,MAAME,SAAS,GAAGF,OAAO,CAAE,YAAF,CAAzB;;AACA,MAAM;AAAEG,EAAAA;AAAF,IAAYH,OAAO,CAAE,UAAF,CAAzB;;AAEA,MAAMI,qBAAqB,GAAGH,IAAI,IAAI;AACpC,QAAMI,IAAI,GAAGJ,IAAI,KAAM,GAAV,GAAgB,OAAhB,GAAyBC,SAAS,CAACD,IAAD,CAA/C;AACA,SAAQ,UAASI,IAAK,EAAtB;AACD,CAHD;;AAKA,MAAMC,0BAA0B,GAAGC,aAAa,IAAI;AAClD,QAAMC,OAAO,GAAGL,KAAK,CAACM,QAAN,GAAiBD,OAAjC;AACA,MAAIE,SAAS,GAAI,GAAjB;;AACA,MAAIF,OAAO,IAAIA,OAAO,CAACE,SAAvB,EAAkC;AAChCA,IAAAA,SAAS,GAAGF,OAAO,CAACE,SAApB;AACD;;AACD,QAAML,IAAI,GAAGJ,IAAI,CAACU,QAAL,CAAcD,SAAd,EAAyBH,aAAzB,CAAb;AACA,SAAQ,eAAcR,SAAS,CAACM,IAAD,CAAO,EAAtC;AACD,CARD;;AAUAO,OAAO,CAACR,qBAAR,GAAgCA,qBAAhC;AACAQ,OAAO,CAACN,0BAAR,GAAqCA,0BAArC","sourcesContent":["const { kebabCase } = require(`lodash`)\nconst path = require(`path`)\nconst kebabHash = require(`kebab-hash`)\nconst { store } = require(`../redux`)\n\nconst generatePathChunkName = path => {\n  const name = path === `/` ? `index` : kebabHash(path)\n  return `path---${name}`\n}\n\nconst generateComponentChunkName = componentPath => {\n  const program = store.getState().program\n  let directory = `/`\n  if (program && program.directory) {\n    directory = program.directory\n  }\n  const name = path.relative(directory, componentPath)\n  return `component---${kebabCase(name)}`\n}\n\nexports.generatePathChunkName = generatePathChunkName\nexports.generateComponentChunkName = generateComponentChunkName\n"],"file":"js-chunk-names.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/utils/merge-gatsby-config.js b/node_modules/gatsby/dist/utils/merge-gatsby-config.js
index 8df7b26..16329f8 100644
--- a/node_modules/gatsby/dist/utils/merge-gatsby-config.js
+++ b/node_modules/gatsby/dist/utils/merge-gatsby-config.js
@@ -15,9 +15,9 @@ module.exports = (a, b) => {
     // choose a merge function for the config key if there's one defined,
     // otherwise use the default value merge function
     const mergeFn = howToMerge[gatsbyConfigKey] || howToMerge.byDefault;
-    return Object.assign({}, config, {
+    return { ...config,
       [gatsbyConfigKey]: mergeFn(a[gatsbyConfigKey], b[gatsbyConfigKey])
-    });
+    };
   }, {}); // return the fully merged config
 
   return mergedConfig;
diff --git a/node_modules/gatsby/dist/utils/merge-gatsby-config.js.map b/node_modules/gatsby/dist/utils/merge-gatsby-config.js.map
index 768eb24..8ae1e58 100644
--- a/node_modules/gatsby/dist/utils/merge-gatsby-config.js.map
+++ b/node_modules/gatsby/dist/utils/merge-gatsby-config.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/utils/merge-gatsby-config.js"],"names":["_","require","module","exports","a","b","allGatsbyConfigKeysWithAValue","uniq","Object","keys","concat","mergedConfig","reduce","config","gatsbyConfigKey","mergeFn","howToMerge","byDefault","siteMetadata","objA","objB","merge","plugins","uniqWith","isEqual","mapping"],"mappings":";;AAAA,MAAMA,CAAC,GAAGC,OAAO,CAAE,QAAF,CAAjB;AACA;;;;;AAGAC,MAAM,CAACC,OAAP,GAAiB,CAACC,CAAD,EAAIC,CAAJ,KAAU;AACzB;AACA,QAAMC,6BAA6B,GAAGN,CAAC,CAACO,IAAF,CACpCC,MAAM,CAACC,IAAP,CAAYL,CAAZ,EAAeM,MAAf,CAAsBF,MAAM,CAACC,IAAP,CAAYJ,CAAZ,CAAtB,CADoC,CAAtC,CAFyB,CAMzB;;;AACA,QAAMM,YAAY,GAAGL,6BAA6B,CAACM,MAA9B,CACnB,CAACC,MAAD,EAASC,eAAT,KAA6B;AAC3B;AACA;AACA,UAAMC,OAAO,GAAGC,UAAU,CAACF,eAAD,CAAV,IAA+BE,UAAU,CAACC,SAA1D;AACA,6BACKJ,MADL;AAEE,OAACC,eAAD,GAAmBC,OAAO,CAACX,CAAC,CAACU,eAAD,CAAF,EAAqBT,CAAC,CAACS,eAAD,CAAtB;AAF5B;AAID,GATkB,EAUnB,EAVmB,CAArB,CAPyB,CAoBzB;;AACA,SAAOH,YAAP;AACD,CAtBD;;AAuBA,MAAMK,UAAU,GAAG;AACjB;;;;;AAKAC,EAAAA,SAAS,EAAE,CAACb,CAAD,EAAIC,CAAJ,KAAUA,CAAC,IAAID,CANT;AAOjBc,EAAAA,YAAY,EAAE,CAACC,IAAD,EAAOC,IAAP,KAAgBpB,CAAC,CAACqB,KAAF,CAAQ,EAAR,EAAYF,IAAZ,EAAkBC,IAAlB,CAPb;AAQjB;AACAE,EAAAA,OAAO,EAAE,CAAClB,CAAC,GAAG,EAAL,EAASC,CAAC,GAAG,EAAb,KAAoBL,CAAC,CAACuB,QAAF,CAAWnB,CAAC,CAACM,MAAF,CAASL,CAAT,CAAX,EAAwBL,CAAC,CAACwB,OAA1B,CATZ;AAUjBC,EAAAA,OAAO,EAAE,CAACN,IAAD,EAAOC,IAAP,KAAgBpB,CAAC,CAACqB,KAAF,CAAQ,EAAR,EAAYF,IAAZ,EAAkBC,IAAlB;AAVR,CAAnB","sourcesContent":["const _ = require(`lodash`)\n/**\n * Defines how a theme object is merged with the user's config\n */\nmodule.exports = (a, b) => {\n  // a and b are gatsby configs, If they have keys, that means there are values to merge\n  const allGatsbyConfigKeysWithAValue = _.uniq(\n    Object.keys(a).concat(Object.keys(b))\n  )\n\n  // reduce the array of mergable keys into a single gatsby config object\n  const mergedConfig = allGatsbyConfigKeysWithAValue.reduce(\n    (config, gatsbyConfigKey) => {\n      // choose a merge function for the config key if there's one defined,\n      // otherwise use the default value merge function\n      const mergeFn = howToMerge[gatsbyConfigKey] || howToMerge.byDefault\n      return {\n        ...config,\n        [gatsbyConfigKey]: mergeFn(a[gatsbyConfigKey], b[gatsbyConfigKey]),\n      }\n    },\n    {}\n  )\n\n  // return the fully merged config\n  return mergedConfig\n}\nconst howToMerge = {\n  /**\n   * pick a truthy value by default.\n   * This makes sure that if a single value is defined, that one it used.\n   * We prefer the \"right\" value, because the user's config will be \"on the right\"\n   */\n  byDefault: (a, b) => b || a,\n  siteMetadata: (objA, objB) => _.merge({}, objA, objB),\n  // plugins are concatenated and uniq'd, so we don't get two of the same plugin value\n  plugins: (a = [], b = []) => _.uniqWith(a.concat(b), _.isEqual),\n  mapping: (objA, objB) => _.merge({}, objA, objB),\n}\n"],"file":"merge-gatsby-config.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/utils/merge-gatsby-config.js"],"names":["_","require","module","exports","a","b","allGatsbyConfigKeysWithAValue","uniq","Object","keys","concat","mergedConfig","reduce","config","gatsbyConfigKey","mergeFn","howToMerge","byDefault","siteMetadata","objA","objB","merge","plugins","uniqWith","isEqual","mapping"],"mappings":";;AAAA,MAAMA,CAAC,GAAGC,OAAO,CAAE,QAAF,CAAjB;AACA;;;;;AAGAC,MAAM,CAACC,OAAP,GAAiB,CAACC,CAAD,EAAIC,CAAJ,KAAU;AACzB;AACA,QAAMC,6BAA6B,GAAGN,CAAC,CAACO,IAAF,CACpCC,MAAM,CAACC,IAAP,CAAYL,CAAZ,EAAeM,MAAf,CAAsBF,MAAM,CAACC,IAAP,CAAYJ,CAAZ,CAAtB,CADoC,CAAtC,CAFyB,CAMzB;;;AACA,QAAMM,YAAY,GAAGL,6BAA6B,CAACM,MAA9B,CACnB,CAACC,MAAD,EAASC,eAAT,KAA6B;AAC3B;AACA;AACA,UAAMC,OAAO,GAAGC,UAAU,CAACF,eAAD,CAAV,IAA+BE,UAAU,CAACC,SAA1D;AACA,WAAO,EACL,GAAGJ,MADE;AAEL,OAACC,eAAD,GAAmBC,OAAO,CAACX,CAAC,CAACU,eAAD,CAAF,EAAqBT,CAAC,CAACS,eAAD,CAAtB;AAFrB,KAAP;AAID,GATkB,EAUnB,EAVmB,CAArB,CAPyB,CAoBzB;;AACA,SAAOH,YAAP;AACD,CAtBD;;AAuBA,MAAMK,UAAU,GAAG;AACjB;;;;;AAKAC,EAAAA,SAAS,EAAE,CAACb,CAAD,EAAIC,CAAJ,KAAUA,CAAC,IAAID,CANT;AAOjBc,EAAAA,YAAY,EAAE,CAACC,IAAD,EAAOC,IAAP,KAAgBpB,CAAC,CAACqB,KAAF,CAAQ,EAAR,EAAYF,IAAZ,EAAkBC,IAAlB,CAPb;AAQjB;AACAE,EAAAA,OAAO,EAAE,CAAClB,CAAC,GAAG,EAAL,EAASC,CAAC,GAAG,EAAb,KAAoBL,CAAC,CAACuB,QAAF,CAAWnB,CAAC,CAACM,MAAF,CAASL,CAAT,CAAX,EAAwBL,CAAC,CAACwB,OAA1B,CATZ;AAUjBC,EAAAA,OAAO,EAAE,CAACN,IAAD,EAAOC,IAAP,KAAgBpB,CAAC,CAACqB,KAAF,CAAQ,EAAR,EAAYF,IAAZ,EAAkBC,IAAlB;AAVR,CAAnB","sourcesContent":["const _ = require(`lodash`)\n/**\n * Defines how a theme object is merged with the user's config\n */\nmodule.exports = (a, b) => {\n  // a and b are gatsby configs, If they have keys, that means there are values to merge\n  const allGatsbyConfigKeysWithAValue = _.uniq(\n    Object.keys(a).concat(Object.keys(b))\n  )\n\n  // reduce the array of mergable keys into a single gatsby config object\n  const mergedConfig = allGatsbyConfigKeysWithAValue.reduce(\n    (config, gatsbyConfigKey) => {\n      // choose a merge function for the config key if there's one defined,\n      // otherwise use the default value merge function\n      const mergeFn = howToMerge[gatsbyConfigKey] || howToMerge.byDefault\n      return {\n        ...config,\n        [gatsbyConfigKey]: mergeFn(a[gatsbyConfigKey], b[gatsbyConfigKey]),\n      }\n    },\n    {}\n  )\n\n  // return the fully merged config\n  return mergedConfig\n}\nconst howToMerge = {\n  /**\n   * pick a truthy value by default.\n   * This makes sure that if a single value is defined, that one it used.\n   * We prefer the \"right\" value, because the user's config will be \"on the right\"\n   */\n  byDefault: (a, b) => b || a,\n  siteMetadata: (objA, objB) => _.merge({}, objA, objB),\n  // plugins are concatenated and uniq'd, so we don't get two of the same plugin value\n  plugins: (a = [], b = []) => _.uniqWith(a.concat(b), _.isEqual),\n  mapping: (objA, objB) => _.merge({}, objA, objB),\n}\n"],"file":"merge-gatsby-config.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/utils/source-nodes.js b/node_modules/gatsby/dist/utils/source-nodes.js
index 5f1e474..2323629 100644
--- a/node_modules/gatsby/dist/utils/source-nodes.js
+++ b/node_modules/gatsby/dist/utils/source-nodes.js
@@ -1,26 +1,27 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const _ = require(`lodash`);
 
 const report = require(`gatsby-cli/lib/reporter`);
 
 const apiRunner = require(`./api-runner-node`);
 
-const _require = require(`../redux`),
-      store = _require.store;
+const {
+  store
+} = require(`../redux`);
 
-const _require2 = require(`../db/nodes`),
-      getNode = _require2.getNode,
-      getNodes = _require2.getNodes;
+const {
+  getNode,
+  getNodes
+} = require(`../db/nodes`);
 
-const _require3 = require(`../redux/actions`),
-      boundActionCreators = _require3.boundActionCreators;
+const {
+  boundActionCreators
+} = require(`../redux/actions`);
 
-const deleteNode = boundActionCreators.deleteNode;
+const {
+  deleteNode
+} = boundActionCreators;
 /**
  * Finds the name of all plugins which implement Gatsby APIs that
  * may create nodes, but which have not actually created any nodes.
@@ -28,8 +29,7 @@ const deleteNode = boundActionCreators.deleteNode;
 
 function discoverPluginsWithoutNodes(storeState) {
   // Discover which plugins implement APIs which may create nodes
-  const nodeCreationPlugins = _.without(_.union(storeState.apiToPlugins.sourceNodes), `default-site-plugin`); // Find out which plugins own already created nodes
-
+  const nodeCreationPlugins = storeState.flattenedPlugins.filter(plugin => plugin.nodeAPIs.includes(`sourceNodes`) && plugin.name !== `default-site-plugin`).map(plugin => plugin.name); // Find out which plugins own already created nodes
 
   const nodeOwners = _.uniq(Array.from(getNodes()).reduce((acc, node) => {
     acc.push(node.internal.owner);
@@ -39,49 +39,41 @@ function discoverPluginsWithoutNodes(storeState) {
   return _.difference(nodeCreationPlugins, nodeOwners);
 }
 
-module.exports =
-/*#__PURE__*/
-function () {
-  var _ref = (0, _asyncToGenerator2.default)(function* ({
-    parentSpan
-  } = {}) {
-    yield apiRunner(`sourceNodes`, {
-      traceId: `initial-sourceNodes`,
-      waitForCascadingActions: true,
-      parentSpan: parentSpan
-    });
-    const state = store.getState(); // Warn about plugins that should have created nodes but didn't.
-
-    const pluginsWithNoNodes = discoverPluginsWithoutNodes(state);
-    pluginsWithNoNodes.map(name => report.warn(`The ${name} plugin has generated no Gatsby nodes. Do you need it?`)); // Garbage collect stale data nodes
-
-    const touchedNodes = Object.keys(state.nodesTouched);
-    const staleNodes = Array.from(getNodes()).filter(node => {
-      // Find the root node.
-      let rootNode = node;
-      let whileCount = 0;
-
-      while (rootNode.parent && getNode(rootNode.parent) !== undefined && whileCount < 101) {
-        rootNode = getNode(rootNode.parent);
-        whileCount += 1;
-
-        if (whileCount > 100) {
-          console.log(`It looks like you have a node that's set its parent as itself`, rootNode);
-        }
-      }
+module.exports = async ({
+  parentSpan
+} = {}) => {
+  await apiRunner(`sourceNodes`, {
+    traceId: `initial-sourceNodes`,
+    waitForCascadingActions: true,
+    parentSpan: parentSpan
+  });
+  const state = store.getState(); // Warn about plugins that should have created nodes but didn't.
 
-      return !_.includes(touchedNodes, rootNode.id);
-    });
+  const pluginsWithNoNodes = discoverPluginsWithoutNodes(state);
+  pluginsWithNoNodes.map(name => report.warn(`The ${name} plugin has generated no Gatsby nodes. Do you need it?`)); // Garbage collect stale data nodes
 
-    if (staleNodes.length > 0) {
-      staleNodes.forEach(node => deleteNode({
-        node
-      }));
+  const touchedNodes = Object.keys(state.nodesTouched);
+  const staleNodes = Array.from(getNodes()).filter(node => {
+    // Find the root node.
+    let rootNode = node;
+    let whileCount = 0;
+
+    while (rootNode.parent && getNode(rootNode.parent) !== undefined && whileCount < 101) {
+      rootNode = getNode(rootNode.parent);
+      whileCount += 1;
+
+      if (whileCount > 100) {
+        console.log(`It looks like you have a node that's set its parent as itself`, rootNode);
+      }
     }
+
+    return !_.includes(touchedNodes, rootNode.id);
   });
 
-  return function () {
-    return _ref.apply(this, arguments);
-  };
-}();
+  if (staleNodes.length > 0) {
+    staleNodes.forEach(node => deleteNode({
+      node
+    }));
+  }
+};
 //# sourceMappingURL=source-nodes.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/utils/source-nodes.js.map b/node_modules/gatsby/dist/utils/source-nodes.js.map
index e4d204b..fcca510 100644
--- a/node_modules/gatsby/dist/utils/source-nodes.js.map
+++ b/node_modules/gatsby/dist/utils/source-nodes.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/utils/source-nodes.js"],"names":["_","require","report","apiRunner","store","getNode","getNodes","boundActionCreators","deleteNode","discoverPluginsWithoutNodes","storeState","nodeCreationPlugins","without","union","apiToPlugins","sourceNodes","nodeOwners","uniq","Array","from","reduce","acc","node","push","internal","owner","difference","module","exports","parentSpan","traceId","waitForCascadingActions","state","getState","pluginsWithNoNodes","map","name","warn","touchedNodes","Object","keys","nodesTouched","staleNodes","filter","rootNode","whileCount","parent","undefined","console","log","includes","id","length","forEach"],"mappings":"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","sourcesContent":["const _ = require(`lodash`)\nconst report = require(`gatsby-cli/lib/reporter`)\n\nconst apiRunner = require(`./api-runner-node`)\nconst { store } = require(`../redux`)\nconst { getNode, getNodes } = require(`../db/nodes`)\nconst { boundActionCreators } = require(`../redux/actions`)\nconst { deleteNode } = boundActionCreators\n\n/**\n * Finds the name of all plugins which implement Gatsby APIs that\n * may create nodes, but which have not actually created any nodes.\n */\nfunction discoverPluginsWithoutNodes(storeState) {\n  // Discover which plugins implement APIs which may create nodes\n  const nodeCreationPlugins = _.without(\n    _.union(storeState.apiToPlugins.sourceNodes),\n    `default-site-plugin`\n  )\n  // Find out which plugins own already created nodes\n  const nodeOwners = _.uniq(\n    Array.from(getNodes()).reduce((acc, node) => {\n      acc.push(node.internal.owner)\n      return acc\n    }, [])\n  )\n  return _.difference(nodeCreationPlugins, nodeOwners)\n}\n\nmodule.exports = async ({ parentSpan } = {}) => {\n  await apiRunner(`sourceNodes`, {\n    traceId: `initial-sourceNodes`,\n    waitForCascadingActions: true,\n    parentSpan: parentSpan,\n  })\n\n  const state = store.getState()\n\n  // Warn about plugins that should have created nodes but didn't.\n  const pluginsWithNoNodes = discoverPluginsWithoutNodes(state)\n  pluginsWithNoNodes.map(name =>\n    report.warn(\n      `The ${name} plugin has generated no Gatsby nodes. Do you need it?`\n    )\n  )\n\n  // Garbage collect stale data nodes\n  const touchedNodes = Object.keys(state.nodesTouched)\n  const staleNodes = Array.from(getNodes()).filter(node => {\n    // Find the root node.\n    let rootNode = node\n    let whileCount = 0\n    while (\n      rootNode.parent &&\n      getNode(rootNode.parent) !== undefined &&\n      whileCount < 101\n    ) {\n      rootNode = getNode(rootNode.parent)\n      whileCount += 1\n      if (whileCount > 100) {\n        console.log(\n          `It looks like you have a node that's set its parent as itself`,\n          rootNode\n        )\n      }\n    }\n\n    return !_.includes(touchedNodes, rootNode.id)\n  })\n\n  if (staleNodes.length > 0) {\n    staleNodes.forEach(node => deleteNode({ node }))\n  }\n}\n"],"file":"source-nodes.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/utils/source-nodes.js"],"names":["_","require","report","apiRunner","store","getNode","getNodes","boundActionCreators","deleteNode","discoverPluginsWithoutNodes","storeState","nodeCreationPlugins","flattenedPlugins","filter","plugin","nodeAPIs","includes","name","map","nodeOwners","uniq","Array","from","reduce","acc","node","push","internal","owner","difference","module","exports","parentSpan","traceId","waitForCascadingActions","state","getState","pluginsWithNoNodes","warn","touchedNodes","Object","keys","nodesTouched","staleNodes","rootNode","whileCount","parent","undefined","console","log","id","length","forEach"],"mappings":"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","sourcesContent":["const _ = require(`lodash`)\nconst report = require(`gatsby-cli/lib/reporter`)\n\nconst apiRunner = require(`./api-runner-node`)\nconst { store } = require(`../redux`)\nconst { getNode, getNodes } = require(`../db/nodes`)\nconst { boundActionCreators } = require(`../redux/actions`)\nconst { deleteNode } = boundActionCreators\n\n/**\n * Finds the name of all plugins which implement Gatsby APIs that\n * may create nodes, but which have not actually created any nodes.\n */\nfunction discoverPluginsWithoutNodes(storeState) {\n  // Discover which plugins implement APIs which may create nodes\n  const nodeCreationPlugins = storeState.flattenedPlugins\n    .filter(\n      plugin =>\n        plugin.nodeAPIs.includes(`sourceNodes`) &&\n        plugin.name !== `default-site-plugin`\n    )\n    .map(plugin => plugin.name)\n\n  // Find out which plugins own already created nodes\n  const nodeOwners = _.uniq(\n    Array.from(getNodes()).reduce((acc, node) => {\n      acc.push(node.internal.owner)\n      return acc\n    }, [])\n  )\n  return _.difference(nodeCreationPlugins, nodeOwners)\n}\n\nmodule.exports = async ({ parentSpan } = {}) => {\n  await apiRunner(`sourceNodes`, {\n    traceId: `initial-sourceNodes`,\n    waitForCascadingActions: true,\n    parentSpan: parentSpan,\n  })\n\n  const state = store.getState()\n\n  // Warn about plugins that should have created nodes but didn't.\n  const pluginsWithNoNodes = discoverPluginsWithoutNodes(state)\n  pluginsWithNoNodes.map(name =>\n    report.warn(\n      `The ${name} plugin has generated no Gatsby nodes. Do you need it?`\n    )\n  )\n\n  // Garbage collect stale data nodes\n  const touchedNodes = Object.keys(state.nodesTouched)\n  const staleNodes = Array.from(getNodes()).filter(node => {\n    // Find the root node.\n    let rootNode = node\n    let whileCount = 0\n    while (\n      rootNode.parent &&\n      getNode(rootNode.parent) !== undefined &&\n      whileCount < 101\n    ) {\n      rootNode = getNode(rootNode.parent)\n      whileCount += 1\n      if (whileCount > 100) {\n        console.log(\n          `It looks like you have a node that's set its parent as itself`,\n          rootNode\n        )\n      }\n    }\n\n    return !_.includes(touchedNodes, rootNode.id)\n  })\n\n  if (staleNodes.length > 0) {\n    staleNodes.forEach(node => deleteNode({ node }))\n  }\n}\n"],"file":"source-nodes.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/utils/stack-trace-utils.js b/node_modules/gatsby/dist/utils/stack-trace-utils.js
index cb5a564..b7442bf 100644
--- a/node_modules/gatsby/dist/utils/stack-trace-utils.js
+++ b/node_modules/gatsby/dist/utils/stack-trace-utils.js
@@ -2,8 +2,9 @@
 
 const stackTrace = require(`stack-trace`);
 
-const _require = require(`@babel/code-frame`),
-      codeFrameColumns = _require.codeFrameColumns;
+const {
+  codeFrameColumns
+} = require(`@babel/code-frame`);
 
 const fs = require(`fs-extra`);
 
diff --git a/node_modules/gatsby/dist/utils/stack-trace-utils.js.map b/node_modules/gatsby/dist/utils/stack-trace-utils.js.map
index 0afe97b..58f8a9e 100644
--- a/node_modules/gatsby/dist/utils/stack-trace-utils.js.map
+++ b/node_modules/gatsby/dist/utils/stack-trace-utils.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/utils/stack-trace-utils.js"],"names":["stackTrace","require","codeFrameColumns","fs","path","chalk","gatsbyLocation","dirname","resolve","getNonGatsbyCallSite","get","find","callSite","getFileName","includes","getNonGatsbyCodeFrame","highlightCode","fileName","line","getLineNumber","column","getColumnNumber","code","readFileSync","encoding","bold","start","join","module","exports"],"mappings":";;AAAA,MAAMA,UAAU,GAAGC,OAAO,CAAE,aAAF,CAA1B;;iBAC6BA,OAAO,CAAE,mBAAF,C;MAA5BC,gB,YAAAA,gB;;AACR,MAAMC,EAAE,GAAGF,OAAO,CAAE,UAAF,CAAlB;;AACA,MAAMG,IAAI,GAAGH,OAAO,CAAE,MAAF,CAApB;;AACA,MAAMI,KAAK,GAAGJ,OAAO,CAAE,OAAF,CAArB;;AAEA,MAAMK,cAAc,GAAGF,IAAI,CAACG,OAAL,CAAaN,OAAO,CAACO,OAAR,CAAiB,qBAAjB,CAAb,CAAvB;;AAEA,MAAMC,oBAAoB,GAAG,MAC3BT,UAAU,CACPU,GADH,GAEGC,IAFH,CAEQC,QAAQ,IAAI,CAACA,QAAQ,CAACC,WAAT,GAAuBC,QAAvB,CAAgCR,cAAhC,CAFrB,CADF;;AAKA,MAAMS,qBAAqB,GAAG,CAAC;AAAEC,EAAAA,aAAa,GAAG;AAAlB,IAA2B,EAA5B,KAAmC;AAC/D,QAAMJ,QAAQ,GAAGH,oBAAoB,EAArC;;AACA,MAAI,CAACG,QAAL,EAAe;AACb,WAAO,IAAP;AACD;;AAED,QAAMK,QAAQ,GAAGL,QAAQ,CAACC,WAAT,EAAjB;AACA,QAAMK,IAAI,GAAGN,QAAQ,CAACO,aAAT,EAAb;AACA,QAAMC,MAAM,GAAGR,QAAQ,CAACS,eAAT,EAAf;AAEA,QAAMC,IAAI,GAAGnB,EAAE,CAACoB,YAAH,CAAgBN,QAAhB,EAA0B;AAAEO,IAAAA,QAAQ,EAAG;AAAb,GAA1B,CAAb;AACA,SAAO,CACJ,QAAOnB,KAAK,CAACoB,IAAN,CAAY,GAAER,QAAS,IAAGC,IAAK,IAAGE,MAAO,EAAzC,CAA4C,EAD/C,EAELlB,gBAAgB,CACdoB,IADc,EAEd;AACEI,IAAAA,KAAK,EAAE;AACLR,MAAAA,IADK;AAELE,MAAAA;AAFK;AADT,GAFc,EAQd;AACEJ,IAAAA;AADF,GARc,CAFX,EAcLW,IAdK,CAcC,IAdD,CAAP;AAeD,CA1BD;;AA4BAC,MAAM,CAACC,OAAP,GAAiB;AACfd,EAAAA;AADe,CAAjB","sourcesContent":["const stackTrace = require(`stack-trace`)\nconst { codeFrameColumns } = require(`@babel/code-frame`)\nconst fs = require(`fs-extra`)\nconst path = require(`path`)\nconst chalk = require(`chalk`)\n\nconst gatsbyLocation = path.dirname(require.resolve(`gatsby/package.json`))\n\nconst getNonGatsbyCallSite = () =>\n  stackTrace\n    .get()\n    .find(callSite => !callSite.getFileName().includes(gatsbyLocation))\n\nconst getNonGatsbyCodeFrame = ({ highlightCode = true } = {}) => {\n  const callSite = getNonGatsbyCallSite()\n  if (!callSite) {\n    return null\n  }\n\n  const fileName = callSite.getFileName()\n  const line = callSite.getLineNumber()\n  const column = callSite.getColumnNumber()\n\n  const code = fs.readFileSync(fileName, { encoding: `utf-8` })\n  return [\n    `File ${chalk.bold(`${fileName}:${line}:${column}`)}`,\n    codeFrameColumns(\n      code,\n      {\n        start: {\n          line,\n          column,\n        },\n      },\n      {\n        highlightCode,\n      }\n    ),\n  ].join(`\\n`)\n}\n\nmodule.exports = {\n  getNonGatsbyCodeFrame,\n}\n"],"file":"stack-trace-utils.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/utils/stack-trace-utils.js"],"names":["stackTrace","require","codeFrameColumns","fs","path","chalk","gatsbyLocation","dirname","resolve","getNonGatsbyCallSite","get","find","callSite","getFileName","includes","getNonGatsbyCodeFrame","highlightCode","fileName","line","getLineNumber","column","getColumnNumber","code","readFileSync","encoding","bold","start","join","module","exports"],"mappings":";;AAAA,MAAMA,UAAU,GAAGC,OAAO,CAAE,aAAF,CAA1B;;AACA,MAAM;AAAEC,EAAAA;AAAF,IAAuBD,OAAO,CAAE,mBAAF,CAApC;;AACA,MAAME,EAAE,GAAGF,OAAO,CAAE,UAAF,CAAlB;;AACA,MAAMG,IAAI,GAAGH,OAAO,CAAE,MAAF,CAApB;;AACA,MAAMI,KAAK,GAAGJ,OAAO,CAAE,OAAF,CAArB;;AAEA,MAAMK,cAAc,GAAGF,IAAI,CAACG,OAAL,CAAaN,OAAO,CAACO,OAAR,CAAiB,qBAAjB,CAAb,CAAvB;;AAEA,MAAMC,oBAAoB,GAAG,MAC3BT,UAAU,CACPU,GADH,GAEGC,IAFH,CAEQC,QAAQ,IAAI,CAACA,QAAQ,CAACC,WAAT,GAAuBC,QAAvB,CAAgCR,cAAhC,CAFrB,CADF;;AAKA,MAAMS,qBAAqB,GAAG,CAAC;AAAEC,EAAAA,aAAa,GAAG;AAAlB,IAA2B,EAA5B,KAAmC;AAC/D,QAAMJ,QAAQ,GAAGH,oBAAoB,EAArC;;AACA,MAAI,CAACG,QAAL,EAAe;AACb,WAAO,IAAP;AACD;;AAED,QAAMK,QAAQ,GAAGL,QAAQ,CAACC,WAAT,EAAjB;AACA,QAAMK,IAAI,GAAGN,QAAQ,CAACO,aAAT,EAAb;AACA,QAAMC,MAAM,GAAGR,QAAQ,CAACS,eAAT,EAAf;AAEA,QAAMC,IAAI,GAAGnB,EAAE,CAACoB,YAAH,CAAgBN,QAAhB,EAA0B;AAAEO,IAAAA,QAAQ,EAAG;AAAb,GAA1B,CAAb;AACA,SAAO,CACJ,QAAOnB,KAAK,CAACoB,IAAN,CAAY,GAAER,QAAS,IAAGC,IAAK,IAAGE,MAAO,EAAzC,CAA4C,EAD/C,EAELlB,gBAAgB,CACdoB,IADc,EAEd;AACEI,IAAAA,KAAK,EAAE;AACLR,MAAAA,IADK;AAELE,MAAAA;AAFK;AADT,GAFc,EAQd;AACEJ,IAAAA;AADF,GARc,CAFX,EAcLW,IAdK,CAcC,IAdD,CAAP;AAeD,CA1BD;;AA4BAC,MAAM,CAACC,OAAP,GAAiB;AACfd,EAAAA;AADe,CAAjB","sourcesContent":["const stackTrace = require(`stack-trace`)\nconst { codeFrameColumns } = require(`@babel/code-frame`)\nconst fs = require(`fs-extra`)\nconst path = require(`path`)\nconst chalk = require(`chalk`)\n\nconst gatsbyLocation = path.dirname(require.resolve(`gatsby/package.json`))\n\nconst getNonGatsbyCallSite = () =>\n  stackTrace\n    .get()\n    .find(callSite => !callSite.getFileName().includes(gatsbyLocation))\n\nconst getNonGatsbyCodeFrame = ({ highlightCode = true } = {}) => {\n  const callSite = getNonGatsbyCallSite()\n  if (!callSite) {\n    return null\n  }\n\n  const fileName = callSite.getFileName()\n  const line = callSite.getLineNumber()\n  const column = callSite.getColumnNumber()\n\n  const code = fs.readFileSync(fileName, { encoding: `utf-8` })\n  return [\n    `File ${chalk.bold(`${fileName}:${line}:${column}`)}`,\n    codeFrameColumns(\n      code,\n      {\n        start: {\n          line,\n          column,\n        },\n      },\n      {\n        highlightCode,\n      }\n    ),\n  ].join(`\\n`)\n}\n\nmodule.exports = {\n  getNonGatsbyCodeFrame,\n}\n"],"file":"stack-trace-utils.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/utils/tracer/index.js b/node_modules/gatsby/dist/utils/tracer/index.js
index 1c8e49f..12f2838 100644
--- a/node_modules/gatsby/dist/utils/tracer/index.js
+++ b/node_modules/gatsby/dist/utils/tracer/index.js
@@ -1,9 +1,5 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const slash = require(`slash`);
 
 const path = require(`path`);
@@ -36,17 +32,10 @@ function initTracer(tracerFile) {
   return tracer;
 }
 
-function stopTracer() {
-  return _stopTracer.apply(this, arguments);
-}
-
-function _stopTracer() {
-  _stopTracer = (0, _asyncToGenerator2.default)(function* () {
-    if (tracerProvider && tracerProvider.stop) {
-      yield tracerProvider.stop();
-    }
-  });
-  return _stopTracer.apply(this, arguments);
+async function stopTracer() {
+  if (tracerProvider && tracerProvider.stop) {
+    await tracerProvider.stop();
+  }
 }
 
 module.exports = {
diff --git a/node_modules/gatsby/dist/utils/tracer/index.js.map b/node_modules/gatsby/dist/utils/tracer/index.js.map
index 03832ec..b3db85f 100644
--- a/node_modules/gatsby/dist/utils/tracer/index.js.map
+++ b/node_modules/gatsby/dist/utils/tracer/index.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/utils/tracer/index.js"],"names":["slash","require","path","opentracing","tracerProvider","initTracer","tracerFile","tracer","resolvedPath","resolve","create","Tracer","initGlobalTracer","stopTracer","stop","module","exports"],"mappings":";;;;;;AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAE,OAAF,CAArB;;AACA,MAAMC,IAAI,GAAGD,OAAO,CAAE,MAAF,CAApB;;AACA,MAAME,WAAW,GAAGF,OAAO,CAAE,aAAF,CAA3B;;AAEA,IAAIG,cAAJ;AAEA;;;;;;;;;;AASA,SAASC,UAAT,CAAoBC,UAApB,EAAgC;AAC9B,MAAIC,MAAJ;;AACA,MAAID,UAAJ,EAAgB;AACd,UAAME,YAAY,GAAGR,KAAK,CAACE,IAAI,CAACO,OAAL,CAAaH,UAAb,CAAD,CAA1B;AACAF,IAAAA,cAAc,GAAGH,OAAO,CAACO,YAAD,CAAxB;AACAD,IAAAA,MAAM,GAAGH,cAAc,CAACM,MAAf,EAAT;AACD,GAJD,MAIO;AACLH,IAAAA,MAAM,GAAG,IAAIJ,WAAW,CAACQ,MAAhB,EAAT,CADK,CAC6B;AACnC;;AAEDR,EAAAA,WAAW,CAACS,gBAAZ,CAA6BL,MAA7B;AAEA,SAAOA,MAAP;AACD;;SAEcM,U;;;;;gDAAf,aAA4B;AAC1B,QAAIT,cAAc,IAAIA,cAAc,CAACU,IAArC,EAA2C;AACzC,YAAMV,cAAc,CAACU,IAAf,EAAN;AACD;AACF,G;;;;AAEDC,MAAM,CAACC,OAAP,GAAiB;AACfX,EAAAA,UADe;AAEfQ,EAAAA;AAFe,CAAjB","sourcesContent":["const slash = require(`slash`)\nconst path = require(`path`)\nconst opentracing = require(`opentracing`)\n\nlet tracerProvider\n\n/**\n * tracerFile should be a js file that exports two functions.\n *\n * `create` - Create and return an open-tracing compatible tracer. See\n * https://github.com/opentracing/opentracing-javascript/blob/master/src/tracer.ts\n *\n * `stop` - Run any tracer cleanup required before the node.js process\n * exits\n */\nfunction initTracer(tracerFile) {\n  let tracer\n  if (tracerFile) {\n    const resolvedPath = slash(path.resolve(tracerFile))\n    tracerProvider = require(resolvedPath)\n    tracer = tracerProvider.create()\n  } else {\n    tracer = new opentracing.Tracer() // Noop\n  }\n\n  opentracing.initGlobalTracer(tracer)\n\n  return tracer\n}\n\nasync function stopTracer() {\n  if (tracerProvider && tracerProvider.stop) {\n    await tracerProvider.stop()\n  }\n}\n\nmodule.exports = {\n  initTracer,\n  stopTracer,\n}\n"],"file":"index.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/utils/tracer/index.js"],"names":["slash","require","path","opentracing","tracerProvider","initTracer","tracerFile","tracer","resolvedPath","resolve","create","Tracer","initGlobalTracer","stopTracer","stop","module","exports"],"mappings":";;AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAE,OAAF,CAArB;;AACA,MAAMC,IAAI,GAAGD,OAAO,CAAE,MAAF,CAApB;;AACA,MAAME,WAAW,GAAGF,OAAO,CAAE,aAAF,CAA3B;;AAEA,IAAIG,cAAJ;AAEA;;;;;;;;;;AASA,SAASC,UAAT,CAAoBC,UAApB,EAAgC;AAC9B,MAAIC,MAAJ;;AACA,MAAID,UAAJ,EAAgB;AACd,UAAME,YAAY,GAAGR,KAAK,CAACE,IAAI,CAACO,OAAL,CAAaH,UAAb,CAAD,CAA1B;AACAF,IAAAA,cAAc,GAAGH,OAAO,CAACO,YAAD,CAAxB;AACAD,IAAAA,MAAM,GAAGH,cAAc,CAACM,MAAf,EAAT;AACD,GAJD,MAIO;AACLH,IAAAA,MAAM,GAAG,IAAIJ,WAAW,CAACQ,MAAhB,EAAT,CADK,CAC6B;AACnC;;AAEDR,EAAAA,WAAW,CAACS,gBAAZ,CAA6BL,MAA7B;AAEA,SAAOA,MAAP;AACD;;AAED,eAAeM,UAAf,GAA4B;AAC1B,MAAIT,cAAc,IAAIA,cAAc,CAACU,IAArC,EAA2C;AACzC,UAAMV,cAAc,CAACU,IAAf,EAAN;AACD;AACF;;AAEDC,MAAM,CAACC,OAAP,GAAiB;AACfX,EAAAA,UADe;AAEfQ,EAAAA;AAFe,CAAjB","sourcesContent":["const slash = require(`slash`)\nconst path = require(`path`)\nconst opentracing = require(`opentracing`)\n\nlet tracerProvider\n\n/**\n * tracerFile should be a js file that exports two functions.\n *\n * `create` - Create and return an open-tracing compatible tracer. See\n * https://github.com/opentracing/opentracing-javascript/blob/master/src/tracer.ts\n *\n * `stop` - Run any tracer cleanup required before the node.js process\n * exits\n */\nfunction initTracer(tracerFile) {\n  let tracer\n  if (tracerFile) {\n    const resolvedPath = slash(path.resolve(tracerFile))\n    tracerProvider = require(resolvedPath)\n    tracer = tracerProvider.create()\n  } else {\n    tracer = new opentracing.Tracer() // Noop\n  }\n\n  opentracing.initGlobalTracer(tracer)\n\n  return tracer\n}\n\nasync function stopTracer() {\n  if (tracerProvider && tracerProvider.stop) {\n    await tracerProvider.stop()\n  }\n}\n\nmodule.exports = {\n  initTracer,\n  stopTracer,\n}\n"],"file":"index.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/utils/tracer/zipkin-local.js b/node_modules/gatsby/dist/utils/tracer/zipkin-local.js
index 7f841e5..fd97665 100644
--- a/node_modules/gatsby/dist/utils/tracer/zipkin-local.js
+++ b/node_modules/gatsby/dist/utils/tracer/zipkin-local.js
@@ -1,13 +1,10 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const zipkin = require(`zipkin`);
 
-const _require = require(`zipkin-transport-http`),
-      HttpLogger = _require.HttpLogger;
+const {
+  HttpLogger
+} = require(`zipkin-transport-http`);
 
 const ZipkinTracer = require(`zipkin-javascript-opentracing`);
 
@@ -53,57 +50,43 @@ function create() {
  */
 
 
-function stop() {
-  return _stop.apply(this, arguments);
+async function stop() {
+  // First, write all partial spans to the http logger
+  recorder.partialSpans.forEach((span, id) => {
+    if (recorder._timedOut(span)) {
+      recorder._writeSpan(id);
+    }
+  }); // Then tell http logger to process all spans in its queue
+
+  return await _processQueue();
 } // Workaround for issue in Zipkin HTTP Logger where Spans are not
 // cleared off their processing queue before the node.js process
 // exits. Code is mostly the same as the zipkin processQueue
 // implementation.
 
 
-function _stop() {
-  _stop = (0, _asyncToGenerator2.default)(function* () {
-    // First, write all partial spans to the http logger
-    recorder.partialSpans.forEach((span, id) => {
-      if (recorder._timedOut(span)) {
-        recorder._writeSpan(id);
+async function _processQueue() {
+  const self = logger;
+
+  if (self.queue.length > 0) {
+    const postBody = `[${self.queue.join(`,`)}]`;
+    return await fetch(self.endpoint, {
+      method: `POST`,
+      body: postBody,
+      headers: self.headers,
+      timeout: self.timeout
+    }).then(response => {
+      if (response.status !== 202) {
+        const err = `Unexpected response while sending Zipkin data, status:` + `${response.status}, body: ${postBody}`;
+        if (self.errorListenerSet) self.emit(`error`, new Error(err));else console.error(err);
       }
-    }); // Then tell http logger to process all spans in its queue
-
-    return yield _processQueue();
-  });
-  return _stop.apply(this, arguments);
-}
+    }).catch(error => {
+      const err = `Error sending Zipkin data ${error}`;
+      if (self.errorListenerSet) this.emit(`error`, new Error(err));else console.error(err);
+    });
+  }
 
-function _processQueue() {
-  return _processQueue2.apply(this, arguments);
-}
-
-function _processQueue2() {
-  _processQueue2 = (0, _asyncToGenerator2.default)(function* () {
-    const self = logger;
-
-    if (self.queue.length > 0) {
-      const postBody = `[${self.queue.join(`,`)}]`;
-      return yield fetch(self.endpoint, {
-        method: `POST`,
-        body: postBody,
-        headers: self.headers,
-        timeout: self.timeout
-      }).then(response => {
-        if (response.status !== 202) {
-          const err = `Unexpected response while sending Zipkin data, status:` + `${response.status}, body: ${postBody}`;
-          if (self.errorListenerSet) self.emit(`error`, new Error(err));else console.error(err);
-        }
-      }).catch(error => {
-        const err = `Error sending Zipkin data ${error}`;
-        if (self.errorListenerSet) this.emit(`error`, new Error(err));else console.error(err);
-      });
-    }
-
-    return true;
-  });
-  return _processQueue2.apply(this, arguments);
+  return true;
 }
 
 module.exports = {
diff --git a/node_modules/gatsby/dist/utils/tracer/zipkin-local.js.map b/node_modules/gatsby/dist/utils/tracer/zipkin-local.js.map
index 7d8874a..8781d37 100644
--- a/node_modules/gatsby/dist/utils/tracer/zipkin-local.js.map
+++ b/node_modules/gatsby/dist/utils/tracer/zipkin-local.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../../src/utils/tracer/zipkin-local.js"],"names":["zipkin","require","HttpLogger","ZipkinTracer","fetch","logger","recorder","create","endpoint","BatchRecorder","timeout","tracer","localServiceName","serviceName","sampler","CountingSampler","traceId128Bit","kind","stop","partialSpans","forEach","span","id","_timedOut","_writeSpan","_processQueue","self","queue","length","postBody","join","method","body","headers","then","response","status","err","errorListenerSet","emit","Error","console","error","catch","module","exports"],"mappings":";;;;;;AAAA,MAAMA,MAAM,GAAGC,OAAO,CAAE,QAAF,CAAtB;;iBACuBA,OAAO,CAAE,uBAAF,C;MAAtBC,U,YAAAA,U;;AACR,MAAMC,YAAY,GAAGF,OAAO,CAAE,+BAAF,CAA5B;;AACA,MAAMG,KAAK,GAAGH,OAAO,CAAE,YAAF,CAArB;;AAEA,IAAII,MAAJ;AACA,IAAIC,QAAJ;AAEA;;;;;AAIA,SAASC,MAAT,GAAkB;AAChBF,EAAAA,MAAM,GAAG,IAAIH,UAAJ,CAAe;AACtB;AACAM,IAAAA,QAAQ,EAAG;AAFW,GAAf,CAAT;AAKAF,EAAAA,QAAQ,GAAG,IAAIN,MAAM,CAACS,aAAX,CAAyB;AAClCJ,IAAAA,MADkC;AAElC;AACAK,IAAAA,OAAO,EAAE,KAAK,EAAL,GAAU,EAAV,GAAe;AAHU,GAAzB,CAAX;AAMA,QAAMC,MAAM,GAAG,IAAIR,YAAJ,CAAiB;AAC9BS,IAAAA,gBAAgB,EAAG,QADW;AAE9BC,IAAAA,WAAW,EAAG,QAFgB;AAG9B;AACA;AACA;AACA;AACA;AACA;AACAC,IAAAA,OAAO,EAAE,IAAId,MAAM,CAACc,OAAP,CAAeC,eAAnB,CAAmC,CAAnC,CATqB;AAU9BC,IAAAA,aAAa,EAAE,IAVe;AAW9BV,IAAAA,QAX8B;AAY9BW,IAAAA,IAAI,EAAG;AAZuB,GAAjB,CAAf;AAeA,SAAON,MAAP;AACD;AAED;;;;;;;SAKeO,I;;EAYf;AACA;AACA;AACA;;;;0CAfA,aAAsB;AACpB;AACAZ,IAAAA,QAAQ,CAACa,YAAT,CAAsBC,OAAtB,CAA8B,CAACC,IAAD,EAAOC,EAAP,KAAc;AAC1C,UAAIhB,QAAQ,CAACiB,SAAT,CAAmBF,IAAnB,CAAJ,EAA8B;AAC5Bf,QAAAA,QAAQ,CAACkB,UAAT,CAAoBF,EAApB;AACD;AACF,KAJD,EAFoB,CAQpB;;AACA,iBAAaG,aAAa,EAA1B;AACD,G;;;;SAMcA,a;;;;;mDAAf,aAA+B;AAC7B,UAAMC,IAAI,GAAGrB,MAAb;;AACA,QAAIqB,IAAI,CAACC,KAAL,CAAWC,MAAX,GAAoB,CAAxB,EAA2B;AACzB,YAAMC,QAAQ,GAAI,IAAGH,IAAI,CAACC,KAAL,CAAWG,IAAX,CAAiB,GAAjB,CAAqB,GAA1C;AACA,mBAAa1B,KAAK,CAACsB,IAAI,CAAClB,QAAN,EAAgB;AAChCuB,QAAAA,MAAM,EAAG,MADuB;AAEhCC,QAAAA,IAAI,EAAEH,QAF0B;AAGhCI,QAAAA,OAAO,EAAEP,IAAI,CAACO,OAHkB;AAIhCvB,QAAAA,OAAO,EAAEgB,IAAI,CAAChB;AAJkB,OAAhB,CAAL,CAMVwB,IANU,CAMLC,QAAQ,IAAI;AAChB,YAAIA,QAAQ,CAACC,MAAT,KAAoB,GAAxB,EAA6B;AAC3B,gBAAMC,GAAG,GACN,wDAAD,GACC,GAAEF,QAAQ,CAACC,MAAO,WAAUP,QAAS,EAFxC;AAIA,cAAIH,IAAI,CAACY,gBAAT,EAA2BZ,IAAI,CAACa,IAAL,CAAW,OAAX,EAAmB,IAAIC,KAAJ,CAAUH,GAAV,CAAnB,EAA3B,KACKI,OAAO,CAACC,KAAR,CAAcL,GAAd;AACN;AACF,OAfU,EAgBVM,KAhBU,CAgBJD,KAAK,IAAI;AACd,cAAML,GAAG,GAAI,6BAA4BK,KAAM,EAA/C;AACA,YAAIhB,IAAI,CAACY,gBAAT,EAA2B,KAAKC,IAAL,CAAW,OAAX,EAAmB,IAAIC,KAAJ,CAAUH,GAAV,CAAnB,EAA3B,KACKI,OAAO,CAACC,KAAR,CAAcL,GAAd;AACN,OApBU,CAAb;AAqBD;;AACD,WAAO,IAAP;AACD,G;;;;AAEDO,MAAM,CAACC,OAAP,GAAiB;AACftC,EAAAA,MADe;AAEfW,EAAAA;AAFe,CAAjB","sourcesContent":["const zipkin = require(`zipkin`)\nconst { HttpLogger } = require(`zipkin-transport-http`)\nconst ZipkinTracer = require(`zipkin-javascript-opentracing`)\nconst fetch = require(`node-fetch`)\n\nlet logger\nlet recorder\n\n/**\n * Create and return an open-tracing compatible tracer. See\n * https://github.com/opentracing/opentracing-javascript/blob/master/src/tracer.ts\n */\nfunction create() {\n  logger = new HttpLogger({\n    // endpoint of local docker zipkin instance\n    endpoint: `http://localhost:9411/api/v1/spans`,\n  })\n\n  recorder = new zipkin.BatchRecorder({\n    logger,\n    // timeout = 60 hours, must be longer than site's build time\n    timeout: 60 * 60 * 60 * 1000000,\n  })\n\n  const tracer = new ZipkinTracer({\n    localServiceName: `gatsby`,\n    serviceName: `gatsby`,\n    // Sample 1 out of 1 spans (100%). When tracing production\n    // services, it is normal to sample 1 out of 10 requests so that\n    // tracing information doesn't impact site performance. But Gatsby\n    // is a build tool and only has \"1\" request (the\n    // build). Therefore, we must set this to 100% so that spans\n    // aren't missing\n    sampler: new zipkin.sampler.CountingSampler(1),\n    traceId128Bit: true,\n    recorder,\n    kind: `client`,\n  })\n\n  return tracer\n}\n\n/**\n * Run any tracer cleanup required before the node.js process\n * exits. For Zipkin HTTP, we must manually process any spans still on\n * the queue\n */\nasync function stop() {\n  // First, write all partial spans to the http logger\n  recorder.partialSpans.forEach((span, id) => {\n    if (recorder._timedOut(span)) {\n      recorder._writeSpan(id)\n    }\n  })\n\n  // Then tell http logger to process all spans in its queue\n  return await _processQueue()\n}\n\n// Workaround for issue in Zipkin HTTP Logger where Spans are not\n// cleared off their processing queue before the node.js process\n// exits. Code is mostly the same as the zipkin processQueue\n// implementation.\nasync function _processQueue() {\n  const self = logger\n  if (self.queue.length > 0) {\n    const postBody = `[${self.queue.join(`,`)}]`\n    return await fetch(self.endpoint, {\n      method: `POST`,\n      body: postBody,\n      headers: self.headers,\n      timeout: self.timeout,\n    })\n      .then(response => {\n        if (response.status !== 202) {\n          const err =\n            `Unexpected response while sending Zipkin data, status:` +\n            `${response.status}, body: ${postBody}`\n\n          if (self.errorListenerSet) self.emit(`error`, new Error(err))\n          else console.error(err)\n        }\n      })\n      .catch(error => {\n        const err = `Error sending Zipkin data ${error}`\n        if (self.errorListenerSet) this.emit(`error`, new Error(err))\n        else console.error(err)\n      })\n  }\n  return true\n}\n\nmodule.exports = {\n  create,\n  stop,\n}\n"],"file":"zipkin-local.js"}
\ No newline at end of file
+{"version":3,"sources":["../../../src/utils/tracer/zipkin-local.js"],"names":["zipkin","require","HttpLogger","ZipkinTracer","fetch","logger","recorder","create","endpoint","BatchRecorder","timeout","tracer","localServiceName","serviceName","sampler","CountingSampler","traceId128Bit","kind","stop","partialSpans","forEach","span","id","_timedOut","_writeSpan","_processQueue","self","queue","length","postBody","join","method","body","headers","then","response","status","err","errorListenerSet","emit","Error","console","error","catch","module","exports"],"mappings":"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","sourcesContent":["const zipkin = require(`zipkin`)\nconst { HttpLogger } = require(`zipkin-transport-http`)\nconst ZipkinTracer = require(`zipkin-javascript-opentracing`)\nconst fetch = require(`node-fetch`)\n\nlet logger\nlet recorder\n\n/**\n * Create and return an open-tracing compatible tracer. See\n * https://github.com/opentracing/opentracing-javascript/blob/master/src/tracer.ts\n */\nfunction create() {\n  logger = new HttpLogger({\n    // endpoint of local docker zipkin instance\n    endpoint: `http://localhost:9411/api/v1/spans`,\n  })\n\n  recorder = new zipkin.BatchRecorder({\n    logger,\n    // timeout = 60 hours, must be longer than site's build time\n    timeout: 60 * 60 * 60 * 1000000,\n  })\n\n  const tracer = new ZipkinTracer({\n    localServiceName: `gatsby`,\n    serviceName: `gatsby`,\n    // Sample 1 out of 1 spans (100%). When tracing production\n    // services, it is normal to sample 1 out of 10 requests so that\n    // tracing information doesn't impact site performance. But Gatsby\n    // is a build tool and only has \"1\" request (the\n    // build). Therefore, we must set this to 100% so that spans\n    // aren't missing\n    sampler: new zipkin.sampler.CountingSampler(1),\n    traceId128Bit: true,\n    recorder,\n    kind: `client`,\n  })\n\n  return tracer\n}\n\n/**\n * Run any tracer cleanup required before the node.js process\n * exits. For Zipkin HTTP, we must manually process any spans still on\n * the queue\n */\nasync function stop() {\n  // First, write all partial spans to the http logger\n  recorder.partialSpans.forEach((span, id) => {\n    if (recorder._timedOut(span)) {\n      recorder._writeSpan(id)\n    }\n  })\n\n  // Then tell http logger to process all spans in its queue\n  return await _processQueue()\n}\n\n// Workaround for issue in Zipkin HTTP Logger where Spans are not\n// cleared off their processing queue before the node.js process\n// exits. Code is mostly the same as the zipkin processQueue\n// implementation.\nasync function _processQueue() {\n  const self = logger\n  if (self.queue.length > 0) {\n    const postBody = `[${self.queue.join(`,`)}]`\n    return await fetch(self.endpoint, {\n      method: `POST`,\n      body: postBody,\n      headers: self.headers,\n      timeout: self.timeout,\n    })\n      .then(response => {\n        if (response.status !== 202) {\n          const err =\n            `Unexpected response while sending Zipkin data, status:` +\n            `${response.status}, body: ${postBody}`\n\n          if (self.errorListenerSet) self.emit(`error`, new Error(err))\n          else console.error(err)\n        }\n      })\n      .catch(error => {\n        const err = `Error sending Zipkin data ${error}`\n        if (self.errorListenerSet) this.emit(`error`, new Error(err))\n        else console.error(err)\n      })\n  }\n  return true\n}\n\nmodule.exports = {\n  create,\n  stop,\n}\n"],"file":"zipkin-local.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/utils/webpack-utils.js b/node_modules/gatsby/dist/utils/webpack-utils.js
index 25f9f07..6b96dc7 100644
--- a/node_modules/gatsby/dist/utils/webpack-utils.js
+++ b/node_modules/gatsby/dist/utils/webpack-utils.js
@@ -1,11 +1,5 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _objectWithoutPropertiesLoose2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutPropertiesLoose"));
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 const autoprefixer = require(`autoprefixer`);
 
 const flexbugs = require(`postcss-flexbugs-fixes`);
@@ -27,374 +21,376 @@ const eslintConfig = require(`./eslint-config`);
 /**
  * A factory method that produces an atoms namespace
  */
-module.exports =
-/*#__PURE__*/
-function () {
-  var _ref = (0, _asyncToGenerator2.default)(function* ({
-    stage,
-    program
-  }) {
-    const assetRelativeRoot = `static/`;
-    const vendorRegex = /(node_modules|bower_components)/;
-    const supportedBrowsers = program.browserslist;
-    const PRODUCTION = !stage.includes(`develop`);
-    const isSSR = stage.includes(`html`);
-
-    const makeExternalOnly = original => (options = {}) => {
-      let rule = original(options);
-      rule.include = vendorRegex;
-      return rule;
-    };
-
-    const makeInternalOnly = original => (options = {}) => {
-      let rule = original(options);
-      rule.exclude = vendorRegex;
-      return rule;
-    };
-
-    let ident = 0;
-    const loaders = {
-      json: (options = {}) => {
-        return {
-          options,
-          loader: require.resolve(`json-loader`)
-        };
-      },
-      yaml: (options = {}) => {
-        return {
-          options,
-          loader: require.resolve(`yaml-loader`)
-        };
-      },
-      null: (options = {}) => {
-        return {
-          options,
-          loader: require.resolve(`null-loader`)
-        };
-      },
-      raw: (options = {}) => {
-        return {
-          options,
-          loader: require.resolve(`raw-loader`)
-        };
-      },
-      style: (options = {}) => {
-        return {
-          options,
-          loader: require.resolve(`style-loader`)
-        };
-      },
-      miniCssExtract: (options = {}) => {
-        return {
-          options,
-          // use MiniCssExtractPlugin only on production builds
-          loader: PRODUCTION ? MiniCssExtractPlugin.loader : require.resolve(`style-loader`)
-        };
-      },
-      css: (options = {}) => {
-        return {
-          loader: isSSR ? require.resolve(`css-loader/locals`) : require.resolve(`css-loader`),
-          options: Object.assign({
-            sourceMap: !PRODUCTION,
-            camelCase: `dashesOnly`,
-            // https://github.com/webpack-contrib/css-loader/issues/406
-            localIdentName: `[name]--[local]--[hash:base64:5]`
-          }, options)
-        };
-      },
-      postcss: (options = {}) => {
-        let _plugins = options.plugins,
-            _options$browsers = options.browsers,
-            browsers = _options$browsers === void 0 ? supportedBrowsers : _options$browsers,
-            postcssOpts = (0, _objectWithoutPropertiesLoose2.default)(options, ["plugins", "browsers"]);
-        return {
-          loader: require.resolve(`postcss-loader`),
-          options: Object.assign({
-            ident: `postcss-${++ident}`,
-            sourceMap: !PRODUCTION,
-            plugins: loader => {
-              _plugins = (typeof _plugins === `function` ? _plugins(loader) : _plugins) || [];
-              return [flexbugs, autoprefixer({
-                browsers,
-                flexbox: `no-2009`
-              }), ..._plugins];
-            }
-          }, postcssOpts)
-        };
-      },
-      file: (options = {}) => {
-        return {
-          loader: require.resolve(`file-loader`),
-          options: Object.assign({
-            name: `${assetRelativeRoot}[name]-[hash].[ext]`
-          }, options)
-        };
-      },
-      url: (options = {}) => {
-        return {
-          loader: require.resolve(`url-loader`),
-          options: Object.assign({
-            limit: 10000,
-            name: `${assetRelativeRoot}[name]-[hash].[ext]`
-          }, options)
-        };
-      },
-      js: options => {
-        return {
-          options,
-          loader: require.resolve(`./babel-loader`)
-        };
-      },
-      eslint: (schema = ``) => {
-        const options = eslintConfig(schema);
-        return {
-          options,
-          loader: require.resolve(`eslint-loader`)
-        };
-      },
-      imports: (options = {}) => {
-        return {
-          options,
-          loader: require.resolve(`imports-loader`)
-        };
-      },
-      exports: (options = {}) => {
-        return {
-          options,
-          loader: require.resolve(`exports-loader`)
-        };
-      }
-      /**
-       * Rules
-       */
+module.exports = async ({
+  stage,
+  program
+}) => {
+  const assetRelativeRoot = `static/`;
+  const vendorRegex = /(node_modules|bower_components)/;
+  const supportedBrowsers = program.browserslist;
+  const PRODUCTION = !stage.includes(`develop`);
+  const isSSR = stage.includes(`html`);
+
+  const makeExternalOnly = original => (options = {}) => {
+    let rule = original(options);
+    rule.include = vendorRegex;
+    return rule;
+  };
 
-    };
-    const rules = {};
-    /**
-     * JavaScript loader via babel, excludes node_modules
-     */
+  const makeInternalOnly = original => (options = {}) => {
+    let rule = original(options);
+    rule.exclude = vendorRegex;
+    return rule;
+  };
 
-    {
-      let js = (options = {}) => {
-        return {
-          test: /\.jsx?$/,
-          exclude: vendorRegex,
-          use: [loaders.js(options)]
-        };
+  let ident = 0;
+  const loaders = {
+    json: (options = {}) => {
+      return {
+        options,
+        loader: require.resolve(`json-loader`)
       };
-
-      rules.js = js;
-    }
-    /**
-     * mjs loader:
-     * webpack 4 has issues automatically dealing with
-     * the .mjs extension, thus we need to explicitly
-     * add this rule to use the default webpack js loader
-     */
-
-    {
-      let mjs = (options = {}) => {
-        return Object.assign({
-          test: /\.mjs$/,
-          include: /node_modules/,
-          type: `javascript/auto`
-        }, options);
+    },
+    yaml: (options = {}) => {
+      return {
+        options,
+        loader: require.resolve(`yaml-loader`)
       };
-
-      rules.mjs = mjs;
-    }
-    {
-      let eslint = schema => {
-        return {
-          enforce: `pre`,
-          test: /\.jsx?$/,
-          exclude: vendorRegex,
-          use: [loaders.eslint(schema)]
-        };
+    },
+    null: (options = {}) => {
+      return {
+        options,
+        loader: require.resolve(`null-loader`)
       };
-
-      rules.eslint = eslint;
-    }
-
-    rules.yaml = () => {
+    },
+    raw: (options = {}) => {
       return {
-        test: /\.ya?ml/,
-        use: [loaders.json(), loaders.yaml()]
+        options,
+        loader: require.resolve(`raw-loader`)
       };
-    };
-    /**
-     * Font loader
-     */
-
-
-    rules.fonts = () => {
+    },
+    style: (options = {}) => {
       return {
-        use: [loaders.url()],
-        test: /\.(eot|otf|ttf|woff(2)?)(\?.*)?$/
+        options,
+        loader: require.resolve(`style-loader`)
       };
-    };
+    },
+    miniCssExtract: (options = {}) => {
+      return {
+        options,
+        // use MiniCssExtractPlugin only on production builds
+        loader: PRODUCTION ? MiniCssExtractPlugin.loader : require.resolve(`style-loader`)
+      };
+    },
+    css: (options = {}) => {
+      return {
+        loader: isSSR ? require.resolve(`css-loader/locals`) : require.resolve(`css-loader`),
+        options: {
+          sourceMap: !PRODUCTION,
+          camelCase: `dashesOnly`,
+          // https://github.com/webpack-contrib/css-loader/issues/406
+          localIdentName: `[name]--[local]--[hash:base64:5]`,
+          ...options
+        }
+      };
+    },
+    postcss: (options = {}) => {
+      let {
+        plugins,
+        browsers = supportedBrowsers,
+        ...postcssOpts
+      } = options;
+      return {
+        loader: require.resolve(`postcss-loader`),
+        options: {
+          ident: `postcss-${++ident}`,
+          sourceMap: !PRODUCTION,
+          plugins: loader => {
+            plugins = (typeof plugins === `function` ? plugins(loader) : plugins) || [];
+            return [flexbugs, autoprefixer({
+              browsers,
+              flexbox: `no-2009`
+            }), ...plugins];
+          },
+          ...postcssOpts
+        }
+      };
+    },
+    file: (options = {}) => {
+      return {
+        loader: require.resolve(`file-loader`),
+        options: {
+          name: `${assetRelativeRoot}[name]-[hash].[ext]`,
+          ...options
+        }
+      };
+    },
+    url: (options = {}) => {
+      return {
+        loader: require.resolve(`url-loader`),
+        options: {
+          limit: 10000,
+          name: `${assetRelativeRoot}[name]-[hash].[ext]`,
+          ...options
+        }
+      };
+    },
+    js: options => {
+      return {
+        options,
+        loader: require.resolve(`./babel-loader`)
+      };
+    },
+    eslint: (schema = ``) => {
+      const options = eslintConfig(schema);
+      return {
+        options,
+        loader: require.resolve(`eslint-loader`)
+      };
+    },
+    imports: (options = {}) => {
+      return {
+        options,
+        loader: require.resolve(`imports-loader`)
+      };
+    },
+    exports: (options = {}) => {
+      return {
+        options,
+        loader: require.resolve(`exports-loader`)
+      };
+    }
     /**
-     * Loads image assets, inlines images via a data URI if they are below
-     * the size threshold
+     * Rules
      */
 
+  };
+  const rules = {};
+  /**
+   * JavaScript loader via babel, excludes node_modules
+   */
 
-    rules.images = () => {
+  {
+    let js = (options = {}) => {
       return {
-        use: [loaders.url()],
-        test: /\.(ico|svg|jpg|jpeg|png|gif|webp)(\?.*)?$/
+        test: /\.jsx?$/,
+        exclude: vendorRegex,
+        use: [loaders.js(options)]
       };
     };
-    /**
-     * Loads audio and video and inlines them via a data URI if they are below
-     * the size threshold
-     */
 
-
-    rules.media = () => {
+    rules.js = js;
+  }
+  /**
+   * mjs loader:
+   * webpack 4 has issues automatically dealing with
+   * the .mjs extension, thus we need to explicitly
+   * add this rule to use the default webpack js loader
+   */
+
+  {
+    let mjs = (options = {}) => {
       return {
-        use: [loaders.url()],
-        test: /\.(mp4|webm|wav|mp3|m4a|aac|oga|flac)$/
+        test: /\.mjs$/,
+        include: /node_modules/,
+        type: `javascript/auto`,
+        ...options
       };
     };
-    /**
-     * Loads assets without inlining
-     */
-
 
-    rules.miscAssets = () => {
+    rules.mjs = mjs;
+  }
+  {
+    let eslint = schema => {
       return {
-        use: [loaders.file()],
-        test: /\.pdf$/
+        enforce: `pre`,
+        test: /\.jsx?$/,
+        exclude: vendorRegex,
+        use: [loaders.eslint(schema)]
       };
     };
-    /**
-     * CSS style loader.
-     */
 
+    rules.eslint = eslint;
+  }
 
-    {
-      const css = (_ref2 = {}) => {
-        let browsers = _ref2.browsers,
-            options = (0, _objectWithoutPropertiesLoose2.default)(_ref2, ["browsers"]);
-        const use = [loaders.css(Object.assign({}, options, {
-          importLoaders: 1
-        })), loaders.postcss({
-          browsers
-        })];
-        if (!isSSR) use.unshift(loaders.miniCssExtract({
-          hmr: !options.modules
-        }));
-        return {
-          use,
-          test: /\.css$/
-        };
-      };
-      /**
-       * CSS style loader, _excludes_ node_modules.
-       */
+  rules.yaml = () => {
+    return {
+      test: /\.ya?ml/,
+      use: [loaders.json(), loaders.yaml()]
+    };
+  };
+  /**
+   * Font loader
+   */
 
 
-      css.internal = makeInternalOnly(css);
-      css.external = makeExternalOnly(css);
+  rules.fonts = () => {
+    return {
+      use: [loaders.url()],
+      test: /\.(eot|otf|ttf|woff(2)?)(\?.*)?$/
+    };
+  };
+  /**
+   * Loads image assets, inlines images via a data URI if they are below
+   * the size threshold
+   */
 
-      const cssModules = options => {
-        const rule = css(Object.assign({}, options, {
-          modules: true
-        }));
-        delete rule.exclude;
-        rule.test = /\.module\.css$/;
-        return rule;
-      };
 
-      rules.css = css;
-      rules.cssModules = cssModules;
-    }
-    /**
-     * PostCSS loader.
-     */
+  rules.images = () => {
+    return {
+      use: [loaders.url()],
+      test: /\.(ico|svg|jpg|jpeg|png|gif|webp)(\?.*)?$/
+    };
+  };
+  /**
+   * Loads audio and video and inlines them via a data URI if they are below
+   * the size threshold
+   */
 
-    {
-      const postcss = options => {
-        return {
-          test: /\.css$/,
-          use: [loaders.css({
-            importLoaders: 1
-          }), loaders.postcss(options)]
-        };
-      };
-      /**
-       * PostCSS loader, _excludes_ node_modules.
-       */
+
+  rules.media = () => {
+    return {
+      use: [loaders.url()],
+      test: /\.(mp4|webm|wav|mp3|m4a|aac|oga|flac)$/
+    };
+  };
+  /**
+   * Loads assets without inlining
+   */
 
 
-      postcss.internal = makeInternalOnly(postcss);
-      postcss.external = makeExternalOnly(postcss);
-      rules.postcss = postcss;
-    }
+  rules.miscAssets = () => {
+    return {
+      use: [loaders.file()],
+      test: /\.pdf$/
+    };
+  };
+  /**
+   * CSS style loader.
+   */
+
+
+  {
+    const css = ({
+      browsers,
+      ...options
+    } = {}) => {
+      const use = [loaders.css({ ...options,
+        importLoaders: 1
+      }), loaders.postcss({
+        browsers
+      })];
+      if (!isSSR) use.unshift(loaders.miniCssExtract({
+        hmr: !options.modules
+      }));
+      return {
+        use,
+        test: /\.css$/
+      };
+    };
     /**
-     * Plugins
+     * CSS style loader, _excludes_ node_modules.
      */
 
-    const plugins = Object.assign({}, builtinPlugins);
-    /**
-     * Minify JavaScript code without regard for IE8. Attempts
-     * to parallelize the work to save time. Generally only add in Production
-     */
 
-    plugins.minifyJs = (_ref3 = {}) => {
-      let terserOptions = _ref3.terserOptions,
-          options = (0, _objectWithoutPropertiesLoose2.default)(_ref3, ["terserOptions"]);
-      return new TerserPlugin(Object.assign({
-        cache: true,
-        // We can't use parallel in WSL because of https://github.com/gatsbyjs/gatsby/issues/6540
-        // This issue was fixed in https://github.com/gatsbyjs/gatsby/pull/12636
-        parallel: !isWsl,
-        exclude: /\.min\.js/,
-        sourceMap: true,
-        terserOptions: Object.assign({
-          ie8: false,
-          mangle: {
-            safari10: true
-          },
-          parse: {
-            ecma: 8
-          },
-          compress: {
-            ecma: 5
-          },
-          output: {
-            ecma: 5
-          }
-        }, terserOptions)
-      }, options));
+    css.internal = makeInternalOnly(css);
+    css.external = makeExternalOnly(css);
+
+    const cssModules = options => {
+      const rule = css({ ...options,
+        modules: true
+      });
+      delete rule.exclude;
+      rule.test = /\.module\.css$/;
+      return rule;
     };
 
-    plugins.minifyCss = (options = {}) => new OptimizeCssAssetsPlugin(options);
+    rules.css = css;
+    rules.cssModules = cssModules;
+  }
+  /**
+   * PostCSS loader.
+   */
+
+  {
+    const postcss = options => {
+      return {
+        test: /\.css$/,
+        use: [loaders.css({
+          importLoaders: 1
+        }), loaders.postcss(options)]
+      };
+    };
     /**
-     * Extracts css requires into a single file;
-     * includes some reasonable defaults
+     * PostCSS loader, _excludes_ node_modules.
      */
 
 
-    plugins.extractText = options => new MiniCssExtractPlugin(Object.assign({
-      filename: `[name].[contenthash].css`,
-      chunkFilename: `[name].[contenthash].css`
-    }, options));
+    postcss.internal = makeInternalOnly(postcss);
+    postcss.external = makeExternalOnly(postcss);
+    rules.postcss = postcss;
+  }
+  /**
+   * Plugins
+   */
 
-    plugins.moment = () => plugins.ignore(/^\.\/locale$/, /moment$/);
+  const plugins = { ...builtinPlugins
+  };
+  /**
+   * Minify JavaScript code without regard for IE8. Attempts
+   * to parallelize the work to save time. Generally only add in Production
+   */
+
+  plugins.minifyJs = ({
+    terserOptions,
+    ...options
+  } = {}) => new TerserPlugin({
+    cache: true,
+    // We can't use parallel in WSL because of https://github.com/gatsbyjs/gatsby/issues/6540
+    // This issue was fixed in https://github.com/gatsbyjs/gatsby/pull/12636
+    parallel: !isWsl,
+    exclude: /\.min\.js/,
+    sourceMap: true,
+    terserOptions: {
+      ie8: false,
+      mangle: {
+        safari10: true
+      },
+      parse: {
+        ecma: 8
+      },
+      compress: {
+        ecma: 5
+      },
+      output: {
+        ecma: 5
+      },
+      ...terserOptions
+    },
+    ...options
+  });
 
-    plugins.extractStats = options => new GatsbyWebpackStatsExtractor(options);
+  plugins.minifyCss = (options = {}) => new OptimizeCssAssetsPlugin(options);
+  /**
+   * Extracts css requires into a single file;
+   * includes some reasonable defaults
+   */
 
-    return {
-      loaders,
-      rules: rules,
-      plugins: plugins
-    };
+
+  plugins.extractText = options => new MiniCssExtractPlugin({
+    filename: `[name].[contenthash].css`,
+    chunkFilename: `[name].[contenthash].css`,
+    ...options
   });
 
-  return function (_x) {
-    return _ref.apply(this, arguments);
+  plugins.moment = () => plugins.ignore(/^\.\/locale$/, /moment$/);
+
+  plugins.extractStats = options => new GatsbyWebpackStatsExtractor(options);
+
+  return {
+    loaders,
+    rules: rules,
+    plugins: plugins
   };
-}();
+};
 //# sourceMappingURL=webpack-utils.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/utils/webpack-utils.js.map b/node_modules/gatsby/dist/utils/webpack-utils.js.map
index 6da12ba..3540352 100644
--- a/node_modules/gatsby/dist/utils/webpack-utils.js.map
+++ b/node_modules/gatsby/dist/utils/webpack-utils.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/utils/webpack-utils.js"],"names":["autoprefixer","require","flexbugs","TerserPlugin","MiniCssExtractPlugin","OptimizeCssAssetsPlugin","isWsl","GatsbyWebpackStatsExtractor","builtinPlugins","eslintConfig","module","exports","stage","program","assetRelativeRoot","vendorRegex","supportedBrowsers","browserslist","PRODUCTION","includes","isSSR","makeExternalOnly","original","options","rule","include","makeInternalOnly","exclude","ident","loaders","json","loader","resolve","yaml","null","raw","style","miniCssExtract","css","sourceMap","camelCase","localIdentName","postcss","plugins","browsers","postcssOpts","flexbox","file","name","url","limit","js","eslint","schema","imports","rules","test","use","mjs","type","enforce","fonts","images","media","miscAssets","importLoaders","unshift","hmr","modules","internal","external","cssModules","minifyJs","terserOptions","cache","parallel","ie8","mangle","safari10","parse","ecma","compress","output","minifyCss","extractText","filename","chunkFilename","moment","ignore","extractStats"],"mappings":";;;;;;;;AAEA,MAAMA,YAAY,GAAGC,OAAO,CAAE,cAAF,CAA5B;;AACA,MAAMC,QAAQ,GAAGD,OAAO,CAAE,wBAAF,CAAxB;;AACA,MAAME,YAAY,GAAGF,OAAO,CAAE,uBAAF,CAA5B;;AACA,MAAMG,oBAAoB,GAAGH,OAAO,CAAE,yBAAF,CAApC;;AACA,MAAMI,uBAAuB,GAAGJ,OAAO,CAAE,oCAAF,CAAvC;;AACA,MAAMK,KAAK,GAAGL,OAAO,CAAE,QAAF,CAArB;;AAEA,MAAMM,2BAA2B,GAAGN,OAAO,CAAE,kCAAF,CAA3C;;AAEA,MAAMO,cAAc,GAAGP,OAAO,CAAE,mBAAF,CAA9B;;AACA,MAAMQ,YAAY,GAAGR,OAAO,CAAE,iBAAF,CAA5B;;AAkGA;;;AAGAS,MAAM,CAACC,OAAP;AAAA;AAAA;AAAA,6CAAiB,WAAO;AACtBC,IAAAA,KADsB;AAEtBC,IAAAA;AAFsB,GAAP,EAMmB;AAClC,UAAMC,iBAAiB,GAAI,SAA3B;AACA,UAAMC,WAAW,GAAG,iCAApB;AACA,UAAMC,iBAAiB,GAAGH,OAAO,CAACI,YAAlC;AAEA,UAAMC,UAAU,GAAG,CAACN,KAAK,CAACO,QAAN,CAAgB,SAAhB,CAApB;AAEA,UAAMC,KAAK,GAAGR,KAAK,CAACO,QAAN,CAAgB,MAAhB,CAAd;;AAEA,UAAME,gBAAgB,GAAIC,QAAD,IAA8B,CACrDC,OAAO,GAAG,EAD2C,KAE5C;AACT,UAAIC,IAAI,GAAGF,QAAQ,CAACC,OAAD,CAAnB;AACAC,MAAAA,IAAI,CAACC,OAAL,GAAeV,WAAf;AACA,aAAOS,IAAP;AACD,KAND;;AAQA,UAAME,gBAAgB,GAAIJ,QAAD,IAA8B,CACrDC,OAAO,GAAG,EAD2C,KAE5C;AACT,UAAIC,IAAI,GAAGF,QAAQ,CAACC,OAAD,CAAnB;AACAC,MAAAA,IAAI,CAACG,OAAL,GAAeZ,WAAf;AACA,aAAOS,IAAP;AACD,KAND;;AAQA,QAAII,KAAK,GAAG,CAAZ;AAEA,UAAMC,OAAoB,GAAG;AAC3BC,MAAAA,IAAI,EAAE,CAACP,OAAO,GAAG,EAAX,KAAkB;AACtB,eAAO;AACLA,UAAAA,OADK;AAELQ,UAAAA,MAAM,EAAE9B,OAAO,CAAC+B,OAAR,CAAiB,aAAjB;AAFH,SAAP;AAID,OAN0B;AAQ3BC,MAAAA,IAAI,EAAE,CAACV,OAAO,GAAG,EAAX,KAAkB;AACtB,eAAO;AACLA,UAAAA,OADK;AAELQ,UAAAA,MAAM,EAAE9B,OAAO,CAAC+B,OAAR,CAAiB,aAAjB;AAFH,SAAP;AAID,OAb0B;AAe3BE,MAAAA,IAAI,EAAE,CAACX,OAAO,GAAG,EAAX,KAAkB;AACtB,eAAO;AACLA,UAAAA,OADK;AAELQ,UAAAA,MAAM,EAAE9B,OAAO,CAAC+B,OAAR,CAAiB,aAAjB;AAFH,SAAP;AAID,OApB0B;AAsB3BG,MAAAA,GAAG,EAAE,CAACZ,OAAO,GAAG,EAAX,KAAkB;AACrB,eAAO;AACLA,UAAAA,OADK;AAELQ,UAAAA,MAAM,EAAE9B,OAAO,CAAC+B,OAAR,CAAiB,YAAjB;AAFH,SAAP;AAID,OA3B0B;AA6B3BI,MAAAA,KAAK,EAAE,CAACb,OAAO,GAAG,EAAX,KAAkB;AACvB,eAAO;AACLA,UAAAA,OADK;AAELQ,UAAAA,MAAM,EAAE9B,OAAO,CAAC+B,OAAR,CAAiB,cAAjB;AAFH,SAAP;AAID,OAlC0B;AAoC3BK,MAAAA,cAAc,EAAE,CAACd,OAAO,GAAG,EAAX,KAAkB;AAChC,eAAO;AACLA,UAAAA,OADK;AAEL;AACAQ,UAAAA,MAAM,EAAEb,UAAU,GACdd,oBAAoB,CAAC2B,MADP,GAEd9B,OAAO,CAAC+B,OAAR,CAAiB,cAAjB;AALC,SAAP;AAOD,OA5C0B;AA8C3BM,MAAAA,GAAG,EAAE,CAACf,OAAO,GAAG,EAAX,KAAkB;AACrB,eAAO;AACLQ,UAAAA,MAAM,EAAEX,KAAK,GACTnB,OAAO,CAAC+B,OAAR,CAAiB,mBAAjB,CADS,GAET/B,OAAO,CAAC+B,OAAR,CAAiB,YAAjB,CAHC;AAILT,UAAAA,OAAO;AACLgB,YAAAA,SAAS,EAAE,CAACrB,UADP;AAELsB,YAAAA,SAAS,EAAG,YAFP;AAGL;AACAC,YAAAA,cAAc,EAAG;AAJZ,aAKFlB,OALE;AAJF,SAAP;AAYD,OA3D0B;AA6D3BmB,MAAAA,OAAO,EAAE,CAACnB,OAAO,GAAG,EAAX,KAAkB;AAAA,YACnBoB,QADmB,GACuCpB,OADvC,CACnBoB,OADmB;AAAA,gCACuCpB,OADvC,CACVqB,QADU;AAAA,YACVA,QADU,kCACC5B,iBADD;AAAA,YACuB6B,WADvB,+CACuCtB,OADvC;AAGzB,eAAO;AACLQ,UAAAA,MAAM,EAAE9B,OAAO,CAAC+B,OAAR,CAAiB,gBAAjB,CADH;AAELT,UAAAA,OAAO;AACLK,YAAAA,KAAK,EAAG,WAAU,EAAEA,KAAM,EADrB;AAELW,YAAAA,SAAS,EAAE,CAACrB,UAFP;AAGLyB,YAAAA,OAAO,EAAEZ,MAAM,IAAI;AACjBY,cAAAA,QAAO,GACL,CAAC,OAAOA,QAAP,KAAoB,UAApB,GAAgCA,QAAO,CAACZ,MAAD,CAAvC,GAAkDY,QAAnD,KAA+D,EADjE;AAGA,qBAAO,CACLzC,QADK,EAELF,YAAY,CAAC;AAAE4C,gBAAAA,QAAF;AAAYE,gBAAAA,OAAO,EAAG;AAAtB,eAAD,CAFP,EAGL,GAAGH,QAHE,CAAP;AAKD;AAZI,aAaFE,WAbE;AAFF,SAAP;AAkBD,OAlF0B;AAoF3BE,MAAAA,IAAI,EAAE,CAACxB,OAAO,GAAG,EAAX,KAAkB;AACtB,eAAO;AACLQ,UAAAA,MAAM,EAAE9B,OAAO,CAAC+B,OAAR,CAAiB,aAAjB,CADH;AAELT,UAAAA,OAAO;AACLyB,YAAAA,IAAI,EAAG,GAAElC,iBAAkB;AADtB,aAEFS,OAFE;AAFF,SAAP;AAOD,OA5F0B;AA8F3B0B,MAAAA,GAAG,EAAE,CAAC1B,OAAO,GAAG,EAAX,KAAkB;AACrB,eAAO;AACLQ,UAAAA,MAAM,EAAE9B,OAAO,CAAC+B,OAAR,CAAiB,YAAjB,CADH;AAELT,UAAAA,OAAO;AACL2B,YAAAA,KAAK,EAAE,KADF;AAELF,YAAAA,IAAI,EAAG,GAAElC,iBAAkB;AAFtB,aAGFS,OAHE;AAFF,SAAP;AAQD,OAvG0B;AAyG3B4B,MAAAA,EAAE,EAAE5B,OAAO,IAAI;AACb,eAAO;AACLA,UAAAA,OADK;AAELQ,UAAAA,MAAM,EAAE9B,OAAO,CAAC+B,OAAR,CAAiB,gBAAjB;AAFH,SAAP;AAID,OA9G0B;AAgH3BoB,MAAAA,MAAM,EAAE,CAACC,MAAM,GAAI,EAAX,KAAiB;AACvB,cAAM9B,OAAO,GAAGd,YAAY,CAAC4C,MAAD,CAA5B;AAEA,eAAO;AACL9B,UAAAA,OADK;AAELQ,UAAAA,MAAM,EAAE9B,OAAO,CAAC+B,OAAR,CAAiB,eAAjB;AAFH,SAAP;AAID,OAvH0B;AAyH3BsB,MAAAA,OAAO,EAAE,CAAC/B,OAAO,GAAG,EAAX,KAAkB;AACzB,eAAO;AACLA,UAAAA,OADK;AAELQ,UAAAA,MAAM,EAAE9B,OAAO,CAAC+B,OAAR,CAAiB,gBAAjB;AAFH,SAAP;AAID,OA9H0B;AAgI3BrB,MAAAA,OAAO,EAAE,CAACY,OAAO,GAAG,EAAX,KAAkB;AACzB,eAAO;AACLA,UAAAA,OADK;AAELQ,UAAAA,MAAM,EAAE9B,OAAO,CAAC+B,OAAR,CAAiB,gBAAjB;AAFH,SAAP;AAID;AAGH;;;;AAxI6B,KAA7B;AA2IA,UAAMuB,KAAK,GAAG,EAAd;AAEA;;;;AAGA;AACE,UAAIJ,EAAE,GAAG,CAAC5B,OAAO,GAAG,EAAX,KAAkB;AACzB,eAAO;AACLiC,UAAAA,IAAI,EAAE,SADD;AAEL7B,UAAAA,OAAO,EAAEZ,WAFJ;AAGL0C,UAAAA,GAAG,EAAE,CAAC5B,OAAO,CAACsB,EAAR,CAAW5B,OAAX,CAAD;AAHA,SAAP;AAKD,OAND;;AAQAgC,MAAAA,KAAK,CAACJ,EAAN,GAAWA,EAAX;AACD;AAED;;;;;;;AAMA;AACE,UAAIO,GAAG,GAAG,CAACnC,OAAO,GAAG,EAAX,KAAkB;AAC1B;AACEiC,UAAAA,IAAI,EAAE,QADR;AAEE/B,UAAAA,OAAO,EAAE,cAFX;AAGEkC,UAAAA,IAAI,EAAG;AAHT,WAIKpC,OAJL;AAMD,OAPD;;AASAgC,MAAAA,KAAK,CAACG,GAAN,GAAYA,GAAZ;AACD;AAED;AACE,UAAIN,MAAM,GAAGC,MAAM,IAAI;AACrB,eAAO;AACLO,UAAAA,OAAO,EAAG,KADL;AAELJ,UAAAA,IAAI,EAAE,SAFD;AAGL7B,UAAAA,OAAO,EAAEZ,WAHJ;AAIL0C,UAAAA,GAAG,EAAE,CAAC5B,OAAO,CAACuB,MAAR,CAAeC,MAAf,CAAD;AAJA,SAAP;AAMD,OAPD;;AASAE,MAAAA,KAAK,CAACH,MAAN,GAAeA,MAAf;AACD;;AAEDG,IAAAA,KAAK,CAACtB,IAAN,GAAa,MAAM;AACjB,aAAO;AACLuB,QAAAA,IAAI,EAAE,SADD;AAELC,QAAAA,GAAG,EAAE,CAAC5B,OAAO,CAACC,IAAR,EAAD,EAAiBD,OAAO,CAACI,IAAR,EAAjB;AAFA,OAAP;AAID,KALD;AAOA;;;;;AAGAsB,IAAAA,KAAK,CAACM,KAAN,GAAc,MAAM;AAClB,aAAO;AACLJ,QAAAA,GAAG,EAAE,CAAC5B,OAAO,CAACoB,GAAR,EAAD,CADA;AAELO,QAAAA,IAAI,EAAE;AAFD,OAAP;AAID,KALD;AAOA;;;;;;AAIAD,IAAAA,KAAK,CAACO,MAAN,GAAe,MAAM;AACnB,aAAO;AACLL,QAAAA,GAAG,EAAE,CAAC5B,OAAO,CAACoB,GAAR,EAAD,CADA;AAELO,QAAAA,IAAI,EAAE;AAFD,OAAP;AAID,KALD;AAOA;;;;;;AAIAD,IAAAA,KAAK,CAACQ,KAAN,GAAc,MAAM;AAClB,aAAO;AACLN,QAAAA,GAAG,EAAE,CAAC5B,OAAO,CAACoB,GAAR,EAAD,CADA;AAELO,QAAAA,IAAI,EAAE;AAFD,OAAP;AAID,KALD;AAOA;;;;;AAGAD,IAAAA,KAAK,CAACS,UAAN,GAAmB,MAAM;AACvB,aAAO;AACLP,QAAAA,GAAG,EAAE,CAAC5B,OAAO,CAACkB,IAAR,EAAD,CADA;AAELS,QAAAA,IAAI,EAAE;AAFD,OAAP;AAID,KALD;AAOA;;;;;AAGA;AACE,YAAMlB,GAAG,GAAG,CAAC,QAA2B,EAA5B,KAAmC;AAAA,YAAhCM,QAAgC,SAAhCA,QAAgC;AAAA,YAAnBrB,OAAmB;AAC7C,cAAMkC,GAAG,GAAG,CACV5B,OAAO,CAACS,GAAR,mBAAiBf,OAAjB;AAA0B0C,UAAAA,aAAa,EAAE;AAAzC,WADU,EAEVpC,OAAO,CAACa,OAAR,CAAgB;AAAEE,UAAAA;AAAF,SAAhB,CAFU,CAAZ;AAIA,YAAI,CAACxB,KAAL,EAAYqC,GAAG,CAACS,OAAJ,CAAYrC,OAAO,CAACQ,cAAR,CAAuB;AAAE8B,UAAAA,GAAG,EAAE,CAAC5C,OAAO,CAAC6C;AAAhB,SAAvB,CAAZ;AAEZ,eAAO;AACLX,UAAAA,GADK;AAELD,UAAAA,IAAI,EAAE;AAFD,SAAP;AAID,OAXD;AAaA;;;;;AAGAlB,MAAAA,GAAG,CAAC+B,QAAJ,GAAe3C,gBAAgB,CAACY,GAAD,CAA/B;AACAA,MAAAA,GAAG,CAACgC,QAAJ,GAAejD,gBAAgB,CAACiB,GAAD,CAA/B;;AAEA,YAAMiC,UAAU,GAAGhD,OAAO,IAAI;AAC5B,cAAMC,IAAI,GAAGc,GAAG,mBAAMf,OAAN;AAAe6C,UAAAA,OAAO,EAAE;AAAxB,WAAhB;AACA,eAAO5C,IAAI,CAACG,OAAZ;AACAH,QAAAA,IAAI,CAACgC,IAAL,GAAY,gBAAZ;AACA,eAAOhC,IAAP;AACD,OALD;;AAOA+B,MAAAA,KAAK,CAACjB,GAAN,GAAYA,GAAZ;AACAiB,MAAAA,KAAK,CAACgB,UAAN,GAAmBA,UAAnB;AACD;AAED;;;;AAGA;AACE,YAAM7B,OAAO,GAAGnB,OAAO,IAAI;AACzB,eAAO;AACLiC,UAAAA,IAAI,EAAE,QADD;AAELC,UAAAA,GAAG,EAAE,CAAC5B,OAAO,CAACS,GAAR,CAAY;AAAE2B,YAAAA,aAAa,EAAE;AAAjB,WAAZ,CAAD,EAAoCpC,OAAO,CAACa,OAAR,CAAgBnB,OAAhB,CAApC;AAFA,SAAP;AAID,OALD;AAOA;;;;;AAGAmB,MAAAA,OAAO,CAAC2B,QAAR,GAAmB3C,gBAAgB,CAACgB,OAAD,CAAnC;AACAA,MAAAA,OAAO,CAAC4B,QAAR,GAAmBjD,gBAAgB,CAACqB,OAAD,CAAnC;AACAa,MAAAA,KAAK,CAACb,OAAN,GAAgBA,OAAhB;AACD;AACD;;;;AAGA,UAAMC,OAAO,qBAAQnC,cAAR,CAAb;AAEA;;;;;AAIAmC,IAAAA,OAAO,CAAC6B,QAAR,GAAmB,CAAC,QAAgC,EAAjC;AAAA,UAAGC,aAAH,SAAGA,aAAH;AAAA,UAAqBlD,OAArB;AAAA,aACjB,IAAIpB,YAAJ;AACEuE,QAAAA,KAAK,EAAE,IADT;AAEE;AACA;AACAC,QAAAA,QAAQ,EAAE,CAACrE,KAJb;AAKEqB,QAAAA,OAAO,EAAE,WALX;AAMEY,QAAAA,SAAS,EAAE,IANb;AAOEkC,QAAAA,aAAa;AACXG,UAAAA,GAAG,EAAE,KADM;AAEXC,UAAAA,MAAM,EAAE;AACNC,YAAAA,QAAQ,EAAE;AADJ,WAFG;AAKXC,UAAAA,KAAK,EAAE;AACLC,YAAAA,IAAI,EAAE;AADD,WALI;AAQXC,UAAAA,QAAQ,EAAE;AACRD,YAAAA,IAAI,EAAE;AADE,WARC;AAWXE,UAAAA,MAAM,EAAE;AACNF,YAAAA,IAAI,EAAE;AADA;AAXG,WAcRP,aAdQ;AAPf,SAuBKlD,OAvBL,EADiB;AAAA,KAAnB;;AA2BAoB,IAAAA,OAAO,CAACwC,SAAR,GAAoB,CAAC5D,OAAO,GAAG,EAAX,KAAkB,IAAIlB,uBAAJ,CAA4BkB,OAA5B,CAAtC;AAEA;;;;;;AAIAoB,IAAAA,OAAO,CAACyC,WAAR,GAAsB7D,OAAO,IAC3B,IAAInB,oBAAJ;AACEiF,MAAAA,QAAQ,EAAG,0BADb;AAEEC,MAAAA,aAAa,EAAG;AAFlB,OAGK/D,OAHL,EADF;;AAOAoB,IAAAA,OAAO,CAAC4C,MAAR,GAAiB,MAAM5C,OAAO,CAAC6C,MAAR,CAAe,cAAf,EAA+B,SAA/B,CAAvB;;AAEA7C,IAAAA,OAAO,CAAC8C,YAAR,GAAuBlE,OAAO,IAAI,IAAIhB,2BAAJ,CAAgCgB,OAAhC,CAAlC;;AAEA,WAAO;AACLM,MAAAA,OADK;AAEL0B,MAAAA,KAAK,EAAGA,KAFH;AAGLZ,MAAAA,OAAO,EAAGA;AAHL,KAAP;AAKD,GA5XD;;AAAA;AAAA;AAAA;AAAA","sourcesContent":["// @flow\n\nconst autoprefixer = require(`autoprefixer`)\nconst flexbugs = require(`postcss-flexbugs-fixes`)\nconst TerserPlugin = require(`terser-webpack-plugin`)\nconst MiniCssExtractPlugin = require(`mini-css-extract-plugin`)\nconst OptimizeCssAssetsPlugin = require(`optimize-css-assets-webpack-plugin`)\nconst isWsl = require(`is-wsl`)\n\nconst GatsbyWebpackStatsExtractor = require(`./gatsby-webpack-stats-extractor`)\n\nconst builtinPlugins = require(`./webpack-plugins`)\nconst eslintConfig = require(`./eslint-config`)\n\ntype LoaderSpec = string | { loader: string, options?: Object }\ntype LoaderResolver<T: Object> = (options?: T) => LoaderSpec\n\ntype Condition = string | RegExp | RegExp[]\n\ntype Rule = {\n  test?: Condition,\n  use: LoaderSpec[],\n  exclude?: Condition,\n  include?: Condition,\n}\n\ntype RuleFactory<T: Object> = (options?: T) => Rule\n\ntype ContextualRuleFactory = RuleFactory<*> & {\n  internal: RuleFactory<*>,\n  external: RuleFactory<*>,\n}\n\ntype PluginInstance = any\ntype PluginFactory = (...args?: any) => PluginInstance\n\ntype BuiltinPlugins = typeof builtinPlugins\n\ntype Stage = \"develop\" | \"develop-html\" | \"build-javascript\" | \"build-html\"\n\n/**\n * Configuration options for `createUtils`\n */\nexport type WebpackUtilsOptions = { stage: Stage, program: any }\n\n/**\n * Utils that produce webpack `loader` objects\n */\nexport type LoaderUtils = {\n  json: LoaderResolver<*>,\n  yaml: LoaderResolver<*>,\n  null: LoaderResolver<*>,\n  raw: LoaderResolver<*>,\n\n  style: LoaderResolver<*>,\n  css: LoaderResolver<*>,\n  postcss: LoaderResolver<{\n    browsers?: string[],\n    plugins?: Array<any> | ((loader: any) => Array<any>),\n  }>,\n\n  file: LoaderResolver<*>,\n  url: LoaderResolver<*>,\n  js: LoaderResolver<*>,\n\n  miniCssExtract: LoaderResolver<*>,\n  imports: LoaderResolver<*>,\n  exports: LoaderResolver<*>,\n\n  eslint: LoaderResolver<*>,\n}\n\n/**\n * Utils that produce webpack rule objects\n */\nexport type RuleUtils = {\n  /**\n   * Handles JavaScript compilation via babel\n   */\n  js: RuleFactory<*>,\n  yaml: RuleFactory<*>,\n  fonts: RuleFactory<*>,\n  images: RuleFactory<*>,\n  miscAssets: RuleFactory<*>,\n\n  css: ContextualRuleFactory,\n  cssModules: RuleFactory<*>,\n  postcss: ContextualRuleFactory,\n\n  eslint: RuleFactory<*>,\n}\n\nexport type PluginUtils = BuiltinPlugins & {\n  extractText: PluginFactory,\n  uglify: PluginFactory,\n  moment: PluginFactory,\n  extractStats: PluginFactory,\n}\n\n/**\n * webpack atoms namespace\n */\nexport type WebpackUtils = {\n  loaders: LoaderUtils,\n\n  rules: RuleUtils,\n\n  plugins: PluginUtils,\n}\n\n/**\n * A factory method that produces an atoms namespace\n */\nmodule.exports = async ({\n  stage,\n  program,\n}: {\n  stage: Stage,\n  program: any,\n}): Promise<WebpackUtilsOptions> => {\n  const assetRelativeRoot = `static/`\n  const vendorRegex = /(node_modules|bower_components)/\n  const supportedBrowsers = program.browserslist\n\n  const PRODUCTION = !stage.includes(`develop`)\n\n  const isSSR = stage.includes(`html`)\n\n  const makeExternalOnly = (original: RuleFactory<*>) => (\n    options = {}\n  ): Rule => {\n    let rule = original(options)\n    rule.include = vendorRegex\n    return rule\n  }\n\n  const makeInternalOnly = (original: RuleFactory<*>) => (\n    options = {}\n  ): Rule => {\n    let rule = original(options)\n    rule.exclude = vendorRegex\n    return rule\n  }\n\n  let ident = 0\n\n  const loaders: LoaderUtils = {\n    json: (options = {}) => {\n      return {\n        options,\n        loader: require.resolve(`json-loader`),\n      }\n    },\n\n    yaml: (options = {}) => {\n      return {\n        options,\n        loader: require.resolve(`yaml-loader`),\n      }\n    },\n\n    null: (options = {}) => {\n      return {\n        options,\n        loader: require.resolve(`null-loader`),\n      }\n    },\n\n    raw: (options = {}) => {\n      return {\n        options,\n        loader: require.resolve(`raw-loader`),\n      }\n    },\n\n    style: (options = {}) => {\n      return {\n        options,\n        loader: require.resolve(`style-loader`),\n      }\n    },\n\n    miniCssExtract: (options = {}) => {\n      return {\n        options,\n        // use MiniCssExtractPlugin only on production builds\n        loader: PRODUCTION\n          ? MiniCssExtractPlugin.loader\n          : require.resolve(`style-loader`),\n      }\n    },\n\n    css: (options = {}) => {\n      return {\n        loader: isSSR\n          ? require.resolve(`css-loader/locals`)\n          : require.resolve(`css-loader`),\n        options: {\n          sourceMap: !PRODUCTION,\n          camelCase: `dashesOnly`,\n          // https://github.com/webpack-contrib/css-loader/issues/406\n          localIdentName: `[name]--[local]--[hash:base64:5]`,\n          ...options,\n        },\n      }\n    },\n\n    postcss: (options = {}) => {\n      let { plugins, browsers = supportedBrowsers, ...postcssOpts } = options\n\n      return {\n        loader: require.resolve(`postcss-loader`),\n        options: {\n          ident: `postcss-${++ident}`,\n          sourceMap: !PRODUCTION,\n          plugins: loader => {\n            plugins =\n              (typeof plugins === `function` ? plugins(loader) : plugins) || []\n\n            return [\n              flexbugs,\n              autoprefixer({ browsers, flexbox: `no-2009` }),\n              ...plugins,\n            ]\n          },\n          ...postcssOpts,\n        },\n      }\n    },\n\n    file: (options = {}) => {\n      return {\n        loader: require.resolve(`file-loader`),\n        options: {\n          name: `${assetRelativeRoot}[name]-[hash].[ext]`,\n          ...options,\n        },\n      }\n    },\n\n    url: (options = {}) => {\n      return {\n        loader: require.resolve(`url-loader`),\n        options: {\n          limit: 10000,\n          name: `${assetRelativeRoot}[name]-[hash].[ext]`,\n          ...options,\n        },\n      }\n    },\n\n    js: options => {\n      return {\n        options,\n        loader: require.resolve(`./babel-loader`),\n      }\n    },\n\n    eslint: (schema = ``) => {\n      const options = eslintConfig(schema)\n\n      return {\n        options,\n        loader: require.resolve(`eslint-loader`),\n      }\n    },\n\n    imports: (options = {}) => {\n      return {\n        options,\n        loader: require.resolve(`imports-loader`),\n      }\n    },\n\n    exports: (options = {}) => {\n      return {\n        options,\n        loader: require.resolve(`exports-loader`),\n      }\n    },\n  }\n\n  /**\n   * Rules\n   */\n  const rules = {}\n\n  /**\n   * JavaScript loader via babel, excludes node_modules\n   */\n  {\n    let js = (options = {}) => {\n      return {\n        test: /\\.jsx?$/,\n        exclude: vendorRegex,\n        use: [loaders.js(options)],\n      }\n    }\n\n    rules.js = js\n  }\n\n  /**\n   * mjs loader:\n   * webpack 4 has issues automatically dealing with\n   * the .mjs extension, thus we need to explicitly\n   * add this rule to use the default webpack js loader\n   */\n  {\n    let mjs = (options = {}) => {\n      return {\n        test: /\\.mjs$/,\n        include: /node_modules/,\n        type: `javascript/auto`,\n        ...options,\n      }\n    }\n\n    rules.mjs = mjs\n  }\n\n  {\n    let eslint = schema => {\n      return {\n        enforce: `pre`,\n        test: /\\.jsx?$/,\n        exclude: vendorRegex,\n        use: [loaders.eslint(schema)],\n      }\n    }\n\n    rules.eslint = eslint\n  }\n\n  rules.yaml = () => {\n    return {\n      test: /\\.ya?ml/,\n      use: [loaders.json(), loaders.yaml()],\n    }\n  }\n\n  /**\n   * Font loader\n   */\n  rules.fonts = () => {\n    return {\n      use: [loaders.url()],\n      test: /\\.(eot|otf|ttf|woff(2)?)(\\?.*)?$/,\n    }\n  }\n\n  /**\n   * Loads image assets, inlines images via a data URI if they are below\n   * the size threshold\n   */\n  rules.images = () => {\n    return {\n      use: [loaders.url()],\n      test: /\\.(ico|svg|jpg|jpeg|png|gif|webp)(\\?.*)?$/,\n    }\n  }\n\n  /**\n   * Loads audio and video and inlines them via a data URI if they are below\n   * the size threshold\n   */\n  rules.media = () => {\n    return {\n      use: [loaders.url()],\n      test: /\\.(mp4|webm|wav|mp3|m4a|aac|oga|flac)$/,\n    }\n  }\n\n  /**\n   * Loads assets without inlining\n   */\n  rules.miscAssets = () => {\n    return {\n      use: [loaders.file()],\n      test: /\\.pdf$/,\n    }\n  }\n\n  /**\n   * CSS style loader.\n   */\n  {\n    const css = ({ browsers, ...options } = {}) => {\n      const use = [\n        loaders.css({ ...options, importLoaders: 1 }),\n        loaders.postcss({ browsers }),\n      ]\n      if (!isSSR) use.unshift(loaders.miniCssExtract({ hmr: !options.modules }))\n\n      return {\n        use,\n        test: /\\.css$/,\n      }\n    }\n\n    /**\n     * CSS style loader, _excludes_ node_modules.\n     */\n    css.internal = makeInternalOnly(css)\n    css.external = makeExternalOnly(css)\n\n    const cssModules = options => {\n      const rule = css({ ...options, modules: true })\n      delete rule.exclude\n      rule.test = /\\.module\\.css$/\n      return rule\n    }\n\n    rules.css = css\n    rules.cssModules = cssModules\n  }\n\n  /**\n   * PostCSS loader.\n   */\n  {\n    const postcss = options => {\n      return {\n        test: /\\.css$/,\n        use: [loaders.css({ importLoaders: 1 }), loaders.postcss(options)],\n      }\n    }\n\n    /**\n     * PostCSS loader, _excludes_ node_modules.\n     */\n    postcss.internal = makeInternalOnly(postcss)\n    postcss.external = makeExternalOnly(postcss)\n    rules.postcss = postcss\n  }\n  /**\n   * Plugins\n   */\n  const plugins = { ...builtinPlugins }\n\n  /**\n   * Minify JavaScript code without regard for IE8. Attempts\n   * to parallelize the work to save time. Generally only add in Production\n   */\n  plugins.minifyJs = ({ terserOptions, ...options } = {}) =>\n    new TerserPlugin({\n      cache: true,\n      // We can't use parallel in WSL because of https://github.com/gatsbyjs/gatsby/issues/6540\n      // This issue was fixed in https://github.com/gatsbyjs/gatsby/pull/12636\n      parallel: !isWsl,\n      exclude: /\\.min\\.js/,\n      sourceMap: true,\n      terserOptions: {\n        ie8: false,\n        mangle: {\n          safari10: true,\n        },\n        parse: {\n          ecma: 8,\n        },\n        compress: {\n          ecma: 5,\n        },\n        output: {\n          ecma: 5,\n        },\n        ...terserOptions,\n      },\n      ...options,\n    })\n\n  plugins.minifyCss = (options = {}) => new OptimizeCssAssetsPlugin(options)\n\n  /**\n   * Extracts css requires into a single file;\n   * includes some reasonable defaults\n   */\n  plugins.extractText = options =>\n    new MiniCssExtractPlugin({\n      filename: `[name].[contenthash].css`,\n      chunkFilename: `[name].[contenthash].css`,\n      ...options,\n    })\n\n  plugins.moment = () => plugins.ignore(/^\\.\\/locale$/, /moment$/)\n\n  plugins.extractStats = options => new GatsbyWebpackStatsExtractor(options)\n\n  return {\n    loaders,\n    rules: (rules: RuleUtils),\n    plugins: (plugins: PluginUtils),\n  }\n}\n"],"file":"webpack-utils.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/utils/webpack-utils.js"],"names":["autoprefixer","require","flexbugs","TerserPlugin","MiniCssExtractPlugin","OptimizeCssAssetsPlugin","isWsl","GatsbyWebpackStatsExtractor","builtinPlugins","eslintConfig","module","exports","stage","program","assetRelativeRoot","vendorRegex","supportedBrowsers","browserslist","PRODUCTION","includes","isSSR","makeExternalOnly","original","options","rule","include","makeInternalOnly","exclude","ident","loaders","json","loader","resolve","yaml","null","raw","style","miniCssExtract","css","sourceMap","camelCase","localIdentName","postcss","plugins","browsers","postcssOpts","flexbox","file","name","url","limit","js","eslint","schema","imports","rules","test","use","mjs","type","enforce","fonts","images","media","miscAssets","importLoaders","unshift","hmr","modules","internal","external","cssModules","minifyJs","terserOptions","cache","parallel","ie8","mangle","safari10","parse","ecma","compress","output","minifyCss","extractText","filename","chunkFilename","moment","ignore","extractStats"],"mappings":"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","sourcesContent":["// @flow\n\nconst autoprefixer = require(`autoprefixer`)\nconst flexbugs = require(`postcss-flexbugs-fixes`)\nconst TerserPlugin = require(`terser-webpack-plugin`)\nconst MiniCssExtractPlugin = require(`mini-css-extract-plugin`)\nconst OptimizeCssAssetsPlugin = require(`optimize-css-assets-webpack-plugin`)\nconst isWsl = require(`is-wsl`)\n\nconst GatsbyWebpackStatsExtractor = require(`./gatsby-webpack-stats-extractor`)\n\nconst builtinPlugins = require(`./webpack-plugins`)\nconst eslintConfig = require(`./eslint-config`)\n\ntype LoaderSpec = string | { loader: string, options?: Object }\ntype LoaderResolver<T: Object> = (options?: T) => LoaderSpec\n\ntype Condition = string | RegExp | RegExp[]\n\ntype Rule = {\n  test?: Condition,\n  use: LoaderSpec[],\n  exclude?: Condition,\n  include?: Condition,\n}\n\ntype RuleFactory<T: Object> = (options?: T) => Rule\n\ntype ContextualRuleFactory = RuleFactory<*> & {\n  internal: RuleFactory<*>,\n  external: RuleFactory<*>,\n}\n\ntype PluginInstance = any\ntype PluginFactory = (...args?: any) => PluginInstance\n\ntype BuiltinPlugins = typeof builtinPlugins\n\ntype Stage = \"develop\" | \"develop-html\" | \"build-javascript\" | \"build-html\"\n\n/**\n * Configuration options for `createUtils`\n */\nexport type WebpackUtilsOptions = { stage: Stage, program: any }\n\n/**\n * Utils that produce webpack `loader` objects\n */\nexport type LoaderUtils = {\n  json: LoaderResolver<*>,\n  yaml: LoaderResolver<*>,\n  null: LoaderResolver<*>,\n  raw: LoaderResolver<*>,\n\n  style: LoaderResolver<*>,\n  css: LoaderResolver<*>,\n  postcss: LoaderResolver<{\n    browsers?: string[],\n    plugins?: Array<any> | ((loader: any) => Array<any>),\n  }>,\n\n  file: LoaderResolver<*>,\n  url: LoaderResolver<*>,\n  js: LoaderResolver<*>,\n\n  miniCssExtract: LoaderResolver<*>,\n  imports: LoaderResolver<*>,\n  exports: LoaderResolver<*>,\n\n  eslint: LoaderResolver<*>,\n}\n\n/**\n * Utils that produce webpack rule objects\n */\nexport type RuleUtils = {\n  /**\n   * Handles JavaScript compilation via babel\n   */\n  js: RuleFactory<*>,\n  yaml: RuleFactory<*>,\n  fonts: RuleFactory<*>,\n  images: RuleFactory<*>,\n  miscAssets: RuleFactory<*>,\n\n  css: ContextualRuleFactory,\n  cssModules: RuleFactory<*>,\n  postcss: ContextualRuleFactory,\n\n  eslint: RuleFactory<*>,\n}\n\nexport type PluginUtils = BuiltinPlugins & {\n  extractText: PluginFactory,\n  uglify: PluginFactory,\n  moment: PluginFactory,\n  extractStats: PluginFactory,\n}\n\n/**\n * webpack atoms namespace\n */\nexport type WebpackUtils = {\n  loaders: LoaderUtils,\n\n  rules: RuleUtils,\n\n  plugins: PluginUtils,\n}\n\n/**\n * A factory method that produces an atoms namespace\n */\nmodule.exports = async ({\n  stage,\n  program,\n}: {\n  stage: Stage,\n  program: any,\n}): Promise<WebpackUtilsOptions> => {\n  const assetRelativeRoot = `static/`\n  const vendorRegex = /(node_modules|bower_components)/\n  const supportedBrowsers = program.browserslist\n\n  const PRODUCTION = !stage.includes(`develop`)\n\n  const isSSR = stage.includes(`html`)\n\n  const makeExternalOnly = (original: RuleFactory<*>) => (\n    options = {}\n  ): Rule => {\n    let rule = original(options)\n    rule.include = vendorRegex\n    return rule\n  }\n\n  const makeInternalOnly = (original: RuleFactory<*>) => (\n    options = {}\n  ): Rule => {\n    let rule = original(options)\n    rule.exclude = vendorRegex\n    return rule\n  }\n\n  let ident = 0\n\n  const loaders: LoaderUtils = {\n    json: (options = {}) => {\n      return {\n        options,\n        loader: require.resolve(`json-loader`),\n      }\n    },\n\n    yaml: (options = {}) => {\n      return {\n        options,\n        loader: require.resolve(`yaml-loader`),\n      }\n    },\n\n    null: (options = {}) => {\n      return {\n        options,\n        loader: require.resolve(`null-loader`),\n      }\n    },\n\n    raw: (options = {}) => {\n      return {\n        options,\n        loader: require.resolve(`raw-loader`),\n      }\n    },\n\n    style: (options = {}) => {\n      return {\n        options,\n        loader: require.resolve(`style-loader`),\n      }\n    },\n\n    miniCssExtract: (options = {}) => {\n      return {\n        options,\n        // use MiniCssExtractPlugin only on production builds\n        loader: PRODUCTION\n          ? MiniCssExtractPlugin.loader\n          : require.resolve(`style-loader`),\n      }\n    },\n\n    css: (options = {}) => {\n      return {\n        loader: isSSR\n          ? require.resolve(`css-loader/locals`)\n          : require.resolve(`css-loader`),\n        options: {\n          sourceMap: !PRODUCTION,\n          camelCase: `dashesOnly`,\n          // https://github.com/webpack-contrib/css-loader/issues/406\n          localIdentName: `[name]--[local]--[hash:base64:5]`,\n          ...options,\n        },\n      }\n    },\n\n    postcss: (options = {}) => {\n      let { plugins, browsers = supportedBrowsers, ...postcssOpts } = options\n\n      return {\n        loader: require.resolve(`postcss-loader`),\n        options: {\n          ident: `postcss-${++ident}`,\n          sourceMap: !PRODUCTION,\n          plugins: loader => {\n            plugins =\n              (typeof plugins === `function` ? plugins(loader) : plugins) || []\n\n            return [\n              flexbugs,\n              autoprefixer({ browsers, flexbox: `no-2009` }),\n              ...plugins,\n            ]\n          },\n          ...postcssOpts,\n        },\n      }\n    },\n\n    file: (options = {}) => {\n      return {\n        loader: require.resolve(`file-loader`),\n        options: {\n          name: `${assetRelativeRoot}[name]-[hash].[ext]`,\n          ...options,\n        },\n      }\n    },\n\n    url: (options = {}) => {\n      return {\n        loader: require.resolve(`url-loader`),\n        options: {\n          limit: 10000,\n          name: `${assetRelativeRoot}[name]-[hash].[ext]`,\n          ...options,\n        },\n      }\n    },\n\n    js: options => {\n      return {\n        options,\n        loader: require.resolve(`./babel-loader`),\n      }\n    },\n\n    eslint: (schema = ``) => {\n      const options = eslintConfig(schema)\n\n      return {\n        options,\n        loader: require.resolve(`eslint-loader`),\n      }\n    },\n\n    imports: (options = {}) => {\n      return {\n        options,\n        loader: require.resolve(`imports-loader`),\n      }\n    },\n\n    exports: (options = {}) => {\n      return {\n        options,\n        loader: require.resolve(`exports-loader`),\n      }\n    },\n  }\n\n  /**\n   * Rules\n   */\n  const rules = {}\n\n  /**\n   * JavaScript loader via babel, excludes node_modules\n   */\n  {\n    let js = (options = {}) => {\n      return {\n        test: /\\.jsx?$/,\n        exclude: vendorRegex,\n        use: [loaders.js(options)],\n      }\n    }\n\n    rules.js = js\n  }\n\n  /**\n   * mjs loader:\n   * webpack 4 has issues automatically dealing with\n   * the .mjs extension, thus we need to explicitly\n   * add this rule to use the default webpack js loader\n   */\n  {\n    let mjs = (options = {}) => {\n      return {\n        test: /\\.mjs$/,\n        include: /node_modules/,\n        type: `javascript/auto`,\n        ...options,\n      }\n    }\n\n    rules.mjs = mjs\n  }\n\n  {\n    let eslint = schema => {\n      return {\n        enforce: `pre`,\n        test: /\\.jsx?$/,\n        exclude: vendorRegex,\n        use: [loaders.eslint(schema)],\n      }\n    }\n\n    rules.eslint = eslint\n  }\n\n  rules.yaml = () => {\n    return {\n      test: /\\.ya?ml/,\n      use: [loaders.json(), loaders.yaml()],\n    }\n  }\n\n  /**\n   * Font loader\n   */\n  rules.fonts = () => {\n    return {\n      use: [loaders.url()],\n      test: /\\.(eot|otf|ttf|woff(2)?)(\\?.*)?$/,\n    }\n  }\n\n  /**\n   * Loads image assets, inlines images via a data URI if they are below\n   * the size threshold\n   */\n  rules.images = () => {\n    return {\n      use: [loaders.url()],\n      test: /\\.(ico|svg|jpg|jpeg|png|gif|webp)(\\?.*)?$/,\n    }\n  }\n\n  /**\n   * Loads audio and video and inlines them via a data URI if they are below\n   * the size threshold\n   */\n  rules.media = () => {\n    return {\n      use: [loaders.url()],\n      test: /\\.(mp4|webm|wav|mp3|m4a|aac|oga|flac)$/,\n    }\n  }\n\n  /**\n   * Loads assets without inlining\n   */\n  rules.miscAssets = () => {\n    return {\n      use: [loaders.file()],\n      test: /\\.pdf$/,\n    }\n  }\n\n  /**\n   * CSS style loader.\n   */\n  {\n    const css = ({ browsers, ...options } = {}) => {\n      const use = [\n        loaders.css({ ...options, importLoaders: 1 }),\n        loaders.postcss({ browsers }),\n      ]\n      if (!isSSR) use.unshift(loaders.miniCssExtract({ hmr: !options.modules }))\n\n      return {\n        use,\n        test: /\\.css$/,\n      }\n    }\n\n    /**\n     * CSS style loader, _excludes_ node_modules.\n     */\n    css.internal = makeInternalOnly(css)\n    css.external = makeExternalOnly(css)\n\n    const cssModules = options => {\n      const rule = css({ ...options, modules: true })\n      delete rule.exclude\n      rule.test = /\\.module\\.css$/\n      return rule\n    }\n\n    rules.css = css\n    rules.cssModules = cssModules\n  }\n\n  /**\n   * PostCSS loader.\n   */\n  {\n    const postcss = options => {\n      return {\n        test: /\\.css$/,\n        use: [loaders.css({ importLoaders: 1 }), loaders.postcss(options)],\n      }\n    }\n\n    /**\n     * PostCSS loader, _excludes_ node_modules.\n     */\n    postcss.internal = makeInternalOnly(postcss)\n    postcss.external = makeExternalOnly(postcss)\n    rules.postcss = postcss\n  }\n  /**\n   * Plugins\n   */\n  const plugins = { ...builtinPlugins }\n\n  /**\n   * Minify JavaScript code without regard for IE8. Attempts\n   * to parallelize the work to save time. Generally only add in Production\n   */\n  plugins.minifyJs = ({ terserOptions, ...options } = {}) =>\n    new TerserPlugin({\n      cache: true,\n      // We can't use parallel in WSL because of https://github.com/gatsbyjs/gatsby/issues/6540\n      // This issue was fixed in https://github.com/gatsbyjs/gatsby/pull/12636\n      parallel: !isWsl,\n      exclude: /\\.min\\.js/,\n      sourceMap: true,\n      terserOptions: {\n        ie8: false,\n        mangle: {\n          safari10: true,\n        },\n        parse: {\n          ecma: 8,\n        },\n        compress: {\n          ecma: 5,\n        },\n        output: {\n          ecma: 5,\n        },\n        ...terserOptions,\n      },\n      ...options,\n    })\n\n  plugins.minifyCss = (options = {}) => new OptimizeCssAssetsPlugin(options)\n\n  /**\n   * Extracts css requires into a single file;\n   * includes some reasonable defaults\n   */\n  plugins.extractText = options =>\n    new MiniCssExtractPlugin({\n      filename: `[name].[contenthash].css`,\n      chunkFilename: `[name].[contenthash].css`,\n      ...options,\n    })\n\n  plugins.moment = () => plugins.ignore(/^\\.\\/locale$/, /moment$/)\n\n  plugins.extractStats = options => new GatsbyWebpackStatsExtractor(options)\n\n  return {\n    loaders,\n    rules: (rules: RuleUtils),\n    plugins: (plugins: PluginUtils),\n  }\n}\n"],"file":"webpack-utils.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/utils/webpack.config.js b/node_modules/gatsby/dist/utils/webpack.config.js
index d94fbe1..1efd672 100644
--- a/node_modules/gatsby/dist/utils/webpack.config.js
+++ b/node_modules/gatsby/dist/utils/webpack.config.js
@@ -1,9 +1,5 @@
 "use strict";
 
-var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
-
-var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
-
 require(`v8-compile-cache`);
 
 const fs = require(`fs-extra`);
@@ -16,18 +12,21 @@ const FriendlyErrorsWebpackPlugin = require(`@pieh/friendly-errors-webpack-plugi
 
 const PnpWebpackPlugin = require(`pnp-webpack-plugin`);
 
-const _require = require(`../redux`),
-      store = _require.store;
+const {
+  store
+} = require(`../redux`);
 
-const _require2 = require(`../redux/actions`),
-      actions = _require2.actions;
+const {
+  actions
+} = require(`../redux/actions`);
 
 const debug = require(`debug`)(`gatsby:webpack-config`);
 
 const report = require(`gatsby-cli/lib/reporter`);
 
-const _require3 = require(`./path`),
-      withBasePath = _require3.withBasePath;
+const {
+  withBasePath
+} = require(`./path`);
 
 const apiRunnerNode = require(`./api-runner-node`);
 
@@ -40,404 +39,396 @@ const hasLocalEslint = require(`./local-eslint-config-finder`); // Four stages o
 //   4) build-html: build all HTML files
 
 
-module.exports =
-/*#__PURE__*/
-function () {
-  var _ref = (0, _asyncToGenerator2.default)(function* (program, directory, suppliedStage, webpackPort = 1500) {
-    const directoryPath = withBasePath(directory);
-    process.env.GATSBY_BUILD_STAGE = suppliedStage; // We combine develop & develop-html stages for purposes of generating the
-    // webpack config.
+module.exports = async (program, directory, suppliedStage, webpackPort = 1500) => {
+  const directoryPath = withBasePath(directory);
+  process.env.GATSBY_BUILD_STAGE = suppliedStage; // We combine develop & develop-html stages for purposes of generating the
+  // webpack config.
 
-    const stage = suppliedStage;
+  const stage = suppliedStage;
+  const {
+    rules,
+    loaders,
+    plugins
+  } = await createUtils({
+    stage,
+    program
+  });
 
-    const _ref2 = yield createUtils({
-      stage,
-      program
-    }),
-          rules = _ref2.rules,
-          loaders = _ref2.loaders,
-          plugins = _ref2.plugins;
-
-    function processEnv(stage, defaultNodeEnv) {
-      debug(`Building env for "${stage}"`);
-      const env = process.env.GATSBY_ACTIVE_ENV || process.env.NODE_ENV || `${defaultNodeEnv}`;
-      const envFile = path.join(process.cwd(), `./.env.${env}`);
-      let parsed = {};
-
-      try {
-        parsed = dotenv.parse(fs.readFileSync(envFile, {
-          encoding: `utf8`
-        }));
-      } catch (err) {
-        if (err.code !== `ENOENT`) {
-          report.error(`There was a problem processing the .env file`, err);
-        }
+  function processEnv(stage, defaultNodeEnv) {
+    debug(`Building env for "${stage}"`);
+    const env = process.env.GATSBY_ACTIVE_ENV || process.env.NODE_ENV || `${defaultNodeEnv}`;
+    const envFile = path.join(process.cwd(), `./.env.${env}`);
+    let parsed = {};
+
+    try {
+      parsed = dotenv.parse(fs.readFileSync(envFile, {
+        encoding: `utf8`
+      }));
+    } catch (err) {
+      if (err.code !== `ENOENT`) {
+        report.error(`There was a problem processing the .env file`, err);
       }
-
-      const envObject = Object.keys(parsed).reduce((acc, key) => {
-        acc[key] = JSON.stringify(parsed[key]);
-        return acc;
-      }, {});
-      const gatsbyVarObject = Object.keys(process.env).reduce((acc, key) => {
-        if (key.match(/^GATSBY_/)) {
-          acc[key] = JSON.stringify(process.env[key]);
-        }
-
-        return acc;
-      }, {}); // Don't allow overwriting of NODE_ENV, PUBLIC_DIR as to not break gatsby things
-
-      envObject.NODE_ENV = JSON.stringify(env);
-      envObject.PUBLIC_DIR = JSON.stringify(`${process.cwd()}/public`);
-      envObject.BUILD_STAGE = JSON.stringify(stage);
-      envObject.CYPRESS_SUPPORT = JSON.stringify(process.env.CYPRESS_SUPPORT);
-      const mergedEnvVars = Object.assign(envObject, gatsbyVarObject);
-      return Object.keys(mergedEnvVars).reduce((acc, key) => {
-        acc[`process.env.${key}`] = mergedEnvVars[key];
-        return acc;
-      }, {
-        "process.env": JSON.stringify({})
-      });
     }
 
-    function getHmrPath() {
-      // ref: https://github.com/gatsbyjs/gatsby/issues/8348
-      let hmrBasePath = `/`;
-      const hmrSuffix = `__webpack_hmr&reload=true&overlay=false`;
+    const envObject = Object.keys(parsed).reduce((acc, key) => {
+      acc[key] = JSON.stringify(parsed[key]);
+      return acc;
+    }, {});
+    const gatsbyVarObject = Object.keys(process.env).reduce((acc, key) => {
+      if (key.match(/^GATSBY_/)) {
+        acc[key] = JSON.stringify(process.env[key]);
+      }
 
-      if (process.env.GATSBY_WEBPACK_PUBLICPATH) {
-        const pubPath = process.env.GATSBY_WEBPACK_PUBLICPATH;
+      return acc;
+    }, {}); // Don't allow overwriting of NODE_ENV, PUBLIC_DIR as to not break gatsby things
+
+    envObject.NODE_ENV = JSON.stringify(env);
+    envObject.PUBLIC_DIR = JSON.stringify(`${process.cwd()}/public`);
+    envObject.BUILD_STAGE = JSON.stringify(stage);
+    envObject.CYPRESS_SUPPORT = JSON.stringify(process.env.CYPRESS_SUPPORT);
+    const mergedEnvVars = Object.assign(envObject, gatsbyVarObject);
+    return Object.keys(mergedEnvVars).reduce((acc, key) => {
+      acc[`process.env.${key}`] = mergedEnvVars[key];
+      return acc;
+    }, {
+      "process.env": JSON.stringify({})
+    });
+  }
 
-        if (pubPath.substr(-1) === `/`) {
-          hmrBasePath = pubPath;
-        } else {
-          hmrBasePath = `${pubPath}/`;
-        }
-      }
+  function getHmrPath() {
+    // ref: https://github.com/gatsbyjs/gatsby/issues/8348
+    let hmrBasePath = `/`;
+    const hmrSuffix = `__webpack_hmr&reload=true&overlay=false`;
 
-      return hmrBasePath + hmrSuffix;
-    }
+    if (process.env.GATSBY_WEBPACK_PUBLICPATH) {
+      const pubPath = process.env.GATSBY_WEBPACK_PUBLICPATH;
 
-    debug(`Loading webpack config for stage "${stage}"`);
-
-    function getOutput() {
-      switch (stage) {
-        case `develop`:
-          return {
-            path: directory,
-            filename: `[name].js`,
-            // Add /* filename */ comments to generated require()s in the output.
-            pathinfo: true,
-            // Point sourcemap entries to original disk location (format as URL on Windows)
-            publicPath: process.env.GATSBY_WEBPACK_PUBLICPATH || `/`,
-            devtoolModuleFilenameTemplate: info => path.resolve(info.absoluteResourcePath).replace(/\\/g, `/`),
-            // Avoid React cross-origin errors
-            // See https://reactjs.org/docs/cross-origin-errors.html
-            crossOriginLoading: `anonymous`
-          };
-
-        case `build-html`:
-        case `develop-html`:
-          // A temp file required by static-site-generator-plugin. See plugins() below.
-          // Deleted by build-html.js, since it's not needed for production.
-          return {
-            path: directoryPath(`public`),
-            filename: `render-page.js`,
-            libraryTarget: `umd`,
-            library: `lib`,
-            umdNamedDefine: true,
-            globalObject: `this`,
-            publicPath: program.prefixPaths ? `${store.getState().config.pathPrefix}/` : `/`
-          };
-
-        case `build-javascript`:
-          return {
-            filename: `[name]-[contenthash].js`,
-            chunkFilename: `[name]-[contenthash].js`,
-            path: directoryPath(`public`),
-            publicPath: program.prefixPaths ? `${store.getState().config.pathPrefix}/` : `/`
-          };
-
-        default:
-          throw new Error(`The state requested ${stage} doesn't exist.`);
+      if (pubPath.substr(-1) === `/`) {
+        hmrBasePath = pubPath;
+      } else {
+        hmrBasePath = `${pubPath}/`;
       }
     }
 
-    function getEntry() {
-      switch (stage) {
-        case `develop`:
-          return {
-            commons: [`event-source-polyfill`, `${require.resolve(`webpack-hot-middleware/client`)}?path=${getHmrPath()}`, directoryPath(`.cache/app`)]
-          };
-
-        case `develop-html`:
-          return {
-            main: directoryPath(`.cache/develop-static-entry`)
-          };
-
-        case `build-html`:
-          return {
-            main: directoryPath(`.cache/static-entry`)
-          };
-
-        case `build-javascript`:
-          return {
-            app: directoryPath(`.cache/production-app`)
-          };
-
-        default:
-          throw new Error(`The state requested ${stage} doesn't exist.`);
-      }
+    return hmrBasePath + hmrSuffix;
+  }
+
+  debug(`Loading webpack config for stage "${stage}"`);
+
+  function getOutput() {
+    switch (stage) {
+      case `develop`:
+        return {
+          path: directory,
+          filename: `[name].js`,
+          // Add /* filename */ comments to generated require()s in the output.
+          pathinfo: true,
+          // Point sourcemap entries to original disk location (format as URL on Windows)
+          publicPath: process.env.GATSBY_WEBPACK_PUBLICPATH || `/`,
+          devtoolModuleFilenameTemplate: info => path.resolve(info.absoluteResourcePath).replace(/\\/g, `/`),
+          // Avoid React cross-origin errors
+          // See https://reactjs.org/docs/cross-origin-errors.html
+          crossOriginLoading: `anonymous`
+        };
+
+      case `build-html`:
+      case `develop-html`:
+        // A temp file required by static-site-generator-plugin. See plugins() below.
+        // Deleted by build-html.js, since it's not needed for production.
+        return {
+          path: directoryPath(`public`),
+          filename: `render-page.js`,
+          libraryTarget: `umd`,
+          library: `lib`,
+          umdNamedDefine: true,
+          globalObject: `this`,
+          publicPath: program.prefixPaths ? `${store.getState().config.pathPrefix}/` : `/`
+        };
+
+      case `build-javascript`:
+        return {
+          filename: `[name]-[contenthash].js`,
+          chunkFilename: `[name]-[contenthash].js`,
+          path: directoryPath(`public`),
+          publicPath: program.prefixPaths ? `${store.getState().config.pathPrefix}/` : `/`
+        };
+
+      default:
+        throw new Error(`The state requested ${stage} doesn't exist.`);
     }
-
-    function getPlugins() {
-      let configPlugins = [plugins.moment(), // Add a few global variables. Set NODE_ENV to production (enables
-      // optimizations for React) and what the link prefix is (__PATH_PREFIX__).
-      plugins.define(Object.assign({}, processEnv(stage, `development`), {
-        __PATH_PREFIX__: JSON.stringify(program.prefixPaths ? store.getState().config.pathPrefix : ``)
-      }))];
-
-      switch (stage) {
-        case `develop`:
-          configPlugins = configPlugins.concat([plugins.hotModuleReplacement(), plugins.noEmitOnErrors(), new FriendlyErrorsWebpackPlugin({
-            clearConsole: false
-          })]);
+  }
+
+  function getEntry() {
+    switch (stage) {
+      case `develop`:
+        return {
+          commons: [`event-source-polyfill`, `${require.resolve(`webpack-hot-middleware/client`)}?path=${getHmrPath()}`, directoryPath(`.cache/app`)]
+        };
+
+      case `develop-html`:
+        return {
+          main: directoryPath(`.cache/develop-static-entry`)
+        };
+
+      case `build-html`:
+        return {
+          main: directoryPath(`.cache/static-entry`)
+        };
+
+      case `build-javascript`:
+        return {
+          app: directoryPath(`.cache/production-app`)
+        };
+
+      default:
+        throw new Error(`The state requested ${stage} doesn't exist.`);
+    }
+  }
+
+  function getPlugins() {
+    let configPlugins = [plugins.moment(), // Add a few global variables. Set NODE_ENV to production (enables
+    // optimizations for React) and what the link prefix is (__PATH_PREFIX__).
+    plugins.define({ ...processEnv(stage, `development`),
+      __PATH_PREFIX__: JSON.stringify(program.prefixPaths ? store.getState().config.pathPrefix : ``)
+    })];
+
+    switch (stage) {
+      case `develop`:
+        configPlugins = configPlugins.concat([plugins.hotModuleReplacement(), plugins.noEmitOnErrors(), new FriendlyErrorsWebpackPlugin({
+          clearConsole: false
+        })]);
+        break;
+
+      case `build-javascript`:
+        {
+          configPlugins = configPlugins.concat([plugins.extractText(), // Write out stats object mapping named dynamic imports (aka page
+          // components) to all their async chunks.
+          plugins.extractStats()]);
           break;
-
-        case `build-javascript`:
-          {
-            configPlugins = configPlugins.concat([plugins.extractText(), // Write out stats object mapping named dynamic imports (aka page
-            // components) to all their async chunks.
-            plugins.extractStats()]);
-            break;
-          }
-      }
-
-      return configPlugins;
+        }
     }
 
-    function getDevtool() {
-      switch (stage) {
-        case `develop`:
-          return `cheap-module-source-map`;
-        // use a normal `source-map` for the html phases since
-        // it gives better line and column numbers
+    return configPlugins;
+  }
 
-        case `develop-html`:
-        case `build-html`:
-        case `build-javascript`:
-          return `source-map`;
+  function getDevtool() {
+    switch (stage) {
+      case `develop`:
+        return `cheap-module-source-map`;
+      // use a normal `source-map` for the html phases since
+      // it gives better line and column numbers
 
-        default:
-          return false;
-      }
-    }
+      case `develop-html`:
+      case `build-html`:
+      case `build-javascript`:
+        return `source-map`;
 
-    function getMode() {
-      switch (stage) {
-        case `build-javascript`:
-          return `production`;
-
-        case `develop`:
-        case `develop-html`:
-        case `build-html`:
-          return `development`;
-        // So we don't uglify the html bundle
-
-        default:
-          return `production`;
-      }
+      default:
+        return false;
     }
+  }
 
-    function getModule(config) {
-      // Common config for every env.
-      // prettier-ignore
-      let configRules = [rules.mjs(), rules.js(), rules.yaml(), rules.fonts(), rules.images(), rules.media(), rules.miscAssets()];
-
-      switch (stage) {
-        case `develop`:
-          {
-            // get schema to pass to eslint config and program for directory
-            const _store$getState = store.getState(),
-                  schema = _store$getState.schema,
-                  program = _store$getState.program; // if no local eslint config, then add gatsby config
+  function getMode() {
+    switch (stage) {
+      case `build-javascript`:
+        return `production`;
 
+      case `develop`:
+      case `develop-html`:
+      case `build-html`:
+        return `development`;
+      // So we don't uglify the html bundle
 
-            if (!hasLocalEslint(program.directory)) {
-              configRules = configRules.concat([rules.eslint(schema)]);
-            }
-
-            configRules = configRules.concat([{
-              oneOf: [rules.cssModules(), rules.css()]
-            }]);
-            break;
+      default:
+        return `production`;
+    }
+  }
+
+  function getModule(config) {
+    // Common config for every env.
+    // prettier-ignore
+    let configRules = [rules.mjs(), rules.js(), rules.yaml(), rules.fonts(), rules.images(), rules.media(), rules.miscAssets()];
+
+    switch (stage) {
+      case `develop`:
+        {
+          // get schema to pass to eslint config and program for directory
+          const {
+            schema,
+            program
+          } = store.getState(); // if no local eslint config, then add gatsby config
+
+          if (!hasLocalEslint(program.directory)) {
+            configRules = configRules.concat([rules.eslint(schema)]);
           }
 
-        case `build-html`:
-        case `develop-html`:
-          // We don't deal with CSS at all when building the HTML.
-          // The 'null' loader is used to prevent 'module not found' errors.
-          // On the other hand CSS modules loaders are necessary.
-          // prettier-ignore
-          configRules = configRules.concat([{
-            oneOf: [rules.cssModules(), Object.assign({}, rules.css(), {
-              use: [loaders.null()]
-            })]
-          }]);
-          break;
-
-        case `build-javascript`:
-          // We don't deal with CSS at all when building JavaScript but we still
-          // need to process the CSS so offline-plugin knows about the various
-          // assets referenced in your CSS.
-          //
-          // It's also necessary to process CSS Modules so your JS knows the
-          // classNames to use.
           configRules = configRules.concat([{
             oneOf: [rules.cssModules(), rules.css()]
           }]);
           break;
-      }
+        }
 
-      return {
-        rules: configRules
-      };
+      case `build-html`:
+      case `develop-html`:
+        // We don't deal with CSS at all when building the HTML.
+        // The 'null' loader is used to prevent 'module not found' errors.
+        // On the other hand CSS modules loaders are necessary.
+        // prettier-ignore
+        configRules = configRules.concat([{
+          oneOf: [rules.cssModules(), { ...rules.css(),
+            use: [loaders.null()]
+          }]
+        }]);
+        break;
+
+      case `build-javascript`:
+        // We don't deal with CSS at all when building JavaScript but we still
+        // need to process the CSS so offline-plugin knows about the various
+        // assets referenced in your CSS.
+        //
+        // It's also necessary to process CSS Modules so your JS knows the
+        // classNames to use.
+        configRules = configRules.concat([{
+          oneOf: [rules.cssModules(), rules.css()]
+        }]);
+        break;
     }
 
-    function getResolve() {
-      const _store$getState2 = store.getState(),
-            program = _store$getState2.program;
-
-      return {
-        // Use the program's extension list (generated via the
-        // 'resolvableExtensions' API hook).
-        extensions: [...program.extensions],
-        alias: {
-          gatsby$: directoryPath(path.join(`.cache`, `gatsby-browser-entry.js`)),
-          // Using directories for module resolution is mandatory because
-          // relative path imports are used sometimes
-          // See https://stackoverflow.com/a/49455609/6420957 for more details
-          "@babel/runtime": path.dirname(require.resolve(`@babel/runtime/package.json`)),
-          "core-js": path.dirname(require.resolve(`core-js/package.json`)),
-          "react-hot-loader": path.dirname(require.resolve(`react-hot-loader/package.json`)),
-          "react-lifecycles-compat": directoryPath(`.cache/react-lifecycles-compat.js`),
-          "create-react-context": directoryPath(`.cache/create-react-context.js`)
-        },
-        plugins: [// Those two folders are special and contain gatsby-generated files
-        // whose dependencies should be resolved through the `gatsby` package
-        PnpWebpackPlugin.bind(directoryPath(`.cache`), module), PnpWebpackPlugin.bind(directoryPath(`public`), module), // Transparently resolve packages via PnP when needed; noop otherwise
-        PnpWebpackPlugin]
-      };
-    }
+    return {
+      rules: configRules
+    };
+  }
 
-    function getResolveLoader() {
-      const root = [path.resolve(directory, `node_modules`)];
-      const userLoaderDirectoryPath = path.resolve(directory, `loaders`);
+  function getResolve() {
+    const {
+      program
+    } = store.getState();
+    return {
+      // Use the program's extension list (generated via the
+      // 'resolvableExtensions' API hook).
+      extensions: [...program.extensions],
+      alias: {
+        gatsby$: directoryPath(path.join(`.cache`, `gatsby-browser-entry.js`)),
+        // Using directories for module resolution is mandatory because
+        // relative path imports are used sometimes
+        // See https://stackoverflow.com/a/49455609/6420957 for more details
+        "@babel/runtime": path.dirname(require.resolve(`@babel/runtime/package.json`)),
+        "core-js": path.dirname(require.resolve(`core-js/package.json`)),
+        "react-hot-loader": path.dirname(require.resolve(`react-hot-loader/package.json`)),
+        "react-lifecycles-compat": directoryPath(`.cache/react-lifecycles-compat.js`),
+        "create-react-context": directoryPath(`.cache/create-react-context.js`)
+      },
+      plugins: [// Those two folders are special and contain gatsby-generated files
+      // whose dependencies should be resolved through the `gatsby` package
+      PnpWebpackPlugin.bind(directoryPath(`.cache`), module), PnpWebpackPlugin.bind(directoryPath(`public`), module), // Transparently resolve packages via PnP when needed; noop otherwise
+      PnpWebpackPlugin]
+    };
+  }
 
-      try {
-        if (fs.statSync(userLoaderDirectoryPath).isDirectory()) {
-          root.push(userLoaderDirectoryPath);
-        }
-      } catch (err) {
-        debug(`Error resolving user loaders directory`, err);
-      }
+  function getResolveLoader() {
+    const root = [path.resolve(directory, `node_modules`)];
+    const userLoaderDirectoryPath = path.resolve(directory, `loaders`);
 
-      return {
-        modules: [...root, path.join(__dirname, `../loaders`), `node_modules`],
-        // Bare loaders should always be loaded via the user dependencies (loaders
-        // configured via third-party like gatsby use require.resolve)
-        plugins: [PnpWebpackPlugin.moduleLoader(`${directory}/`)]
-      };
+    try {
+      if (fs.statSync(userLoaderDirectoryPath).isDirectory()) {
+        root.push(userLoaderDirectoryPath);
+      }
+    } catch (err) {
+      debug(`Error resolving user loaders directory`, err);
     }
 
-    const config = {
-      // Context is the base directory for resolving the entry option.
-      context: directory,
-      entry: getEntry(),
-      output: getOutput(),
-      module: getModule(),
-      plugins: getPlugins(),
-      // Certain "isomorphic" packages have different entry points for browser
-      // and server (see
-      // https://github.com/defunctzombie/package-browser-field-spec); setting
-      // the target tells webpack which file to include, ie. browser vs main.
-      target: stage === `build-html` || stage === `develop-html` ? `node` : `web`,
-      devtool: getDevtool(),
-      // Turn off performance hints as we (for now) don't want to show the normal
-      // webpack output anywhere.
-      performance: {
-        hints: false
-      },
-      mode: getMode(),
-      resolveLoader: getResolveLoader(),
-      resolve: getResolve(),
-      node: {
-        __filename: true
-      }
+    return {
+      modules: [...root, path.join(__dirname, `../loaders`), `node_modules`],
+      // Bare loaders should always be loaded via the user dependencies (loaders
+      // configured via third-party like gatsby use require.resolve)
+      plugins: [PnpWebpackPlugin.moduleLoader(`${directory}/`)]
     };
-
-    if (stage === `build-javascript`) {
-      config.optimization = {
-        runtimeChunk: {
-          name: `webpack-runtime`
-        },
-        splitChunks: {
-          name: false,
-          cacheGroups: {
-            // Only create one CSS file to avoid
-            // problems with code-split CSS loading in different orders
-            // causing inconsistent/non-determanistic styling
-            // See https://github.com/gatsbyjs/gatsby/issues/11072
-            styles: {
-              name: `styles`,
-              // This should cover all our types of CSS.
-              test: /\.(css|scss|sass|less|styl)$/,
-              chunks: `all`,
-              enforce: true
-            }
-          }
-        },
-        minimizer: [// TODO: maybe this option should be noMinimize?
-        !program.noUglify && plugins.minifyJs(), plugins.minifyCss()].filter(Boolean)
-      };
+  }
+
+  const config = {
+    // Context is the base directory for resolving the entry option.
+    context: directory,
+    entry: getEntry(),
+    output: getOutput(),
+    module: getModule(),
+    plugins: getPlugins(),
+    // Certain "isomorphic" packages have different entry points for browser
+    // and server (see
+    // https://github.com/defunctzombie/package-browser-field-spec); setting
+    // the target tells webpack which file to include, ie. browser vs main.
+    target: stage === `build-html` || stage === `develop-html` ? `node` : `web`,
+    devtool: getDevtool(),
+    // Turn off performance hints as we (for now) don't want to show the normal
+    // webpack output anywhere.
+    performance: {
+      hints: false
+    },
+    mode: getMode(),
+    resolveLoader: getResolveLoader(),
+    resolve: getResolve(),
+    node: {
+      __filename: true
     }
+  };
 
-    if (stage === `build-html` || stage === `develop-html`) {
-      const externalList = [// match `lodash` and `lodash/foo`
-      // but not things like `lodash-es`
-      `lodash`, /^lodash\//, `react`, /^react-dom\//, `pify`, `@reach/router`, `@reach/router/lib/history`, `common-tags`, `path`, `semver`, `react-helmet`, `minimatch`, `fs`, /^core-js\//, `es6-promise`, `crypto`, `zlib`, `http`, `https`, `debug`];
-      config.externals = [function (context, request, callback) {
-        if (externalList.some(item => {
-          if (typeof item === `string` && item === request) {
-            return true;
-          } else if (item instanceof RegExp && item.test(request)) {
-            return true;
+  if (stage === `build-javascript`) {
+    config.optimization = {
+      runtimeChunk: {
+        name: `webpack-runtime`
+      },
+      splitChunks: {
+        name: false,
+        cacheGroups: {
+          // Only create one CSS file to avoid
+          // problems with code-split CSS loading in different orders
+          // causing inconsistent/non-determanistic styling
+          // See https://github.com/gatsbyjs/gatsby/issues/11072
+          styles: {
+            name: `styles`,
+            // This should cover all our types of CSS.
+            test: /\.(css|scss|sass|less|styl)$/,
+            chunks: `all`,
+            enforce: true
           }
-
-          return false;
-        })) {
-          return callback(null, `umd ${request}`);
+        }
+      },
+      minimizer: [// TODO: maybe this option should be noMinimize?
+      !program.noUglify && plugins.minifyJs(), plugins.minifyCss()].filter(Boolean)
+    };
+  }
+
+  if (stage === `build-html` || stage === `develop-html`) {
+    const externalList = [// match `lodash` and `lodash/foo`
+    // but not things like `lodash-es`
+    `lodash`, /^lodash\//, `react`, /^react-dom\//, `pify`, `@reach/router`, `@reach/router/lib/history`, `common-tags`, `path`, `semver`, `react-helmet`, `minimatch`, `fs`, /^core-js\//, `es6-promise`, `crypto`, `zlib`, `http`, `https`, `debug`];
+    config.externals = [function (context, request, callback) {
+      if (externalList.some(item => {
+        if (typeof item === `string` && item === request) {
+          return true;
+        } else if (item instanceof RegExp && item.test(request)) {
+          return true;
         }
 
-        return callback();
-      }];
-    }
+        return false;
+      })) {
+        return callback(null, `umd ${request}`);
+      }
 
-    store.dispatch(actions.replaceWebpackConfig(config));
+      return callback();
+    }];
+  }
 
-    const getConfig = () => store.getState().webpack;
+  store.dispatch(actions.replaceWebpackConfig(config));
 
-    yield apiRunnerNode(`onCreateWebpackConfig`, {
-      getConfig,
-      stage,
-      rules,
-      loaders,
-      plugins
-    });
-    return getConfig();
-  });
+  const getConfig = () => store.getState().webpack;
 
-  return function (_x, _x2, _x3) {
-    return _ref.apply(this, arguments);
-  };
-}();
+  await apiRunnerNode(`onCreateWebpackConfig`, {
+    getConfig,
+    stage,
+    rules,
+    loaders,
+    plugins
+  });
+  return getConfig();
+};
 //# sourceMappingURL=webpack.config.js.map
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/utils/webpack.config.js.map b/node_modules/gatsby/dist/utils/webpack.config.js.map
index 5b4b015..3e974e9 100644
--- a/node_modules/gatsby/dist/utils/webpack.config.js.map
+++ b/node_modules/gatsby/dist/utils/webpack.config.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/utils/webpack.config.js"],"names":["require","fs","path","dotenv","FriendlyErrorsWebpackPlugin","PnpWebpackPlugin","store","actions","debug","report","withBasePath","apiRunnerNode","createUtils","hasLocalEslint","module","exports","program","directory","suppliedStage","webpackPort","directoryPath","process","env","GATSBY_BUILD_STAGE","stage","rules","loaders","plugins","processEnv","defaultNodeEnv","GATSBY_ACTIVE_ENV","NODE_ENV","envFile","join","cwd","parsed","parse","readFileSync","encoding","err","code","error","envObject","Object","keys","reduce","acc","key","JSON","stringify","gatsbyVarObject","match","PUBLIC_DIR","BUILD_STAGE","CYPRESS_SUPPORT","mergedEnvVars","assign","getHmrPath","hmrBasePath","hmrSuffix","GATSBY_WEBPACK_PUBLICPATH","pubPath","substr","getOutput","filename","pathinfo","publicPath","devtoolModuleFilenameTemplate","info","resolve","absoluteResourcePath","replace","crossOriginLoading","libraryTarget","library","umdNamedDefine","globalObject","prefixPaths","getState","config","pathPrefix","chunkFilename","Error","getEntry","commons","main","app","getPlugins","configPlugins","moment","define","__PATH_PREFIX__","concat","hotModuleReplacement","noEmitOnErrors","clearConsole","extractText","extractStats","getDevtool","getMode","getModule","configRules","mjs","js","yaml","fonts","images","media","miscAssets","schema","eslint","oneOf","cssModules","css","use","null","getResolve","extensions","alias","gatsby$","dirname","bind","getResolveLoader","root","userLoaderDirectoryPath","statSync","isDirectory","push","modules","__dirname","moduleLoader","context","entry","output","target","devtool","performance","hints","mode","resolveLoader","node","__filename","optimization","runtimeChunk","name","splitChunks","cacheGroups","styles","test","chunks","enforce","minimizer","noUglify","minifyJs","minifyCss","filter","Boolean","externalList","externals","request","callback","some","item","RegExp","dispatch","replaceWebpackConfig","getConfig","webpack"],"mappings":"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","sourcesContent":["require(`v8-compile-cache`)\n\nconst fs = require(`fs-extra`)\nconst path = require(`path`)\nconst dotenv = require(`dotenv`)\nconst FriendlyErrorsWebpackPlugin = require(`@pieh/friendly-errors-webpack-plugin`)\nconst PnpWebpackPlugin = require(`pnp-webpack-plugin`)\nconst { store } = require(`../redux`)\nconst { actions } = require(`../redux/actions`)\nconst debug = require(`debug`)(`gatsby:webpack-config`)\nconst report = require(`gatsby-cli/lib/reporter`)\nconst { withBasePath } = require(`./path`)\n\nconst apiRunnerNode = require(`./api-runner-node`)\nconst createUtils = require(`./webpack-utils`)\nconst hasLocalEslint = require(`./local-eslint-config-finder`)\n\n// Four stages or modes:\n//   1) develop: for `gatsby develop` command, hot reload and CSS injection into page\n//   2) develop-html: same as develop without react-hmre in the babel config for html renderer\n//   3) build-javascript: Build JS and CSS chunks for production\n//   4) build-html: build all HTML files\n\nmodule.exports = async (\n  program,\n  directory,\n  suppliedStage,\n  webpackPort = 1500\n) => {\n  const directoryPath = withBasePath(directory)\n\n  process.env.GATSBY_BUILD_STAGE = suppliedStage\n\n  // We combine develop & develop-html stages for purposes of generating the\n  // webpack config.\n  const stage = suppliedStage\n  const { rules, loaders, plugins } = await createUtils({ stage, program })\n\n  function processEnv(stage, defaultNodeEnv) {\n    debug(`Building env for \"${stage}\"`)\n    const env =\n      process.env.GATSBY_ACTIVE_ENV ||\n      process.env.NODE_ENV ||\n      `${defaultNodeEnv}`\n    const envFile = path.join(process.cwd(), `./.env.${env}`)\n    let parsed = {}\n    try {\n      parsed = dotenv.parse(fs.readFileSync(envFile, { encoding: `utf8` }))\n    } catch (err) {\n      if (err.code !== `ENOENT`) {\n        report.error(`There was a problem processing the .env file`, err)\n      }\n    }\n\n    const envObject = Object.keys(parsed).reduce((acc, key) => {\n      acc[key] = JSON.stringify(parsed[key])\n      return acc\n    }, {})\n\n    const gatsbyVarObject = Object.keys(process.env).reduce((acc, key) => {\n      if (key.match(/^GATSBY_/)) {\n        acc[key] = JSON.stringify(process.env[key])\n      }\n      return acc\n    }, {})\n\n    // Don't allow overwriting of NODE_ENV, PUBLIC_DIR as to not break gatsby things\n    envObject.NODE_ENV = JSON.stringify(env)\n    envObject.PUBLIC_DIR = JSON.stringify(`${process.cwd()}/public`)\n    envObject.BUILD_STAGE = JSON.stringify(stage)\n    envObject.CYPRESS_SUPPORT = JSON.stringify(process.env.CYPRESS_SUPPORT)\n\n    const mergedEnvVars = Object.assign(envObject, gatsbyVarObject)\n\n    return Object.keys(mergedEnvVars).reduce(\n      (acc, key) => {\n        acc[`process.env.${key}`] = mergedEnvVars[key]\n        return acc\n      },\n      {\n        \"process.env\": JSON.stringify({}),\n      }\n    )\n  }\n\n  function getHmrPath() {\n    // ref: https://github.com/gatsbyjs/gatsby/issues/8348\n    let hmrBasePath = `/`\n    const hmrSuffix = `__webpack_hmr&reload=true&overlay=false`\n\n    if (process.env.GATSBY_WEBPACK_PUBLICPATH) {\n      const pubPath = process.env.GATSBY_WEBPACK_PUBLICPATH\n      if (pubPath.substr(-1) === `/`) {\n        hmrBasePath = pubPath\n      } else {\n        hmrBasePath = `${pubPath}/`\n      }\n    }\n\n    return hmrBasePath + hmrSuffix\n  }\n\n  debug(`Loading webpack config for stage \"${stage}\"`)\n  function getOutput() {\n    switch (stage) {\n      case `develop`:\n        return {\n          path: directory,\n          filename: `[name].js`,\n          // Add /* filename */ comments to generated require()s in the output.\n          pathinfo: true,\n          // Point sourcemap entries to original disk location (format as URL on Windows)\n          publicPath: process.env.GATSBY_WEBPACK_PUBLICPATH || `/`,\n          devtoolModuleFilenameTemplate: info =>\n            path.resolve(info.absoluteResourcePath).replace(/\\\\/g, `/`),\n          // Avoid React cross-origin errors\n          // See https://reactjs.org/docs/cross-origin-errors.html\n          crossOriginLoading: `anonymous`,\n        }\n      case `build-html`:\n      case `develop-html`:\n        // A temp file required by static-site-generator-plugin. See plugins() below.\n        // Deleted by build-html.js, since it's not needed for production.\n        return {\n          path: directoryPath(`public`),\n          filename: `render-page.js`,\n          libraryTarget: `umd`,\n          library: `lib`,\n          umdNamedDefine: true,\n          globalObject: `this`,\n          publicPath: program.prefixPaths\n            ? `${store.getState().config.pathPrefix}/`\n            : `/`,\n        }\n      case `build-javascript`:\n        return {\n          filename: `[name]-[contenthash].js`,\n          chunkFilename: `[name]-[contenthash].js`,\n          path: directoryPath(`public`),\n          publicPath: program.prefixPaths\n            ? `${store.getState().config.pathPrefix}/`\n            : `/`,\n        }\n      default:\n        throw new Error(`The state requested ${stage} doesn't exist.`)\n    }\n  }\n\n  function getEntry() {\n    switch (stage) {\n      case `develop`:\n        return {\n          commons: [\n            `event-source-polyfill`,\n            `${require.resolve(\n              `webpack-hot-middleware/client`\n            )}?path=${getHmrPath()}`,\n            directoryPath(`.cache/app`),\n          ],\n        }\n      case `develop-html`:\n        return {\n          main: directoryPath(`.cache/develop-static-entry`),\n        }\n      case `build-html`:\n        return {\n          main: directoryPath(`.cache/static-entry`),\n        }\n      case `build-javascript`:\n        return {\n          app: directoryPath(`.cache/production-app`),\n        }\n      default:\n        throw new Error(`The state requested ${stage} doesn't exist.`)\n    }\n  }\n\n  function getPlugins() {\n    let configPlugins = [\n      plugins.moment(),\n\n      // Add a few global variables. Set NODE_ENV to production (enables\n      // optimizations for React) and what the link prefix is (__PATH_PREFIX__).\n      plugins.define({\n        ...processEnv(stage, `development`),\n        __PATH_PREFIX__: JSON.stringify(\n          program.prefixPaths ? store.getState().config.pathPrefix : ``\n        ),\n      }),\n    ]\n\n    switch (stage) {\n      case `develop`:\n        configPlugins = configPlugins.concat([\n          plugins.hotModuleReplacement(),\n          plugins.noEmitOnErrors(),\n\n          new FriendlyErrorsWebpackPlugin({\n            clearConsole: false,\n          }),\n        ])\n        break\n      case `build-javascript`: {\n        configPlugins = configPlugins.concat([\n          plugins.extractText(),\n          // Write out stats object mapping named dynamic imports (aka page\n          // components) to all their async chunks.\n          plugins.extractStats(),\n        ])\n        break\n      }\n    }\n\n    return configPlugins\n  }\n\n  function getDevtool() {\n    switch (stage) {\n      case `develop`:\n        return `cheap-module-source-map`\n      // use a normal `source-map` for the html phases since\n      // it gives better line and column numbers\n      case `develop-html`:\n      case `build-html`:\n      case `build-javascript`:\n        return `source-map`\n      default:\n        return false\n    }\n  }\n\n  function getMode() {\n    switch (stage) {\n      case `build-javascript`:\n        return `production`\n      case `develop`:\n      case `develop-html`:\n      case `build-html`:\n        return `development` // So we don't uglify the html bundle\n      default:\n        return `production`\n    }\n  }\n\n  function getModule(config) {\n    // Common config for every env.\n    // prettier-ignore\n    let configRules = [\n      rules.mjs(),\n      rules.js(),\n      rules.yaml(),\n      rules.fonts(),\n      rules.images(),\n      rules.media(),\n      rules.miscAssets(),\n    ]\n    switch (stage) {\n      case `develop`: {\n        // get schema to pass to eslint config and program for directory\n        const { schema, program } = store.getState()\n\n        // if no local eslint config, then add gatsby config\n        if (!hasLocalEslint(program.directory)) {\n          configRules = configRules.concat([rules.eslint(schema)])\n        }\n\n        configRules = configRules.concat([\n          {\n            oneOf: [rules.cssModules(), rules.css()],\n          },\n        ])\n\n        break\n      }\n      case `build-html`:\n      case `develop-html`:\n        // We don't deal with CSS at all when building the HTML.\n        // The 'null' loader is used to prevent 'module not found' errors.\n        // On the other hand CSS modules loaders are necessary.\n\n        // prettier-ignore\n        configRules = configRules.concat([\n          {\n            oneOf: [\n              rules.cssModules(),\n              {\n                ...rules.css(),\n                use: [loaders.null()],\n              },\n            ],\n          },\n        ])\n        break\n\n      case `build-javascript`:\n        // We don't deal with CSS at all when building JavaScript but we still\n        // need to process the CSS so offline-plugin knows about the various\n        // assets referenced in your CSS.\n        //\n        // It's also necessary to process CSS Modules so your JS knows the\n        // classNames to use.\n        configRules = configRules.concat([\n          {\n            oneOf: [rules.cssModules(), rules.css()],\n          },\n        ])\n\n        break\n    }\n\n    return { rules: configRules }\n  }\n\n  function getResolve() {\n    const { program } = store.getState()\n    return {\n      // Use the program's extension list (generated via the\n      // 'resolvableExtensions' API hook).\n      extensions: [...program.extensions],\n      alias: {\n        gatsby$: directoryPath(path.join(`.cache`, `gatsby-browser-entry.js`)),\n        // Using directories for module resolution is mandatory because\n        // relative path imports are used sometimes\n        // See https://stackoverflow.com/a/49455609/6420957 for more details\n        \"@babel/runtime\": path.dirname(\n          require.resolve(`@babel/runtime/package.json`)\n        ),\n        \"core-js\": path.dirname(require.resolve(`core-js/package.json`)),\n        \"react-hot-loader\": path.dirname(\n          require.resolve(`react-hot-loader/package.json`)\n        ),\n        \"react-lifecycles-compat\": directoryPath(\n          `.cache/react-lifecycles-compat.js`\n        ),\n        \"create-react-context\": directoryPath(`.cache/create-react-context.js`),\n      },\n      plugins: [\n        // Those two folders are special and contain gatsby-generated files\n        // whose dependencies should be resolved through the `gatsby` package\n        PnpWebpackPlugin.bind(directoryPath(`.cache`), module),\n        PnpWebpackPlugin.bind(directoryPath(`public`), module),\n        // Transparently resolve packages via PnP when needed; noop otherwise\n        PnpWebpackPlugin,\n      ],\n    }\n  }\n\n  function getResolveLoader() {\n    const root = [path.resolve(directory, `node_modules`)]\n\n    const userLoaderDirectoryPath = path.resolve(directory, `loaders`)\n\n    try {\n      if (fs.statSync(userLoaderDirectoryPath).isDirectory()) {\n        root.push(userLoaderDirectoryPath)\n      }\n    } catch (err) {\n      debug(`Error resolving user loaders directory`, err)\n    }\n\n    return {\n      modules: [...root, path.join(__dirname, `../loaders`), `node_modules`],\n      // Bare loaders should always be loaded via the user dependencies (loaders\n      // configured via third-party like gatsby use require.resolve)\n      plugins: [PnpWebpackPlugin.moduleLoader(`${directory}/`)],\n    }\n  }\n\n  const config = {\n    // Context is the base directory for resolving the entry option.\n    context: directory,\n    entry: getEntry(),\n    output: getOutput(),\n\n    module: getModule(),\n    plugins: getPlugins(),\n\n    // Certain \"isomorphic\" packages have different entry points for browser\n    // and server (see\n    // https://github.com/defunctzombie/package-browser-field-spec); setting\n    // the target tells webpack which file to include, ie. browser vs main.\n    target: stage === `build-html` || stage === `develop-html` ? `node` : `web`,\n\n    devtool: getDevtool(),\n    // Turn off performance hints as we (for now) don't want to show the normal\n    // webpack output anywhere.\n    performance: {\n      hints: false,\n    },\n    mode: getMode(),\n\n    resolveLoader: getResolveLoader(),\n    resolve: getResolve(),\n\n    node: {\n      __filename: true,\n    },\n  }\n\n  if (stage === `build-javascript`) {\n    config.optimization = {\n      runtimeChunk: {\n        name: `webpack-runtime`,\n      },\n      splitChunks: {\n        name: false,\n        cacheGroups: {\n          // Only create one CSS file to avoid\n          // problems with code-split CSS loading in different orders\n          // causing inconsistent/non-determanistic styling\n          // See https://github.com/gatsbyjs/gatsby/issues/11072\n          styles: {\n            name: `styles`,\n            // This should cover all our types of CSS.\n            test: /\\.(css|scss|sass|less|styl)$/,\n            chunks: `all`,\n            enforce: true,\n          },\n        },\n      },\n      minimizer: [\n        // TODO: maybe this option should be noMinimize?\n        !program.noUglify && plugins.minifyJs(),\n        plugins.minifyCss(),\n      ].filter(Boolean),\n    }\n  }\n\n  if (stage === `build-html` || stage === `develop-html`) {\n    const externalList = [\n      // match `lodash` and `lodash/foo`\n      // but not things like `lodash-es`\n      `lodash`,\n      /^lodash\\//,\n      `react`,\n      /^react-dom\\//,\n      `pify`,\n      `@reach/router`,\n      `@reach/router/lib/history`,\n      `common-tags`,\n      `path`,\n      `semver`,\n      `react-helmet`,\n      `minimatch`,\n      `fs`,\n      /^core-js\\//,\n      `es6-promise`,\n      `crypto`,\n      `zlib`,\n      `http`,\n      `https`,\n      `debug`,\n    ]\n\n    config.externals = [\n      function(context, request, callback) {\n        if (\n          externalList.some(item => {\n            if (typeof item === `string` && item === request) {\n              return true\n            } else if (item instanceof RegExp && item.test(request)) {\n              return true\n            }\n\n            return false\n          })\n        ) {\n          return callback(null, `umd ${request}`)\n        }\n        return callback()\n      },\n    ]\n  }\n\n  store.dispatch(actions.replaceWebpackConfig(config))\n  const getConfig = () => store.getState().webpack\n\n  await apiRunnerNode(`onCreateWebpackConfig`, {\n    getConfig,\n    stage,\n    rules,\n    loaders,\n    plugins,\n  })\n\n  return getConfig()\n}\n"],"file":"webpack.config.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/utils/webpack.config.js"],"names":["require","fs","path","dotenv","FriendlyErrorsWebpackPlugin","PnpWebpackPlugin","store","actions","debug","report","withBasePath","apiRunnerNode","createUtils","hasLocalEslint","module","exports","program","directory","suppliedStage","webpackPort","directoryPath","process","env","GATSBY_BUILD_STAGE","stage","rules","loaders","plugins","processEnv","defaultNodeEnv","GATSBY_ACTIVE_ENV","NODE_ENV","envFile","join","cwd","parsed","parse","readFileSync","encoding","err","code","error","envObject","Object","keys","reduce","acc","key","JSON","stringify","gatsbyVarObject","match","PUBLIC_DIR","BUILD_STAGE","CYPRESS_SUPPORT","mergedEnvVars","assign","getHmrPath","hmrBasePath","hmrSuffix","GATSBY_WEBPACK_PUBLICPATH","pubPath","substr","getOutput","filename","pathinfo","publicPath","devtoolModuleFilenameTemplate","info","resolve","absoluteResourcePath","replace","crossOriginLoading","libraryTarget","library","umdNamedDefine","globalObject","prefixPaths","getState","config","pathPrefix","chunkFilename","Error","getEntry","commons","main","app","getPlugins","configPlugins","moment","define","__PATH_PREFIX__","concat","hotModuleReplacement","noEmitOnErrors","clearConsole","extractText","extractStats","getDevtool","getMode","getModule","configRules","mjs","js","yaml","fonts","images","media","miscAssets","schema","eslint","oneOf","cssModules","css","use","null","getResolve","extensions","alias","gatsby$","dirname","bind","getResolveLoader","root","userLoaderDirectoryPath","statSync","isDirectory","push","modules","__dirname","moduleLoader","context","entry","output","target","devtool","performance","hints","mode","resolveLoader","node","__filename","optimization","runtimeChunk","name","splitChunks","cacheGroups","styles","test","chunks","enforce","minimizer","noUglify","minifyJs","minifyCss","filter","Boolean","externalList","externals","request","callback","some","item","RegExp","dispatch","replaceWebpackConfig","getConfig","webpack"],"mappings":"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","sourcesContent":["require(`v8-compile-cache`)\n\nconst fs = require(`fs-extra`)\nconst path = require(`path`)\nconst dotenv = require(`dotenv`)\nconst FriendlyErrorsWebpackPlugin = require(`@pieh/friendly-errors-webpack-plugin`)\nconst PnpWebpackPlugin = require(`pnp-webpack-plugin`)\nconst { store } = require(`../redux`)\nconst { actions } = require(`../redux/actions`)\nconst debug = require(`debug`)(`gatsby:webpack-config`)\nconst report = require(`gatsby-cli/lib/reporter`)\nconst { withBasePath } = require(`./path`)\n\nconst apiRunnerNode = require(`./api-runner-node`)\nconst createUtils = require(`./webpack-utils`)\nconst hasLocalEslint = require(`./local-eslint-config-finder`)\n\n// Four stages or modes:\n//   1) develop: for `gatsby develop` command, hot reload and CSS injection into page\n//   2) develop-html: same as develop without react-hmre in the babel config for html renderer\n//   3) build-javascript: Build JS and CSS chunks for production\n//   4) build-html: build all HTML files\n\nmodule.exports = async (\n  program,\n  directory,\n  suppliedStage,\n  webpackPort = 1500\n) => {\n  const directoryPath = withBasePath(directory)\n\n  process.env.GATSBY_BUILD_STAGE = suppliedStage\n\n  // We combine develop & develop-html stages for purposes of generating the\n  // webpack config.\n  const stage = suppliedStage\n  const { rules, loaders, plugins } = await createUtils({ stage, program })\n\n  function processEnv(stage, defaultNodeEnv) {\n    debug(`Building env for \"${stage}\"`)\n    const env =\n      process.env.GATSBY_ACTIVE_ENV ||\n      process.env.NODE_ENV ||\n      `${defaultNodeEnv}`\n    const envFile = path.join(process.cwd(), `./.env.${env}`)\n    let parsed = {}\n    try {\n      parsed = dotenv.parse(fs.readFileSync(envFile, { encoding: `utf8` }))\n    } catch (err) {\n      if (err.code !== `ENOENT`) {\n        report.error(`There was a problem processing the .env file`, err)\n      }\n    }\n\n    const envObject = Object.keys(parsed).reduce((acc, key) => {\n      acc[key] = JSON.stringify(parsed[key])\n      return acc\n    }, {})\n\n    const gatsbyVarObject = Object.keys(process.env).reduce((acc, key) => {\n      if (key.match(/^GATSBY_/)) {\n        acc[key] = JSON.stringify(process.env[key])\n      }\n      return acc\n    }, {})\n\n    // Don't allow overwriting of NODE_ENV, PUBLIC_DIR as to not break gatsby things\n    envObject.NODE_ENV = JSON.stringify(env)\n    envObject.PUBLIC_DIR = JSON.stringify(`${process.cwd()}/public`)\n    envObject.BUILD_STAGE = JSON.stringify(stage)\n    envObject.CYPRESS_SUPPORT = JSON.stringify(process.env.CYPRESS_SUPPORT)\n\n    const mergedEnvVars = Object.assign(envObject, gatsbyVarObject)\n\n    return Object.keys(mergedEnvVars).reduce(\n      (acc, key) => {\n        acc[`process.env.${key}`] = mergedEnvVars[key]\n        return acc\n      },\n      {\n        \"process.env\": JSON.stringify({}),\n      }\n    )\n  }\n\n  function getHmrPath() {\n    // ref: https://github.com/gatsbyjs/gatsby/issues/8348\n    let hmrBasePath = `/`\n    const hmrSuffix = `__webpack_hmr&reload=true&overlay=false`\n\n    if (process.env.GATSBY_WEBPACK_PUBLICPATH) {\n      const pubPath = process.env.GATSBY_WEBPACK_PUBLICPATH\n      if (pubPath.substr(-1) === `/`) {\n        hmrBasePath = pubPath\n      } else {\n        hmrBasePath = `${pubPath}/`\n      }\n    }\n\n    return hmrBasePath + hmrSuffix\n  }\n\n  debug(`Loading webpack config for stage \"${stage}\"`)\n  function getOutput() {\n    switch (stage) {\n      case `develop`:\n        return {\n          path: directory,\n          filename: `[name].js`,\n          // Add /* filename */ comments to generated require()s in the output.\n          pathinfo: true,\n          // Point sourcemap entries to original disk location (format as URL on Windows)\n          publicPath: process.env.GATSBY_WEBPACK_PUBLICPATH || `/`,\n          devtoolModuleFilenameTemplate: info =>\n            path.resolve(info.absoluteResourcePath).replace(/\\\\/g, `/`),\n          // Avoid React cross-origin errors\n          // See https://reactjs.org/docs/cross-origin-errors.html\n          crossOriginLoading: `anonymous`,\n        }\n      case `build-html`:\n      case `develop-html`:\n        // A temp file required by static-site-generator-plugin. See plugins() below.\n        // Deleted by build-html.js, since it's not needed for production.\n        return {\n          path: directoryPath(`public`),\n          filename: `render-page.js`,\n          libraryTarget: `umd`,\n          library: `lib`,\n          umdNamedDefine: true,\n          globalObject: `this`,\n          publicPath: program.prefixPaths\n            ? `${store.getState().config.pathPrefix}/`\n            : `/`,\n        }\n      case `build-javascript`:\n        return {\n          filename: `[name]-[contenthash].js`,\n          chunkFilename: `[name]-[contenthash].js`,\n          path: directoryPath(`public`),\n          publicPath: program.prefixPaths\n            ? `${store.getState().config.pathPrefix}/`\n            : `/`,\n        }\n      default:\n        throw new Error(`The state requested ${stage} doesn't exist.`)\n    }\n  }\n\n  function getEntry() {\n    switch (stage) {\n      case `develop`:\n        return {\n          commons: [\n            `event-source-polyfill`,\n            `${require.resolve(\n              `webpack-hot-middleware/client`\n            )}?path=${getHmrPath()}`,\n            directoryPath(`.cache/app`),\n          ],\n        }\n      case `develop-html`:\n        return {\n          main: directoryPath(`.cache/develop-static-entry`),\n        }\n      case `build-html`:\n        return {\n          main: directoryPath(`.cache/static-entry`),\n        }\n      case `build-javascript`:\n        return {\n          app: directoryPath(`.cache/production-app`),\n        }\n      default:\n        throw new Error(`The state requested ${stage} doesn't exist.`)\n    }\n  }\n\n  function getPlugins() {\n    let configPlugins = [\n      plugins.moment(),\n\n      // Add a few global variables. Set NODE_ENV to production (enables\n      // optimizations for React) and what the link prefix is (__PATH_PREFIX__).\n      plugins.define({\n        ...processEnv(stage, `development`),\n        __PATH_PREFIX__: JSON.stringify(\n          program.prefixPaths ? store.getState().config.pathPrefix : ``\n        ),\n      }),\n    ]\n\n    switch (stage) {\n      case `develop`:\n        configPlugins = configPlugins.concat([\n          plugins.hotModuleReplacement(),\n          plugins.noEmitOnErrors(),\n\n          new FriendlyErrorsWebpackPlugin({\n            clearConsole: false,\n          }),\n        ])\n        break\n      case `build-javascript`: {\n        configPlugins = configPlugins.concat([\n          plugins.extractText(),\n          // Write out stats object mapping named dynamic imports (aka page\n          // components) to all their async chunks.\n          plugins.extractStats(),\n        ])\n        break\n      }\n    }\n\n    return configPlugins\n  }\n\n  function getDevtool() {\n    switch (stage) {\n      case `develop`:\n        return `cheap-module-source-map`\n      // use a normal `source-map` for the html phases since\n      // it gives better line and column numbers\n      case `develop-html`:\n      case `build-html`:\n      case `build-javascript`:\n        return `source-map`\n      default:\n        return false\n    }\n  }\n\n  function getMode() {\n    switch (stage) {\n      case `build-javascript`:\n        return `production`\n      case `develop`:\n      case `develop-html`:\n      case `build-html`:\n        return `development` // So we don't uglify the html bundle\n      default:\n        return `production`\n    }\n  }\n\n  function getModule(config) {\n    // Common config for every env.\n    // prettier-ignore\n    let configRules = [\n      rules.mjs(),\n      rules.js(),\n      rules.yaml(),\n      rules.fonts(),\n      rules.images(),\n      rules.media(),\n      rules.miscAssets(),\n    ]\n    switch (stage) {\n      case `develop`: {\n        // get schema to pass to eslint config and program for directory\n        const { schema, program } = store.getState()\n\n        // if no local eslint config, then add gatsby config\n        if (!hasLocalEslint(program.directory)) {\n          configRules = configRules.concat([rules.eslint(schema)])\n        }\n\n        configRules = configRules.concat([\n          {\n            oneOf: [rules.cssModules(), rules.css()],\n          },\n        ])\n\n        break\n      }\n      case `build-html`:\n      case `develop-html`:\n        // We don't deal with CSS at all when building the HTML.\n        // The 'null' loader is used to prevent 'module not found' errors.\n        // On the other hand CSS modules loaders are necessary.\n\n        // prettier-ignore\n        configRules = configRules.concat([\n          {\n            oneOf: [\n              rules.cssModules(),\n              {\n                ...rules.css(),\n                use: [loaders.null()],\n              },\n            ],\n          },\n        ])\n        break\n\n      case `build-javascript`:\n        // We don't deal with CSS at all when building JavaScript but we still\n        // need to process the CSS so offline-plugin knows about the various\n        // assets referenced in your CSS.\n        //\n        // It's also necessary to process CSS Modules so your JS knows the\n        // classNames to use.\n        configRules = configRules.concat([\n          {\n            oneOf: [rules.cssModules(), rules.css()],\n          },\n        ])\n\n        break\n    }\n\n    return { rules: configRules }\n  }\n\n  function getResolve() {\n    const { program } = store.getState()\n    return {\n      // Use the program's extension list (generated via the\n      // 'resolvableExtensions' API hook).\n      extensions: [...program.extensions],\n      alias: {\n        gatsby$: directoryPath(path.join(`.cache`, `gatsby-browser-entry.js`)),\n        // Using directories for module resolution is mandatory because\n        // relative path imports are used sometimes\n        // See https://stackoverflow.com/a/49455609/6420957 for more details\n        \"@babel/runtime\": path.dirname(\n          require.resolve(`@babel/runtime/package.json`)\n        ),\n        \"core-js\": path.dirname(require.resolve(`core-js/package.json`)),\n        \"react-hot-loader\": path.dirname(\n          require.resolve(`react-hot-loader/package.json`)\n        ),\n        \"react-lifecycles-compat\": directoryPath(\n          `.cache/react-lifecycles-compat.js`\n        ),\n        \"create-react-context\": directoryPath(`.cache/create-react-context.js`),\n      },\n      plugins: [\n        // Those two folders are special and contain gatsby-generated files\n        // whose dependencies should be resolved through the `gatsby` package\n        PnpWebpackPlugin.bind(directoryPath(`.cache`), module),\n        PnpWebpackPlugin.bind(directoryPath(`public`), module),\n        // Transparently resolve packages via PnP when needed; noop otherwise\n        PnpWebpackPlugin,\n      ],\n    }\n  }\n\n  function getResolveLoader() {\n    const root = [path.resolve(directory, `node_modules`)]\n\n    const userLoaderDirectoryPath = path.resolve(directory, `loaders`)\n\n    try {\n      if (fs.statSync(userLoaderDirectoryPath).isDirectory()) {\n        root.push(userLoaderDirectoryPath)\n      }\n    } catch (err) {\n      debug(`Error resolving user loaders directory`, err)\n    }\n\n    return {\n      modules: [...root, path.join(__dirname, `../loaders`), `node_modules`],\n      // Bare loaders should always be loaded via the user dependencies (loaders\n      // configured via third-party like gatsby use require.resolve)\n      plugins: [PnpWebpackPlugin.moduleLoader(`${directory}/`)],\n    }\n  }\n\n  const config = {\n    // Context is the base directory for resolving the entry option.\n    context: directory,\n    entry: getEntry(),\n    output: getOutput(),\n\n    module: getModule(),\n    plugins: getPlugins(),\n\n    // Certain \"isomorphic\" packages have different entry points for browser\n    // and server (see\n    // https://github.com/defunctzombie/package-browser-field-spec); setting\n    // the target tells webpack which file to include, ie. browser vs main.\n    target: stage === `build-html` || stage === `develop-html` ? `node` : `web`,\n\n    devtool: getDevtool(),\n    // Turn off performance hints as we (for now) don't want to show the normal\n    // webpack output anywhere.\n    performance: {\n      hints: false,\n    },\n    mode: getMode(),\n\n    resolveLoader: getResolveLoader(),\n    resolve: getResolve(),\n\n    node: {\n      __filename: true,\n    },\n  }\n\n  if (stage === `build-javascript`) {\n    config.optimization = {\n      runtimeChunk: {\n        name: `webpack-runtime`,\n      },\n      splitChunks: {\n        name: false,\n        cacheGroups: {\n          // Only create one CSS file to avoid\n          // problems with code-split CSS loading in different orders\n          // causing inconsistent/non-determanistic styling\n          // See https://github.com/gatsbyjs/gatsby/issues/11072\n          styles: {\n            name: `styles`,\n            // This should cover all our types of CSS.\n            test: /\\.(css|scss|sass|less|styl)$/,\n            chunks: `all`,\n            enforce: true,\n          },\n        },\n      },\n      minimizer: [\n        // TODO: maybe this option should be noMinimize?\n        !program.noUglify && plugins.minifyJs(),\n        plugins.minifyCss(),\n      ].filter(Boolean),\n    }\n  }\n\n  if (stage === `build-html` || stage === `develop-html`) {\n    const externalList = [\n      // match `lodash` and `lodash/foo`\n      // but not things like `lodash-es`\n      `lodash`,\n      /^lodash\\//,\n      `react`,\n      /^react-dom\\//,\n      `pify`,\n      `@reach/router`,\n      `@reach/router/lib/history`,\n      `common-tags`,\n      `path`,\n      `semver`,\n      `react-helmet`,\n      `minimatch`,\n      `fs`,\n      /^core-js\\//,\n      `es6-promise`,\n      `crypto`,\n      `zlib`,\n      `http`,\n      `https`,\n      `debug`,\n    ]\n\n    config.externals = [\n      function(context, request, callback) {\n        if (\n          externalList.some(item => {\n            if (typeof item === `string` && item === request) {\n              return true\n            } else if (item instanceof RegExp && item.test(request)) {\n              return true\n            }\n\n            return false\n          })\n        ) {\n          return callback(null, `umd ${request}`)\n        }\n        return callback()\n      },\n    ]\n  }\n\n  store.dispatch(actions.replaceWebpackConfig(config))\n  const getConfig = () => store.getState().webpack\n\n  await apiRunnerNode(`onCreateWebpackConfig`, {\n    getConfig,\n    stage,\n    rules,\n    loaders,\n    plugins,\n  })\n\n  return getConfig()\n}\n"],"file":"webpack.config.js"}
\ No newline at end of file
diff --git a/node_modules/gatsby/dist/utils/websocket-manager.js b/node_modules/gatsby/dist/utils/websocket-manager.js
index 2371f8a..40ba298 100644
--- a/node_modules/gatsby/dist/utils/websocket-manager.js
+++ b/node_modules/gatsby/dist/utils/websocket-manager.js
@@ -6,8 +6,9 @@ var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/de
 
 const path = require(`path`);
 
-const _require = require(`../redux`),
-      store = _require.store;
+const {
+  store
+} = require(`../redux`);
 
 const fs = require(`fs`);
 
@@ -28,10 +29,10 @@ const readCachedResults = (dataFileName, directory) => {
 
 
 const getCachedPageData = (pagePath, directory) => {
-  const _store$getState = store.getState(),
-        jsonDataPaths = _store$getState.jsonDataPaths,
-        pages = _store$getState.pages;
-
+  const {
+    jsonDataPaths,
+    pages
+  } = store.getState();
   const page = pages.get(pagePath);
 
   if (!page) {
@@ -59,11 +60,10 @@ const getCachedPageData = (pagePath, directory) => {
 
 const getCachedStaticQueryResults = (resultsMap, directory) => {
   const cachedStaticQueryResults = new Map();
-
-  const _store$getState2 = store.getState(),
-        staticQueryComponents = _store$getState2.staticQueryComponents,
-        jsonDataPaths = _store$getState2.jsonDataPaths;
-
+  const {
+    staticQueryComponents,
+    jsonDataPaths
+  } = store.getState();
   staticQueryComponents.forEach(staticQueryComponent => {
     // Don't read from file if results were already passed from query runner
     if (resultsMap.has(staticQueryComponent.hash)) return;
diff --git a/node_modules/gatsby/dist/utils/websocket-manager.js.map b/node_modules/gatsby/dist/utils/websocket-manager.js.map
index 8f86eb2..ac72f4f 100644
--- a/node_modules/gatsby/dist/utils/websocket-manager.js.map
+++ b/node_modules/gatsby/dist/utils/websocket-manager.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/utils/websocket-manager.js"],"names":["path","require","store","fs","readCachedResults","dataFileName","directory","filePath","join","JSON","parse","readFileSync","getCachedPageData","pagePath","getState","jsonDataPaths","pages","page","get","dataPath","jsonName","console","log","undefined","result","id","getCachedStaticQueryResults","resultsMap","cachedStaticQueryResults","Map","staticQueryComponents","forEach","staticQueryComponent","has","hash","componentPath","set","getRoomNameFromPath","WebsocketManager","constructor","isInitialised","activePaths","Set","pageResults","staticQueryResults","errors","init","bind","getSocket","emitPageData","emitStaticQueryData","emitError","server","programDir","websocket","on","s","activePath","send","type","payload","message","errorID","leaveRoom","leave","leftRoom","sockets","adapter","rooms","length","delete","getDataForPath","why","add","data","manager","module","exports"],"mappings":"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","sourcesContent":["// @flow\n\nconst path = require(`path`)\nconst { store } = require(`../redux`)\nconst fs = require(`fs`)\n\ntype QueryResult = {\n  id: string,\n  result: object,\n}\n\ntype QueryResultsMap = Map<string, QueryResult>\n\n/**\n * Get cached query result for given data path.\n * @param {string} dataFileName Cached query result filename.\n * @param {string} directory Root directory of current project.\n */\nconst readCachedResults = (dataFileName: string, directory: string): object => {\n  const filePath = path.join(\n    directory,\n    `public`,\n    `static`,\n    `d`,\n    `${dataFileName}.json`\n  )\n  return JSON.parse(fs.readFileSync(filePath, `utf-8`))\n}\n\n/**\n * Get cached page query result for given page path.\n * @param {string} pagePath Path to a page.\n * @param {string} directory Root directory of current project.\n */\nconst getCachedPageData = (\n  pagePath: string,\n  directory: string\n): QueryResult => {\n  const { jsonDataPaths, pages } = store.getState()\n  const page = pages.get(pagePath)\n  if (!page) {\n    return null\n  }\n  const dataPath = jsonDataPaths[page.jsonName]\n  if (typeof dataPath === `undefined`) {\n    console.log(\n      `Error loading a result for the page query in \"${pagePath}\". Query was not run and no cached result was found.`\n    )\n    return undefined\n  }\n\n  return {\n    result: readCachedResults(dataPath, directory),\n    id: pagePath,\n  }\n}\n\n/**\n * Get cached StaticQuery results for components that Gatsby didn't run query yet.\n * @param {QueryResultsMap} resultsMap Already stored results for queries that don't need to be read from files.\n * @param {string} directory Root directory of current project.\n */\nconst getCachedStaticQueryResults = (\n  resultsMap: QueryResultsMap,\n  directory: string\n): QueryResultsMap => {\n  const cachedStaticQueryResults = new Map()\n  const { staticQueryComponents, jsonDataPaths } = store.getState()\n  staticQueryComponents.forEach(staticQueryComponent => {\n    // Don't read from file if results were already passed from query runner\n    if (resultsMap.has(staticQueryComponent.hash)) return\n\n    const dataPath = jsonDataPaths[staticQueryComponent.jsonName]\n    if (typeof dataPath === `undefined`) {\n      console.log(\n        `Error loading a result for the StaticQuery in \"${\n          staticQueryComponent.componentPath\n        }\". Query was not run and no cached result was found.`\n      )\n      return\n    }\n    cachedStaticQueryResults.set(staticQueryComponent.hash, {\n      result: readCachedResults(dataPath, directory),\n      id: staticQueryComponent.hash,\n    })\n  })\n  return cachedStaticQueryResults\n}\n\nconst getRoomNameFromPath = (path: string): string => `path-${path}`\n\nclass WebsocketManager {\n  pageResults: QueryResultsMap\n  staticQueryResults: QueryResultsMap\n  errors: Map<string, QueryResult>\n  isInitialised: boolean\n  activePaths: Set<string>\n  programDir: string\n\n  constructor() {\n    this.isInitialised = false\n    this.activePaths = new Set()\n    this.pageResults = new Map()\n    this.staticQueryResults = new Map()\n    this.errors = new Map()\n    // this.websocket\n    // this.programDir\n\n    this.init = this.init.bind(this)\n    this.getSocket = this.getSocket.bind(this)\n    this.emitPageData = this.emitPageData.bind(this)\n    this.emitStaticQueryData = this.emitStaticQueryData.bind(this)\n    this.emitError = this.emitError.bind(this)\n  }\n\n  init({ server, directory }) {\n    this.programDir = directory\n\n    const cachedStaticQueryResults = getCachedStaticQueryResults(\n      this.staticQueryResults,\n      this.programDir\n    )\n    this.staticQueryResults = new Map([\n      ...this.staticQueryResults,\n      ...cachedStaticQueryResults,\n    ])\n\n    this.websocket = require(`socket.io`)(server)\n\n    this.websocket.on(`connection`, s => {\n      let activePath = null\n      // Send already existing static query results\n      this.staticQueryResults.forEach(result => {\n        this.websocket.send({\n          type: `staticQueryResult`,\n          payload: result,\n        })\n      })\n      this.errors.forEach((message, errorID) => {\n        this.websocket.send({\n          type: `overlayError`,\n          payload: {\n            id: errorID,\n            message,\n          },\n        })\n      })\n\n      const leaveRoom = path => {\n        s.leave(getRoomNameFromPath(path))\n        const leftRoom = this.websocket.sockets.adapter.rooms[\n          getRoomNameFromPath(path)\n        ]\n        if (!leftRoom || leftRoom.length === 0) {\n          this.activePaths.delete(path)\n        }\n      }\n\n      const getDataForPath = path => {\n        if (!this.pageResults.has(path)) {\n          const result = getCachedPageData(path, this.programDir)\n          if (result) {\n            this.pageResults.set(path, result)\n          } else {\n            console.log(`Page not found`, path)\n            return\n          }\n        }\n\n        this.websocket.send({\n          type: `pageQueryResult`,\n          why: `getDataForPath`,\n          payload: this.pageResults.get(path),\n        })\n      }\n\n      s.on(`getDataForPath`, getDataForPath)\n\n      s.on(`registerPath`, path => {\n        s.join(getRoomNameFromPath(path))\n        activePath = path\n        this.activePaths.add(path)\n      })\n\n      s.on(`disconnect`, s => {\n        leaveRoom(activePath)\n      })\n\n      s.on(`unregisterPath`, path => {\n        leaveRoom(path)\n      })\n    })\n\n    this.isInitialised = true\n  }\n\n  getSocket() {\n    return this.isInitialised && this.websocket\n  }\n\n  emitStaticQueryData(data: QueryResult) {\n    this.staticQueryResults.set(data.id, data)\n    if (this.isInitialised) {\n      this.websocket.send({ type: `staticQueryResult`, payload: data })\n    }\n  }\n\n  emitPageData(data: QueryResult) {\n    this.pageResults.set(data.id, data)\n    if (this.isInitialised) {\n      this.websocket.send({ type: `pageQueryResult`, payload: data })\n    }\n  }\n  emitError(id: string, message?: string) {\n    if (message) {\n      this.errors.set(id, message)\n    } else {\n      this.errors.delete(id)\n    }\n\n    if (this.isInitialised) {\n      this.websocket.send({ type: `overlayError`, payload: { id, message } })\n    }\n  }\n}\n\nconst manager = new WebsocketManager()\n\nmodule.exports = manager\n"],"file":"websocket-manager.js"}
\ No newline at end of file
+{"version":3,"sources":["../../src/utils/websocket-manager.js"],"names":["path","require","store","fs","readCachedResults","dataFileName","directory","filePath","join","JSON","parse","readFileSync","getCachedPageData","pagePath","jsonDataPaths","pages","getState","page","get","dataPath","jsonName","console","log","undefined","result","id","getCachedStaticQueryResults","resultsMap","cachedStaticQueryResults","Map","staticQueryComponents","forEach","staticQueryComponent","has","hash","componentPath","set","getRoomNameFromPath","WebsocketManager","constructor","isInitialised","activePaths","Set","pageResults","staticQueryResults","errors","init","bind","getSocket","emitPageData","emitStaticQueryData","emitError","server","programDir","websocket","on","s","activePath","send","type","payload","message","errorID","leaveRoom","leave","leftRoom","sockets","adapter","rooms","length","delete","getDataForPath","why","add","data","manager","module","exports"],"mappings":"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","sourcesContent":["// @flow\n\nconst path = require(`path`)\nconst { store } = require(`../redux`)\nconst fs = require(`fs`)\n\ntype QueryResult = {\n  id: string,\n  result: object,\n}\n\ntype QueryResultsMap = Map<string, QueryResult>\n\n/**\n * Get cached query result for given data path.\n * @param {string} dataFileName Cached query result filename.\n * @param {string} directory Root directory of current project.\n */\nconst readCachedResults = (dataFileName: string, directory: string): object => {\n  const filePath = path.join(\n    directory,\n    `public`,\n    `static`,\n    `d`,\n    `${dataFileName}.json`\n  )\n  return JSON.parse(fs.readFileSync(filePath, `utf-8`))\n}\n\n/**\n * Get cached page query result for given page path.\n * @param {string} pagePath Path to a page.\n * @param {string} directory Root directory of current project.\n */\nconst getCachedPageData = (\n  pagePath: string,\n  directory: string\n): QueryResult => {\n  const { jsonDataPaths, pages } = store.getState()\n  const page = pages.get(pagePath)\n  if (!page) {\n    return null\n  }\n  const dataPath = jsonDataPaths[page.jsonName]\n  if (typeof dataPath === `undefined`) {\n    console.log(\n      `Error loading a result for the page query in \"${pagePath}\". Query was not run and no cached result was found.`\n    )\n    return undefined\n  }\n\n  return {\n    result: readCachedResults(dataPath, directory),\n    id: pagePath,\n  }\n}\n\n/**\n * Get cached StaticQuery results for components that Gatsby didn't run query yet.\n * @param {QueryResultsMap} resultsMap Already stored results for queries that don't need to be read from files.\n * @param {string} directory Root directory of current project.\n */\nconst getCachedStaticQueryResults = (\n  resultsMap: QueryResultsMap,\n  directory: string\n): QueryResultsMap => {\n  const cachedStaticQueryResults = new Map()\n  const { staticQueryComponents, jsonDataPaths } = store.getState()\n  staticQueryComponents.forEach(staticQueryComponent => {\n    // Don't read from file if results were already passed from query runner\n    if (resultsMap.has(staticQueryComponent.hash)) return\n\n    const dataPath = jsonDataPaths[staticQueryComponent.jsonName]\n    if (typeof dataPath === `undefined`) {\n      console.log(\n        `Error loading a result for the StaticQuery in \"${\n          staticQueryComponent.componentPath\n        }\". Query was not run and no cached result was found.`\n      )\n      return\n    }\n    cachedStaticQueryResults.set(staticQueryComponent.hash, {\n      result: readCachedResults(dataPath, directory),\n      id: staticQueryComponent.hash,\n    })\n  })\n  return cachedStaticQueryResults\n}\n\nconst getRoomNameFromPath = (path: string): string => `path-${path}`\n\nclass WebsocketManager {\n  pageResults: QueryResultsMap\n  staticQueryResults: QueryResultsMap\n  errors: Map<string, QueryResult>\n  isInitialised: boolean\n  activePaths: Set<string>\n  programDir: string\n\n  constructor() {\n    this.isInitialised = false\n    this.activePaths = new Set()\n    this.pageResults = new Map()\n    this.staticQueryResults = new Map()\n    this.errors = new Map()\n    // this.websocket\n    // this.programDir\n\n    this.init = this.init.bind(this)\n    this.getSocket = this.getSocket.bind(this)\n    this.emitPageData = this.emitPageData.bind(this)\n    this.emitStaticQueryData = this.emitStaticQueryData.bind(this)\n    this.emitError = this.emitError.bind(this)\n  }\n\n  init({ server, directory }) {\n    this.programDir = directory\n\n    const cachedStaticQueryResults = getCachedStaticQueryResults(\n      this.staticQueryResults,\n      this.programDir\n    )\n    this.staticQueryResults = new Map([\n      ...this.staticQueryResults,\n      ...cachedStaticQueryResults,\n    ])\n\n    this.websocket = require(`socket.io`)(server)\n\n    this.websocket.on(`connection`, s => {\n      let activePath = null\n      // Send already existing static query results\n      this.staticQueryResults.forEach(result => {\n        this.websocket.send({\n          type: `staticQueryResult`,\n          payload: result,\n        })\n      })\n      this.errors.forEach((message, errorID) => {\n        this.websocket.send({\n          type: `overlayError`,\n          payload: {\n            id: errorID,\n            message,\n          },\n        })\n      })\n\n      const leaveRoom = path => {\n        s.leave(getRoomNameFromPath(path))\n        const leftRoom = this.websocket.sockets.adapter.rooms[\n          getRoomNameFromPath(path)\n        ]\n        if (!leftRoom || leftRoom.length === 0) {\n          this.activePaths.delete(path)\n        }\n      }\n\n      const getDataForPath = path => {\n        if (!this.pageResults.has(path)) {\n          const result = getCachedPageData(path, this.programDir)\n          if (result) {\n            this.pageResults.set(path, result)\n          } else {\n            console.log(`Page not found`, path)\n            return\n          }\n        }\n\n        this.websocket.send({\n          type: `pageQueryResult`,\n          why: `getDataForPath`,\n          payload: this.pageResults.get(path),\n        })\n      }\n\n      s.on(`getDataForPath`, getDataForPath)\n\n      s.on(`registerPath`, path => {\n        s.join(getRoomNameFromPath(path))\n        activePath = path\n        this.activePaths.add(path)\n      })\n\n      s.on(`disconnect`, s => {\n        leaveRoom(activePath)\n      })\n\n      s.on(`unregisterPath`, path => {\n        leaveRoom(path)\n      })\n    })\n\n    this.isInitialised = true\n  }\n\n  getSocket() {\n    return this.isInitialised && this.websocket\n  }\n\n  emitStaticQueryData(data: QueryResult) {\n    this.staticQueryResults.set(data.id, data)\n    if (this.isInitialised) {\n      this.websocket.send({ type: `staticQueryResult`, payload: data })\n    }\n  }\n\n  emitPageData(data: QueryResult) {\n    this.pageResults.set(data.id, data)\n    if (this.isInitialised) {\n      this.websocket.send({ type: `pageQueryResult`, payload: data })\n    }\n  }\n  emitError(id: string, message?: string) {\n    if (message) {\n      this.errors.set(id, message)\n    } else {\n      this.errors.delete(id)\n    }\n\n    if (this.isInitialised) {\n      this.websocket.send({ type: `overlayError`, payload: { id, message } })\n    }\n  }\n}\n\nconst manager = new WebsocketManager()\n\nmodule.exports = manager\n"],"file":"websocket-manager.js"}
\ No newline at end of file
